/*! This file includes third-party software, governed by the licenses described here: https://steamcommunity.com/public/javascript/webui/friends.licenses.txt */










/**** (c) Valve Corporation. Use is governed by the terms of the Steam Subscriber Agreement http://store.steampowered.com/subscriber_agreement/. 
****/
!function(c){function e(e){for(var t,n,o=e[0],i=e[1],r=e[2],a=0,s=[];a<o.length;a++)n=o[a],p[n]&&s.push(p[n][0]),p[n]=0;for(t in i)Object.prototype.hasOwnProperty.call(i,t)&&(c[t]=i[t]);for(m&&m(e);s.length;)s.shift()();return u.push.apply(u,r||[]),l()}function l(){for(var e,t=0;t<u.length;t++){for(var n=u[t],o=!0,i=1;i<n.length;i++){var r=n[i];0!==p[r]&&(o=!1)}o&&(u.splice(t--,1),e=a(a.s=n[0]))}return e}var n={},p={3:0},u=[];function a(e){if(n[e])return n[e].exports;var t=n[e]={i:e,l:!1,exports:{}};return c[e].call(t.exports,t,t.exports,a),t.l=!0,t.exports}a.m=c,a.c=n,a.d=function(e,t,n){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(t,e){if(1&e&&(t=a(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)a.d(n,o,function(e){return t[e]}.bind(null,o));return n},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="";var t=window.webpackJsonp=window.webpackJsonp||[],o=t.push.bind(t);t.push=e,t=t.slice();for(var i=0;i<t.length;i++)e(t[i]);var m=o;u.push(["gfbn",4,0,6]),l()}({"/7KC":function(e,t,n){"use strict";function o(e,t){return e=Math.ceil(e),t=Math.floor(t),Math.floor(Math.random()*(t-e+1))+e}function i(e,t,n){return Math.max(t,Math.min(n,e))}function r(e,t,n,o,i){return o+(i-o)*(e-t)/(n-t)}n.d(t,"b",function(){return o}),n.d(t,"a",function(){return i}),n.d(t,"c",function(){return r})},"/IDK":function(e,t,n){"use strict";n.d(t,"c",function(){return i}),n.d(t,"e",function(){return r}),n.d(t,"d",function(){return a}),n.d(t,"a",function(){return s}),n.d(t,"o",function(){return c}),n.d(t,"k",function(){return l}),n.d(t,"h",function(){return p}),n.d(t,"m",function(){return u}),n.d(t,"l",function(){return m}),n.d(t,"i",function(){return d}),n.d(t,"j",function(){return h}),n.d(t,"b",function(){return _}),n.d(t,"n",function(){return f}),n.d(t,"g",function(){return g}),n.d(t,"f",function(){return b});var o=n("UqDm");n("XaMz");function i(e){if(!(e.clientX||e.clientY||e.screenX||e.screenY))return!0;if(e.relatedTarget)return!r(e.currentTarget,e.relatedTarget);var t=e.currentTarget.getBoundingClientRect();return(e.clientX<=t.left||e.clientX>=t.right||e.clientY<=t.top||e.clientY>=t.bottom)&&(console.log(e.clientX+" <= "+t.left+" || "+e.clientX+" >= "+t.right+" ||\n\t\t\t\t"+e.clientY+" <= "+t.top+" || "+e.clientY+" >= "+t.bottom),!0)}function r(e,t){for(;t;){if(t.parentNode.nodeType==Node.DOCUMENT_FRAGMENT_NODE&&(t=t.parentNode.host),t==e)return!0;t=t.parentElement}return!1}function a(e,t){for(;t;)if((t=t.parentElement)==e)return!0;return!1}function s(e){if(!window.getSelection)return!1;for(var t=window.getSelection(),n=0,o=0;o<t.rangeCount;o++){var i=t.getRangeAt(o);if(i.startOffset!=i.endOffset)r(e,i.commonAncestorContainer)&&n++}return 0<t.rangeCount&&t.rangeCount==n}function c(e,t){var n=e.offsetTop;e.offsetParent!=t&&(n-=t.offsetTop),n<t.scrollTop?e.scrollIntoView(!0):n+e.offsetHeight>t.scrollTop+t.offsetHeight&&e.scrollIntoView(!1)}function l(e,t,n){var o=0,i=0;return t<e.left?o=e.left-t:t>e.right&&(o=t-e.right),n<e.top?i=e.top-n:n>e.bottom&&(i=n-e.bottom),Math.sqrt(o*o+i*i)}function p(e,t){return{width:t.width,height:t.height,top:e.screenTop+t.top,bottom:e.screenTop+t.bottom,left:e.screenLeft+t.left,right:e.screenLeft+t.right}}function u(e){var t=void 0;return e&&e.currentTarget&&(t=e.currentTarget.ownerDocument.defaultView),t}function m(e){var t=void 0;return e&&(t=e.ownerDocument.defaultView),t}function d(e){var t=document.createElement("textarea");t.textContent=e,t.style.position="fixed",document.body.appendChild(t),t.select();try{document.execCommand("copy")}catch(e){console.warn("Copy to clipboard failed.",e)}finally{document.body.removeChild(t)}}function h(e){var t="steam://openurl/";e.startsWith(t)&&(e=e.slice(t.length)),d(e)}function _(e){var t=e.ownerDocument;return t.fullscreen||t.webkitIsFullScreen||t.mozFullScreen||t.msFullscreenElement}function f(e){var t=e;t.requestFullscreen?t.requestFullscreen():t.webkitRequestFullScreen?t.webkitRequestFullScreen():t.mozRequestFullScreen?t.mozRequestFullScreen():t.msRequestFullscreen&&t.msRequestFullscreen()}function g(e){var t=e.ownerDocument;t.cancelFullscreen?t.cancelFullscreen():t.webkitCancelFullScreen?t.webkitCancelFullScreen():t.mozCancelFullScreen?t.mozCancelFullScreen():t.msExitFullscreen&&t.msExitFullscreen()}var b=function(){function e(e){var r=this;this.m_bNeedSort=!1,this.m_bOffsetsInvalidated=!1,this.m_rgChildren=[],this.RecomputeVisibility=function(){var e=r.m_elParent.scrollTop-r.m_nBufferPx,t=r.m_elParent.scrollTop+r.m_elParent.clientHeight+r.m_nBufferPx;r.EnsureSort();for(var n=0,o=r.m_rgChildren;n<o.length;n++){var i=o[n];if(!(i.yOffset<e)){if(i.yOffset>t)break;i.fnCallback(!0)}}r.m_nLastYMin=e,r.m_nLastYMax=t},this.m_nBufferPx=e}return e.prototype.SetParent=function(e){this.m_elParent&&this.m_elParent.ownerDocument.defaultView.removeEventListener("resize",this.RecomputeVisibility),this.m_elParent=e,this.m_elParent&&this.m_elParent.ownerDocument.defaultView.addEventListener("resize",this.RecomputeVisibility)},e.prototype.InvalidateOffsetsAndRecompute=function(){this.m_bOffsetsInvalidated=!0,this.RecomputeVisibility()},e.prototype.EnsureSort=function(){if(this.m_bOffsetsInvalidated){for(var e=0;e<this.m_rgChildren.length;e++)this.m_rgChildren[e].yOffset=this.m_rgChildren[e].element.offsetTop;this.m_bOffsetsInvalidated=!1}this.m_bNeedSort&&(this.m_rgChildren.sort(function(e,t){return e.yOffset-t.yOffset}),this.m_bNeedSort=!1)},e.prototype.RegisterChild=function(e,t){this.m_rgChildren.push({element:e,yOffset:e.offsetTop,fnCallback:t}),this.m_bNeedSort=!0,void 0!==this.m_nLastYMin&&void 0!==this.m_nLastYMax&&e.offsetTop>=this.m_nLastYMin&&e.offsetTop<=this.m_nLastYMax&&t(!0)},e.prototype.UnregisterChild=function(t){o.e(this.m_rgChildren,function(e){return e.element==t})},e}()},"0N1H":function(e,t,n){"use strict";function o(e){return 3==e||6==e}function i(e){return 5==e||6==e}n.d(t,"b",function(){return o}),n.d(t,"a",function(){return i}),n.d(t,"m",function(){return l}),n.d(t,"n",function(){return p}),n.d(t,"f",function(){return u}),n.d(t,"g",function(){return m}),n.d(t,"l",function(){return d}),n.d(t,"h",function(){return h}),n.d(t,"i",function(){return _}),n.d(t,"k",function(){return f}),n.d(t,"j",function(){return g}),n.d(t,"c",function(){return b}),n.d(t,"e",function(){return v}),n.d(t,"d",function(){return S});var r,a,s,c,l=1,p=4,u=750,m=799,d=7,h=250820,_=330050,f=358510,g=366490,b="18446744073709551615",v=0,S=2147483647;(a=r||(r={}))[a.k_EOtherEvent=1]="k_EOtherEvent",a[a.k_EGameEvent=2]="k_EGameEvent",a[a.k_EPartyEvent=3]="k_EPartyEvent",a[a.k_EMeetingEvent=4]="k_EMeetingEvent",a[a.k_ESpecialCauseEvent=5]="k_ESpecialCauseEvent",a[a.k_EMusicAndArtsEvent=6]="k_EMusicAndArtsEvent",a[a.k_ESportsEvent=7]="k_ESportsEvent",a[a.k_ETripEvent=8]="k_ETripEvent",a[a.k_EChatEvent=9]="k_EChatEvent",a[a.k_EGameReleaseEvent=10]="k_EGameReleaseEvent",a[a.k_EBroadcastEvent=11]="k_EBroadcastEvent",a[a.k_ESmallUpdateEvent=12]="k_ESmallUpdateEvent",a[a.k_EPreAnnounceMajorUpdateEvent=13]="k_EPreAnnounceMajorUpdateEvent",a[a.k_EMajorUpdateEvent=14]="k_EMajorUpdateEvent",a[a.k_EDLCReleaseEvent=15]="k_EDLCReleaseEvent",a[a.k_EFutureReleaseEvent=16]="k_EFutureReleaseEvent",a[a.k_EESportTournamentStreamEvent=17]="k_EESportTournamentStreamEvent",a[a.k_EDevStreamEvent=18]="k_EDevStreamEvent",a[a.k_EFamousStreamEvent=19]="k_EFamousStreamEvent",a[a.k_EGameSalesEvent=20]="k_EGameSalesEvent",a[a.k_EGameItemSalesEvent=21]="k_EGameItemSalesEvent",a[a.k_EInGameBonusXPEvent=22]="k_EInGameBonusXPEvent",a[a.k_EInGameLootEvent=23]="k_EInGameLootEvent",a[a.k_EInGamePerksEvent=24]="k_EInGamePerksEvent",a[a.k_EInGameChallengeEvent=25]="k_EInGameChallengeEvent",a[a.k_EInGameContestEvent=26]="k_EInGameContestEvent",a[a.k_EIRLEvent=27]="k_EIRLEvent",a[a.k_ENewsEvent=28]="k_ENewsEvent",a[a.k_EBetaReleaseEvent=29]="k_EBetaReleaseEvent",a[a.k_EInGameContentReleaseEvent=30]="k_EInGameContentReleaseEvent",(c=s||(s={}))[c.k_ELaunchSource_None=0]="k_ELaunchSource_None",c[c.k_ELaunchSource_2ftLibraryDetails=100]="k_ELaunchSource_2ftLibraryDetails",c[c.k_ELaunchSource_2ftLibraryListView=101]="k_ELaunchSource_2ftLibraryListView",c[c.k_ELaunchSource_2ftLibraryGrid=103]="k_ELaunchSource_2ftLibraryGrid",c[c.k_ELaunchSource_InstallSubComplete=104]="k_ELaunchSource_InstallSubComplete",c[c.k_ELaunchSource_DownloadsPage=105]="k_ELaunchSource_DownloadsPage",c[c.k_ELaunchSource_RemoteClientStartStreaming=106]="k_ELaunchSource_RemoteClientStartStreaming",c[c.k_ELaunchSource_2ftMiniModeList=107]="k_ELaunchSource_2ftMiniModeList",c[c.k_ELaunchSource_10ft=200]="k_ELaunchSource_10ft",c[c.k_ELaunchSource_DashAppLaunchCmdLine=300]="k_ELaunchSource_DashAppLaunchCmdLine",c[c.k_ELaunchSource_DashGameIdLaunchCmdLine=301]="k_ELaunchSource_DashGameIdLaunchCmdLine",c[c.k_ELaunchSource_RunByGameDir=302]="k_ELaunchSource_RunByGameDir",c[c.k_ELaunchSource_SubCmdRunDashGame=303]="k_ELaunchSource_SubCmdRunDashGame",c[c.k_ELaunchSource_SteamURL_Launch=400]="k_ELaunchSource_SteamURL_Launch",c[c.k_ELaunchSource_SteamURL_Run=401]="k_ELaunchSource_SteamURL_Run",c[c.k_ELaunchSource_SteamURL_JoinLobby=402]="k_ELaunchSource_SteamURL_JoinLobby",c[c.k_ELaunchSource_SteamURL_RunGame=403]="k_ELaunchSource_SteamURL_RunGame",c[c.k_ELaunchSource_SteamURL_RunGameIdOrJumplist=404]="k_ELaunchSource_SteamURL_RunGameIdOrJumplist",c[c.k_ELaunchSource_SteamURL_RunSafe=405]="k_ELaunchSource_SteamURL_RunSafe",c[c.k_ELaunchSource_TrayIcon=500]="k_ELaunchSource_TrayIcon",c[c.k_ELaunchSource_LibraryLeftColumnContextMenu=600]="k_ELaunchSource_LibraryLeftColumnContextMenu",c[c.k_ELaunchSource_LibraryLeftColumnDoubleClick=601]="k_ELaunchSource_LibraryLeftColumnDoubleClick",c[c.k_ELaunchSource_Dota2Launcher=700]="k_ELaunchSource_Dota2Launcher",c[c.k_ELaunchSource_IRunGameEngine=800]="k_ELaunchSource_IRunGameEngine",c[c.k_ELaunchSource_DRMFailureResponse=801]="k_ELaunchSource_DRMFailureResponse",c[c.k_ELaunchSource_DRMDataRequest=802]="k_ELaunchSource_DRMDataRequest",c[c.k_ELaunchSource_CloudFilePanel=803]="k_ELaunchSource_CloudFilePanel",c[c.k_ELaunchSource_DiscoveredAlreadyRunning=804]="k_ELaunchSource_DiscoveredAlreadyRunning",c[c.k_ELaunchSource_GameActionJoinParty=900]="k_ELaunchSource_GameActionJoinParty"},"1VtQ":function(e,t,n){"use strict";function o(e,t,n){return{get:function(){var e=n.value.bind(this);return this.hasOwnProperty(t)||Object.defineProperty(this,t,{value:e}),e}}}function i(e,t,n){return[e,t,n]}n.d(t,"a",function(){return o}),n.d(t,"b",function(){return i})},"1n9R":function(e,t,n){"use strict";n("mrSG");var o=n("/7KC");n.d(t,"b",function(){return i}),n.d(t,"e",function(){return r}),n.d(t,"a",function(){return a}),n.d(t,"d",function(){return l}),n.d(t,"c",function(){return p});var i={EUNIVERSE:0,WEB_UNIVERSE:"",LANGUAGE:"english",SUPPORTED_LANGUAGES:[],COUNTRY:"",CDN_URL:"",MEDIA_CDN_COMMUNITY_URL:"",MEDIA_CDN_URL:"",COMMUNITY_CDN_URL:"",COMMUNITY_CDN_ASSET_URL:"",PUBLIC_SHARED_URL:"",COMMUNITY_BASE_URL:"",CHAT_BASE_URL:"",STORE_BASE_URL:"",STORE_ICON_BASE_URL:"",IMG_URL:"",STEAMTV_BASE_URL:"",HELP_BASE_URL:"",IN_CLIENT:!1,USE_POPUPS:!1,IN_MOBILE:!1,IN_TENFOOT:!1,WEBAPI_BASE_URL:"",TOKEN_URL:"",SESSIONID:"",BUILD_TIMESTAMP:0,FRIENDSUI_BETA:!1,STEAM_TV:!1},r={logged_in:!1,steamid:"",accountid:0,account_name:"",token:void 0,token_use_id:void 0,webapi_token:"",authwgtoken:""},a={steamid:""},s="webui_config";function c(){if(i.IN_CLIENT){var e=function(){for(var e="",t=0;t<24;t++)e+=Object(o.b)(0,35).toString(36);return e}();!function(e,t,n,o){o||(o="/");var i="";if(void 0!==n&&n){var r=new Date;r.setTime(r.getTime()+864e5*n),i="; expires="+r.toUTCString()}document.cookie=encodeURIComponent(e)+"="+encodeURIComponent(t)+i+";path="+o}("sessionid",e,0),i.SESSIONID=e}}function l(e){void 0===e&&(e=s);var t=p("config",e);t&&Object.assign(i,t);var n=p("userinfo",e);n&&Object.assign(r,n),c()}function p(e,t){void 0===t&&(t=s);var n=document.getElementById(t);if(n)try{return JSON.parse(n.getAttribute("data-"+e)||"")}catch(e){console.error("Failed to parse config",e)}else console.error("Missing config element #"+t)}},"7oej":function(e,t,n){},"8o0Y":function(e,t,n){"use strict";n.d(t,"b",function(){return c}),n.d(t,"a",function(){return p});var o=n("mrSG"),i=n("q1tI"),r=n("/IDK"),a=n("EGkk"),l=n("G+3Z"),s=n("2vnA"),c=function(){function e(){}return e.GetBrowserInfoForPopup=function(e){return null},e.prototype.SetTakeFocus=function(e){this.m_fnTakeFocus=e},e}();function p(e,t,n){var o,i=void 0,r=void 0,a=t;if(a.preventDefault&&a.stopPropagation){if(a.shiftKey)return null;a.preventDefault(),a.stopPropagation(),o=a.currentTarget,i=a.clientX,r=a.clientY}else o=t;var s=new m(e,o,i,r,n);return s.Show(),s}var u=function(n){function e(e){var t=n.call(this)||this;return t.m_bVisible=!1,t.m_elSubmenuItem=null,t.m_timerHideSubMenu=0,t.m_ownerWindow=e,t}return o.d(e,n),e.prototype.Init=function(e,t){(e.options.bForcePopup||this.m_ownerWindow.innerWidth)<400&&this.m_ownerWindow.SteamClient&&this.m_ownerWindow.SteamClient.Window?this.m_popupContextMenu=new a.a(e,t,c.GetBrowserInfoForPopup(this.m_ownerWindow)):(this.m_embeddedElementInstance=Object(l.b)(this.m_ownerWindow.document),this.m_rctElement=i.createElement(a.g,e,t))},e.prototype.SetOnHideCallback=function(e){this.m_fnOnHideCallback=e},e.prototype.Show=function(){this.m_rctElement?this.m_embeddedElementInstance.Show(this.m_rctElement):this.m_popupContextMenu.Show(),this.m_bVisible=!0},e.prototype.Hide=function(){this.InternalHide()},e.prototype.HideIfNotInFocus=function(){this.BHasFocus()||this.BIsFocusInChildHierarchy()||this.Hide()},e.prototype.InternalHide=function(){this.m_bVisible&&(this.m_bVisible=!1,this.InternalHideSubMenu(),this.m_fnOnHideCallback&&this.m_fnOnHideCallback(),this.m_embeddedElementInstance?this.m_embeddedElementInstance.Hide(300):this.m_popupContextMenu.Close())},Object.defineProperty(e.prototype,"visible",{get:function(){return this.m_bVisible},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"options",{get:function(){return this.m_options},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"owner_window",{get:function(){return this.m_ownerWindow},enumerable:!0,configurable:!0}),e.prototype.ShowSubMenu=function(e,t){return this.m_elSubmenuItem==e?(this.CancelHideSubMenuTimer(),this.m_submenu.TakeFocus(),null):(this.InternalHideSubMenu(),this.m_elSubmenuItem=e,this.m_submenu=new d(this,t(),e),this.m_submenu.Show(),this.m_submenu)},e.prototype.CancelHideSubMenuTimer=function(){0<this.m_timerHideSubMenu&&(clearTimeout(this.m_timerHideSubMenu),this.m_timerHideSubMenu=0)},e.prototype.HideSubMenu=function(){var e=this;if(this.m_submenu){if(!(0<this.m_timerHideSubMenu)){this.m_timerHideSubMenu=window.setTimeout(function(){e.InternalHideSubMenu(),e.m_timerHideSubMenu=0},500)}}else this.CancelHideSubMenuTimer()},e.prototype.InternalHideSubMenu=function(){this.CancelHideSubMenuTimer(),this.m_submenu&&(this.BIsFocusInChildHierarchy()&&this.TakeFocus(),this.m_elSubmenuItem=null,this.m_submenu.InternalHide(),this.m_submenu=null)},e.prototype.TakeFocus=function(){this.m_popupContextMenu&&this.m_popupContextMenu.Focus(),this.m_fnTakeFocus&&this.m_fnTakeFocus()},e.prototype.BInternalElementInParentHierarchy=function(e){return this.m_parentInstance&&(this.m_parentInstance.BIsChildElement(e)||this.m_parentInstance.BInternalElementInParentHierarchy(e))},e.prototype.BInternalElementInChildHierarchy=function(e){return this.m_submenu&&(this.m_submenu.BIsChildElement(e)||this.m_submenu.BInternalElementInChildHierarchy(e))},e.prototype.BIsChildElement=function(e){return this.m_embeddedElementInstance?this.m_embeddedElementInstance.BIsChildElement(e):r.e(this.m_popupContextMenu.root_element,e)},e.prototype.BHasFocus=function(){return this.m_embeddedElementInstance?this.m_embeddedElementInstance.BIsChildElement(this.m_ownerWindow.document.activeElement):this.m_popupContextMenu.focused},e.prototype.BIsFocusInChildHierarchy=function(){return this.m_submenu&&(this.m_submenu.BHasFocus()||this.m_submenu.BIsFocusInChildHierarchy())},e.prototype.BIsElementInMenuHierarchy=function(e){return this.BInternalElementInParentHierarchy(e)||this.BInternalElementInChildHierarchy(e)},e.prototype.BIsSubMenuVisible=function(){return!!this.m_submenu},o.c([s.observable],e.prototype,"m_bVisible",void 0),e}(c),m=function(s){function c(e,t,n,o,i){var r=s.call(this,t.ownerDocument.defaultView)||this;c.sm_iActiveContextMenuInstance&&c.sm_iActiveContextMenuInstance.Hide(),(c.sm_iActiveContextMenuInstance=r).m_options=i||{};var a={element:t,clientX:n,clientY:o,instance:r,options:r.m_options,fnOnMenuItemSelected:function(){r.Hide()}};return r.Init(a,e),r}return o.d(c,s),c.prototype.Show=function(){c.sm_mapEmbeddedMouseOverlays.ShowElement(this.m_ownerWindow.document,i.createElement(a.f),this),s.prototype.Show.call(this)},c.prototype.Hide=function(){c.sm_mapEmbeddedMouseOverlays.HideElement(this.m_ownerWindow.document,this),s.prototype.Hide.call(this)},c.sm_mapEmbeddedMouseOverlays=new l.a("ContextMenuMouseOverlay"),c}(u),d=function(r){function e(e,t,n){var o=r.call(this,n.ownerDocument.defaultView)||this;o.m_parentInstance=e,o.m_options={bOverlapVertical:!0,bUseWebStyles:e.options.bUseWebStyles};var i={element:n,clientX:null,clientY:null,instance:o,options:o.m_options,fnOnMenuItemSelected:function(){o.Hide()},bSubmenu:!0};return o.Init(i,t),o}return o.d(e,r),e.prototype.Hide=function(){var e=this;this.m_popupContextMenu?window.setTimeout(function(){e.m_parentInstance.HideIfNotInFocus()},10):this.m_parentInstance.Hide()},e}(u)},Cebd:function(e,t,n){e.exports={PersonaStatusIcon:"personastatusicons_PersonaStatusIcon_2rP7f",MobilePhoneIcon:"personastatusicons_MobilePhoneIcon_2ZlAW"}},EGkk:function(e,t,n){"use strict";n.d(t,"c",function(){return h}),n.d(t,"d",function(){return _}),n.d(t,"b",function(){return f}),n.d(t,"e",function(){return g}),n.d(t,"g",function(){return b}),n.d(t,"a",function(){return v}),n.d(t,"f",function(){return S}),n.d(t,"i",function(){return y}),n.d(t,"h",function(){return I}),n.d(t,"j",function(){return E});var a=n("mrSG"),o=n("okNM"),s=n("q1tI"),c=n("i8i4"),l=n("8o0Y"),p=n("JtU4"),R=n("/IDK"),i=n("1VtQ"),r=n("e2SU"),u=n("WpBz"),m=n("oh5H"),d=n("1n9R"),h=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a.d(t,e),t.prototype.render=function(){var e=this.props,t=e.children,n=e.className,o=a.f(e,["children","className"]),i=this.context.contextMenuInstance&&this.context.contextMenuInstance.options.bUseWebStyles?"popup_menu popup_body":"contextMenuContents";return n&&(i+=" "+n),s.createElement("div",a.a({},o,{className:i}),t)},t.contextTypes={contextMenuInstance:function(){return null}},t}(s.PureComponent),_=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a.d(t,e),t.prototype.OnClick=function(e){this.props.disabled||(this.props.onClick&&this.props.onClick(e),this.props.bInteractableItem||(this.props.onSelected&&this.props.onSelected(e),this.context.contextMenuInstance&&this.context.contextMenuInstance.Hide()))},t.prototype.OnMouseEnter=function(e){this.context.contextMenuInstance&&this.context.contextMenuInstance.HideSubMenu()},t.prototype.render=function(){var e=this.props,t=(e.onSelected,e.bInteractableItem,a.f(e,["onSelected","bInteractableItem"])),n=[this.context.contextMenuInstance&&this.context.contextMenuInstance.options.bUseWebStyles?"popup_menu_item":"contextMenuItem"];return this.props.className&&n.push(this.props.className),this.props.disabled&&n.push("disabled"),s.createElement("div",a.a({onMouseEnter:this.OnMouseEnter},t,{onClick:this.OnClick,unselectable:this.props.unselectable,className:n.join(" ")}),this.props.children)},t.contextTypes={contextMenuInstance:function(){return null}},a.c([i.a],t.prototype,"OnClick",null),a.c([i.a],t.prototype,"OnMouseEnter",null),t}(s.PureComponent),f=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a.d(t,e),t.prototype.render=function(){var e=this.props,t=e.bChecked,n=e.children,o=a.f(e,["bChecked","children"]);return s.createElement(_,a.a({},o,{className:t&&"menuChecked"}),s.createElement("div",{className:"contextMenuCheckMark"}),n)},t}(s.PureComponent),g=function(n){function e(e){var t=n.call(this,e)||this;return t.state={bActive:!1},t}return a.d(e,n),e.prototype.OnSubMenuMouseEnter=function(){this.context.contextMenuInstance.CancelHideSubMenuTimer()},e.prototype.RenderSubMenu=function(){return s.createElement(h,{onMouseEnter:this.OnSubMenuMouseEnter},this.props.children)},e.prototype.OnMouseEnter=function(e){var t=this;if(this.context.contextMenuInstance){var n=this.context.contextMenuInstance.ShowSubMenu(e.currentTarget,this.RenderSubMenu);n&&(this.setState({bActive:!0}),n.SetOnHideCallback(function(){t.setState({bActive:!1})}))}},e.prototype.OnClick=function(e){this.OnMouseEnter(e),this.props.onClick&&this.props.onClick(e)},e.prototype.render=function(){var e=this.props,t=e.label,n=(e.children,e.className),o=a.f(e,["label","children","className"]);return this.state.bActive&&(n=(n||"")+" active"),s.createElement(_,a.a({},o,{onClick:this.OnClick,className:n,onMouseEnter:this.OnMouseEnter,onSelected:null,bInteractableItem:!0}),t," ",s.createElement(r.n,null))},e.contextTypes={contextMenuInstance:function(){return null}},a.c([i.a],e.prototype,"OnSubMenuMouseEnter",null),a.c([i.a],e.prototype,"RenderSubMenu",null),a.c([i.a],e.prototype,"OnMouseEnter",null),a.c([i.a],e.prototype,"OnClick",null),e}(s.PureComponent),b=function(n){function e(e){var t=n.call(this,e)||this;return t.m_elMenu=void 0,t.m_cReenteranceGuard=1,t.state={ready:!1,menuLeft:void 0,menuTop:void 0,menuRight:void 0,menuBottom:void 0,menuWidth:void 0,menuHeight:void 0},t.m_mutationObserver=new MutationObserver(t.OnMenuMutation),t}return a.d(e,n),e.prototype.BindMenuElement=function(e){var t=this;this.m_elMenu&&(this.m_mutationObserver.disconnect(),this.props.popup||this.m_elMenu.ownerDocument.defaultView.removeEventListener("resize",this.OnWindowResize)),e&&(this.m_mutationObserver.observe(e,{childList:!0,subtree:!0}),this.props.popup||e.ownerDocument.defaultView.addEventListener("resize",this.OnWindowResize)),this.m_elMenu=e||void 0,this.PositionMenu(),this.state.ready||(this.props.instance.SetTakeFocus(this.TakeFocus.bind(this)),this.setState({ready:!0},function(){t.TakeFocus()}))},e.prototype.OnMenuMutation=function(e,t){this.PositionMenu()},e.prototype.OnWindowResize=function(){this.PositionMenu()},e.prototype.OnBlur=function(e){e.relatedTarget&&R.e(e.currentTarget,e.relatedTarget)||e.relatedTarget&&this.props.instance.BIsElementInMenuHierarchy(e.relatedTarget)||this.props.instance.BIsSubMenuVisible()||this.state.ready&&this.props.instance.visible&&this.props.instance.Hide()},e.prototype.OnKeyDown=function(e){27==e.keyCode&&this.state.ready&&(this.props.instance.Hide(),e.preventDefault(),e.stopPropagation())},e.prototype.getChildContext=function(){return{contextMenuInstance:this.props.instance}},e.prototype.componentDidUpdate=function(){0<this.m_cReenteranceGuard--?this.PositionMenu():this.m_cReenteranceGuard=2},e.prototype.TakeFocus=function(){if(this.m_elMenu&&this.state.ready&&this.props.instance.visible&&(this.props.popup||!R.e(this.m_elMenu,this.m_elMenu.ownerDocument.activeElement))){var e=this.m_elMenu.querySelector(".ContextMenuAutoFocus");e&&e.focus?e.focus():this.m_elMenu.focus()}},e.prototype.PositionMenu=function(){var e=this.m_elMenu,t=this.props.element;if(e&&t){var n=t.ownerDocument.defaultView;e.ownerDocument.defaultView.CtxUpdate=this.PositionMenu.bind(this);var o=t.getBoundingClientRect(),i=e.getBoundingClientRect(),r=null!=this.props.popup,a=this.props.options,s={menuLeft:void 0,menuRight:void 0,menuTop:void 0,menuBottom:void 0,menuWidth:void 0,menuHeight:void 0},c=this.props.clientX,l=this.props.clientY,p=n.innerWidth,u=n.innerHeight;if(r){c+=n.screenLeft,l+=n.screenTop,o=R.h(n,o);var m=n.screen,d=0,h=0;m.availLeft&&(d=m.availLeft),m.availTop&&(h=m.availTop),p=d+m.availWidth,u=h+m.availHeight}(a.bOverlapHorizontal||a.bOverlapVertical)&&(c=l=void 0);var _=c||o.left,f=c||o.right,g=i.width;a.bMatchWidth&&(g=f-_,s.menuWidth=g);var b=(a.bOverlapHorizontal?f:_)-g,v=0<b,S=p-(a.bOverlapHorizontal?_:f)-g,y=0<S,C=(a.bPreferPopLeft||!y)&&v;v||y||(C=y<v,a.bFitToWindow&&(g+=(C?b:S)-8,s.menuWidth=g)),!a.bPreferPopLeft&&y||!v?s.menuLeft=a.bOverlapHorizontal?_:f:s.menuRight=p-(a.bOverlapHorizontal?f:_);var I=l||o.top,E=l||o.bottom,O=i.height;a.bMatchHeight&&(O=E-I,s.menuHeight=O);var w=(a.bOverlapVertical?E:I)-O,M=0<w,D=u-(a.bOverlapVertical?I:E)-O,T=0<D,G=(a.bPreferPopTop||!T)&&M;M||T||(G=D<w,a.bFitToWindow&&(O+=(G?w:D)-8,s.menuHeight=O)),G?s.menuBottom=u-(a.bOverlapVertical?E:I):s.menuTop=a.bOverlapVertical?I:E,r?(s.menuHeight||(s.menuHeight=i.height),s.menuWidth||(s.menuWidth=i.width),s.menuBottom&&!s.menuTop&&(s.menuTop=u-s.menuBottom-s.menuHeight,s.menuBottom=void 0),s.menuRight&&!s.menuLeft&&(s.menuLeft=p-s.menuRight-s.menuWidth,s.menuRight=void 0)):(s.menuLeft&&(s.menuLeft+=n.scrollX),s.menuTop&&(s.menuTop+=n.scrollY),s.menuBottom&&(s.menuBottom+=n.document.body.scrollHeight-n.scrollY-n.innerHeight),s.menuRight&&(s.menuRight+=n.document.body.scrollWidth-n.scrollX-n.innerWidth)),s.menuLeft===this.state.menuLeft&&s.menuRight===this.state.menuRight&&s.menuTop===this.state.menuTop&&s.menuBottom===this.state.menuBottom&&s.menuWidth===this.state.menuWidth&&s.menuHeight===this.state.menuHeight||this.setState(s)}},e.prototype.render=function(){var i=this,e={visibility:this.state.ready?"visible":"hidden"};if(this.props.popup){var r=this.props.element.ownerDocument.defaultView;void 0!==this.state.menuLeft&&void 0!==this.state.menuTop&&void 0!==this.state.menuWidth&&void 0!==this.state.menuHeight&&r.SteamClient.Window.GetWindowRestoreDetails(function(e){var t=i.props.popup.window,n=i.state.menuLeft-r.screenX,o=i.state.menuTop-r.screenY;try{t.SteamClient.Window.PositionWindowRelative(e,n,o,i.state.menuWidth,i.state.menuHeight)}catch(e){console.error(e)}})}else void 0!==this.state.menuTop?e.top=this.state.menuTop:void 0!==this.state.menuBottom&&(e.bottom=this.state.menuBottom),void 0!==this.state.menuLeft?e.left=this.state.menuLeft:void 0!==this.state.menuRight&&(e.right=this.state.menuRight),void 0!==this.state.menuHeight&&(e.height=this.state.menuHeight),void 0!==this.state.menuWidth&&(e.width=this.state.menuWidth);var t=this.props.options.strClassName||(this.props.options.bUseWebStyles?"popup_block_new popup_block_hidden_until_visible":"contextMenu");return this.props.instance.visible&&this.state.ready&&(t+=" visible"),t+=" ContextMenuFocusContainer",s.createElement("div",{className:t,ref:this.BindMenuElement,style:e,onBlur:this.OnBlur,onKeyDown:this.OnKeyDown,tabIndex:0},this.props.children)},e.childContextTypes={contextMenuInstance:function(){return null},context:function(){return null}},a.c([i.a],e.prototype,"BindMenuElement",null),a.c([i.a,Object(u.a)(100)],e.prototype,"OnMenuMutation",null),a.c([i.a],e.prototype,"OnWindowResize",null),a.c([i.a],e.prototype,"OnBlur",null),a.c([i.a],e.prototype,"OnKeyDown",null),e=a.c([o.observer],e)}(s.Component),v=function(i){function r(e,t,n){var o=i.call(this,"contextmenu_"+r.sm_iContextMenuInstance++,{title:"Menu",html_class:"ContextMenuPopup client_chat_frame",body_class:"ContextMenuPopupBody",replace_existing_popup:!1,target_browser:n,eCreationFlags:p.c.ContextMenu})||this;return o.m_menuProps=e,o.m_children=t,o}return a.d(r,i),r.prototype.UpdateParamsBeforeShow=function(e){var t=R.h(this.m_menuProps.element.ownerDocument.defaultView,this.m_menuProps.element.getBoundingClientRect());return e.dimensions={left:t.right,top:t.top,width:350,height:1},e.availscreenwidth=this.m_menuProps.element.ownerDocument.defaultView.screen.availWidth,e.availscreenheight=this.m_menuProps.element.ownerDocument.defaultView.screen.availHeight,e},r.prototype.Render=function(e,t){c.render(s.createElement(b,a.a({},this.m_menuProps,{popup:this}),this.m_children),t)},r.prototype.OnBlur=function(){},r.prototype.OnFocus=function(){},r.prototype.OnLoad=function(){},r.prototype.OnResize=function(){},r.prototype.OnClose=function(){},r.sm_iContextMenuInstance=0,r}(p.a);function S(e){return s.createElement("div",{className:"ContextMenuMouseOverlay"})}function y(e){var t=[],n=R.m(e),o=n.getSelection(),i=o&&0<o.rangeCount&&0<o.toString().length,r=e.target,a=!1;if(r&&"tagName"in r&&("INPUT"!=r.tagName&&"TEXTAREA"!=r.tagName||(a=!0)),(n.document.queryCommandEnabled("cut")||i&&a)&&t.push(s.createElement(_,{key:"cut",onSelected:function(){n.document.execCommand("cut")}},Object(m.b)("#ContextMenu_Cut"))),(document.queryCommandEnabled("copy")||i)&&t.push(s.createElement(_,{key:"copy",onSelected:function(){n.document.execCommand("copy")}},Object(m.b)("#ContextMenu_Copy"))),d.b.IN_CLIENT&&a&&t.push(s.createElement(_,{key:"paste",onSelected:function(){r.focus(),n.SteamClient._internal.Paste()}},Object(m.b)("#ContextMenu_Paste"))),t.length)Object(l.a)(s.createElement(h,null,t),e);else{if(e.shiftKey)return;e.preventDefault(),e.stopPropagation()}}var C="DEBUG_StickyContextMenus";function I(){return window.sessionStorage&&"true"==window.sessionStorage.getItem(C)}function E(e){e?window.sessionStorage.setItem(C,"true"):window.sessionStorage.removeItem(C)}},F2OU:function(e,t,n){e.exports={SnoozeContainer:"friendsnooze_SnoozeContainer_1OfTa",SnoozeZ:"friendsnooze_SnoozeZ_29fyi",none:"friendsnooze_none_lZX-E",Medium:"friendsnooze_Medium_2NSIM",Large:"friendsnooze_Large_2QDqq",Dim:"friendsnooze_Dim_10sPU",Z1:"friendsnooze_Z1_GU6T2",Z2:"friendsnooze_Z2_277XL",Z3:"friendsnooze_Z3_1gXQi",animating:"friendsnooze_animating_1pImE",hoverParent:"friendsnooze_hoverParent_3SgRH",Snoring:"friendsnooze_Snoring_6q8Na"}},FuJV:function(e,t,n){},"G+3Z":function(e,t,n){"use strict";n.d(t,"b",function(){return a}),n.d(t,"a",function(){return c});var o=n("i8i4"),i=n("/IDK"),r=function(){return function(e){this.instance=new s(e,!1)}}();function a(e){return new s(e.body,!0)}var s=function(){function e(e,t){void 0===t&&(t=!0),this.m_parent=e,this.m_window=e.ownerDocument.defaultView,this.m_bRemoveOnHide=t}return e.prototype.Show=function(n,o){var i=this;return this.CancelShowInterval(),o?new Promise(function(t,e){i.iIntervalShow=i.m_window.setTimeout(function(){var e=i.m_parent.ownerDocument;e.defaultView&&!e.defaultView.closed&&(i.InternalShow(n),t())},o)}):(this.InternalShow(n),Promise.resolve())},e.prototype.InternalShow=function(e){this.m_container?o.unmountComponentAtNode(this.m_container):(this.m_container=this.m_parent.ownerDocument.createElement("div"),this.m_parent.appendChild(this.m_container)),o.render(e,this.m_container)},e.prototype.Hide=function(e){var t=this;this.CancelShowInterval(),e?this.iIntervalShow=this.m_window.setTimeout(function(){t.InternalHide()},e):this.InternalHide()},e.prototype.InternalHide=function(){this.m_container&&(o.unmountComponentAtNode(this.m_container),this.m_bRemoveOnHide&&(this.m_parent.removeChild(this.m_container),this.m_container=null))},e.prototype.CancelShowInterval=function(){void 0!==this.iIntervalShow&&(this.m_window.clearInterval(this.iIntervalShow),this.iIntervalShow=void 0)},e.prototype.BIsChildElement=function(e){return this.m_container&&i.e(this.m_container,e)},e}(),c=function(){function e(e){this.m_mapEmbeddedHovers=new WeakMap,this.m_strUniqueID=e}return e.prototype.ShowElementDelayed=function(e,t,n,o){var i=this.GetEmbeddedElement(e);return i.activeObject=o,i.instance.Show(n,t)},e.prototype.ShowElement=function(e,t,n){var o=this.GetEmbeddedElement(e);o.activeObject=n,o.instance.Show(t)},e.prototype.HideElement=function(e,t,n){var o=this.GetEmbeddedElement(e);o.activeObject==t&&(o.activeObject=void 0,o.instance.Hide(n))},e.prototype.GetEmbeddedElement=function(e){var t=this.m_mapEmbeddedHovers.get(e);return t||(t=new r(e.body),this.m_mapEmbeddedHovers.set(e,t)),t},e}()},"H+H8":function(e,t,n){e.exports={HoverPosition:"hoverposition_HoverPosition_3gYNB",ready:"hoverposition_ready_3d6MD",nospace:"hoverposition_nospace_39IjN"}},HVDT:function(e,t,n){e.exports={NewEmoticonIndicator:"emoticon_NewEmoticonIndicator_3NVON",NewEmoticonCircle:"emoticon_NewEmoticonCircle_3mNrG"}},J0bI:function(e,t,n){"use strict";n.d(t,"b",function(){return s}),n.d(t,"a",function(){return c});var o=n("mrSG"),i=n("2vnA"),r=n("0N1H"),a=n("tkkQ"),s=function(){function e(e){this.m_bReady=!1,this.m_bValid=!1,this.m_strInviteCode=e}return e.prototype.BIsReady=function(){return this.m_bReady},e.prototype.BIsValid=function(){return this.m_bValid},e.prototype.BIsInviteLink=function(){return!!this.m_strInviteCode},e.prototype.GetInviteCode=function(){return this.m_strInviteCode},e.prototype.BNeverExpires=function(){return this.m_rtTimeExpires==r.d},e.prototype.GetChatRoomGroupID=function(){return this.m_ulChatRoomGroupID},e.prototype.BIsVoiceChatInvite=function(){return!!this.m_ulChatID},e.prototype.GetChatID=function(){return this.m_ulChatID},e.prototype.GetURL=function(){return this.m_strInviteCode?c(this.m_strInviteCode):null},e.prototype.BIsUserBanned=function(){return this.m_bIsBanned},e.prototype.GetTimeKickExpires=function(){return this.m_rtKickExpires},Object.defineProperty(e.prototype,"time_expires",{get:function(){return this.m_rtTimeExpires},enumerable:!0,configurable:!0}),e.prototype.InitInvalid=function(){this.m_bValid=!1,this.m_bReady=!0},e.prototype.InitDirectInvite=function(e,t,n,o){void 0===n&&(n=!1),void 0===o&&(o=void 0),this.m_ulChatRoomGroupID=e,this.m_ulChatID=t,this.m_bIsBanned=n,this.m_rtKickExpires=o,this.m_rtTimeExpires=r.d,this.m_bValid=!0,this.m_bReady=!0},o.c([i.observable],e.prototype,"m_bReady",void 0),o.c([i.action],e.prototype,"InitInvalid",null),o.c([i.action],e.prototype,"InitDirectInvite",null),e}();function c(e){return"public"==a.a.WEB_UNIVERSE?"https://s.team/chat/"+e:a.a.COMMUNITY_BASE_URL+"chat/invite/"+e}},JtU4:function(e,t,n){"use strict";n.d(t,"c",function(){return c}),n.d(t,"a",function(){return m}),n.d(t,"b",function(){return d}),n.d(t,"d",function(){return _});var c,o,i=n("mrSG"),r=n("2vnA"),a=n("i8i4"),s=n("UqDm"),l=n("WpBz"),p=n("1VtQ");(o=c||(c={}))[o.Minimized=1]="Minimized",o[o.Hidden=2]="Hidden",o[o.Tooltip=4]="Tooltip",o[o.ContextMenu=8]="ContextMenu",o[o.Resizable=16]="Resizable";var u=function(){function e(e,t){this.m_rgLoadingLinks=[],this.m_rgLoadingLinks=[];for(var n=e.document.getElementsByTagName("link"),o=0;o<n.length;o++){var i=n[o];i.addEventListener("load",this.OnLinkLoad),this.m_rgLoadingLinks.push(i)}}return e.prototype.SetTarget=function(e){this.m_fnRender=e,0==this.m_rgLoadingLinks.length&&(this.m_fnRender(),this.m_fnRender=void 0)},e.prototype.OnLinkLoad=function(e){e.currentTarget.removeEventListener("load",this.OnLinkLoad),s.d(this.m_rgLoadingLinks,e.currentTarget),0==this.m_rgLoadingLinks.length&&(this.m_fnRender(),this.m_fnRender=void 0)},i.c([p.a],e.prototype,"OnLinkLoad",null),e}(),m=function(){function e(e,t){this.m_bFocused=!1,this.m_strName=e,this.m_rgParams=t,this.m_rgParams.target_browser&&(this.m_strName+="_pid"+this.m_rgParams.target_browser.m_unPID),this.m_strTitle=t.title,delete this.m_rgParams.title}return e.prototype.UpdateParamsBeforeShow=function(e){return e},e.prototype.OnDrop=function(e){console.log("Ignoring drop onto toplevel window",e),e.preventDefault(),e.stopPropagation()},e.prototype.OnDragOver=function(e){e.preventDefault(),e.dataTransfer.dropEffect="none",e.stopPropagation()},e.prototype.OnMessage=function(e){"window_moved"==e.data&&this.OnResize()},e.prototype.Show=function(e,t){var n,o=this;void 0===e&&(e=!0),void 0===t&&(t=!1),window.SteamClient&&(this.m_rgParams.eCreationFlags|=c.Hidden),this.m_rgParams.eCreationFlags&c.Tooltip&&(e=!1),this.BIsValid()&&(this.BIsClosed()?(this.m_popup=void 0,this.m_element=void 0):e&&this.Focus(t));var i,r,a,s=_.GetExistingPopup(this.m_strName);s&&!this.m_rgParams.replace_existing_popup||(this.m_rgParams=this.UpdateParamsBeforeShow(this.m_rgParams),s?(r=s.m_element,i=s.m_popup,s.ReleasePopup(),a=s.m_renderWhenReady,_.RemoveTrackedPopup(s),i.removeEventListener("beforeunload",s.OnBeforeUnloadEvent),i.removeEventListener("unload",s.OnUnload),i.removeEventListener("resize",s.OnResizeEvent),i.removeEventListener("focus",this.OnFocusInternal),i.removeEventListener("blur",this.OnBlurInternal),i.removeEventListener("drop",s.OnDrop),i.removeEventListener("dragover",s.OnDragOver),i.removeEventListener("message",this.OnMessage)):(i=(n=h.CreatePopup(this.m_strName,this.m_rgParams)).popup,r=n.element,a=new u(i,r)),i&&r&&(i.document.title=this.m_strTitle,i.addEventListener("beforeunload",this.OnBeforeUnloadEvent),i.addEventListener("unload",this.OnUnload),i.addEventListener("resize",this.OnResizeEvent),i.addEventListener("focus",this.OnFocusInternal),i.addEventListener("blur",this.OnBlurInternal),i.addEventListener("drop",this.OnDrop),i.addEventListener("dragover",this.OnDragOver),i.addEventListener("message",this.OnMessage),this.m_popup=i,this.m_element=r,this.m_renderWhenReady=a,this.m_renderWhenReady.SetTarget(function(){return o.RenderInternal(o.m_popup,o.m_element,e)})),_.AddTrackedPopup(this),s&&e&&this.Focus())},e.prototype.RemoveEventListeners=function(){this.window.removeEventListener("beforeunload",this.OnBeforeUnloadEvent),this.window.removeEventListener("unload",this.OnUnload),this.window.removeEventListener("resize",this.OnResizeEvent),this.window.removeEventListener("focus",this.OnFocusInternal),this.window.removeEventListener("blur",this.OnBlurInternal),this.window.removeEventListener("drop",this.OnDrop),this.window.removeEventListener("dragover",this.OnDragOver),this.window.removeEventListener("message",this.OnMessage)},e.prototype.RenderInternal=function(e,t,n){this.Render(e,t),this.OnLoad(),e.SteamClient&&(n?e.SteamClient.Window.BringToFront():e.SteamClient.Window.ShowWindow())},e.prototype.OnResizeEvent=function(){this.OnResize()},e.prototype.OnBeforeUnloadEvent=function(){this.OnBeforeUnload()},e.prototype.OnUnload=function(){this.RemoveEventListeners(),_.RemoveTrackedPopup(this),this.OnClose(),a.unmountComponentAtNode(this.m_element)},Object.defineProperty(e.prototype,"browser_info",{get:function(){return this.m_rgParams.target_browser},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"window",{get:function(){return this.m_popup},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"root_element",{get:function(){return this.m_element},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"title",{get:function(){return this.m_strTitle},set:function(e){this.m_strTitle=e,this.m_popup&&(this.m_popup.document.title=this.m_strTitle)},enumerable:!0,configurable:!0}),e.prototype.Focus=function(e){void 0===e&&(e=!1),this.m_popup&&void 0!==this.m_popup.SteamClient&&void 0!==this.m_popup.SteamClient.Window?e?this.m_popup.SteamClient.Window.SetForegroundWindow():this.m_popup.SteamClient.Window.BringToFront():this.m_popup&&this.m_popup.focus()},e.prototype.Close=function(){this.m_popup&&this.m_popup.close()},e.prototype.GetName=function(){return this.m_strName},e.prototype.BIsValid=function(){return!!this.m_popup},e.prototype.BIsClosed=function(){return!this.m_popup||this.m_popup.closed},e.prototype.BIsVisible=function(){return this.m_popup&&!this.m_popup.closed&&"visible"==this.m_popup.document.visibilityState},e.prototype.BIsFocused=function(){return this.BIsVisible()&&this.m_popup.document.hasFocus()},e.prototype.OnFocusInternal=function(){this.m_bFocused=!0,this.OnFocus()},e.prototype.OnBlurInternal=function(){this.m_bFocused=!1,this.OnBlur()},Object.defineProperty(e.prototype,"focused",{get:function(){return this.m_bFocused},enumerable:!0,configurable:!0}),e.prototype.GetWindowRestoreDetails=function(){var n=this;return this.m_popup&&!this.m_popup.closed&&this.m_popup.SteamClient?new Promise(function(t,e){n.m_popup.SteamClient.Window.GetWindowRestoreDetails(function(e){t(e)})}):Promise.resolve("")},e.prototype.IsMinimized=function(){var n=this;return this.m_popup&&!this.m_popup.closed&&this.m_popup.SteamClient&&this.m_popup.SteamClient.Window&&this.m_popup.SteamClient.Window.IsWindowMinimized?new Promise(function(t,e){n.m_popup.SteamClient.Window.IsWindowMinimized(function(e){t(e)})}):Promise.resolve(!1)},e.prototype.ReleasePopup=function(){this.OnClose(),this.m_popup=null},e.prototype.OnBeforeUnload=function(){},e.prototype.OnFocus=function(){},e.prototype.OnBlur=function(){},i.c([r.observable],e.prototype,"m_bFocused",void 0),i.c([p.a],e.prototype,"OnMessage",null),i.c([p.a],e.prototype,"OnResizeEvent",null),i.c([p.a],e.prototype,"OnBeforeUnloadEvent",null),i.c([p.a],e.prototype,"OnUnload",null),i.c([p.a],e.prototype,"OnFocusInternal",null),i.c([p.a],e.prototype,"OnBlurInternal",null),i.c([r.computed],e.prototype,"focused",null),e}(),d=function(r){function e(e,t,n,o){var i=r.call(this,e,n)||this;return i.SetSavedDimensionsKey(t),i.m_bExpires=o,i}return i.d(e,r),e.prototype.BIsInOverlay=function(){return this.browser_info&&this.browser_info!={m_unPID:0,m_nBrowserID:-1}},e.prototype.SetSavedDimensionsKey=function(e){this.m_strSavedDimensionsKey=e},e.prototype.UpdateParamsBeforeShow=function(e){return!this.m_strSavedDimensionsKey||e.bIgnoreSavedDimensions||e.strRestoreDetails?e.strRestoreDetails&&(this.m_strInitialSavedDimensionsKey=this.GetSavedDimensionsKey(),_.SetRestoreDetails(this.m_strInitialSavedDimensionsKey,e.strRestoreDetails,this.m_bExpires)):(this.m_strInitialSavedDimensionsKey=this.GetSavedDimensionsKey(),e.strRestoreDetails=_.GetRestoreDetails(this.m_strInitialSavedDimensionsKey)),e},e.prototype.OnLoad=function(){var t=this;this.GetWindowRestoreDetails().then(function(e){t.m_strInitialRestoreDetails=e,t.OnResizeComplete(e)})},e.prototype.OnResize=function(){this.QueryAndStoreWindowPosition()},e.prototype.OnResizeComplete=function(e){},e.prototype.QueryAndStoreWindowPosition=function(){var n=this;if(this.m_strInitialRestoreDetails){var o=this.GetSavedDimensionsKey();this.m_popup.setTimeout(function(){n.GetWindowRestoreDetails().then(function(e){var t=n.m_strInitialRestoreDetails==e&&o==n.m_strInitialSavedDimensionsKey;n.m_popup&&n.m_strSavedDimensionsKey&&e&&!t&&(_.SetRestoreDetails(o,e,n.m_bExpires),n.m_rgParams.strRestoreDetails=e,n.m_strInitialSavedDimensionsKey=o,n.OnResizeComplete(e))})},30)}},e.prototype.OnBeforeUnload=function(){this.QueryAndStoreWindowPosition(),r.prototype.OnBeforeUnload.call(this)},e.prototype.OnClose=function(){},e.prototype.SaveWindowPosition=function(e){_.SetRestoreDetails(this.GetSavedDimensionsKey(),e,!1),this.m_rgParams.strRestoreDetails=e},i.c([p.a],e.prototype,"QueryAndStoreWindowPosition",null),e}(m),h=function(){function e(){var a=this;this.m_bShuttingDown=!1,this.m_mapPopups=new Map,this.m_rgShutdownCallbacks=[],this.m_rgPopupCreatedCallbacks=[],this.m_unCurrentAccountID=0,this.m_mapRestoreDetails=new Map,this.m_bSaveRequired=!1,Object({NODE_ENV:"production",STEAM_BUILD:"buildbot",VALVE_BUILD:"false"}).MOBILE_BUILD||window.addEventListener("beforeunload",function(e){a.m_bShuttingDown=!0;for(var t=0,n=a.m_rgShutdownCallbacks;t<n.length;t++){(0,n[t])()}var o=[];a.m_mapPopups.forEach(function(e){e.BIsValid()&&!e.BIsClosed()&&o.push(e)});for(var i=0,r=o;i<r.length;i++){r[i].Close()}a.m_bSaveRequired&&a.SaveSavedDimensionStore(),a.m_mapPopups.clear()})}return e.prototype.SetCurrentLoggedInAccountID=function(e){(this.m_unCurrentAccountID=e)?this.LoadSavedDimensionStore():this.ClearSavedDimensionStore()},e.prototype.AddShutdownCallback=function(e){this.m_rgShutdownCallbacks.push(e)},e.prototype.AddPopupCreatedCallback=function(e){this.m_rgPopupCreatedCallbacks.push(e)},e.prototype.AddTrackedPopup=function(e){this.m_mapPopups.set(e.GetName(),e);for(var t=0,n=this.m_rgPopupCreatedCallbacks;t<n.length;t++){(0,n[t])(e)}},e.prototype.RemoveTrackedPopup=function(e){this.m_mapPopups.delete(e.GetName())},e.prototype.GetExistingPopup=function(e){return this.m_mapPopups.get(e)},e.prototype.GetPopups=function(){return this.m_mapPopups.values()},e.prototype.ClosePopupsOwnedByBrowser=function(t){this.m_mapPopups.forEach(function(e){e.browser_info&&e.browser_info.m_nBrowserID==t.m_nBrowserID&&e.browser_info.m_unPID==t.m_unPID&&e.Close()})},e.CreatePopup=function(e,t){var n=t.dimensions||{},o=n.width||300,i=n.height||300,r=t.title,a="width="+o+",height="+i;void 0!==n.left&&(a+=",left="+n.left),void 0!==n.top&&(a+=",top="+n.top),a+=",resizeable,status=0,toolbar=0,menubar=0,location=0";var s="about:blank",c=[];c.push("createflags="+t.eCreationFlags),t.minWidth&&c.push("minwidth="+t.minWidth),t.minHeight&&c.push("minheight="+t.minHeight),t.target_browser&&(c.push("pid="+t.target_browser.m_unPID),c.push("browser="+t.target_browser.m_nBrowserID),t.availscreenwidth&&t.availscreenheight&&(c.push("screenavailwidth="+t.availscreenwidth),c.push("screenavailheight="+t.availscreenheight))),t.strRestoreDetails&&c.push("restoredetails="+t.strRestoreDetails),c&&(s+="?"+c.join("&"));var l=(t.owner_window||window).open(s,e,a,!0);if(!l)return console.log("Failed to create popup.. browser popup blocker enabled?"),{};var p="";t.html_class&&(p='class="'+t.html_class+'"');var u="";t.body_class&&(u='class="'+t.body_class+'"');var m="<!DOCTYPE html><html "+p+"><head><title></title></head><body "+u+'><div id="popup_target"></div></body></html>';l.document.write(m),l.document.title=r;for(var d=l.document.getElementsByTagName("head")[0],h=document.getElementsByTagName("link"),_=0;_<h.length;_++){var f=h[_];if("stylesheet"==f.rel){for(var g=l.document.createElement("link"),b=0;b<f.attributes.length;b++){var v=f.attributes.item(b);g.setAttribute(v.name,v.value)}d.appendChild(g)}}return{popup:l,element:l.document.getElementById("popup_target")}},e.prototype.BShuttingDown=function(){return this.m_bShuttingDown},e.prototype.GetLocalStorageKey=function(){return"PopupSavedDimensions_"+this.m_unCurrentAccountID},e.prototype.LoadSavedDimensionStore=function(){if(this.m_unCurrentAccountID){var e=this.GetLocalStorageKey();this.m_mapRestoreDetails=void 0;var t=window.localStorage.getItem(e);if(t)try{var n=JSON.parse(t);this.m_mapRestoreDetails=new Map(n)}catch(e){}this.m_mapRestoreDetails||(this.m_mapRestoreDetails=new Map)}},e.prototype.SaveSavedDimensionStore=function(){if(this.m_unCurrentAccountID&&this.m_bSaveRequired){var e=this.GetLocalStorageKey(),t=JSON.stringify(Array.from(this.m_mapRestoreDetails));window.localStorage.setItem(e,t),this.m_bSaveRequired=!1}},e.prototype.DebouncedSaveSavedDimensionStore=function(){this.SaveSavedDimensionStore()},e.prototype.ClearSavedDimensionStore=function(){this.m_mapRestoreDetails.clear(),this.m_bSaveRequired=!1},e.prototype.GetRestoreDetails=function(e){if(!this.m_mapRestoreDetails.has(e))return"";var t=this.m_mapRestoreDetails.get(e);return t.last_used=Date.now(),this.m_bSaveRequired=!0,t.strRestoreDetails},e.prototype.SetRestoreDetails=function(e,t,n){if(e){if(t){if(50<this.m_mapRestoreDetails.size){for(var o=null,i=Date.now(),r=0,a=Array.from(this.m_mapRestoreDetails.keys());r<a.length;r++){var s=a[r],c=this.m_mapRestoreDetails.get(s);c.last_used<i&&c.bExpires&&(i=c.last_used,o=s)}o&&this.m_mapRestoreDetails.delete(o)}var l={strRestoreDetails:t,last_used:Date.now(),bExpires:n};this.m_mapRestoreDetails.set(e,l)}else this.m_mapRestoreDetails.delete(e);this.m_bSaveRequired=!0,this.m_bShuttingDown?this.SaveSavedDimensionStore():this.DebouncedSaveSavedDimensionStore()}},i.c([p.a,Object(l.a)(100)],e.prototype,"DebouncedSaveSavedDimensionStore",null),e}(),_=new h},MfD9:function(e,t,n){e.exports={ChatMessageSteamStore_Failed:"bbcode_ChatMessageSteamStore_Failed_2wa0X",ChatMessageSteamStore:"bbcode_ChatMessageSteamStore_gwzSZ",ChatMessagesSteamStore_FilteredContent:"bbcode_ChatMessagesSteamStore_FilteredContent_34k3I",senderName:"bbcode_senderName_1_tWd",URLSent:"bbcode_URLSent_2yalT",SteamURL:"bbcode_SteamURL_2VXfO",ChatMessageSteamStore_Name:"bbcode_ChatMessageSteamStore_Name_2-b92",ChatMessageSteamStore_GameNameAndIcon:"bbcode_ChatMessageSteamStore_GameNameAndIcon_qa-O1",ChatMessageSteamStore_Header:"bbcode_ChatMessageSteamStore_Header_3X7hC",ChatMessageSteamStore_HeaderImage:"bbcode_ChatMessageSteamStore_HeaderImage_2s811",Blurred:"bbcode_Blurred_3BKMl",ChatMessageSteamStore_HeaderImageFiltered:"bbcode_ChatMessageSteamStore_HeaderImageFiltered_2GO7-",ChatMessageSteamStore_GameDetails:"bbcode_ChatMessageSteamStore_GameDetails_99hwV",ChatMessageSteamStore_Description:"bbcode_ChatMessageSteamStore_Description_17PwS",ChatMessageSteamStore_FilteredDescription:"bbcode_ChatMessageSteamStore_FilteredDescription_3Iqni",ChatMessageSteamStore_GameIcon:"bbcode_ChatMessageSteamStore_GameIcon_1EeOf",ChatMessageSteamStore_Body:"bbcode_ChatMessageSteamStore_Body_1L1hB",ChatMessageSteamStore_DetailsContainer:"bbcode_ChatMessageSteamStore_DetailsContainer_2d12m",ChatMessageSteamStore_MediaContainer:"bbcode_ChatMessageSteamStore_MediaContainer_2i_00",ChatMessageSteamStore_MainMedia:"bbcode_ChatMessageSteamStore_MainMedia_28eQq",ChatMessageSteamStore_VideoThumbnail:"bbcode_ChatMessageSteamStore_VideoThumbnail_2c-FU",ChatMessageSteamStore_ThumbnailsContainer:"bbcode_ChatMessageSteamStore_ThumbnailsContainer_246HV",ChatMessageSteamStore_Screenshot:"bbcode_ChatMessageSteamStore_Screenshot_3XVGb",ChatMessageSteamStore_ScreenshotThumbnail:"bbcode_ChatMessageSteamStore_ScreenshotThumbnail_3R0VG",videoPlaying:"bbcode_videoPlaying_1UpDR",ChatMessageSteamStore_VideoPlayButton:"bbcode_ChatMessageSteamStore_VideoPlayButton_2oeMy",ChatMessageSteamStore_VideoLargeContainer:"bbcode_ChatMessageSteamStore_VideoLargeContainer_2pzdG",ChatMessageSteamStore_VideoLarge:"bbcode_ChatMessageSteamStore_VideoLarge_2Dj_u",ChatMessageSteamStore_Footer:"bbcode_ChatMessageSteamStore_Footer_1mXJd",ChatMessageSteamStore_PricingContainer:"bbcode_ChatMessageSteamStore_PricingContainer_fYTQK",ChatMessageSteamStore_Pricing:"bbcode_ChatMessageSteamStore_Pricing_bKeQr",ChatMessageSteamStore_Pricing_Discount:"bbcode_ChatMessageSteamStore_Pricing_Discount_1BAfb",ChatMessageSteamStore_Pricing_FinalContainer:"bbcode_ChatMessageSteamStore_Pricing_FinalContainer_3piGx",ChatMessageSteamStore_Pricing_Final:"bbcode_ChatMessageSteamStore_Pricing_Final_2TCu5",hasDiscount:"bbcode_hasDiscount_2DoYC",ChatMessageSteamStore_Pricing_Initial:"bbcode_ChatMessageSteamStore_Pricing_Initial_1Jm7h",ChatMessageSteamStore_ViewStore:"bbcode_ChatMessageSteamStore_ViewStore_1_czf",ChatMessageSteamStore_Free:"bbcode_ChatMessageSteamStore_Free_3Zq0f",ChatMessageSteamStore_CopyURL:"bbcode_ChatMessageSteamStore_CopyURL_23S5M",ChatMessageTweet:"bbcode_ChatMessageTweet_1R69m",ChatMessageTweet_Header:"bbcode_ChatMessageTweet_Header_gpcGy",ChatMessageTweet_ProfileImage:"bbcode_ChatMessageTweet_ProfileImage_wRcpO",ChatMessageTweet_NameSection:"bbcode_ChatMessageTweet_NameSection_3c-Qw",ChatMessageTweet_NameGroup:"bbcode_ChatMessageTweet_NameGroup_3VNx1",ChatMessageTweet_Name:"bbcode_ChatMessageTweet_Name_1_swN",ChatMessageTweet_Logo:"bbcode_ChatMessageTweet_Logo_1ex2E",ChatMessageTweet_Verified:"bbcode_ChatMessageTweet_Verified_2roaO",ChatMessageTweet_ScreenName:"bbcode_ChatMessageTweet_ScreenName_3pM50",ChatMessageTweet_Body:"bbcode_ChatMessageTweet_Body_2mh_n",ChatMessageTweet_Footer:"bbcode_ChatMessageTweet_Footer_11DrN",ChatMessageTweet_Created:"bbcode_ChatMessageTweet_Created_1qrLY",numberCounterContainer:"bbcode_numberCounterContainer_mswnK",numberColumn:"bbcode_numberColumn_2SFVv",randomNumberLabel:"bbcode_randomNumberLabel_6Nz3l",randomActual:"bbcode_randomActual_1KvCn",randomNumberShadow:"bbcode_randomNumberShadow_3OoiC",startingZero:"bbcode_startingZero_20MSk",randomMsg:"bbcode_randomMsg_2x8Cn",MsgAnimating:"bbcode_MsgAnimating_3a9nR",none:"bbcode_none_3qH01",randomValues:"bbcode_randomValues_Vpi5G",coinLabel:"bbcode_coinLabel_1GhxZ",CoinModel:"bbcode_CoinModel_JExHJ",flipCoinContainer:"bbcode_flipCoinContainer_2PyUD",coinFade:"bbcode_coinFade_3vycN",flipCoinAndResult:"bbcode_flipCoinAndResult_1FjLD",coin:"bbcode_coin_AlQa_",front:"bbcode_front_h-0pm",back:"bbcode_back_22p29",coinFlipBottom:"bbcode_coinFlipBottom_38MhH",coinFlipTop:"bbcode_coinFlipTop_BnEA6",front_b:"bbcode_front_b_2ugtx",back_b:"bbcode_back_b_3YNs8",mid:"bbcode_mid_10JhA",coinFace:"bbcode_coinFace_3OmQy",flipCoinWinningSide:"bbcode_flipCoinWinningSide_17gzn",flipCoinLosingSide:"bbcode_flipCoinLosingSide_g63r6",coinFlip:"bbcode_coinFlip_3klbs",resultLabel:"bbcode_resultLabel_3Lefr",coinFlipResult:"bbcode_coinFlipResult_2a-5i",plusOne:"bbcode_plusOne_3mCUi",ImageModalBackground:"bbcode_ImageModalBackground_XfE_W",ImageModalContent:"bbcode_ImageModalContent_1jjqt",randomNumbers:"bbcode_randomNumbers_2IGPW",randomNumbers0:"bbcode_randomNumbers0_1UWWl",randomNumbers1:"bbcode_randomNumbers1_2b7O2",randomNumbers2:"bbcode_randomNumbers2_TxzW6",randomNumbers3:"bbcode_randomNumbers3_1v-a7",randomNumbers4:"bbcode_randomNumbers4_2J19q",randomNumbers5:"bbcode_randomNumbers5_2tjCM",randomNumbers6:"bbcode_randomNumbers6_behC6",randomNumbers7:"bbcode_randomNumbers7_CGn78",randomNumbers8:"bbcode_randomNumbers8_261Uj",randomNumbers9:"bbcode_randomNumbers9_1orHm",randomNumbers10:"bbcode_randomNumbers10_2bRjg",randomNumbersZero:"bbcode_randomNumbersZero_OKABV",coinSpin:"bbcode_coinSpin_3_X1R"}},SOfK:function(e,t,n){e.exports={PreMessage:"messages_PreMessage_1jeo-",CodeMessage:"messages_CodeMessage_1Fe4I",QuoteMessage:"messages_QuoteMessage_33jrq"}},UDpV:function(e,t,n){e.exports={chatEntryControls:"chatentry_chatEntryControls_2O_X7",chatTextarea:"chatentry_chatTextarea_3e__5",chatEntryActionsGroup:"chatentry_chatEntryActionsGroup_15mWd",chatEntryActionsContainer:"chatentry_chatEntryActionsContainer_WZNUD",minHeightZero:"chatentry_minHeightZero_NcZQ_"}},UqDm:function(e,t,n){"use strict";n.d(t,"f",function(){return o}),n.d(t,"d",function(){return i}),n.d(t,"e",function(){return r}),n.d(t,"b",function(){return a}),n.d(t,"a",function(){return s}),n.d(t,"g",function(){return c}),n.d(t,"h",function(){return l}),n.d(t,"i",function(){return p}),n.d(t,"c",function(){return u});n("XaMz");function o(e,t,n){t<0||n<0||(n>=e.length&&(e[n]=void 0),e.splice(n,0,e.splice(t,1)[0]))}function i(e,t){return r(e,function(e){return t==e})}function r(e,t){var n=e.findIndex(t);return 0<=n&&(e.splice(n,1),!0)}function a(e,i){return e.reduce(function(e,t,n,o){return e+(i(t,n,o)?1:0)},0)}function s(e,t){return e.filter(function(e){return t!==e})}function c(e,t){if(e.length!=t.length)return!1;for(var n=0;n<e.length;n++)if(e[n]!=t[n])return!1;return!0}function l(e,t,n){for(var o=0,i=e.length-1;o<=i;){var r=Math.floor((o+i)/2),a=n(e[r],t);if(a<0)o=r+1;else if(0<a)i=r-1;else{if(i==r)return r;if(r==o)return r<i&&n(t,e[r+1])<0?r:r+1;o=r}}return i}function p(e,t,n){var o=l(e,t,n);e.splice(o+1,0,t)}function u(e,t){for(var n=0,o=0;n<e.length;){var i=e[n];t(i,n,e)&&(e[o++]=i),n++}return e.length=o,e}},WpBz:function(e,t,n){"use strict";function o(a){return function(e,i,t){var r=t.value;t.value=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var o=this[i+"_DebounceProperties"];void 0===o&&(o=this[i+"_DebounceProperties"]={hTimer:void 0,nPending:0}),void 0===o.hTimer?(r.apply(this,t),o.hTimer=window.setInterval(function(){0<o.nPending?(r.apply(e,t),o.nPending=0):(window.clearInterval(o.hTimer),o.hTimer=void 0)},a)):o.nPending+=1}}}n.d(t,"a",function(){return o})},XaMz:function(e,t,n){"use strict";function o(e,t){for(var n=[],o=2;o<arguments.length;o++)n[o-2]=arguments[o];console.assert?0==n.length?console.assert(!!e,t):console.assert.apply(console,[!!e,t].concat(n)):e||console.warn.apply(console,[t].concat(n))}n.d(t,"a",function(){return o})},Y3TG:function(e,t,n){"use strict";n("vDqi"),n("JtU4")},ZsEe:function(e,t,n){e.exports={throbberContainer:"main_throbberContainer_29hiv","throbberContainer-exit-active":"main_throbberContainer-exit-active_24VO6",SteamPageHeader:"main_SteamPageHeader_3EaXO",SteamPageHeaderShortLogo:"main_SteamPageHeaderShortLogo_2KbGi",SteamPageHeaderTopLink:"main_SteamPageHeaderTopLink_17wXz"}},"bf/M":function(e,t,n){},dBNU:function(e,t,n){},dcQ8:function(e,t,n){e.exports={BroadcastChat:"broadcastchat_BroadcastChat_25xed",ChatEntry:"broadcastchat_ChatEntry_3hSYv",ChatPanel:"broadcastchat_ChatPanel_3jc_d",ChatMessages:"broadcastchat_ChatMessages_PNfmQ",EmoticonContainer:"broadcastchat_EmoticonContainer_3ArHy",ChatSend:"broadcastchat_ChatSend_2szrh",ChatBox:"broadcastchat_ChatBox_3y_AV",ChatControls:"broadcastchat_ChatControls_35ufH",MessageChat:"broadcastchat_MessageChat_3eku_",MessageName:"broadcastchat_MessageName_2P_MO",MessageContents:"broadcastchat_MessageContents_555m-",MessageNotification:"broadcastchat_MessageNotification_2LJJp",MessageError:"broadcastchat_MessageError_YWUjL",minHeightZero:"broadcastchat_minHeightZero_3Cgfe",ChatLoginButton:"broadcastchat_ChatLoginButton_7EQxy",RateLimitProgressBarContainer:"broadcastchat_RateLimitProgressBarContainer_fFamE",RateLimitProgressBar:"broadcastchat_RateLimitProgressBar_kaFIe",TimedProgressBarContainer:"broadcastchat_TimedProgressBarContainer_321-Z",wrapper:"broadcastchat_wrapper_1iiJF",pie:"broadcastchat_pie_2q7aN",spinner:"broadcastchat_spinner_2u1pz",rota:"broadcastchat_rota_1D2nd",filler:"broadcastchat_filler_ZTWuH",fill:"broadcastchat_fill_1uXHe",mask:"broadcastchat_mask_xcUAc",FlairContainer:"broadcastchat_FlairContainer_tqyZ3"}},e2SU:function(e,t,n){"use strict";n.d(t,"w",function(){return a}),n.d(t,"S",function(){return s}),n.d(t,"g",function(){return c}),n.d(t,"i",function(){return l}),n.d(t,"n",function(){return p}),n.d(t,"A",function(){return u}),n.d(t,"D",function(){return m}),n.d(t,"o",function(){return d}),n.d(t,"X",function(){return h}),n.d(t,"N",function(){return _}),n.d(t,"L",function(){return f}),n.d(t,"ib",function(){return g}),n.d(t,"jb",function(){return b}),n.d(t,"gb",function(){return v}),n.d(t,"Z",function(){return S}),n.d(t,"u",function(){return y}),n.d(t,"t",function(){return C}),n.d(t,"K",function(){return I}),n.d(t,"a",function(){return E}),n.d(t,"r",function(){return O}),n.d(t,"y",function(){return w}),n.d(t,"H",function(){return M}),n.d(t,"hb",function(){return D}),n.d(t,"G",function(){return T}),n.d(t,"j",function(){return G}),n.d(t,"J",function(){return R}),n.d(t,"I",function(){return N}),n.d(t,"V",function(){return L}),n.d(t,"h",function(){return k}),n.d(t,"k",function(){return P}),n.d(t,"f",function(){return A}),n.d(t,"z",function(){return B}),n.d(t,"ab",function(){return F}),n.d(t,"eb",function(){return V}),n.d(t,"x",function(){return x}),n.d(t,"c",function(){return U}),n.d(t,"b",function(){return j}),n.d(t,"m",function(){return H}),n.d(t,"Y",function(){return W}),n.d(t,"B",function(){return z}),n.d(t,"E",function(){return q}),n.d(t,"O",function(){return K}),n.d(t,"U",function(){return Y}),n.d(t,"M",function(){return J}),n.d(t,"bb",function(){return X}),n.d(t,"cb",function(){return Q}),n.d(t,"R",function(){return Z}),n.d(t,"p",function(){return $}),n.d(t,"q",function(){return ee}),n.d(t,"l",function(){return te}),n.d(t,"C",function(){return ne}),n.d(t,"W",function(){return oe}),n.d(t,"fb",function(){return ie}),n.d(t,"s",function(){return re}),n.d(t,"P",function(){return ae}),n.d(t,"Q",function(){return se}),n.d(t,"v",function(){return ce}),n.d(t,"T",function(){return le}),n.d(t,"d",function(){return pe}),n.d(t,"F",function(){return ue}),n.d(t,"db",function(){return me}),n.d(t,"kb",function(){return de}),n.d(t,"e",function(){return he});var o=n("q1tI"),i=n("twdX"),r=n.n(i);function a(){return o.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",className:"SVGIcon_Button SVGIcon_Hyperlink","data-name":"Layer 1",viewBox:"0 0 100 100",x:"0px",y:"0px"},o.createElement("g",{"data-name":"Group"},o.createElement("path",{"data-name":"Path",d:"M50.86,20.23l-9,9,4.24,4.24,9-9c6.35-6.35,16.09-6.93,21.73-1.3s5,15.38-1.3,21.73l-9,9,4.24,4.24,9-9c8.69-8.69,9.27-22.24,1.3-30.21S59.55,11.55,50.86,20.23Z"}),o.createElement("path",{"data-name":"Path",d:"M44.89,75.53a17.22,17.22,0,0,1-11.28,5.13A13.23,13.23,0,0,1,19.34,66.39a17.22,17.22,0,0,1,5.13-11.28l9-9-4.24-4.24-9,9a23.21,23.21,0,0,0-6.88,15.22c0,.37,0,.74,0,1.11A19.19,19.19,0,0,0,33.91,86.66a23.21,23.21,0,0,0,15.22-6.88l9-9-4.24-4.24Z"}),o.createElement("rect",{"data-name":"Path",className:"Link1",x:"28.75",y:"47",width:"42.48",height:"6",transform:"translate(-20.71 50) rotate(-45)"})))}function s(){return o.createElement("svg",{version:"1.1",id:"Layer_1",xmlns:"http://www.w3.org/2000/svg",className:"SVGIcon_Button SVGIcon_Settings",x:"0px",y:"0px",width:"256px",height:"256px",viewBox:"-305.5 396.5 256 256",enableBackground:"new -305.5 396.5 256 256"},o.createElement("path",{d:"M-232.755,589.942l3.103,2.408c5.78,4.492,11.973,8.18,18.409,10.959l3.581,1.547l2.276,33.783 c0.089,1.33,1.385,2.54,2.715,2.54h48.62c1.355,0,2.745-1.273,2.852-2.621l2.74-33.284l3.602-1.496 c6.406-2.656,12.646-6.262,18.554-10.707l3.137-2.366l30.578,15.009c1.155,0.571,2.924,0.017,3.563-1.087l24.303-42.1 c0.674-1.173,0.265-3.014-0.852-3.785l-27.872-19.309l0.469-3.832c0.495-4.032,0.725-7.395,0.725-10.57 c0-3.129-0.227-6.5-0.687-10.307l-0.469-3.896l28.699-19.253c1.112-0.741,1.509-2.473,0.84-3.627l-24.3-42.104 c-0.657-1.139-2.502-1.727-3.7-1.155l-31.208,14.748l-3.091-2.341c-5.571-4.224-11.466-7.688-17.522-10.306l-3.58-1.548 l-2.34-34.887c-0.089-1.33-1.381-2.536-2.715-2.536h-48.617c-1.355,0-2.74,1.274-2.851,2.626l-2.834,34.371l-3.593,1.501 c-6.082,2.535-12.028,5.924-17.667,10.071l-3.124,2.302l-31.392-15.413c-1.168-0.575-2.924-0.025-3.559,1.074l-24.309,42.107 c-0.678,1.172-0.264,3.014,0.848,3.781l28.068,19.444l-0.524,3.883c-0.592,4.378-0.865,8.018-0.865,11.462 c0,2.988,0.179,6.065,0.55,9.403l0.431,3.853l-28.528,19.125c-1.108,0.742-1.509,2.468-0.84,3.632l24.308,42.1 c0.656,1.142,2.489,1.726,3.7,1.154L-232.755,589.942z M-177.498,560.051c-19.311,0-35.02-15.709-35.02-35.02 s15.709-35.02,35.02-35.02s35.02,15.709,35.02,35.02S-158.188,560.051-177.498,560.051z"}))}function c(){return o.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",className:"SVGIcon_Button SVGIcon_ChatSettings",version:"1.1",x:"0px",y:"0px",viewBox:"0 0 600 600"},o.createElement("g",null,o.createElement("path",{d:"M256,0C126.6,0,21.3,104.7,21.3,233.7c0,65.9,26.5,125.4,74.7,168.3v99.3c0,3.8,2,7.4,5.3,9.2c1.7,1,3.5,1.5,5.3,1.5   c1.8,0,3.7-0.5,5.4-1.5l85.8-50.3c18.9,4.8,38.4,7.3,58.1,7.3c129.4,0,234.7-104.9,234.7-233.7C490.7,104.7,385.4,0,256,0z    M405.3,254.1L370,260c-3,13.5-8.3,26-15.5,37.3l20.8,29.2L347.8,354l-29.2-20.8c-11.3,7.2-23.8,12.5-37.3,15.5l-5.9,35.3h-39   l-5.9-35.3c-13.5-3-26-8.3-37.3-15.5L164.2,354l-27.5-27.5l20.8-29.2C150.3,286,145,273.5,142,260l-35.3-5.9v-39l35.3-5.9   c3-13.5,8.3-26,15.5-37.3l-20.8-29.2l27.5-27.5l29.2,20.8c11.3-7.2,23.8-12.5,37.3-15.5l5.9-35.3h39l5.9,35.3   c13.5,3,26,8.3,37.3,15.5l29.2-20.8l27.5,27.5L354.5,172c7.2,11.3,12.5,23.8,15.5,37.3l35.3,5.9V254.1z"}),o.createElement("circle",{cx:"256",cy:"234.6",r:"45.9"})))}function l(){return o.createElement("svg",{version:"1.1",className:"SVGIcon_Button SVGIcon_CopyToClipboard",xmlns:"http://www.w3.org/2000/svg",x:"0px",y:"0px",width:"256px",height:"256px",viewBox:"0 0 256 256"},o.createElement("polyline",{fill:"none",className:"line",strokeWidth:"12",strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:"10",points:"178.25,197.25 247,197.25 247,82.5 175,10.25 111.5,10.25 111.5,56 "}),o.createElement("polygon",{fill:"none",className:"line",strokeWidth:"12",strokeLinejoin:"round",strokeMiterlimit:"10",points:"155,133 83,60.75 11,60.75 11,247.75 155,247.75 "}),o.createElement("polyline",{fill:"none",className:"line",strokeWidth:"12",strokeLinejoin:"round",strokeMiterlimit:"10",points:"83,60.75 83,133 155,133 "}),o.createElement("polyline",{fill:"none",className:"line",strokeWidth:"12",strokeLinejoin:"round",strokeMiterlimit:"10",points:"175,10.25 175,82.5 247,82.5 "}))}function p(){return o.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",className:"SVGIcon_Button SVGIcon_DownArrowContextMenu","data-name":"Layer 1",viewBox:"0 0 128 128",x:"0px",y:"0px"},o.createElement("polygon",{points:"50 59.49 13.21 22.89 4.74 31.39 50 76.41 95.26 31.39 86.79 22.89 50 59.49"}))}function u(){return o.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",className:"SVGIcon_Button SVGIcon_MagnifyingGlass",version:"1.1",x:"0px",y:"0px",viewBox:"0 0 100 100"},o.createElement("g",{transform:"translate(0,-952.36218)"},o.createElement("path",{className:"ColorSelector",d:"m 40.99855,964.36216 c -15.9798,0 -28.9986,13.01864 -28.9986,28.99862 0,15.97992 13.0188,28.99862 28.9986,28.99862 6.9189,0 13.2881,-2.4349 18.2803,-6.4997 l 23.5927,23.6239 c 1.1714,1.1714 3.0784,1.1715 4.2498,0 1.1716,-1.1715 1.1716,-3.0783 0,-4.2498 l -23.6239,-23.5926 c 4.0649,-4.9923 6.4997,-11.3615 6.4997,-18.28042 0,-15.97998 -13.0187,-28.99862 -28.9986,-28.99862 z m 0,5.99972 c 12.7374,0 22.9989,10.26145 22.9989,22.9989 0,12.73732 -10.2615,22.99892 -22.9989,22.99892 -12.7374,0 -22.9989,-10.2616 -22.9989,-22.99892 0,-12.73745 10.2615,-22.9989 22.9989,-22.9989 z",fill:"#ffffff",fillOpacity:"1",stroke:"none",visibility:"visible",display:"inline",overflow:"visible"})))}function m(e){var t="SVGIcon_Button SVGIcon_Microphone";return e.className&&(t+=" "+e.className),o.createElement("svg",{version:"1.1",xmlns:"http://www.w3.org/2000/svg",className:t,x:"0px",y:"0px",width:"256px",height:"256px",viewBox:"-127.5 664.5 256 256"},o.createElement("g",{className:"MicBase"},o.createElement("g",null,o.createElement("g",null,o.createElement("path",{d:"M-64.7,826.3c-0.5-2.9-0.8-5.8-0.8-8.7v-38.2h11.2v36.5L-64.7,826.3z"}),o.createElement("path",{d:"M-54.8,779.9v35.8l-9.6,9.6c-0.4-2.6-0.6-5.1-0.6-7.6v-37.7H-54.8 M-53.8,778.9H-66v38.7c0,3.3,0.4,6.5,1,9.7l11.2-11.2 V778.9L-53.8,778.9z"})),o.createElement("g",null,o.createElement("path",{d:"M56.8,817.6c0,24.7-24.8,44.9-55.3,44.9c-16.6,0-31.6-6-41.7-15.5l-8.6,8.6c11.1,10.5,26.7,17.5,44.2,18.8v25.1h-35.2 c-2.1,0-3.8,2.7-3.8,6.1c0,3.4,1.7,6.1,3.8,6.1h35.5H7.3h35.5c2.1,0,3.8-2.7,3.8-6.1c0-3.4-1.7-6.1-3.8-6.1H7.6v-25.1 C42,871.8,69,847.3,69,817.6v-38.7H56.8V817.6z"}),o.createElement("path",{d:"M69,778.9H56.8v38.7c0,24.7-24.8,44.9-55.3,44.9c-16.6,0-31.6-6-41.7-15.5l-8.6,8.6c11.1,10.5,26.7,17.5,44.2,18.8v25.1 h-35.2c-2.1,0-3.8,2.7-3.8,6.1c0,3.4,1.7,6.1,3.8,6.1h35.5H7.3h35.5c2.1,0,3.8-2.7,3.8-6.1c0-3.4-1.7-6.1-3.8-6.1H7.6v-25.1 C42,871.8,69,847.3,69,817.6V778.9L69,778.9z"}))),o.createElement("g",null,o.createElement("path",{d:"M40.6,712.5c0-21.6-17.5-39.1-39.1-39.1c-21.6,0-39.1,17.5-39.1,39.1v87.4l10-10v-72.4h0v-5c0-16.1,13.1-29.1,29.1-29.1 c16.1,0,29.1,13.1,29.1,29.1v5v14.1l10-10V712.5z"})),o.createElement("g",null,o.createElement("path",{d:"M-4.7,835.4c-2.2-0.5-4.4-1.2-6.4-2.2C-9.1,834.2-6.9,834.9-4.7,835.4z"}),o.createElement("path",{d:"M-0.1,836c-0.2,0-0.4,0-0.6,0C-0.6,836-0.4,836-0.1,836z"}),o.createElement("path",{d:"M30.6,806.9C30.6,806.9,30.6,806.9,30.6,806.9v-16.6"}),o.createElement("path",{d:"M-11.9,832.8c0.2,0.1,0.5,0.2,0.7,0.3C-11.4,833-11.7,832.9-11.9,832.8L-11.9,832.8z"}),o.createElement("path",{d:"M-1.7,835.9c-0.3,0-0.5-0.1-0.8-0.1C-2.3,835.8-2,835.8-1.7,835.9z"}),o.createElement("path",{d:"M-3.3,835.7c-0.3-0.1-0.6-0.1-1-0.2C-3.9,835.6-3.6,835.6-3.3,835.7z"}),o.createElement("path",{d:"M30.6,776.1v14.1v16.6c0,0,0,0,0,0s0,0,0,0c0,16.1-13,29.1-29.1,29.1c-0.5,0-1.1,0-1.6,0c-0.2,0-0.4,0-0.6,0 c-0.3,0-0.6,0-1-0.1c-0.3,0-0.5-0.1-0.8-0.1c-0.2,0-0.5-0.1-0.7-0.1c-0.3-0.1-0.6-0.1-1-0.2c-0.2,0-0.3-0.1-0.5-0.1 c-2.2-0.5-4.4-1.2-6.4-2.2c0,0-0.1,0-0.1,0c-0.2-0.1-0.5-0.2-0.7-0.3l0,0c-3-1.6-5.7-3.6-8-6.1l-7.1,7.1 c7.1,7.6,17.3,12.3,28.5,12.3c21.6,0,39.1-17.5,39.1-39.1v-40.8L30.6,776.1z"}),o.createElement("path",{d:"M-0.8,836c-0.3,0-0.6-0.1-1-0.1C-1.4,835.9-1.1,835.9-0.8,836z"}),o.createElement("path",{d:"M1.5,836.1c-0.5,0-1.1,0-1.6,0C0.4,836,0.9,836.1,1.5,836.1z"}),o.createElement("path",{d:"M-2.6,835.8c-0.2,0-0.5-0.1-0.7-0.1C-3,835.7-2.8,835.7-2.6,835.8z"}),o.createElement("path",{d:"M1.5,836.1c16.1,0,29.1-13,29.1-29.1c0,0,0,0,0,0C30.6,823,17.6,836.1,1.5,836.1z"}),o.createElement("path",{d:"M-4.2,835.5c-0.2,0-0.3-0.1-0.5-0.1C-4.5,835.4-4.4,835.5-4.2,835.5z"}),o.createElement("path",{d:"M-11.1,833.2C-11.1,833.2-11.2,833.2-11.1,833.2C-11.2,833.2-11.1,833.2-11.1,833.2z"}))),o.createElement("g",{className:"MicFill"},o.createElement("g",null,o.createElement("path",{d:"M-53.8,816.1L-65,827.3c2.2,10.8,7.9,20.5,16.2,28.3l8.6-8.6c-8.5-7.9-13.6-18.2-13.6-29.4V816.1L-53.8,816.1z"})),o.createElement("g",null,o.createElement("path",{d:"M1.5,834.6c-15.2,0-27.6-12.4-27.6-27.6v-94.5c0-15.2,12.4-27.6,27.6-27.6c15.2,0,27.6,12.4,27.6,27.6v94.5 C29.1,822.2,16.7,834.6,1.5,834.6z"}),o.createElement("path",{d:"M1.5,696.3c8.9,0,16.1,7.2,16.1,16.1v94.5c0,8.9-7.2,16.1-16.1,16.1c-8.9,0-16.1-7.2-16.1-16.1v-94.5 C-14.6,703.6-7.4,696.3,1.5,696.3 M1.5,673.3c-21.6,0-39.1,17.5-39.1,39.1v94.5c0,21.6,17.5,39.1,39.1,39.1s39.1-17.5,39.1-39.1 v-94.5C40.6,690.8,23.1,673.3,1.5,673.3L1.5,673.3z"}))),o.createElement("g",{className:"MicStrike",fill:"none",strokeWidth:"1"},o.createElement("line",{x1:"-82.5",y1:"866.5",x2:"83.5",y2:"700.4"})))}function d(){return o.createElement("svg",{version:"1.1",id:"Layer_1",xmlns:"http://www.w3.org/2000/svg",className:"SVGIcon_Button SVGIcon_Emoticon",x:"0px",y:"0px",width:"256px",height:"256px",viewBox:"0 0 256 256"},o.createElement("circle",{fill:"none",stroke:"#ffffff",strokeWidth:"12",strokeMiterlimit:"10",cx:"128",cy:"128",r:"107.5"}),o.createElement("path",{fill:"none",stroke:"#ffffff",strokeWidth:"12",strokeLinecap:"round",strokeMiterlimit:"10",d:"M74.484,145.945 c0,0,12.996,37.533,53.514,37.533c38.084,0,53.499-37.533,53.499-37.533"}),o.createElement("line",{fill:"none",stroke:"#ffffff",strokeWidth:"12",strokeLinecap:"round",strokeMiterlimit:"10",x1:"94.5",y1:"97.5",x2:"94.5",y2:"109.5"}),o.createElement("line",{fill:"none",stroke:"#ffffff",strokeWidth:"12",strokeLinecap:"round",strokeMiterlimit:"10",x1:"160.5",y1:"97.5",x2:"160.5",y2:"109.5"}))}function h(){return o.createElement("svg",{fill:"#FFFFFF",xmlns:"http://www.w3.org/2000/svg",className:"SVGIcon_Button SVGIcon_Submit",version:"1.1",x:"0px",y:"0px",viewBox:"0 0 100 100"},o.createElement("g",{transform:"translate(0,-952.36218)"},o.createElement("path",{d:"m 92.115057,974.14842 a 2.0001999,2.0001999 0 0 0 -1.96764,2.02965 l 0.0376,31.19553 -77.475501,0 16.161909,-15.73013 a 2.0002746,2.0002746 0 1 0 -2.790355,-2.8667 L 6.3913393,1007.9405 a 2.0001999,2.0001999 0 0 0 -0.0011,2.8646 l 19.6896957,19.2036 a 2.0002671,2.0002671 0 1 0 2.792551,-2.8646 l -16.170767,-15.771 79.153048,0 a 2.0001999,2.0001999 0 0 0 1.72959,-0.5437 2.0001999,2.0001999 0 0 0 0.0598,-0.058 2.0001999,2.0001999 0 0 0 0.54259,-1.7218 l -0.0388,-32.87638 a 2.0001999,2.0001999 0 0 0 -2.03297,-2.02522 z",fill:"#FFFFFF",fillOpacity:"1",fillRule:"evenodd",stroke:"none",visibility:"visible",display:"inline",overflow:"visible"})))}function _(){return o.createElement("svg",{version:"1.1",xmlns:"http://www.w3.org/2000/svg",className:"SVGIcon_Button SVGIcon_ResizeIcon",x:"0px",y:"0px",viewBox:"0 0 256 256"},o.createElement("g",null,o.createElement("path",{fill:"#020202",d:"M115.512,137.263l21.6-21.6c0,0,25.5,25.5,45.8,45.8l35-35v91.6h-91.6l35-35 C141.012,162.763,115.512,137.263,115.512,137.263z"}),o.createElement("path",{fill:"#020202",d:"M108.312,129.763c-20.3-20.3-35.8-35.8-35.8-35.8l21.6-21.601c0,0,15.5,15.5,35.8,35.801L108.312,129.763z"}),o.createElement("path",{fill:"#020202",d:"M54.312,75.763c-20.3-20.3-15.8-15.8-15.8-15.8l21.6-21.601c0,0-4.5-4.5,15.8,15.801L54.312,75.763z"})))}function f(){return o.createElement("svg",{fill:"#FFFFFF",xmlns:"http://www.w3.org/2000/svg",className:"SVGIcon_Button SVGIcon_Popout",viewBox:"0 0 8 8",x:"0px",y:"0px"},o.createElement("path",{d:"M0 0v8h8v-2h-1v1h-6v-6h1v-1h-2zm4 0l1.5 1.5-2.5 2.5 1 1 2.5-2.5 1.5 1.5v-4h-4z"}))}function g(){return o.createElement("svg",{fill:"#FFFFFF",xmlns:"http://www.w3.org/2000/svg",className:"SVGIcon_Button SVGIcon_X",version:"1.1",x:"0px",y:"0px",viewBox:"-165 95 100 100"},o.createElement("g",null,o.createElement("polygon",{points:"-74.9,117.2 -102.2,145 -74.9,172.8 -89.1,186.8 -116.2,159.3 -143.2,186.8 -157.5,172.8 -130.2,145 -157.5,117.2 -143.2,103.2 -116.2,130.7 -89.1,103.2"})))}function b(){return o.createElement("svg",{version:"1.1",id:"Layer_2",xmlns:"http://www.w3.org/2000/svg",className:"SVGIcon_Button SVGIcon_X_Line",x:"0px",y:"0px",width:"256px",height:"256px",viewBox:"0 0 256 256"},o.createElement("line",{fill:"none",stroke:"#ffffff",strokeWidth:"45",strokeMiterlimit:"10",x1:"212",y1:"212",x2:"44",y2:"44"}),o.createElement("line",{fill:"none",stroke:"#ffffff",strokeWidth:"45",strokeMiterlimit:"10",x1:"44",y1:"212",x2:"212",y2:"44"}))}function v(e){return o.createElement("svg",{version:"1.1",xmlns:"http://www.w3.org/2000/svg",className:"SVGIcon_Button SVGIcon_VoiceRoom",x:"0px",y:"0px",width:"64px",height:"64px",viewBox:"0 0 64 64",enableBackground:"new 0 0 64 64"},!e.exitOnly&&o.createElement("g",null,o.createElement("path",{className:"Bubble",fill:"none",strokeMiterlimit:"1",strokeWidth:"2.5px",d:"M60.1,32.3c0,15.1-12.3,27.3-27.4,27.3 c-5,0-9.7-1.4-13.8-3.7c-1.8-1.1-15,5.4-13.8,3.4c1.7-2.9,5.9-10.3,4.7-12C7,43,5.3,37.8,5.3,32.3C5.3,17.2,17.6,5,32.7,5 C47.8,5,60.1,17.2,60.1,32.3z"})),!e.exitOnly&&o.createElement("g",null,o.createElement("path",{className:"AudioLines",opacity:"0",strokeWidth:"1px",d:"M37.2,51.1c-0.5,0-1-0.1-1.3-0.4c-0.7-0.5-0.7-1.3,0-1.8c6.3-4.4,9.8-10.2,9.8-16.4c0-6.2-3.5-12-9.8-16.4 c-0.7-0.5-0.7-1.3,0-1.8s1.9-0.5,2.6,0c7.1,4.9,10.9,11.4,10.9,18.3c0,6.9-3.9,13.4-10.9,18.3C38.2,51,37.7,51.1,37.2,51.1 M21.4,40.2c0.5,0,0.9-0.1,1.3-0.4c2.8-2,4.3-4.6,4.3-7.3s-1.5-5.4-4.3-7.3c-0.7-0.5-1.9-0.5-2.6,0c-0.7,0.5-0.7,1.3,0,1.8 c2.1,1.5,3.3,3.4,3.3,5.5c0,2.1-1.2,4-3.3,5.5c-0.7,0.5-0.7,1.3,0,1.8C20.4,40.1,20.9,40.2,21.4,40.2 M29.3,45.7 c0.5,0,1-0.1,1.3-0.4c4.9-3.4,7.7-7.9,7.7-12.7c0-4.8-2.7-9.3-7.7-12.7c-0.7-0.5-1.9-0.5-2.6,0c-0.7,0.5-0.7,1.3,0,1.8 c4.2,2.9,6.6,6.8,6.6,10.9c0,4.1-2.3,8-6.6,10.9c-0.7,0.5-0.7,1.3,0,1.8C28.4,45.5,28.8,45.7,29.3,45.7"})),o.createElement("g",{className:"Arrow",opacity:e.exitOnly?1:0},o.createElement("polyline",{fill:"none",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:"10",points:"41,30.7 14.5,30.7 23.5,19.4 "}),o.createElement("polyline",{fill:"none",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:"10",points:"41,30.7 14.5,30.7 23.5,42 "})),o.createElement("g",null,o.createElement("polyline",{className:"ExitDoor",opacity:e.exitOnly?1:0,strokeLinecap:"round",strokeMiterlimit:"1",strokeWidth:"2px",fill:"none",points:"32.5,22.1 32.5,17.7 47.7,17.7 47.7,43.8 32.5,43.8 32.5,39.5"})),!e.exitOnly&&o.createElement("g",{className:"Microphone"},o.createElement("path",{d:"M40.971,28.593v6.278c0,4.007-4.023,7.284-8.971,7.284c-2.693,0-5.126-0.974-6.765-2.516 c-1.379-1.28-2.207-2.952-2.207-4.769v-6.278l0,0H21.05v6.278c0,0.536,0.064,1.055,0.162,1.573 c0.357,1.752,1.281,3.325,2.627,4.592c1.801,1.702,4.332,2.839,7.17,3.049v4.072H25.3c-0.341,0-0.616,0.438-0.616,0.989 c0,0.552,0.275,0.99,0.616,0.99h5.759h1.882H38.7c0.341,0,0.616-0.438,0.616-0.99c0-0.551-0.275-0.989-0.616-0.989h-5.71v-4.072 c5.58-0.422,9.96-4.396,9.96-9.214v-6.278H40.971z"}),o.createElement("g",null,o.createElement("path",{d:"M32,39.841c-3.493,0-6.343-2.344-6.343-5.213v-17.85c0-2.871,2.85-5.213,6.343-5.213s6.343,2.342,6.343,5.213v17.85,C38.343,37.497,35.493,39.841,32,39.841z"}))))}function S(){return o.createElement("svg",{version:"1.1",id:"Layer_1",xmlns:"http://www.w3.org/2000/svg",className:"SVGIcon_Button SVGIcon_TextRoom",x:"0px",y:"0px",width:"256px",height:"256px",viewBox:"0 0 256 256",stroke:"#000",strokeWidth:"10px"},o.createElement("g",{className:"ScratchPad"},o.createElement("path",{fill:"none",strokeWidth:"0",strokeMiterlimit:"10",d:"M179.751,40.994h14.869 c8.388,0,15.25,6.862,15.25,15.25v141.193c0,8.388-6.862,15.25-15.25,15.25H57.37c-8.388,0-15.25-6.862-15.25-15.25V56.244 c0-8.388,6.862-15.25,15.25-15.25h14.869H179.751z"}),o.createElement("line",{fill:"none",strokeWidth:"0",strokeLinecap:"round",strokeMiterlimit:"10",x1:"74.495",y1:"27.313",x2:"74.495",y2:"54.063"}),o.createElement("line",{fill:"none",strokeWidth:"0",strokeLinecap:"round",strokeMiterlimit:"10",x1:"124.495",y1:"27.313",x2:"124.495",y2:"54.063"}),o.createElement("line",{fill:"none",strokeWidth:"0",strokeLinecap:"round",strokeMiterlimit:"10",x1:"174.745",y1:"27.313",x2:"174.745",y2:"54.063"})),o.createElement("line",{className:"TextLines",x1:"71.6",y1:"115.4",x2:"179.4",y2:"115.4"}),o.createElement("line",{className:"TextLines",x1:"71.6",y1:"145.8",x2:"143.3",y2:"145.8"}),o.createElement("line",{className:"TextLines",x1:"71.6",y1:"175.9",x2:"179.4",y2:"175.9"}),o.createElement("line",{className:"TextLines",x1:"73.7",y1:"82.7",x2:"166.8",y2:"82.7"}))}function y(e){var t="SVGIcon_Button SVGIcon_Headphones";return e.className&&(t+=" "+e.className),o.createElement("svg",{version:"1.1",xmlns:"http://www.w3.org/2000/svg",className:t,x:"0px",y:"0px",width:"256px",height:"256px",viewBox:"-305.5 396.5 256 256"},o.createElement("g",{className:"HeadPhonesBase"},o.createElement("g",null,o.createElement("path",{fill:"none",d:"M-176.5,418.7c-37,0-69.5,30.2-69.5,64.5v25.3c11.3,2.3,19.9,12.3,19.9,24.3v8.6l100.9-100.9 C-138.2,427.3-156.7,418.7-176.5,418.7z"}),o.createElement("path",{d:"M-226.2,532.9c0-12-8.5-22-19.9-24.3v-25.3c0-34.4,32.5-64.5,69.5-64.5c19.8,0,38.3,8.6,51.2,21.9l6.9-6.9 c-14.8-15.1-35.7-24.9-58.2-24.9c-42.3,0-79.4,34.8-79.4,74.5v25.3c-11.3,2.3-19.9,12.3-19.9,24.3v29.8c0,7.8,3.6,14.7,9.2,19.3 l40.5-40.5V532.9z"}),o.createElement("path",{d:"M-97.1,508.6v-25.3c0-7.5-1.3-14.8-3.8-21.8l-7.9,7.9c1.2,4.5,1.8,9.1,1.8,13.9v25.3c-11.3,2.3-19.9,12.3-19.9,24.3v29.8 c0,13.7,11.1,24.8,24.8,24.8c13.7,0,24.8-11.1,24.8-24.8v-29.8C-77.2,520.9-85.8,510.9-97.1,508.6z"}))),o.createElement("g",{className:"HeadphonesStrike"},o.createElement("line",{fill:"none",x1:"-260.5",y1:"598.5",x2:"-94.5",y2:"432.4"})),o.createElement("g",{className:"HeadPhonesFill"},o.createElement("path",{d:"M-226.2,562.7v-21.2l-40.5,40.5c4.3,3.5,9.7,5.6,15.6,5.6C-237.3,587.5-226.2,576.4-226.2,562.7z"}),o.createElement("path",{d:"M-118.3,433.7l-6.9,6.9c7.9,8.1,13.7,18,16.5,28.8l7.9-7.9C-104.5,451.1-110.5,441.6-118.3,433.7z"})))}function C(){return o.createElement("svg",{version:"1.1",id:"Layer_5",xmlns:"http://www.w3.org/2000/svg",className:"SVGIcon_Button SVGIcon_Group",x:"0px",y:"0px",width:"256px",height:"256px",viewBox:"0 0 256 256"},o.createElement("g",{transform:"translate(0,-952.36218)"},o.createElement("path",{d:"M58.6,970.4c-15.4,0-28.1,12.7-28.1,28.1c0,15.4,12.7,28.1,28.1,28.1s28.1-12.7,28.1-28.1\tC86.7,983,74,970.4,58.6,970.4z M202.1,970.4c-15.4,0-28.1,12.7-28.1,28.1c0,15.4,12.7,28.1,28.1,28.1s28.1-12.7,28.1-28.1 C230.2,983,217.6,970.4,202.1,970.4z M130.4,986c-15.4,0-28.1,12.7-28.1,28.1c0,15.4,12.7,28.1,28.1,28.1s28.1-12.7,28.1-28.1 C158.5,998.6,145.8,986,130.4,986z M242.8,1110.6c0-0.1,0-17.9,0-18l-0.1-16.1c0-22.4-18.2-40.6-40.6-40.6 c-17.8,0-30,7.7-36.3,18.8c-2,3.5-3.4,7.3-4.5,11.1c-7.5-8.7-18.6-14.3-31-14.3s-23.5,5.6-31,14.3c-1.1-3.9-2.5-7.6-4.5-11.1 c-6.3-11.1-18.4-18.8-36.3-18.8c-22.4,0-40.6,18.2-40.6,40.6v46.8c0,3.4,2.8,6.2,6.2,6.2h12.5v31.2c0,3.4,2.8,6.2,6.2,6.2h31.2 c3.4,0,6.2-2.8,6.2-6.2v-31.2h9.4v9.4c0,3.4,2.8,6.2,6.2,6.2h12.5v31.2c0,3.4,2.8,6.2,6.2,6.2H146c3.4,0,6.2-2.8,6.2-6.2v-31.2 h12.5c3.4,0,6.2-2.8,6.2-6.2v-9.4h9.4v31.2c0,3.4,2.8,6.2,6.2,6.2h31.2c3.4,0,6.2-2.8,6.2-6.2v-31.2h12.5c3.4,0,6.3-2.7,6.3-6.2\tV1110.6z"})))}function I(){return o.createElement("svg",{version:"1.1",xmlns:"http://www.w3.org/2000/svg",className:"SVGIcon_Button SVGIcon_PlusCircle",x:"0px",y:"0px",width:"256px",height:"256px",viewBox:"0 0 256 256"},o.createElement("circle",{fill:"none",strokeWidth:"10",strokeMiterlimit:"10",cx:"128",cy:"128",r:"95.333"}),o.createElement("line",{className:"horizontalLine",fill:"none",strokeWidth:"10",strokeLinecap:"round",strokeMiterlimit:"10",x1:"73.333",y1:"128",x2:"183.333",y2:"128"}),o.createElement("line",{className:"verticalLine",fill:"none",strokeWidth:"10",strokeLinecap:"round",strokeMiterlimit:"10",x1:"128.333",y1:"73.335",x2:"128.333",y2:"183.333"}))}function E(){return o.createElement("svg",{version:"1.1",id:"Layer_1",xmlns:"http://www.w3.org/2000/svg",className:"SVGIcon_Button SVGIcon_AddFriend",x:"0px",y:"0px",width:"256px",height:"256px",viewBox:"0 0 256 256"},o.createElement("g",{className:"friendHead",transform:"matrix(1.34048,0,0,1.34048,-10.0942,-5.50445)"},o.createElement("circle",{cx:"86.296",cy:"47.419",r:"33.526"})),o.createElement("path",{className:"friendBody",d:"M100.353,170.882c0-23.589,10.397-44.736,26.842-59.152c-3.352-0.423-6.773-0.649-10.257-0.649H94.231\tc-39.775,0-56.481,28.271-56.481,63.099v41.88c0,0-0.3,16.369,35.917,21.813c36.217,5.444,73.651,5,73.651,5 C119.666,230.681,100.353,203.044,100.353,170.882z"}),o.createElement("path",{className:"plusCircle",d:"M179.01,103.892c-36.998,0-66.99,29.992-66.99,66.99s29.994,66.989,66.99,66.989c36.997,0,66.99-29.991,66.99-66.989 S216.008,103.892,179.01,103.892z M217.893,175.882h-33.647v33.882c0,2.762-2.239,5-5,5s-5-2.238-5-5v-33.882h-33.647 c-2.762,0-5-2.238-5-5c0-2.763,2.238-5,5-5h33.647V132.47c0-2.762,2.239-5,5-5s5,2.238,5,5v33.412h33.647c2.762,0,5,2.237,5,5 C222.893,173.643,220.654,175.882,217.893,175.882z"}))}function O(){return o.createElement("svg",{version:"1.1",id:"Layer_4",xmlns:"http://www.w3.org/2000/svg",className:"SVGIcon_Button SVGIcon_FriendRequest",x:"0px",y:"0px",width:"256px",height:"256px",viewBox:"0 0 256 256"},o.createElement("g",{className:"friendHead",transform:"matrix(1.34048,0,0,1.34048,-10.0942,-5.50445)"},o.createElement("circle",{cx:"85.923",cy:"47.419",r:"33.526"})),o.createElement("path",{className:"friendBody",d:"M100.353,170.882c0-23.589,10.397-44.736,26.842-59.152c-3.352-0.423-6.773-0.649-10.257-0.649H94.231\tc-39.775,0-56.481,28.271-56.481,63.099v41.88c0,0-0.3,16.369,35.917,21.813c36.217,5.444,73.651,5,73.651,5 C119.666,230.681,100.353,203.044,100.353,170.882z"}),o.createElement("path",{className:"friendBodyFull",d:"M176.504,217.922v-42.624c0-35.443-17.002-64.217-57.483-64.217H106.96h-1.017H94.898 c-40.48,0.001-57.484,28.774-57.484,64.217v42.624c0,0,0,22.197,69.544,22.197C177.521,240.121,176.504,217.922,176.504,217.922z"}),o.createElement("path",{className:"friendArm",d:"M18.167,63.833c6.53-0.734,39.348,39.127,50.007,47.647s21.327,16.686,15.16,25.353s-20.646,16.74-36.167,2.5 S-1.349,90.532,0,85.333S8.599,64.909,18.167,63.833z"}),o.createElement("path",{className:"redCircle",d:"M178.51,103.892c-36.998,0-66.99,29.992-66.99,66.99s29.994,66.99,66.99,66.99c36.997,0,66.99-29.992,66.99-66.99 S215.508,103.892,178.51,103.892z"}))}function w(){return o.createElement("svg",{version:"1.1",id:"Layer_5",xmlns:"http://www.w3.org/2000/svg",className:"SVGIcon_Button SVGIcon_Invite",x:"0px",y:"0px",width:"256px",height:"255.999px",viewBox:"0 0 256 255.999"},o.createElement("path",{d:"M165.678,20.535c-17.251,0-31.386,14.135-31.386,31.386c0,17.252,14.135,31.386,31.386,31.386 c17.251,0,31.386-14.134,31.386-31.386C197.063,34.67,182.929,20.535,165.678,20.535z"}),o.createElement("path",{d:"M165.678,93.121c24.995,0,45.335,20.34,45.335,45.335v52.31c0,3.853-3.123,6.975-6.975,6.975h-13.95v34.874 c0,3.852-3.123,6.974-6.974,6.975h-34.874c-3.852-0.001-6.974-3.123-6.975-6.975v-34.874h-13.95c-3.852,0-6.974-3.123-6.974-6.975 v-52.31C120.343,113.461,140.683,93.121,165.678,93.121z"}),o.createElement("g",{className:"invitePlus"},o.createElement("line",{fill:"none",stroke:"#ffffff",strokeWidth:"22",strokeMiterlimit:"10",x1:"14",y1:"128",x2:"101.5",y2:"128"}),o.createElement("line",{fill:"none",stroke:"#ffffff",strokeWidth:"22",strokeMiterlimit:"10",x1:"57.75",y1:"84.25",x2:"57.75",y2:"171.75"})))}function M(){return o.createElement("svg",{version:"1.1",id:"Layer_5",xmlns:"http://www.w3.org/2000/svg",className:"SVGIcon_Button SVGIcon_Paperclip",x:"0px",y:"0px",width:"256px",height:"256px",viewBox:"0 0 256 256"},o.createElement("path",{fill:"none",strokeWidth:"10",strokeLinecap:"round",strokeMiterlimit:"10",d:"M167.768,62.647 l-0.012,123.052c0,24.729-19.334,44.856-43.096,44.866c-23.765-0.006-43.099-20.134-43.096-44.872L81.557,48.851 c0-15.345,14.483-27.827,29.83-27.83c15.342,0.003,27.827,12.488,27.833,27.833l-0.002,139.245 c0.003,6.376-8.546,12.925-14.925,12.925c0,0-13.929-0.166-13.929-12.928l0.003-124.839"}))}function D(){return o.createElement("svg",{version:"1.1",xmlns:"http://www.w3.org/2000/svg",className:"SVGIcon_Button SVGIcon_Volume",x:"0px",y:"0px",width:"256px",height:"255.999px",viewBox:"0 0 256 255.999"},o.createElement("g",{className:"Speaker"},o.createElement("path",{d:"M93.785,52.265c-0.946,0-2.357,0.63-3.304,1.577L40.284,98.022c-0.947,0.789-2.831,1.578-4.093,1.578H9.367 C8.104,99.6,7,100.706,7,101.967v52.069c0,1.264,1.104,2.367,2.367,2.367H36.19c1.262,0,3.146,0.632,4.093,1.578l50.197,44.181 c0.947,0.789,2.516,1.578,3.304,1.578s1.578-1.104,1.578-2.367V54.631C95.363,53.369,94.731,52.265,93.785,52.265z"})),o.createElement("g",{className:"SoundWaves"},o.createElement("path",{className:"SoundWavesHighest",d:"M193.826,30.402c24.959,24.958,40.349,59.403,40.349,97.604c0,38.199-15.388,72.645-40.349,97.603l9.916,9.916 c28.067-28.067,44.263-64.673,44.263-107.521c0-42.847-16.196-79.455-44.263-107.521"}),o.createElement("path",{className:"SoundWavesHigh",d:"M175.737,47.628l-8.924,8.924c18.271,18.27,29.536,43.484,29.536,71.448s-11.264,53.178-29.536,71.448l8.924,8.924 c20.546-20.546,33.234-49.008,33.234-80.374c0-31.366-12.688-59.829-33.234-80.374V47.628z"}),o.createElement("path",{className:"SoundWavesMed",d:"M148.913,74.454l-8.925,8.925c11.488,11.488,18.491,27.236,18.491,44.624c0,17.388-7.054,33.281-18.491,44.575l8.875,8.975 c13.811-13.635,22.239-32.753,22.239-53.55c0-20.797-8.432-39.793-22.189-53.55V74.454z"}),o.createElement("path",{className:"SoundWavesLow",d:"M121.989,101.229l-8.778,9.073c4.641,4.516,7.397,10.706,7.397,17.702c0,6.995-2.755,13.186-7.397,17.702l8.778,9.073 c7.035-6.844,11.243-16.413,11.243-26.775C133.232,117.643,129.024,108.075,121.989,101.229z"})),o.createElement("g",{className:"SoundX"},o.createElement("line",{fill:"none",strokeWidth:"0",strokeMiterlimit:"10",x1:"137",y1:"170.667",x2:"223.167",y2:"84.5"}),o.createElement("line",{fill:"none",strokeWidth:"0",strokeMiterlimit:"10",x1:"137",y1:"84.5",x2:"223.167",y2:"170.667"})))}function T(){return o.createElement("svg",{version:"1.1",xmlns:"http://www.w3.org/2000/svg",className:"SVGIcon_Button SVGIcon_NewChatGroup",x:"0px",y:"0px",viewBox:"0 0 256 256"},o.createElement("path",{className:"Bubble",strokeWidth:"12",strokeMiterlimit:"10",d:"M127.393,10.833 c64.854,0,117.46,52.609,117.46,117.013c0,24.035-7.254,45.804-19.5,63.943c-4.99,7.711,13.15,39.457,20.408,51.705 c4.989,8.612-51.701-19.05-59.412-14.514c-17.233,9.979-37.188,15.872-58.957,15.872c-64.859,0-117.465-52.607-117.465-117.008 C9.928,63.442,62.534,10.833,127.393,10.833z"}),o.createElement("line",{strokeWidth:"22",strokeLinecap:"round",strokeMiterlimit:"10",x1:"83.5",y1:"128.886",x2:"176.184",y2:"128.886"}),o.createElement("line",{strokeWidth:"22",strokeLinecap:"round",strokeMiterlimit:"10",x1:"129.842",y1:"82.544",x2:"129.842",y2:"175.228"}))}function G(){return o.createElement("svg",{version:"1.1",id:"Layer_1",xmlns:"http://www.w3.org/2000/svg",className:"SVGIcon_Button SVGIcon_Crown",x:"0px",y:"0px",width:"256px",height:"256px",viewBox:"0 0 256 256"},o.createElement("g",null,o.createElement("path",{d:"M239.874,94.963l-31.115,21.325c-18.18,12.586-43.351,5.594-52.44-14.333l-23.772-50.692c-2.099-4.194-8.041-4.194-9.789,0 l-23.074,50.343c-9.439,20.627-35.31,27.27-53.49,13.983L16.128,93.565c-4.195-3.147-10.139,1.049-8.391,6.293l31.464,106.628 c0.35,1.049,1.398,1.397,2.098,1.397h173.752c1.049,0,1.749-0.698,2.098-1.397l31.115-104.53 C250.012,96.36,244.068,91.816,239.874,94.963z"})))}function R(){return o.createElement("svg",{version:"1.1",id:"Layer_1",xmlns:"http://www.w3.org/2000/svg",className:"SVGIcon_Button SVGIcon_Play",x:"0px",y:"0px",width:"256px",height:"256px",viewBox:"0 0 256 256"},o.createElement("path",{className:"playTriangle",d:"M65.321,33.521c-11.274-6.615-20.342-1.471-20.342,11.52V210.96c0,12.989,9.068,18.135,20.342,11.521l137.244-82.348 c11.274-6.618,11.274-17.646,0-24.509L65.321,33.521z"}))}function N(){return o.createElement("svg",{version:"1.1",id:"Layer_1",xmlns:"http://www.w3.org/2000/svg",className:"SVGIcon_Button SVGIcon_Pause",x:"0px",y:"0px",width:"256px",height:"256px",viewBox:"0 0 256 256"},o.createElement("path",{d:"M44.979,219.364c0,3.3,2.7,6,6,6h49.753c3.3,0,6-2.7,6-6V36.5c0-3.3-2.7-6-6-6H50.979c-3.3,0-6,2.7-6,6V219.364z"}),o.createElement("path",{d:"M149.267,219.364c0,3.3,2.7,6,6,6h49.753c3.3,0,6-2.7,6-6V36.5c0-3.3-2.7-6-6-6h-49.753c-3.3,0-6,2.7-6,6V219.364z"}))}function L(){return o.createElement("svg",{version:"1.1",id:"Layer_1",xmlns:"http://www.w3.org/2000/svg",className:"SVGIcon_Button SVGIcon_SortBy",x:"0px",y:"0px",width:"256px",height:"256px",viewBox:"0 0 256 256"},o.createElement("g",{className:"time"},o.createElement("circle",{fill:"none",strokeWidth:"10",strokeMiterlimit:"10",cx:"91.735",cy:"128.014",r:"64"}),o.createElement("polyline",{fill:"none",strokeWidth:"10",strokeLinecap:"round",strokeMiterlimit:"10",points:"91.735,90.833 91.735,128.014 116.58,152.086 \t"})),o.createElement("g",{className:"arrow"},o.createElement("polyline",{fill:"none",strokeWidth:"10",strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:"10",points:"199.735,63.66 199.735,192.366 171.207,163.675"}),o.createElement("polyline",{fill:"none",strokeWidth:"10",strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:"10",points:"199.735,63.66 199.735,192.366 228.266,163.675"})),o.createElement("g",{className:"alphabet"},o.createElement("polyline",{fill:"none",strokeWidth:"10",strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:"10",points:"70.268,109.934 94.483,63.635 119.77,109.934"}),o.createElement("line",{fill:"none",strokeWidth:"10",strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:"10",x1:"77.458",y1:"97.861",x2:"112.135",y2:"97.861"}),o.createElement("polyline",{fill:"none",strokeWidth:"10",strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:"10",points:"70.045,145.379 119.547,145.379 70.045,192.032 119.547,192.032"})))}function k(){return o.createElement("svg",{version:"1.1",id:"base",xmlns:"http://www.w3.org/2000/svg",className:"SVGIcon_Button SVGIcon_Check",x:"0px",y:"0px",width:"256px",height:"256px",viewBox:"0 0 256 256"},o.createElement("polyline",{fill:"none",stroke:"#fff",strokeWidth:"24",strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:"10",points:"49.5,147.75 95,210.75 206.5,45.25 "}))}function P(){return o.createElement("svg",{version:"1.1",id:"base",xmlns:"http://www.w3.org/2000/svg",className:"SVGIcon_Button SVGIcon_DialogCheck",x:"0px",y:"0px",width:"256px",height:"256px",viewBox:"0 0 256 256"},o.createElement("defs",null,o.createElement("linearGradient",{id:"linear",x1:"0%",y1:"0%",x2:"100%",y2:"100%"},o.createElement("stop",{id:"stop0",offset:"0%",stopColor:"#00ccff"}),o.createElement("stop",{id:"stop1",offset:"100%",stopColor:"#2d73ff"})),o.createElement("filter",{id:"f1",x:"0",y:"0",width:"200%",height:"200%"},o.createElement("feOffset",{result:"offOut",in:"SourceAlpha",dx:"20",dy:"20"}),o.createElement("feGaussianBlur",{result:"blurOut",in:"offOut",stdDeviation:"10"}),o.createElement("feBlend",{in:"SourceGraphic",in2:"blurOut",mode:"normal"}))),o.createElement("path",{fill:"none",stroke:"url(#linear)",strokeWidth:"24",strokeLinecap:"round",strokeLinejoin:"miter",strokeMiterlimit:"10",d:"M206.5,45.25L95,210.75l-45.5-63",strokeDasharray:"365.19 365.19",strokeDashoffset:"0.00"}),o.createElement("path",{fill:"none",opacity:".2",filter:"url(#f1)",stroke:"url(#linear)",strokeWidth:"24",strokeLinecap:"round",strokeLinejoin:"miter",strokeMiterlimit:"10",d:"M206.5,45.25L95,210.75l-45.5-63",strokeDasharray:"365.19 365.19",strokeDashoffset:"0.00"}))}function A(){return o.createElement("svg",{version:"1.1",id:"Layer_1",xmlns:"http://www.w3.org/2000/svg",className:"SVGIcon_Button SVGIcon_Caution",x:"0px",y:"0px",width:"256px",height:"256px",viewBox:"0 0 256 256"},o.createElement("g",{className:"triangle"},o.createElement("path",{stroke:"#020202",strokeWidth:"16",strokeLinecap:"round",strokeMiterlimit:"10",d:"M127.9,76.632"}),o.createElement("path",{fill:"none",stroke:"#020202",strokeWidth:"11",strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:"5",d:"M128.001,226.606c42.507,0,81.538,0,87.756,0c31.222,0,36.95-14.974,24.045-34.771c-6.921-10.617-78.297-122.962-89.163-140.254\tC141.859,37.613,138.542,29.393,128,29.393l0,0c-10.543,0-13.86,8.222-22.639,22.189C94.495,68.874,23.119,181.219,16.198,191.836 c-12.905,19.797-7.175,34.771,24.045,34.771C46.463,226.606,85.494,226.606,128.001,226.606"}),o.createElement("path",{fill:"#020202",d:"M127.9,208.12"})),o.createElement("g",{className:"exclamation"},o.createElement("line",{fill:"none",stroke:"#020202",strokeWidth:"16",strokeLinecap:"round",strokeMiterlimit:"10",x1:"127.9",y1:"76.632",x2:"127.9",y2:"160.07"}),o.createElement("path",{fill:"#020202",d:"M127.9,208.12c-6.377,0-11.548-5.17-11.548-11.548c0-6.377,5.17-11.547,11.548-11.547 c6.377,0,11.547,5.17,11.547,11.547C139.447,202.95,134.277,208.12,127.9,208.12"})))}function B(){return o.createElement("svg",{version:"1.1",id:"Layer_1",xmlns:"http://www.w3.org/2000/svg",className:"SVGIcon_Button SVGIcon_Lock",x:"0px",y:"0px",width:"256px",height:"256px",viewBox:"0 0 256 256"},o.createElement("path",{className:"topLock",d:"M203.553,197.794c0,21.929-17.778,39.706-39.706,39.706H92.154c-21.929,0-39.706-17.777-39.706-39.706v-71.693 c0-21.928,17.778-39.706,39.706-39.706h71.692c21.928,0,39.706,17.778,39.706,39.706V197.794z M128.001,129.664 c-8.941,0-16.19,7.248-16.19,16.189c0,5.589,2.833,10.518,7.137,13.427c2.066,1.395,0.318,23.508,0.318,32.842 c0,2.292-0.078,3.65,8.734,3.65c8.676,0,8.75-1.221,8.75-3.654c0-9.348-1.708-31.469,0.368-32.886 c4.269-2.916,7.071-7.821,7.071-13.38C144.191,136.912,136.941,129.664,128.001,129.664z"}),o.createElement("path",{className:"baseLock",fill:"none",stroke:"#ffffff",strokeWidth:"22",strokeMiterlimit:"10",d:"M84.813,172.74V73.688l0,0 c0-23.85,19.335-43.188,43.187-43.188l0,0c23.852,0,43.188,19.337,43.188,43.188l0,0v23.885"}))}function F(e){var t="SVGIcon_Button SVGIcon_Throbber ";return e.className&&(t+=e.className),o.createElement("svg",{version:"1.1",id:"base",xmlns:"http://www.w3.org/2000/svg",className:t,x:"0px",y:"0px",width:"256px",height:"256px",viewBox:"0 0 256 256"},o.createElement("g",{className:r.a.partCircle},o.createElement("path",{className:r.a.roundOuter,fill:"none",stroke:"#ffffff",strokeWidth:"6",strokeMiterlimit:"10",d:"M27.66,156.37 c12.355,43.698,52.503,75.733,100.16,75.733c57.495,0,104.104-46.61,104.104-104.105S185.314,23.895,127.82,23.895"}),o.createElement("path",{className:r.a.roundOuter,fill:"none",stroke:"#ffffff",strokeWidth:"6",strokeMiterlimit:"10",d:"M201.432,101.166"}),o.createElement("path",{className:r.a.roundOuter,fill:"none",stroke:"#ffffff",strokeWidth:"6",strokeMiterlimit:"10",d:"M127.82,23.895 c-54.686,0-99.487,42.167-103.745,95.754"})),o.createElement("g",{className:r.a.mainOutline},o.createElement("path",{className:r.a.roundFill,fill:"none",stroke:"#ffffff",strokeWidth:"6",strokeMiterlimit:"10",d:"M127.82,23.895 c-54.686,0-99.487,42.167-103.745,95.754l55.797,23.069c4.729-3.231,10.44-5.122,16.584-5.122c0.551,0,1.098,0.014,1.642,0.047 l24.815-35.968c0-0.17-0.004-0.338-0.004-0.509c0-21.647,17.61-39.261,39.26-39.261s39.263,17.613,39.263,39.261 c0,21.65-17.611,39.264-39.263,39.264c-0.299,0-0.593-0.007-0.887-0.014l-35.392,25.251c0.018,0.462,0.035,0.931,0.035,1.396 c0,16.252-13.22,29.472-29.469,29.472c-14.265,0-26.19-10.185-28.892-23.666L27.66,156.37 c12.355,43.698,52.503,75.733,100.16,75.733c57.495,0,104.104-46.61,104.104-104.105S185.314,23.895,127.82,23.895z"}),o.createElement("path",{className:r.a.roundOuterOutline,strokeLinecap:"butt",fill:"none",stroke:"#ffffff",strokeWidth:"6",strokeMiterlimit:"10",d:"M127.82,23.895 c-54.686,0-99.487,42.167-103.745,95.754l55.797,23.069c4.729-3.231,10.44-5.122,16.584-5.122c0.551,0,1.098,0.014,1.642,0.047 l24.815-35.968c0-0.17-0.004-0.338-0.004-0.509c0-21.647,17.61-39.261,39.26-39.261s39.263,17.613,39.263,39.261 c0,21.65-17.611,39.264-39.263,39.264c-0.299,0-0.593-0.007-0.887-0.014l-35.392,25.251c0.018,0.462,0.035,0.931,0.035,1.396 c0,16.252-13.22,29.472-29.469,29.472c-14.265,0-26.19-10.185-28.892-23.666L27.66,156.37 c12.355,43.698,52.503,75.733,100.16,75.733c57.495,0,104.104-46.61,104.104-104.105S185.314,23.895,127.82,23.895z"}),o.createElement("path",{className:r.a.roundThrobber01,strokeLinecap:"butt",fill:"none",stroke:"#ffffff",strokeWidth:"6",strokeMiterlimit:"10",d:"M127.82,23.895 c-54.686,0-99.487,42.167-103.745,95.754l55.797,23.069c4.729-3.231,10.44-5.122,16.584-5.122c0.551,0,1.098,0.014,1.642,0.047 l24.815-35.968c0-0.17-0.004-0.338-0.004-0.509c0-21.647,17.61-39.261,39.26-39.261s39.263,17.613,39.263,39.261 c0,21.65-17.611,39.264-39.263,39.264c-0.299,0-0.593-0.007-0.887-0.014l-35.392,25.251c0.018,0.462,0.035,0.931,0.035,1.396 c0,16.252-13.22,29.472-29.469,29.472c-14.265,0-26.19-10.185-28.892-23.666L27.66,156.37 c12.355,43.698,52.503,75.733,100.16,75.733c57.495,0,104.104-46.61,104.104-104.105S185.314,23.895,127.82,23.895z"}),o.createElement("path",{className:r.a.roundThrobber02,strokeLinecap:"butt",fill:"none",stroke:"#ffffff",strokeWidth:"6",strokeMiterlimit:"10",d:"M127.82,23.895 c-54.686,0-99.487,42.167-103.745,95.754l55.797,23.069c4.729-3.231,10.44-5.122,16.584-5.122c0.551,0,1.098,0.014,1.642,0.047 l24.815-35.968c0-0.17-0.004-0.338-0.004-0.509c0-21.647,17.61-39.261,39.26-39.261s39.263,17.613,39.263,39.261 c0,21.65-17.611,39.264-39.263,39.264c-0.299,0-0.593-0.007-0.887-0.014l-35.392,25.251c0.018,0.462,0.035,0.931,0.035,1.396 c0,16.252-13.22,29.472-29.469,29.472c-14.265,0-26.19-10.185-28.892-23.666L27.66,156.37 c12.355,43.698,52.503,75.733,100.16,75.733c57.495,0,104.104-46.61,104.104-104.105S185.314,23.895,127.82,23.895z"}),o.createElement("path",{className:r.a.roundThrobber03,strokeLinecap:"butt",fill:"none",stroke:"#ffffff",strokeWidth:"6",strokeMiterlimit:"10",d:"M127.82,23.895 c-54.686,0-99.487,42.167-103.745,95.754l55.797,23.069c4.729-3.231,10.44-5.122,16.584-5.122c0.551,0,1.098,0.014,1.642,0.047 l24.815-35.968c0-0.17-0.004-0.338-0.004-0.509c0-21.647,17.61-39.261,39.26-39.261s39.263,17.613,39.263,39.261 c0,21.65-17.611,39.264-39.263,39.264c-0.299,0-0.593-0.007-0.887-0.014l-35.392,25.251c0.018,0.462,0.035,0.931,0.035,1.396 c0,16.252-13.22,29.472-29.469,29.472c-14.265,0-26.19-10.185-28.892-23.666L27.66,156.37 c12.355,43.698,52.503,75.733,100.16,75.733c57.495,0,104.104-46.61,104.104-104.105S185.314,23.895,127.82,23.895z"}),o.createElement("path",{className:r.a.roundThrobber04,strokeLinecap:"butt",fill:"none",stroke:"#ffffff",strokeWidth:"6",strokeMiterlimit:"10",d:"M127.82,23.895 c-54.686,0-99.487,42.167-103.745,95.754l55.797,23.069c4.729-3.231,10.44-5.122,16.584-5.122c0.551,0,1.098,0.014,1.642,0.047 l24.815-35.968c0-0.17-0.004-0.338-0.004-0.509c0-21.647,17.61-39.261,39.26-39.261s39.263,17.613,39.263,39.261 c0,21.65-17.611,39.264-39.263,39.264c-0.299,0-0.593-0.007-0.887-0.014l-35.392,25.251c0.018,0.462,0.035,0.931,0.035,1.396 c0,16.252-13.22,29.472-29.469,29.472c-14.265,0-26.19-10.185-28.892-23.666L27.66,156.37 c12.355,43.698,52.503,75.733,100.16,75.733c57.495,0,104.104-46.61,104.104-104.105S185.314,23.895,127.82,23.895z"}),o.createElement("path",{className:r.a.roundThrobber05,strokeLinecap:"butt",fill:"none",stroke:"#ffffff",strokeWidth:"6",strokeMiterlimit:"10",d:"M127.82,23.895 c-54.686,0-99.487,42.167-103.745,95.754l55.797,23.069c4.729-3.231,10.44-5.122,16.584-5.122c0.551,0,1.098,0.014,1.642,0.047 l24.815-35.968c0-0.17-0.004-0.338-0.004-0.509c0-21.647,17.61-39.261,39.26-39.261s39.263,17.613,39.263,39.261 c0,21.65-17.611,39.264-39.263,39.264c-0.299,0-0.593-0.007-0.887-0.014l-35.392,25.251c0.018,0.462,0.035,0.931,0.035,1.396 c0,16.252-13.22,29.472-29.469,29.472c-14.265,0-26.19-10.185-28.892-23.666L27.66,156.37 c12.355,43.698,52.503,75.733,100.16,75.733c57.495,0,104.104-46.61,104.104-104.105S185.314,23.895,127.82,23.895z"}),o.createElement("path",{className:r.a.roundThrobber06,strokeLinecap:"butt",fill:"none",stroke:"#ffffff",strokeWidth:"6",strokeMiterlimit:"10",d:"M127.82,23.895 c-54.686,0-99.487,42.167-103.745,95.754l55.797,23.069c4.729-3.231,10.44-5.122,16.584-5.122c0.551,0,1.098,0.014,1.642,0.047 l24.815-35.968c0-0.17-0.004-0.338-0.004-0.509c0-21.647,17.61-39.261,39.26-39.261s39.263,17.613,39.263,39.261 c0,21.65-17.611,39.264-39.263,39.264c-0.299,0-0.593-0.007-0.887-0.014l-35.392,25.251c0.018,0.462,0.035,0.931,0.035,1.396 c0,16.252-13.22,29.472-29.469,29.472c-14.265,0-26.19-10.185-28.892-23.666L27.66,156.37 c12.355,43.698,52.503,75.733,100.16,75.733c57.495,0,104.104-46.61,104.104-104.105S185.314,23.895,127.82,23.895z"}),o.createElement("path",{className:r.a.roundThrobber07,strokeLinecap:"butt",fill:"none",stroke:"#ffffff",strokeWidth:"6",strokeMiterlimit:"10",d:"M127.82,23.895 c-54.686,0-99.487,42.167-103.745,95.754l55.797,23.069c4.729-3.231,10.44-5.122,16.584-5.122c0.551,0,1.098,0.014,1.642,0.047 l24.815-35.968c0-0.17-0.004-0.338-0.004-0.509c0-21.647,17.61-39.261,39.26-39.261s39.263,17.613,39.263,39.261 c0,21.65-17.611,39.264-39.263,39.264c-0.299,0-0.593-0.007-0.887-0.014l-35.392,25.251c0.018,0.462,0.035,0.931,0.035,1.396 c0,16.252-13.22,29.472-29.469,29.472c-14.265,0-26.19-10.185-28.892-23.666L27.66,156.37 c12.355,43.698,52.503,75.733,100.16,75.733c57.495,0,104.104-46.61,104.104-104.105S185.314,23.895,127.82,23.895z"}),o.createElement("path",{className:r.a.roundThrobber08,strokeLinecap:"butt",fill:"none",stroke:"#ffffff",strokeWidth:"6",strokeMiterlimit:"10",d:"M127.82,23.895 c-54.686,0-99.487,42.167-103.745,95.754l55.797,23.069c4.729-3.231,10.44-5.122,16.584-5.122c0.551,0,1.098,0.014,1.642,0.047 l24.815-35.968c0-0.17-0.004-0.338-0.004-0.509c0-21.647,17.61-39.261,39.26-39.261s39.263,17.613,39.263,39.261 c0,21.65-17.611,39.264-39.263,39.264c-0.299,0-0.593-0.007-0.887-0.014l-35.392,25.251c0.018,0.462,0.035,0.931,0.035,1.396 c0,16.252-13.22,29.472-29.469,29.472c-14.265,0-26.19-10.185-28.892-23.666L27.66,156.37 c12.355,43.698,52.503,75.733,100.16,75.733c57.495,0,104.104-46.61,104.104-104.105S185.314,23.895,127.82,23.895z"}),o.createElement("path",{className:r.a.roundThrobber09,strokeLinecap:"butt",fill:"none",stroke:"#ffffff",strokeWidth:"6",strokeMiterlimit:"10",d:"M127.82,23.895 c-54.686,0-99.487,42.167-103.745,95.754l55.797,23.069c4.729-3.231,10.44-5.122,16.584-5.122c0.551,0,1.098,0.014,1.642,0.047 l24.815-35.968c0-0.17-0.004-0.338-0.004-0.509c0-21.647,17.61-39.261,39.26-39.261s39.263,17.613,39.263,39.261 c0,21.65-17.611,39.264-39.263,39.264c-0.299,0-0.593-0.007-0.887-0.014l-35.392,25.251c0.018,0.462,0.035,0.931,0.035,1.396 c0,16.252-13.22,29.472-29.469,29.472c-14.265,0-26.19-10.185-28.892-23.666L27.66,156.37 c12.355,43.698,52.503,75.733,100.16,75.733c57.495,0,104.104-46.61,104.104-104.105S185.314,23.895,127.82,23.895z"}),o.createElement("path",{className:r.a.roundThrobber10,strokeLinecap:"butt",fill:"none",stroke:"#ffffff",strokeWidth:"6",strokeMiterlimit:"10",d:"M127.82,23.895 c-54.686,0-99.487,42.167-103.745,95.754l55.797,23.069c4.729-3.231,10.44-5.122,16.584-5.122c0.551,0,1.098,0.014,1.642,0.047 l24.815-35.968c0-0.17-0.004-0.338-0.004-0.509c0-21.647,17.61-39.261,39.26-39.261s39.263,17.613,39.263,39.261 c0,21.65-17.611,39.264-39.263,39.264c-0.299,0-0.593-0.007-0.887-0.014l-35.392,25.251c0.018,0.462,0.035,0.931,0.035,1.396 c0,16.252-13.22,29.472-29.469,29.472c-14.265,0-26.19-10.185-28.892-23.666L27.66,156.37 c12.355,43.698,52.503,75.733,100.16,75.733c57.495,0,104.104-46.61,104.104-104.105S185.314,23.895,127.82,23.895z"}),o.createElement("path",{className:r.a.roundThrobber11,strokeLinecap:"butt",fill:"none",stroke:"#ffffff",strokeWidth:"6",strokeMiterlimit:"10",d:"M127.82,23.895 c-54.686,0-99.487,42.167-103.745,95.754l55.797,23.069c4.729-3.231,10.44-5.122,16.584-5.122c0.551,0,1.098,0.014,1.642,0.047 l24.815-35.968c0-0.17-0.004-0.338-0.004-0.509c0-21.647,17.61-39.261,39.26-39.261s39.263,17.613,39.263,39.261 c0,21.65-17.611,39.264-39.263,39.264c-0.299,0-0.593-0.007-0.887-0.014l-35.392,25.251c0.018,0.462,0.035,0.931,0.035,1.396 c0,16.252-13.22,29.472-29.469,29.472c-14.265,0-26.19-10.185-28.892-23.666L27.66,156.37 c12.355,43.698,52.503,75.733,100.16,75.733c57.495,0,104.104-46.61,104.104-104.105S185.314,23.895,127.82,23.895z"}),o.createElement("path",{className:r.a.roundThrobber12,strokeLinecap:"butt",fill:"none",stroke:"#ffffff",strokeWidth:"6",strokeMiterlimit:"10",d:"M127.82,23.895 c-54.686,0-99.487,42.167-103.745,95.754l55.797,23.069c4.729-3.231,10.44-5.122,16.584-5.122c0.551,0,1.098,0.014,1.642,0.047 l24.815-35.968c0-0.17-0.004-0.338-0.004-0.509c0-21.647,17.61-39.261,39.26-39.261s39.263,17.613,39.263,39.261 c0,21.65-17.611,39.264-39.263,39.264c-0.299,0-0.593-0.007-0.887-0.014l-35.392,25.251c0.018,0.462,0.035,0.931,0.035,1.396 c0,16.252-13.22,29.472-29.469,29.472c-14.265,0-26.19-10.185-28.892-23.666L27.66,156.37 c12.355,43.698,52.503,75.733,100.16,75.733c57.495,0,104.104-46.61,104.104-104.105S185.314,23.895,127.82,23.895z"}),o.createElement("path",{className:r.a.roundThrobber13,strokeLinecap:"butt",fill:"none",stroke:"#ffffff",strokeWidth:"6",strokeMiterlimit:"10",d:"M127.82,23.895 c-54.686,0-99.487,42.167-103.745,95.754l55.797,23.069c4.729-3.231,10.44-5.122,16.584-5.122c0.551,0,1.098,0.014,1.642,0.047 l24.815-35.968c0-0.17-0.004-0.338-0.004-0.509c0-21.647,17.61-39.261,39.26-39.261s39.263,17.613,39.263,39.261 c0,21.65-17.611,39.264-39.263,39.264c-0.299,0-0.593-0.007-0.887-0.014l-35.392,25.251c0.018,0.462,0.035,0.931,0.035,1.396 c0,16.252-13.22,29.472-29.469,29.472c-14.265,0-26.19-10.185-28.892-23.666L27.66,156.37 c12.355,43.698,52.503,75.733,100.16,75.733c57.495,0,104.104-46.61,104.104-104.105S185.314,23.895,127.82,23.895z"}),o.createElement("path",{className:r.a.roundThrobber14,strokeLinecap:"butt",fill:"none",stroke:"#ffffff",strokeWidth:"6",strokeMiterlimit:"10",d:"M127.82,23.895 c-54.686,0-99.487,42.167-103.745,95.754l55.797,23.069c4.729-3.231,10.44-5.122,16.584-5.122c0.551,0,1.098,0.014,1.642,0.047 l24.815-35.968c0-0.17-0.004-0.338-0.004-0.509c0-21.647,17.61-39.261,39.26-39.261s39.263,17.613,39.263,39.261 c0,21.65-17.611,39.264-39.263,39.264c-0.299,0-0.593-0.007-0.887-0.014l-35.392,25.251c0.018,0.462,0.035,0.931,0.035,1.396 c0,16.252-13.22,29.472-29.469,29.472c-14.265,0-26.19-10.185-28.892-23.666L27.66,156.37 c12.355,43.698,52.503,75.733,100.16,75.733c57.495,0,104.104-46.61,104.104-104.105S185.314,23.895,127.82,23.895z"}),o.createElement("path",{className:r.a.roundThrobber15,strokeLinecap:"butt",fill:"none",stroke:"#ffffff",strokeWidth:"6",strokeMiterlimit:"10",d:"M127.82,23.895 c-54.686,0-99.487,42.167-103.745,95.754l55.797,23.069c4.729-3.231,10.44-5.122,16.584-5.122c0.551,0,1.098,0.014,1.642,0.047 l24.815-35.968c0-0.17-0.004-0.338-0.004-0.509c0-21.647,17.61-39.261,39.26-39.261s39.263,17.613,39.263,39.261 c0,21.65-17.611,39.264-39.263,39.264c-0.299,0-0.593-0.007-0.887-0.014l-35.392,25.251c0.018,0.462,0.035,0.931,0.035,1.396 c0,16.252-13.22,29.472-29.469,29.472c-14.265,0-26.19-10.185-28.892-23.666L27.66,156.37 c12.355,43.698,52.503,75.733,100.16,75.733c57.495,0,104.104-46.61,104.104-104.105S185.314,23.895,127.82,23.895z"})),o.createElement("g",{className:r.a.bottomCircle},o.createElement("path",{fill:"#ffffff",d:"M89.226,181.579L76.5,176.321c2.256,4.696,6.159,8.628,11.339,10.786 c11.197,4.668,24.11-0.647,28.779-11.854c2.259-5.425,2.274-11.405,0.033-16.841c-2.237-5.436-6.46-9.675-11.886-11.938 c-5.384-2.24-11.151-2.156-16.22-0.244l13.146,5.436c8.261,3.443,12.166,12.93,8.725,21.189 C106.976,181.115,97.486,185.022,89.226,181.579"})),o.createElement("g",{className:r.a.topCircle},o.createElement("circle",{fill:"none",stroke:"#ffffff",strokeWidth:"6",strokeMiterlimit:"10",cx:"161.731",cy:"101.274",r:"23.019"})))}function V(){return o.createElement("svg",{version:"1.1",id:"base",xmlns:"http://www.w3.org/2000/svg",className:"SVGIcon_Button SVGIcon_Video",x:"0px",y:"0px",width:"256px",height:"256px",viewBox:"0 0 256 256"},o.createElement("path",{className:"videoPlayButton",d:"M165.399,124.063L109.118,92.06c-1.399-0.797-3.118-0.787-4.508,0.026c-1.39,0.805-2.25,2.295-2.25,3.905v64.008 c0,1.609,0.86,3.1,2.25,3.913c0.705,0.412,1.491,0.613,2.277,0.613c0.768,0,1.546-0.191,2.241-0.596l56.283-32.003 c1.416-0.806,2.285-2.306,2.285-3.934C167.694,126.368,166.816,124.869,165.399,124.063z"}),o.createElement("path",{d:"M238.069,40.646H214.25h-28.82h-28.82h-28.458h-0.36H99.333H70.536H41.727h-23.82c-3.184,0-5.773,2.59-5.773,5.772v23.856 v120.441v18.867c0,3.184,2.589,5.771,5.773,5.771h2.415h21.394h28.82h28.82h28.459h0.361h28.457h28.82h28.82h23.82 c3.184,0,5.773-2.589,5.773-5.771v-18.867V70.274V46.418C243.844,43.223,241.254,40.646,238.069,40.646z M191.215,47.181h17.273  V64.5h-17.273V47.181L191.215,47.181z M162.396,47.181h17.272V64.5h-17.272V47.181z M133.938,47.181h16.912V64.5h-16.912V47.181z\tM105.128,47.181h16.912V64.5h-16.912V47.181z M76.309,47.181h17.273V64.5H76.309V47.181z M47.488,47.181h17.273V64.5H47.488V47.181 z M18.681,47.181h17.273V64.5H18.681V47.181z M35.954,208.811H18.681v-17.319h17.273V208.811z M64.763,208.811H47.489v-17.319 h17.273V208.811L64.763,208.811z M93.583,208.811H76.31v-17.319h17.273V208.811z M122.041,208.811h-16.912v-17.319h16.912V208.811z M150.849,208.811h-16.912v-17.319h16.912V208.811z M179.668,208.811h-17.272v-17.319h17.272V208.811z M208.488,208.811h-17.273 v-17.319h17.273V208.811z M237.297,208.811h-17.273v-17.319h17.273V208.811L237.297,208.811z M237.297,184.943H214.25h-28.819 h-28.82h-28.458h-0.361H99.333H70.537H41.728H18.682V71.047h23.046h28.82h28.82h28.458h0.36h28.458h28.82h28.82h23.045v113.896 H237.297z M237.297,64.5h-17.273V47.181h17.273V64.5L237.297,64.5z"}))}function x(){return o.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",version:"1.1",className:"SVGIcon_Button SVGIcon_Image",x:"0px",y:"0px",viewBox:"0 0 100 100",enableBackground:"new 0 0 100 100"},o.createElement("path",{stroke:"#ffffff",fill:"#ffffff",d:"M83.086,12.091H16.913C10.344,12.091,5,17.435,5,24.004v51.992l0.005,0.102c0.056,6.514,5.396,11.813,11.908,11.813h66.173  c6.531,0,11.874-5.314,11.906-11.764L95,24.004C95,17.435,89.654,12.091,83.086,12.091z M83.086,82.989H16.913  c-3.516,0-6.488-2.653-6.93-6.106l18.899-20.615c1.226-1.34,2.85-2.076,4.574-2.076c1.723,0,3.347,0.736,4.574,2.078l19.611,21.393  c0.885,0.961,2.508,1.029,3.473,0.148c1-0.916,1.068-2.476,0.152-3.478l-4.113-4.485l8.406-8.918  c1.258-1.332,2.926-2.064,4.696-2.064c1.772,0,3.44,0.732,4.696,2.064l15.061,15.973C89.564,80.346,86.594,82.989,83.086,82.989z   M90.08,69.801L78.532,57.555c-2.194-2.328-5.132-3.609-8.275-3.609c-3.142,0-6.08,1.281-8.272,3.609l-8.164,8.656l-12.162-13.27  c-2.171-2.366-5.084-3.67-8.201-3.67c-3.119,0-6.031,1.304-8.202,3.67L9.92,69.673V24.004c0-3.856,3.137-6.994,6.993-6.994h66.173  c3.857,0,6.994,3.137,6.994,6.994V69.801z"}),o.createElement("path",{stroke:"#ffffff",fill:"#ffffff",d:"M68.907,22.489c-6.569,0-11.914,5.344-11.914,11.914c0,6.569,5.345,11.913,11.914,11.913  c6.567,0,11.913-5.344,11.913-11.913C80.82,27.833,75.477,22.489,68.907,22.489z M68.907,41.396c-3.856,0-6.993-3.137-6.993-6.993  s3.137-6.994,6.993-6.994c3.854,0,6.991,3.138,6.991,6.994S72.764,41.396,68.907,41.396z"}))}function U(){return o.createElement("svg",{version:"1.1",id:"base",xmlns:"http://www.w3.org/2000/svg",className:"SVGIcon_Button SVGIcon_Bell",x:"0px",y:"0px",width:"256px",height:"256px",viewBox:"0 0 256 256"},o.createElement("path",{d:"M107.785,33.965c-34.875,8.972-60.644,40.618-60.644,78.308v53.903c0,4.965-4.035,8.99-8.975,8.99 c-9.929,0-17.978,8.066-17.978,17.971c0,9.924,8.059,17.969,18.013,17.969h179.598c9.948,0,18.014-8.066,18.014-17.969 c0-9.926-8.087-17.971-17.979-17.971c-4.956,0-8.975-3.993-8.975-8.99v-53.903c0-37.676-25.763-69.333-60.644-78.308v-9.281 c0-11.193-9.052-20.219-20.215-20.219c-11.143,0-20.215,9.052-20.215,20.219V33.965L107.785,33.965z M96.554,220.09h62.891 c0,17.366-14.079,31.445-31.445,31.445C110.633,251.535,96.554,237.458,96.554,220.09z"}))}function j(e){return o.createElement("svg",{version:"1.1",transform:"rotate("+e.angle+")",id:"arrowBase",xmlns:"http://www.w3.org/2000/svg",className:"SVGIcon_Button SVGIcon_Arrow",x:"0px",y:"0px",width:"256px",height:"256px",viewBox:"0 0 256 256"},o.createElement("polyline",{fill:"none",stroke:"#ffffff",strokeWidth:"10",strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:"10",points:"128,247.688 128,8.313 181.061,61.674 "}),o.createElement("polyline",{fill:"none",stroke:"#ffffff",strokeWidth:"10",strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:"10",points:"128,247.688 128,8.313 74.939,61.674 "}))}function H(e){var t="";return e.angle&&(t="rotate("+e.angle+")"),o.createElement("svg",{transform:t,version:"1.1",id:"arrowBase",xmlns:"http://www.w3.org/2000/svg",className:"SVGIcon_Button SVGIcon_DoubleArrow",x:"0px",y:"0px",width:"256px",height:"256px",viewBox:"0 0 256 256"},o.createElement("polyline",{className:"Arrow1",fill:"none",stroke:"#ffffff",strokeWidth:"23",strokeLinecap:"round",strokeMiterlimit:"10",points:"135.65,21.667 30.081,127.235 137.18,234.333 "}),o.createElement("polyline",{className:"Arrow2",fill:"none",stroke:"#ffffff",strokeWidth:"23",strokeLinecap:"round",strokeMiterlimit:"10",points:"224.389,21.667 118.821,127.235 225.92,234.333 "}))}function W(){return o.createElement("svg",{version:"1.1",id:"arrowBase",xmlns:"http://www.w3.org/2000/svg",className:"SVGIcon_Button SVGIcon_DoubleArrow",x:"0px",y:"0px",width:"256px",height:"256px",viewBox:"0 0 256 256"},o.createElement("polyline",{className:"Arrow1",fill:"none",stroke:"#ffffff",strokeWidth:"23",strokeLinecap:"round",strokeMiterlimit:"10",points:"135.65,21.667 30.081,127.235 137.18,234.333 "}),o.createElement("polyline",{className:"Arrow2",fill:"none",stroke:"#ffffff",strokeWidth:"23",strokeLinecap:"round",strokeMiterlimit:"10",points:"224.389,21.667 118.821,127.235 225.92,234.333 "}))}function z(){return o.createElement("svg",{version:"1.1",id:"base",xmlns:"http://www.w3.org/2000/svg",className:"SVGIcon_Button SVGIcon_Maximize",x:"0px",y:"0px",width:"256px",height:"256px",viewBox:"0 0 256 256"},o.createElement("rect",{x:"24",y:"42.167",fill:"none",stroke:"rgb(120, 138, 146)",strokeWidth:"18",strokeMiterlimit:"10",width:"208",height:"171.667"}),o.createElement("line",{fill:"none",stroke:"rgb(120, 138, 146)",strokeWidth:"42",strokeMiterlimit:"10",x1:"24",y1:"54.01",x2:"232",y2:"54.01"}))}function q(){return o.createElement("svg",{version:"1.1",id:"base",xmlns:"http://www.w3.org/2000/svg",className:"SVGIcon_Button SVGIcon_Minimize",x:"0px",y:"0px",width:"256px",height:"256px",viewBox:"0 0 256 256"},o.createElement("line",{fill:"none",stroke:"rgb(120, 138, 146)",strokeWidth:"18",strokeMiterlimit:"10",x1:"24",y1:"209.01",x2:"232",y2:"209.01"}))}function K(){return o.createElement("svg",{version:"1.1",id:"Layer_2",xmlns:"http://www.w3.org/2000/svg",className:"SVGIcon_Button SVGIcon_Restore",x:"0px",y:"0px",width:"256px",height:"256px",viewBox:"0 0 256 256"},o.createElement("polyline",{fill:"none",stroke:"rgb(120, 138, 146)",strokeWidth:"12",strokeMiterlimit:"10",points:"83,90.861 83,42.167 232,42.167 232,165.14 173,165.14 "}),o.createElement("rect",{x:"24",y:"90.861",fill:"none",stroke:"rgb(120, 138, 146)",strokeWidth:"18",strokeMiterlimit:"10",width:"149",height:"122.973"}))}function Y(){return o.createElement("svg",{version:"1.1",id:"base",xmlns:"http://www.w3.org/2000/svg",className:"SVGIcon_Button SVGIcon_SingleWindowToggle",x:"0px",y:"0px",width:"256px",height:"256px",viewBox:"0 0 256 256"},o.createElement("g",{className:"mainBox"},o.createElement("rect",{x:"90",y:"42.167",fill:"none",stroke:"rgb(120, 138, 146)",strokeWidth:"18",strokeMiterlimit:"10",width:"142",height:"171.667"}),o.createElement("line",{fill:"none",stroke:"rgb(120, 138, 146)",strokeWidth:"42",strokeMiterlimit:"10",x1:"90",y1:"54.01",x2:"232",y2:"54.01"})),o.createElement("g",{className:"leftBox"},o.createElement("rect",{x:"28",y:"42.167",fill:"none",stroke:"rgb(120, 138, 146)",strokeWidth:"18",strokeMiterlimit:"10",width:"62",height:"171.667"}),o.createElement("line",{fill:"none",stroke:"rgb(120, 138, 146)",strokeWidth:"42",strokeMiterlimit:"10",x1:"28",y1:"54.01",x2:"90",y2:"54.01"})))}function J(){return o.createElement("svg",{version:"1.1",id:"Layer_2",xmlns:"http://www.w3.org/2000/svg",className:"SVGIcon_Button SVGIcon_Reload",x:"0px",y:"0px",width:"256px",height:"256px",viewBox:"0 0 256 256"},o.createElement("path",{fill:"none",stroke:"#ffffff",strokeWidth:"30",strokeLinecap:"round",strokeMiterlimit:"10",d:"M229.809,147.639 c-9.178,47.863-51.27,84.027-101.809,84.027c-57.253,0-103.667-46.412-103.667-103.666S70.747,24.334,128,24.334 c34.107,0,64.368,16.472,83.261,41.895"}),o.createElement("polygon",{points:"147.639,108.361 245.755,10.166 245.834,108.361 "}))}function X(){return o.createElement("svg",{version:"1.1",id:"Layer_2",xmlns:"http://www.w3.org/2000/svg",className:"SVGIcon_Button SVGIcon_Trade",x:"0px",y:"0px",width:"256px",height:"256px",viewBox:"0 0 256 256"},o.createElement("path",{d:"M132.025,162.943h40.246c0,0,3.219,56.879-31.303,79.599c-12.298,8.094,71.103-6.708,75.574-79.599h35.775l-60.146-74.681 L132.025,162.943z"}),o.createElement("path",{d:"M123.975,93.056H83.729c0,0-3.219-56.879,31.303-79.599c12.298-8.094-71.103,6.708-75.574,79.599H3.682l60.146,74.681 L123.975,93.056z"}))}function Q(){return o.createElement("svg",{version:"1.1",id:"Layer_1",xmlns:"http://www.w3.org/2000/svg",className:"SVGIcon_Button SVGIcon_Trash",x:"0px",y:"0px",width:"256px",height:"256px",viewBox:"0 0 256 256"},o.createElement("g",{className:"base"},o.createElement("path",{fill:"none",stroke:"#ffffff",strokeWidth:"10",strokeLinecap:"round",strokeLinejoin:"round",d:"M216.773,43.909 l-7.399,177.589c-0.37,8.893-7.919,16.1-16.812,16.1H63.437c-8.914,0-16.442-7.24-16.812-16.1L39.226,43.909"})),o.createElement("g",{className:"lines"},o.createElement("path",{className:"line1",fill:"none",stroke:"#ffffff",strokeWidth:"10",strokeLinecap:"round",strokeLinejoin:"round",d:"M128,68.12v137.197"}),o.createElement("path",{className:"line2",fill:"none",stroke:"#ffffff",strokeWidth:"10",strokeLinecap:"round",strokeLinejoin:"round",d:"M83.613,68.12 l4.035,137.197"}),o.createElement("path",{className:"line3",fill:"none",stroke:"#ffffff",strokeWidth:"10",strokeLinecap:"round",strokeLinejoin:"round",d:"M172.387,68.12 l-4.035,137.197"})),o.createElement("g",{className:"lid"},o.createElement("path",{fill:"none",stroke:"#ffffff",strokeWidth:"10",strokeLinecap:"round",strokeLinejoin:"round",d:"M27.121,38.577H228.88"}),o.createElement("path",{fill:"none",stroke:"#ffffff",strokeWidth:"10",d:"M87.648,38.577l4.319-10.796c2.072-5.181,8.292-9.379,13.84-9.379h44.386 c5.572,0,11.761,4.18,13.841,9.379l4.319,10.796"})))}function Z(){return o.createElement("svg",{version:"1.1",id:"Layer_1",xmlns:"http://www.w3.org/2000/svg",className:"SVGIcon_Button SVGIcon_Scroll",x:"0px",y:"0px",width:"256px",height:"256px",viewBox:"0 0 256 256"},o.createElement("g",{transform:"translate(0,-952.36215)"},o.createElement("path",{d:"M49.624,963.362c-20.72,0-37.667,14.78-37.667,32.806c0,3.589,3.353,6.499,7.486,6.499l52.407-0.305v162.5 c0,18.134,17.404,32.5,38.018,32.5h96.508c20.612,0,37.667-14.475,37.667-32.5c0-3.59-3.354-6.499-7.486-6.5H217.84V996.168 c0-18.024-16.947-32.806-37.667-32.806H49.624z M49.624,976.362h2.223c0.569,0.162,1.158,0.265,1.754,0.306 c8.159,1.274,14.426,6.085,16.962,12.694l-42.112,0.306C31.513,981.897,39.656,976.362,49.624,976.362z M79.337,976.362h100.836 c12.587,0,22.694,8.77,22.694,19.806v162.194H139.23c-4.135,0.001-7.486,2.91-7.488,6.5c0,4.609-1.43,7.796-4.21,10.765 c-2.78,2.972-7.203,5.757-13.686,7.923c-0.624,0.201-1.214,0.476-1.755,0.813h-2.223c-12.695,0-23.044-8.573-23.044-19.5v-169 C86.824,988.529,84.023,981.812,79.337,976.362z M108.582,1005.611c-4.135,0.169-7.33,3.216-7.135,6.807 c0.193,3.59,3.702,6.363,7.837,6.194h71.123c4.135,0.051,7.535-2.817,7.592-6.407c0.059-3.591-3.246-6.542-7.381-6.594 c-0.069,0-0.141,0-0.211,0h-71.123C109.05,1005.603,108.816,1005.603,108.582,1005.611z M108.582,1044.612 c-4.135,0.169-7.33,3.215-7.135,6.807c0.193,3.588,3.702,6.362,7.837,6.192h71.123c4.135,0.051,7.535-2.816,7.592-6.407 c0.059-3.59-3.246-6.542-7.381-6.592c-0.069,0-0.141,0-0.211,0h-71.123C109.05,1044.603,108.816,1044.603,108.582,1044.612z M108.582,1083.612c-4.135,0.169-7.33,3.216-7.135,6.806c0.193,3.589,3.702,6.363,7.837,6.193h71.123 c4.135,0.052,7.535-2.816,7.592-6.407c0.059-3.59-3.246-6.541-7.381-6.592c-0.069-0.001-0.141-0.001-0.211,0h-71.123 C109.05,1083.602,108.816,1083.602,108.582,1083.612z M108.582,1122.611c-4.135,0.17-7.33,3.216-7.135,6.806 c0.193,3.591,3.702,6.364,7.837,6.195h71.123c4.135,0.05,7.535-2.818,7.592-6.408c0.059-3.591-3.246-6.541-7.381-6.593 c-0.069,0-0.141,0-0.211,0h-71.123C109.05,1122.602,108.816,1122.602,108.582,1122.611z M145.547,1171.363h82.002 c-3.09,7.604-11.189,12.999-21.173,12.999h-67.849c0.196-0.197,0.512-0.306,0.703-0.509 C142.576,1180.277,144.436,1175.973,145.547,1171.363z"})))}function $(e){return o.createElement("svg",{transform:"rotate("+e.angle+")",version:"1.1",id:"base",xmlns:"http://www.w3.org/2000/svg",className:"SVGIcon_Button SVGIcon_FlatArrow",x:"0px",y:"0px",width:"256px",height:"256px",viewBox:"0 0 256 256"},o.createElement("polygon",{points:"13.913,141 128,59 242.087,141 ",fill:"#ffffff"}))}function ee(e){return o.createElement("svg",{version:"1.1",xmlns:"http://www.w3.org/2000/svg",className:"SVGIcon_Button SVGIcon_FriendIcon"+(e.bPending?" SVGIcon_FriendIcon_Pending":""),x:"0px",y:"0px",width:"256px",height:"256px",viewBox:"0 0 256 256"},o.createElement("g",{className:"outline"},o.createElement("g",{transform:"matrix(1.34048,0,0,1.34048,-10.0942,-5.50445)"},o.createElement("path",{d:"M102.239,90.394c-22.556,0-40.906-18.351-40.906-40.906c0-22.556,18.35-40.906,40.906-40.906s40.906,18.35,40.906,40.906 C143.145,72.043,124.795,90.394,102.239,90.394z"})),o.createElement("path",{d:"M127.453,250.212c-30.208,0-52.086-4.188-65.028-12.45c-12.507-7.983-13.141-17.484-13.141-19.308v-41.781 c0-20.554,5.356-38.104,15.489-50.754c11.63-14.519,29.216-22.193,50.858-22.194h23.646c21.643,0,39.229,7.674,50.858,22.193 c10.133,12.65,15.488,30.201,15.488,50.754v41.751c0.011,2.202-0.586,8.058-6.43,14.175 c-11.164,11.687-35.301,17.613-71.732,17.613C127.458,250.212,127.458,250.212,127.453,250.212z"}),o.createElement("path",{className:"WavingArm",opacity:e.bPending?"1":"0",d:"M87.625,170.102c-5.877,0-14.85-1.804-24.219-10.4c-8.677-7.961-20.959-20.438-30.563-31.048 c-18.766-20.732-21.125-26.658-19.522-32.832c1.463-5.64,10.288-27.077,26.729-28.926c0.429-0.048,0.867-0.072,1.303-0.072 c7.609,0,14.543,6.335,38.063,31.516c7.141,7.645,14.524,15.549,18.002,18.33l0.803,0.641c5.551,4.432,11.291,9.015,15.104,14.136 c8.477,11.383,3.634,20.705,1.158,24.185C108.034,164.692,97.995,170.102,87.625,170.102z"})),o.createElement("g",{className:"foreground"},o.createElement("g",{transform:"matrix(1.34048,0,0,1.34048,-10.0942,-5.50445)"},o.createElement("circle",{fill:"#FFFFFF",cx:"102.239",cy:"49.488",r:"33.446"})),o.createElement("path",{fill:"#FFFFFF",d:"M195.624,218.454v-41.781c0-34.743-16.666-62.948-56.347-62.948h-11.822h-0.997h-10.826 c-39.68,0.001-56.348,28.205-56.348,62.948v41.781c0,0,0,21.758,68.169,21.758C196.62,240.214,195.624,218.454,195.624,218.454z"}),o.createElement("path",{className:"WavingArm",opacity:e.bPending?"1":"0",d:"M41.167,76.833c6.53-0.734,39.348,39.127,50.007,47.647c10.659,8.52,21.327,16.686,15.16,25.353 s-20.646,16.74-36.167,2.5 s-48.516-48.801-47.167-54S31.599,77.909,41.167,76.833z"})))}function te(){return o.createElement("svg",{version:"1.1",id:"Layer_1",xmlns:"http://www.w3.org/2000/svg",className:"SVGIcon_Button SVGIcon_DoNotDisturb",x:"0px",y:"0px",width:"256px",height:"256px",viewBox:"0 0 256 256"},o.createElement("circle",{fill:"none",stroke:"#ffffff",strokeWidth:"24",strokeMiterlimit:"10",cx:"128",cy:"128",r:"101.5"}),o.createElement("line",{fill:"none",stroke:"#ffffff",strokeWidth:"24",strokeMiterlimit:"10",x1:"73",y1:"128",x2:"183",y2:"128"}))}function ne(e){return o.createElement("svg",{version:"1.1",id:"Layer_1",xmlns:"http://www.w3.org/2000/svg",transform:e.bFlipHorizontal?"scale(-1 1)":"scale(1 1)",className:"SVGIcon_Button SVGIcon_MediaControls",x:"0px",y:"0px",width:"256px",height:"256px",viewBox:"0 0 256 256"},o.createElement("path",{className:"Arrow",d:"M77.003,54.763h32.784c3.794,0,9.113,2.181,11.814,4.848l63.604,62.773c2.703,2.667,2.727,7.054,0.05,9.748 l-63.705,64.206c-2.674,2.693-7.968,4.898-11.763,4.898H77.003"}),o.createElement("polyline",{className:"preArrowBox",opacity:e.bHidePreArrow?"0":"1",points:"6.833,54.763 46.71,54.763 46.71,201.236 6.833,201.236 \t"}),o.createElement("polyline",{className:"jumpAheadBox",opacity:e.bShowJumpAheadBox?"1":"0",points:"6.833,54.764 86.386,54.764 86.386,201.236 6.833,201.236 \t"}),o.createElement("polyline",{className:"postArrowBox",opacity:e.bHidePostArrow?"0":"1",points:"209.29,54.763 249.167,54.763 249.167,201.236 209.29,201.236 \t"}))}function oe(){return o.createElement("svg",{version:"1.1",id:"Layer_1",xmlns:"http://www.w3.org/2000/svg",className:"SVGIcon_SteamTV",x:"0px",y:"0px",width:"1024px",height:"256px",viewBox:"0 0 1024 256"},o.createElement("defs",null,o.createElement("linearGradient",{id:"gradient",x1:"0%",y1:"0%",x2:"100%",y2:"0%"},o.createElement("stop",{offset:"0%",stopColor:"rgb(55, 102, 251)"}),o.createElement("stop",{offset:"100%",stopColor:"rgb(91, 106, 219)"})),o.createElement("linearGradient",{id:"gradientText",x1:"0%",y1:"0%",x2:"100%",y2:"0%"},o.createElement("stop",{offset:"0%",stopColor:"rgb(91, 106, 219)"}),o.createElement("stop",{offset:"100%",stopColor:"rgb(125, 110, 188)"}))),o.createElement("circle",{className:"logoBG",opacity:"0",fill:"#000000",cx:"156.586",cy:"128",r:"125.914"}),o.createElement("g",{id:"logo"},o.createElement("path",{fill:"url(#gradient)",d:"M156.374,5.355c-64.404,0-117.167,49.661-122.18,112.77l65.712,27.171 c5.567-3.808,12.293-6.032,19.53-6.032c0.649,0,1.294,0.016,1.934,0.051l29.226-42.355c0-0.202-0.005-0.399-0.005-0.598 c0-25.496,20.74-46.241,46.237-46.241c25.498,0,46.239,20.745,46.239,46.241c0,25.494-20.741,46.241-46.239,46.241 c-0.352,0-0.698-0.01-1.047-0.021l-41.68,29.741c0.022,0.546,0.041,1.095,0.041,1.644c0,19.14-15.569,34.707-34.706,34.707 c-16.796,0-30.843-11.991-34.026-27.87l-46.993-19.429c14.55,51.464,61.831,89.19,117.957,89.19 c67.713,0,122.605-54.893,122.605-122.604C278.978,60.244,224.086,5.355,156.374,5.355"}),o.createElement("path",{fill:"rgb(67, 104, 241)",d:"M111.026,191.387l-15.061-6.22c2.67,5.56,7.285,10.208,13.418,12.767 c13.25,5.521,28.531-0.771,34.054-14.028c2.674-6.416,2.694-13.5,0.04-19.929c-2.646-6.431-7.64-11.451-14.063-14.129 c-6.371-2.648-13.196-2.552-19.198-0.291l15.561,6.436c9.776,4.074,14.396,15.299,10.324,25.072 C132.031,190.841,120.801,195.464,111.026,191.387"}),o.createElement("path",{fill:"rgb(79, 105, 230)",d:"M227.639,96.359c0-16.987-13.82-30.809-30.809-30.809c-16.987,0-30.812,13.821-30.812,30.809 c0,16.988,13.824,30.806,30.812,30.806C213.818,127.165,227.639,113.347,227.639,96.359 M173.736,96.306 c0-12.783,10.364-23.142,23.145-23.142c12.783,0,23.145,10.359,23.145,23.142c0,12.783-10.361,23.142-23.145,23.142 C184.1,119.447,173.736,109.089,173.736,96.306"})),o.createElement("g",{id:"steam"},o.createElement("path",{fill:"rgb(92, 106, 218)",d:"M404.52,91.9l-7.968,14.006c-6.138-4.287-14.455-6.862-21.717-6.862c-8.299,0-13.437,3.43-13.437,9.586 c0,7.473,9.124,9.212,22.682,14.082c14.574,5.149,22.948,11.21,22.948,24.558c0,18.264-14.359,28.519-34.998,28.519 c-10.063,0-22.195-2.595-31.53-8.265l5.815-15.539c7.579,4.008,16.644,6.381,24.722,6.381c10.897,0,16.071-4.021,16.071-9.96 c0-6.802-7.893-8.843-20.641-13.06c-14.521-4.856-24.586-11.213-24.586-25.992c0-16.658,13.34-26.225,32.538-26.225 C387.797,83.128,398.551,87.367,404.52,91.9"}),o.createElement("polygon",{fill:"rgb(99, 107, 211)",points:"468.163,100.753 468.163,174.252 449.402,174.252 449.402,100.753 422.166,100.753 422.166,84.663 495.315,84.663 495.315,100.753 \t"}),o.createElement("polygon",{fill:"rgb(108, 108, 203)",points:"533.512,100.706 533.512,120.896 569.417,120.896 569.417,136.982 533.512,136.982 533.512,158.014 575.173,158.014 575.173,174.253 514.757,174.253 514.757,84.665 575.173,84.665 575.173,100.706"}),o.createElement("path",{fill:"rgb(117, 109, 195)",d:"M617.054,156.857l-5.932,17.396h-19.67l33.593-89.594h18.888l34.539,89.594h-20.336l-6.061-17.396H617.054z M634.378,106.035l-12.23,35.87h24.723L634.378,106.035z"}),o.createElement("polygon",{fill:"rgb(125, 110, 188)",points:"773.403,119.291 748.888,171.645 738.302,171.645 714.182,119.758 714.182,174.253 696.212,174.253 696.212,84.665 714.138,84.665 744.251,149.33 773.285,84.665 791.374,84.665 791.374,174.253 773.406,174.253"})),o.createElement("g",{id:"tv"},o.createElement("polygon",{fill:"rgb(125, 110, 188)",points:"853.961,92.664 823.506,92.664 823.506,84.147 893.835,84.147 893.835,92.664 863.51,92.664 863.51,174.479 853.961,174.479"}),o.createElement("polygon",{fill:"rgb(125, 110, 188)",points:"909.835,84.147 920.286,84.147 950.612,165.831 980.033,84.147 990.487,84.147 956.421,174.479 944.159,174.479"})))}function ie(){return o.createElement("svg",{version:"1.1",id:"Layer_1",xmlns:"http://www.w3.org/2000/svg",className:"SVGIcon_Button SVGIcon_Viewers",x:"0px",y:"0px",width:"256px",height:"256px",viewBox:"0 0 256 256"},o.createElement("path",{className:"frontGuy",fill:"#666666",d:"M181.732,53.151c-17.255,0-31.321,13.316-31.321,32.634v25.132 c0,18.005,24.006,21.006,24.382,21.381c-10.691,2.813-30.947,8.252-40.888,15.566c-8.252,6.003-11.44,18.005-13.128,22.882 c-0.75,2.063-1.688,5.064-1.688,7.127c0,0,0,9.94,0,19.881s12.941,16.505,18.005,16.505h89.65c4.877,0,18.006-5.627,18.006-16.505 s0-19.881,0-19.881c0-2.251-0.938-5.627-1.688-7.689c-4.313-10.878-4.688-16.316-13.315-22.319 c-9.941-6.939-30.009-12.19-40.512-15.004c0.374-0.563,24.193-4.127,24.193-22.131V85.785 C213.053,66.467,198.986,53.151,181.732,53.151L181.732,53.151z"}),o.createElement("path",{className:"backGuy",fill:"rgb(144, 153, 161)",d:"M84.204,34.396c-20.068,0-36.385,15.38-36.385,38.074v29.258c0,20.818,27.945,24.382,28.32,24.944 c-12.378,3.189-36.01,9.565-47.638,18.006c-9.753,7.127-13.504,21.006-15.379,26.632c-0.75,2.251-1.876,6.002-1.876,8.253  c0,0,0,11.44,0,23.257c0,11.815,15.004,19.13,20.819,19.13h104.279c5.814,0,20.818-6.564,20.818-19.13c0-12.566,0-23.257,0-23.257 c0-2.438-1.125-6.564-2.063-8.815c-5.063-12.566-5.438-18.942-15.566-26.069c-11.628-8.065-34.885-14.067-47.076-17.443 c0.375-0.563,28.133-4.876,28.133-25.695V72.469C120.59,49.775,104.272,34.396,84.204,34.396L84.204,34.396z"}))}function re(){return o.createElement("svg",{version:"1.1",id:"Layer_5",className:"SVGIcon_Button SVGIcon_Globe",xmlns:"http://www.w3.org/2000/svg",x:"0px",y:"0px",viewBox:"0 0 64 64"},o.createElement("g",null,o.createElement("path",{d:"M32.5,5C17.9,5,6,16.9,6,31.5C6,46.1,17.9,58,32.5,58S59,46.1,59,31.5C59,16.9,47.1,5,32.5,5 M32.5,54.7c-1.2,0-2.5-0.1-3.7-0.3c-1.1-1.1-2.1-2.8-3-4.8c-0.8-1.8-1.4-3.8-2-6c2.7-0.3,5.6-0.5,8.6-0.5c3,0,5.9,0.2,8.6,0.5c-0.5,2.2-1.2,4.2-2,6c-0.9,2-1.9,3.7-3,4.8C35,54.6,33.7,54.7,32.5,54.7 M32.5,41.4c-3.2,0-6.2,0.2-9,0.5c-0.6-3-0.9-6.2-1-9.6h19.9c0,3.4-0.4,6.6-1,9.6C38.7,41.6,35.7,41.4,32.5,41.4 M32.5,8.3c1.2,0,2.5,0.1,3.7,0.3c1.1,1.1,2.1,2.8,3,4.8c0.8,1.8,1.4,3.8,2,6c-2.7,0.3-5.6,0.5-8.6,0.5c-3,0-5.9-0.2-8.6-0.5c0.5-2.2,1.2-4.2,2-6c0.9-2,1.9-3.7,3-4.8C30,8.4,31.3,8.3,32.5,8.3 M32.5,21.6c3.2,0,6.2-0.2,9-0.5c0.6,3,0.9,6.2,1,9.6H22.6c0-3.4,0.4-6.6,1-9.6C26.3,21.4,29.3,21.6,32.5,21.6 M44.1,30.7c0-3.5-0.4-6.8-1-9.8c3.4-0.5,6.4-1.1,8.8-2c2.3,3.5,3.6,7.5,3.7,11.8H44.1z M20.9,30.7H9.3c0.1-4.2,1.4-8.3,3.7-11.8c2.5,0.8,5.5,1.5,8.8,2C21.3,23.9,21,27.2,20.9,30.7 M20.9,32.3c0,3.5,0.4,6.8,1,9.8c-3.4,0.5-6.4,1.1-8.8,2c-2.3-3.5-3.6-7.5-3.7-11.8H20.9z M44.1,32.3h11.6c-0.1,4.2-1.4,8.3-3.7,11.8c-2.5-0.8-5.5-1.5-8.8-2C43.7,39.1,44,35.8,44.1,32.3 M51,17.5c-0.1,0-0.2,0.1-0.3,0.1c-2.3,0.7-5,1.3-7.9,1.7c-0.9-4.1-2.3-7.6-4-10.1c3.8,1.1,7.3,3.1,10.2,5.9C49.6,15.9,50.3,16.6,51,17.5 M26.3,9.2c-1.7,2.5-3.1,6-4,10.1c-2.9-0.4-5.6-1-7.9-1.7c-0.1,0-0.2-0.1-0.3-0.1c0.6-0.8,1.3-1.6,2.1-2.4C19,12.2,22.5,10.2,26.3,9.2 M14,45.5c0.1,0,0.2-0.1,0.3-0.1c2.3-0.7,5-1.3,7.9-1.7c0.9,4.1,2.3,7.6,4,10.1c-3.8-1.1-7.3-3.1-10.2-5.9C15.4,47.1,14.7,46.4,14,45.5 M38.7,53.8c1.7-2.5,3.1-6,4-10.1c2.9,0.4,5.6,1,7.9,1.7c0.1,0,0.2,0.1,0.3,0.1c-0.6,0.8-1.3,1.6-2.1,2.4C46,50.8,42.5,52.8,38.7,53.8"})))}function ae(){return o.createElement("svg",{version:"1.1",xmlns:"http://www.w3.org/2000/svg",className:"SVGIcon_Button SVGIcon_STVTimelineGrabber",x:"0px",y:"0px",width:"256px",height:"256px",viewBox:"0 0 256 256"},o.createElement("g",{className:"leftarrow",opacity:"0"},o.createElement("polygon",{points:"127.817,4.403 4,128 127.817,251.598"})),o.createElement("g",{className:"rightarrow",opacity:"0"},o.createElement("polygon",{points:"127.816,4.403 251.633,128 127.816,251.598"})),o.createElement("g",{className:"grabber"},o.createElement("polygon",{points:"145.692,22.132 145.692,234.361 127.817,251.598 110.307,234.361 110.307,22.132 127.817,4.403"})))}function se(){return o.createElement("svg",{version:"1.1",id:"Layer_1",xmlns:"http://www.w3.org/2000/svg",className:"SVGIcon_Button SVGIcon_STVTimelineMarker",x:"0px",y:"0px",width:"256px",height:"256px",viewBox:"0 0 256 256"},o.createElement("polygon",{className:"pointer",points:"128,154.979 46.374,230.548 46.374,253.333 209.626,253.333 209.626,230.548 \t"}),o.createElement("rect",{className:"line",x:"116.271",y:"3.168",width:"23.459",height:"137.332"}))}function ce(e){return o.createElement("svg",{version:"1.1",xmlns:"http://www.w3.org/2000/svg",className:"SVGIcon_Button SVGIcon_HideShowChat",x:"0px",y:"0px",width:"256px",height:"256px",viewBox:"0 0 256 256"},o.createElement("g",{id:"hidechat",opacity:e.showChat?"0":"1"},">",o.createElement("polyline",{fill:"none",stroke:"#ffffff",strokeWidth:"10",strokeLinecap:"round",strokeMiterlimit:"10",points:"156.001,189.834 116.375,189.834 67.31,222.538 67.31,189.834 39.834,189.834 39.834,59.011 59.25,59.011"}),o.createElement("polyline",{fill:"none",stroke:"#ffffff",strokeWidth:"10",strokeLinecap:"round",strokeMiterlimit:"10",points:"109.427,59.011 225.299,59.011 225.299,189.834 207,189.834"}),o.createElement("line",{fill:"none",stroke:"#ffffff",strokeWidth:"10",strokeLinecap:"round",strokeMiterlimit:"10",x1:"49.786",y1:"15.012",x2:"214.409",y2:"233.723"})),o.createElement("g",{id:"showchat",opacity:e.showChat?"1":"0"},o.createElement("polygon",{fill:"none",stroke:"#ffffff",strokeWidth:"10",strokeLinecap:"round",strokeMiterlimit:"10",points:"116.375,189.834 67.31,222.538 67.31,189.834 39.834,189.834 39.834,59.011 225.299,59.011 225.299,189.834"})),o.createElement("g",{id:"textlines",opacity:e.showChat?"1":"0"},o.createElement("line",{fill:"none",stroke:"#ffffff",strokeWidth:"10",strokeMiterlimit:"10",x1:"72.333",y1:"124.75",x2:"194.167",y2:"124.75"}),o.createElement("line",{fill:"none",stroke:"#ffffff",strokeWidth:"10",strokeMiterlimit:"10",x1:"72.333",y1:"155.75",x2:"194.167",y2:"155.75"}),o.createElement("line",{fill:"none",stroke:"#ffffff",strokeWidth:"10",strokeMiterlimit:"10",x1:"72.333",y1:"93.75",x2:"179.926",y2:"93.75"}),o.createElement("polyline",{fill:"none",stroke:"#ffffff",strokeWidth:"10",strokeLinecap:"round",strokeMiterlimit:"10",points:"156.001,189.834 116.375,189.834 67.31,222.538 67.31,189.834 39.834,189.834 39.834,59.011 59.25,59.011 "}),o.createElement("polyline",{fill:"none",stroke:"#ffffff",strokeWidth:"10",strokeLinecap:"round",strokeMiterlimit:"10",points:"109.427,59.011 225.299,59.011 225.299,189.834 207,189.834"})))}function le(){return o.createElement("svg",{version:"1.1",id:"Layer_1",xmlns:"http://www.w3.org/2000/svg",className:"SVGIcon_Button SVGIcon_ShowBothChats",x:"0px",y:"0px",width:"256px",height:"256px",viewBox:"0 0 256 256"},o.createElement("circle",{opacity:"0",fill:"#FFFFFF",strokeWidth:"0",cx:"166.241",cy:"161.906",r:"75.259"}),o.createElement("polyline",{fill:"none",stroke:"#ffffff",strokeWidth:"8",strokeLinecap:"round",strokeMiterlimit:"10",points:"92.367,155.634 51.311,183 51.311,150.296 23.834,150.296 23.834,19.473 140.5,19.473 140.5,91.5"}),o.createElement("line",{fill:"none",stroke:"#ffffff",strokeWidth:"8",strokeMiterlimit:"10",x1:"48.529",y1:"82.167",x2:"113.379",y2:"82.167"}),o.createElement("line",{fill:"none",stroke:"#ffffff",strokeWidth:"8",strokeMiterlimit:"10",x1:"48.529",y1:"113.167",x2:"113.379",y2:"113.167"}),o.createElement("line",{fill:"none",stroke:"#ffffff",strokeWidth:"8",strokeMiterlimit:"10",x1:"48.529",y1:"51.167",x2:"99.138",y2:"51.167"}),o.createElement("path",{d:"M166.241,82.167c-43.933,0-79.74,35.807-79.74,79.74c0,43.932,35.808,79.739,79.74,79.739 c43.932,0,79.739-35.808,79.739-79.739C245.98,117.975,210.173,82.167,166.241,82.167 M166.241,231.717 c-3.611,0-7.522-0.301-11.134-0.902c-3.31-3.311-6.318-8.426-9.027-14.444c-2.407-5.416-4.212-11.434-6.018-18.054  8.124-0.902,16.851-1.505,25.878-1.505c9.026,0,17.753,0.603,25.877,1.505c-1.504,6.62-3.61,12.638-6.018,18.054 c-2.708,6.019-5.718,11.134-9.027,14.444C173.764,231.416,169.852,231.717,166.241,231.717 M166.241,191.696 c-9.629,0-18.656,0.602-27.082,1.505c-1.805-9.027-2.708-18.656-3.009-28.887h59.88c0,10.23-1.203,19.859-3.009,28.887 C184.896,192.298,175.87,191.696,166.241,191.696 M166.241,92.097c3.61,0,7.522,0.301,11.133,0.903 c3.311,3.31,6.319,8.425,9.027,14.443c2.407,5.416,4.213,11.435,6.019,18.055c-8.125,0.902-16.851,1.504-25.878,1.504  s-17.753-0.602-25.878-1.504c1.505-6.62,3.611-12.639,6.019-18.055c2.708-6.018,5.717-11.133,9.026-14.443 \tC158.719,92.398,162.63,92.097,166.241,92.097 M166.241,132.117c9.629,0,18.655-0.602,27.081-1.504 \tc1.806,9.026,2.708,18.655,3.009,28.887h-59.88c0-10.231,1.204-19.86,3.01-28.887 \tC147.585,131.516,156.612,132.117,166.241,132.117 M201.146,159.5c0-10.532-1.203-20.462-3.009-29.488 c10.23-1.505,19.258-3.311,26.479-6.019c6.921,10.531,10.833,22.567,11.134,35.507H201.146z M131.336,159.5H96.432 c0.301-12.639,4.212-24.976,11.133-35.507c7.522,2.407,16.55,4.514,26.479,6.019C132.54,139.038,131.637,148.968,131.336,159.5 M131.336,164.314c0,10.531,1.204,20.461,3.01,29.488c-10.231,1.505-19.259,3.31-26.48,6.018 c-6.921-10.531-10.832-22.567-11.133-35.506H131.336z M201.146,164.314h34.905c-0.301,12.638-4.213,24.975-11.134,35.506 c-7.522-2.406-16.55-4.513-26.479-6.018C199.942,184.775,200.845,174.846,201.146,164.314 M221.908,119.78 c-0.301,0-0.602,0.301-0.903,0.301c-6.92,2.106-15.045,3.912-23.771,5.115c-2.708-12.337-6.921-22.868-12.036-30.391 c11.434,3.31,21.966,9.328,30.691,17.753C217.695,114.966,219.802,117.072,221.908,119.78 M147.585,94.806 c-5.115,7.522-9.328,18.054-12.036,30.391c-8.727-1.203-16.851-3.009-23.771-5.115c-0.301,0-0.602-0.301-0.902-0.301 c1.805-2.407,3.911-4.814,6.318-7.222C125.619,103.833,136.15,97.814,147.585,94.806 M110.574,204.033 c0.301,0,0.602-0.301,0.902-0.301c6.921-2.106,15.045-3.912,23.771-5.115c2.708,12.337,6.921,22.869,12.036,30.392 c-11.435-3.311-21.966-9.328-30.692-17.754C114.786,208.848,112.68,206.742,110.574,204.033 M184.896,229.009 c5.116-7.522,9.329-18.055,12.036-30.392c8.727,1.203,16.852,3.009,23.771,5.115c0.301,0,0.603,0.301,0.903,0.301 c-1.806,2.407-3.912,4.814-6.319,7.222C206.863,219.981,196.331,226,184.896,229.009"}))}function pe(){return o.createElement("svg",{version:"1.1",id:"Layer_2",xmlns:"http://www.w3.org/2000/svg",className:"SVGIcon_Button SVGIcon_BigPicture",x:"0px",y:"0px",width:"256px",height:"256px",viewBox:"0 0 256 256"},o.createElement("path",{fill:"#ffffff",d:"M213.771,68.659c-4.108-7.066-46.007-7.231-49.293-7.231H128H91.522c-3.286,0-45.186,0.165-49.293,7.231 c-19.555,29.248-27.385,100.263-27.276,104.01c0.238,8.294,2.11,24.583,16.595,35.162c9.201,6.72,22.183,8.709,29.083,3.614 c4.989-3.682,11.995-19.224,19.061-32.204c7.064-12.981,9.202-11.174,12.98-12.159c3.78-0.986,36.066-0.74,36.066-0.74 s30.809-0.247,34.588,0.74c3.777,0.985,5.915-0.822,12.98,12.159c7.064,12.98,14.07,28.522,19.061,32.204 c6.9,5.095,19.882,3.106,29.083-3.614c14.485-10.58,16.356-26.868,16.595-35.162C241.154,168.922,233.325,97.906,213.771,68.659z M67.251,128.14c-14.974,0-27.112-12.137-27.112-27.111c0-14.975,12.137-27.112,27.112-27.112 c14.973,0,27.111,12.137,27.111,27.112C94.362,116.003,82.224,128.14,67.251,128.14z M188.749,128.14 c-14.974,0-27.111-12.137-27.111-27.111c0-14.975,12.138-27.112,27.111-27.112c14.973,0,27.111,12.137,27.111,27.112 C215.86,116.003,203.722,128.14,188.749,128.14z"}))}function ue(){return o.createElement("svg",{version:"1.1",id:"Layer_2",xmlns:"http://www.w3.org/2000/svg",className:"SVGIcon_Button SVGIcon_MobilePhone",x:"0px",y:"0px",width:"256px",height:"256px",viewBox:"0 0 256 256"},o.createElement("path",{d:"M165.693,45.186H91.368c-7.963,0-14.41,6.447-14.41,14.41V210.9c0,7.964,6.447,14.41,14.41,14.41h74.134 c7.965,0,14.41-6.447,14.41-14.41V59.596C180.102,51.633,173.657,45.186,165.693,45.186z M113.172,57.509h30.717 c1.707,0,3.223,1.327,3.223,3.224c0,1.896-1.328,3.223-3.223,3.223h-30.717c-1.707,0-3.223-1.328-3.223-3.223 C109.949,58.837,111.465,57.509,113.172,57.509z M128.529,213.554c-4.551,0-8.152-3.603-8.152-8.153c0-4.55,3.604-8.152,8.152-8.152 s8.151,3.603,8.151,8.152C136.682,209.761,133.081,213.554,128.529,213.554z M169.105,186.819h-81.15V74.384h81.15V186.819 L169.105,186.819z"}))}function me(){return o.createElement("svg",{version:"1.1",id:"Layer_2",xmlns:"http://www.w3.org/2000/svg",className:"SVGIcon_Button SVGIcon_VR",x:"0px",y:"0px",width:"256px",height:"256px",viewBox:"0 0 256 256"},o.createElement("path",{d:"M224.389,62.411H31.613c-10.147,0-18.36,8.214-18.36,18.36v94.453c0,10.147,8.215,18.359,18.36,18.359h192.775 c10.146,0.241,18.358-7.968,18.358-18.116V80.771C242.747,70.625,234.534,62.411,224.389,62.411z M92.317,175.026H71.646 L35.472,79.832h21.895l25.022,72.484l24.343-72.484h21.895L92.317,175.026z M195.264,175.026l-19.175-32.095h-2.176h-14.279 v32.095h-19.991V79.832h35.63c13.056,0,22.664,2.607,28.831,7.819c6.164,5.215,9.247,12.49,9.247,21.827 c0,7.343-1.61,13.463-4.828,18.359c-3.219,4.896-7.729,8.614-13.531,11.151l22.575,36.038H195.264z"}),o.createElement("path",{d:"M187.784,100.298c-2.812-2.312-7.391-3.468-13.735-3.468h-14.415v28.966h15.639c5.257,0,9.36-1.336,12.308-4.012 c2.945-2.673,4.42-6.368,4.42-11.083C192,106.078,190.593,102.61,187.784,100.298z"}))}function de(){return o.createElement("svg",{version:"1.1",id:"Layer_2",xmlns:"http://www.w3.org/2000/svg",className:"SVGIcon_Button SVGIcon_YouTube",x:"0px",y:"0px",width:"256px",height:"256px",viewBox:"0 0 256 256"},o.createElement("path",{d:"M243.402,70.101c-2.775-10.309-10.906-18.439-21.217-21.217c-18.838-5.152-94.185-5.152-94.185-5.152 s-75.348,0-94.185,4.957c-10.112,2.775-18.44,11.104-21.216,21.413C7.644,88.94,7.644,128,7.644,128s0,39.257,4.957,57.896 c2.775,10.313,10.905,18.439,21.216,21.219c19.036,5.154,94.185,5.154,94.185,5.154s75.347,0,94.185-4.957 c10.311-2.771,18.441-10.906,21.217-21.217c4.953-18.838,4.953-57.898,4.953-57.898S248.557,88.94,243.402,70.101z M104.008,164.088 V91.912L166.668,128L104.008,164.088z"}))}function he(){return o.createElement("svg",{version:"1.1",id:"Layer_2",xmlns:"http://www.w3.org/2000/svg",className:"SVGIcon_Button SVGIcon_CSGO",x:"0px",y:"0px",width:"256px",height:"256px",viewBox:"0 0 256 256"},o.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M236.979,138.059c0.548,0.078,6.91,0.101,7.772,0.032 c1.215-0.095,1.396,0.068,1.388,0.708c-0.01,0.397,0.012,3.039-2.365,7.32c-3.301,5.948-12.079,10.436-12.55,10.672 c-0.47,0.233-0.53,0.484-0.136,0.75c0.434,0.295,8.068,1.454,9.084,1.611c1.017,0.154,0.637,1.001,0.637,1.001 s-0.704,2.621-2.895,5.36c-2.189,2.738-9.311,6.123-8.583,6.123c0.731,0,7.187,0.159,6.181,1.422 c-3.019,3.786-13.603,9.528-18.43,13.813c-13.388,11.885-13.217,12.864-15.52,15.09c-0.983-3.298-3.02-12.658-3.02-12.658 l-6.105-11.467c4.413,0.18,6.364,0.081,8.952,0.081c9.214,0,17.525-2.185,22.234-5.841l2.371-1.843l-2.911-0.728 c-2.131-0.528-7.121-1.782-11.896-2.979c2.184-0.104,10.803-1.299,14.413-5.339c0.136-0.151,0.276-0.321,0.406-0.494l1.245-1.664 l-2.404-0.735c-2.607-0.799-5.948-1.682-8.517-2.335c3.173-1.572,7.585-3.942,10.048-6.088c4.83-4.203,7.226-9.709,7.322-9.943 l0.9-2.098l-10.772,0.318c1.503-1.483,3.218-3.197,3.939-3.991c1.43-1.571,4.053-6.221,4.198-9.896l0.072-1.787l-1.763,0.288 c-1.979,0.322-5.301,1.279-8.179,2.173c2.025-2.193,4.296-4.767,5.46-6.484c2.687-3.964,2.76-8.371,2.597-12.916l-0.104-2.881 l-2.261,1.79c-2.559,2.028-7.595,5.031-11.097,7.047c1.538-3.644,3.54-8.752,3.813-11.276c0.5-4.681-0.248-10.196-0.248-10.196 l-10.76,9.394c0.885-1.953,1.684-4.013,2.117-5.832c1.735-7.29,0.055-17.892-0.021-18.338l-0.452-2.807l-7.777,7.739 c0.722-3.535,1.465-8.253,1.23-11.789c-0.426-6.321-2.278-10.517-2.359-10.694l-1.01-2.251l-6.465,8.577 c0.231-4.285,0.27-10.24-0.948-13.547c-1.934-5.262-3.651-8.007-3.723-8.121l-1.232-1.958l-3.057,4.85 c0.018-2.967-0.11-6.475-0.69-8.68c-1.202-4.543-2.825-6.396-3.002-6.592l-1.325-1.433l-1.623,2.705 c-0.278-3.19-1.112-7.084-3.343-9.478l-0.814-0.872l-1.012,0.623c-0.327,0.201-0.714,0.497-1.104,0.823 c-0.154-1.135-0.365-2.451-0.639-3.691c0.563-4.733,1.186-10.03,1.206-10.452c0.027-0.547,0.274-0.767,1.017-0.391 c0.898,0.452,3.156,2.064,5.187,6.133c2.036,4.067,3.132,11.324,3.117,12.044c-0.009,0.383,0.291,0.757,0.438,0.151 c0.145-0.607,0.478-7.591,0.623-8.312c0.081-0.383,0.199-0.484,0.737-0.212c0.496,0.249,2.959,2.181,4.899,6.463 c1.179,2.599,1.634,11.946,1.574,12.653c-0.106,1.278,0.313,0.891,0.339,0.883c-0.009,0.013-0.025,0.04-0.03,0.049 c0.03-0.041,0.036-0.049,0.03-0.049c0.573-0.841,4.21-8.99,4.519-9.377c0.313-0.39,0.521-0.395,0.835,0.002 c0.262,0.33,2.095,1.717,4.049,10.088c1.902,8.135,1.949,11.542,1.848,12.682c-0.08,0.86,0.339,0.993,0.731,0.524 c0.389-0.47,5.104-9.201,5.497-9.515c0.389-0.313,0.613-0.309,0.927,0.161c0.312,0.469,2.718,4.762,3.684,11.448 c0.861,5.947,0.608,13.599,0.375,14.381c-0.235,0.782-0.135,1.077,0.493,0.53c0.623-0.548,10.299-8.412,11.004-9.038 c0.703-0.627,1.18-0.65,1.34-0.046c0.172,0.654,0.822,8.654,0.275,15.225c-0.549,6.571-2.626,12.752-2.94,13.145 c-0.312,0.391,0.087,0.712,0.478,0.555c0.394-0.157,11.902-10.018,12.645-10.402c0.711-0.367,1.043,0.005,1.105,0.507 c0.068,0.544,0.966,3.098-0.419,11.269c-0.959,5.65-3.54,11.876-3.855,12.033c-0.313,0.157-0.077,0.336,0.234,0.259 c0.315-0.079,8.324-3.488,8.872-3.567c0.546-0.079,0.671,0.339,0.514,0.808c-0.158,0.469-0.458,6.273-2.534,11.639 c-2.603,6.732-6.056,11.001-6.056,11.001s-0.252,0.519,0.217,0.519s9.266-0.186,9.813-0.263c0.547-0.079,0.627,0.156,0.547,0.704 c-0.077,0.547,0.858,9.116-8.624,14.601C236.524,137.734,236.432,137.979,236.979,138.059z M174.473,24.823 c1.981,3.34,2.018,9.248,1.836,11.469l-0.52,6.238l5.25-8.744c0.395,0.843,0.85,2.003,1.25,3.524 c1.02,3.877,0.422,13.082,0.417,13.173l-0.384,5.752l6.435-10.212c0.628,1.27,1.45,3.097,2.32,5.459 c1.466,3.983,0.772,13.806,0.381,17.257l-0.602,5.308l9.568-12.69c0.493,1.707,1.058,4.21,1.259,7.227 c0.39,5.821-2.272,15.731-2.299,15.83l-1.428,5.26l11.125-11.068c0.377,3.586,0.772,9.774-0.304,14.302 c-1.2,5.057-5.778,12.588-5.823,12.664l-1.806,3.992l16.878-14.09c-0.116,1.366-0.262,2.944-0.423,4.435 c-0.312,2.935-3.954,11.389-5.335,14.399l-1.827,4.002l3.856-2.115c0.381-0.208,8.027-4.41,12.979-7.778 c-0.039,3.484-0.537,6.042-2.139,8.4c-2.189,3.234-9.05,10.198-9.118,10.268l-4.352,4.408l5.861-2.004 c0.08-0.025,6.868-2.34,11.188-3.41c-0.675,2.445-2.208,5.125-3.11,6.118c-1.319,1.449-6.429,6.429-6.48,6.482l-2.682,2.614 l13.475-0.404c-1.06,1.837-2.89,4.549-5.457,6.783c-3.727,3.244-12.956,7.341-13.048,7.383l-3.952,1.746l4.201,1.008 c0.062,0.015,5.637,1.354,10.266,2.67c-3.412,2.191-9.291,3.081-10.948,3.138c-2.06,0.072-11.075,0.125-11.075,0.125l-11.51,0.069 l11.162,2.804c0,0,12.587,3.164,19.486,4.894c-4.398,2.216-10.717,3.493-17.657,3.493c-3.102,0-10.335-0.284-15.048-0.483 c4.064,6.069,7.041,11.004,7.992,13.681c2.813,7.915,6.777,28.269,6.889,48.907c0.039,6.572-1.081,11.649-9.022,11.649 c-0.288,0-0.597-0.038-0.908-0.092c-1.846,0.339-4.351,0.595-5.438-0.095c-1.805-1.149-3.163-2.627-3.544-3.957 c-0.383-1.334-1.146-9.374-3.106-20.675c-1.92-11.046-4.038-19.431-4.237-19.525c-1.535-0.731-9.358-18.45-9.358-18.45 l-37.23-47.615c0,0-20.737,23.917-37.455,47.8c-0.867,1.235-5.994,11.251-9.275,17.989c-0.212,0.437-0.181,0.475-0.281,0.808 c-0.604,2.015-2.396,9.525-4.039,18.994c-1.962,11.301-2.725,19.341-3.105,20.675c-0.384,1.33-1.74,2.808-3.546,3.957 c-1.085,0.689-3.592,0.434-5.437,0.095c-0.313,0.054-0.621,0.092-0.909,0.092c-7.941,0-9.061-5.077-9.024-11.649 c0.114-20.639,4.078-40.992,6.892-48.907c0.95-2.677,3.926-7.611,7.993-13.681c-4.714,0.199-11.946,0.483-15.051,0.483 c-6.939,0-13.26-1.277-17.653-3.493c6.896-1.729,19.486-4.894,19.486-4.894l11.159-2.804l-11.508-0.069 c0,0-9.019-0.053-11.076-0.125c-1.66-0.057-7.537-0.946-10.949-3.138c4.629-1.315,10.202-2.655,10.264-2.67l4.201-1.008l-3.95-1.746 c-0.094-0.042-9.324-4.139-13.049-7.383c-2.566-2.234-4.397-4.946-5.458-6.783l13.477,0.404l-2.684-2.614 c-0.05-0.054-5.16-5.033-6.48-6.482c-0.9-0.993-2.436-3.673-3.108-6.118c4.319,1.069,11.108,3.384,11.188,3.41l5.861,2.004 l-4.352-4.408c-0.069-0.069-6.928-7.033-9.12-10.268c-1.601-2.358-2.099-4.916-2.139-8.4c4.953,3.368,12.601,7.57,12.98,7.778 l3.858,2.115l-1.829-4.002c-1.379-3.011-5.022-11.465-5.334-14.399c-0.161-1.491-0.305-3.068-0.421-4.435l16.877,14.09l-1.806-3.992 c-0.046-0.076-4.622-7.607-5.821-12.664c-1.078-4.528-0.682-10.716-0.307-14.302L58.57,89.672l-1.426-5.26 c-0.025-0.098-2.688-10.008-2.3-15.83c0.203-3.017,0.767-5.52,1.26-7.227l9.566,12.69l-0.601-5.308 c-0.391-3.451-1.083-13.274,0.381-17.257c0.871-2.362,1.693-4.189,2.32-5.459l6.435,10.212l-0.382-5.752 c-0.006-0.091-0.604-9.295,0.416-13.173c0.401-1.521,0.854-2.681,1.251-3.524l5.249,8.744l-0.52-6.238 c-0.181-2.221-0.144-8.129,1.836-11.469c0.596,0.522,1.248,1.148,1.67,1.575l2.215,2.245l0.276-3.142 c0.162-1.838,0.783-7.003,1.703-8.813c1.342-2.635,4.69-3.91,7.104-4.505c-6.691,13.614-36.889,77.59-36.889,122.937 c0,23.658,16.206,23.931,16.368,23.931c4.881,0,6.947-7.914,6.947-11.063V133.45c0-2.744,1.148-2.744,1.835-2.744 c5.807,0,10.48,3.196,13.855,6.69c8.813-11.615,15.81-20.526,15.81-20.526s0.16-0.182,0.248-0.345 c-1.03-2.443-7.165-16.995-7.165-16.995l1.708-43.717c0,0-0.278-3.797,1.044-6.052c1.314-2.245,4.247-3.175,4.247-3.175 l13.307,41.443c0,0-4.107,0.866-4.107,5.585c0,2.982,2.658,4.99,6.227,5.013c3.572-0.022,6.227-2.031,6.227-5.013 c0-4.719-4.109-5.585-4.109-5.585l13.311-41.443c0,0,2.93,0.93,4.245,3.175c1.322,2.255,1.043,6.052,1.043,6.052l1.709,43.717 l-7.309,17.34c0,0,6.997,8.911,15.809,20.526c3.375-3.494,8.048-6.69,13.855-6.69c0.687,0,1.833,0,1.833,2.744v14.538 c0,3.148,2.068,11.063,6.95,11.063c0.159,0,16.367-0.272,16.367-23.931c0-45.347-30.197-109.322-36.888-122.937 c2.412,0.595,5.761,1.87,7.104,4.505c0.92,1.809,1.541,6.975,1.705,8.813l0.275,3.142l2.213-2.245 C173.226,25.972,173.875,25.345,174.473,24.823z M176.157,181.396c-1.644-2.189-41.07-55.856-41.07-55.856l-6.723,8.809 l-0.946-1.233l-0.829-1.082l-5.053-6.594l-0.095,0.101c0,0-39.427,53.667-41.07,55.856c-1.643,2.191-4.777,6.708-6.058,9.322 c-1.279,2.614-8.946,39.306-8.946,42.592c0,2.005,0.041,8.618,0.071,13.47c1.536,0.2,3.411,0.761,4.357,0.125 c1.624-1.093,2.363-2.323,2.491-3.372c0.128-1.048,1.367-12.969,2.69-20.812c1.779-10.547,4.571-19.005,4.415-18.97 c3.213-6.672,8.966-17.938,9.887-19.252c17.808-25.439,38.994-49.947,38.994-49.947s21.166,24.502,38.978,49.947 c0.921,1.313,6.672,12.58,9.888,19.252c-0.158-0.035,2.635,8.423,4.414,18.97c1.322,7.843,2.562,19.764,2.688,20.812 c0.131,1.049,0.87,2.279,2.493,3.372c0.944,0.636,2.818,0.075,4.355-0.125c0.032-4.852,0.073-11.465,0.073-13.47 c0-3.286-7.667-39.978-8.948-42.592C180.936,188.104,177.801,183.588,176.157,181.396z M82.538,21.517l-1.014-0.623l-0.813,0.872 c-2.231,2.394-3.063,6.287-3.342,9.478l-1.624-2.705l-1.323,1.433c-0.179,0.197-1.801,2.049-3.004,6.592 c-0.581,2.205-0.709,5.712-0.689,8.68l-3.057-4.85l-1.234,1.958c-0.072,0.114-1.787,2.859-3.722,8.121 c-1.22,3.307-1.179,9.262-0.949,13.547l-6.463-8.577l-1.012,2.251c-0.08,0.177-1.934,4.373-2.359,10.694 c-0.234,3.536,0.51,8.253,1.231,11.789l-7.778-7.739l-0.453,2.807c-0.073,0.446-1.754,11.048-0.02,18.338 c0.433,1.819,1.231,3.879,2.117,5.832l-10.759-9.394c0,0-0.749,5.515-0.248,10.196c0.271,2.523,2.272,7.632,3.813,11.276 c-3.503-2.016-8.539-5.019-11.099-7.047l-2.259-1.79l-0.106,2.881c-0.162,4.545-0.087,8.952,2.6,12.916 c1.161,1.717,3.433,4.291,5.459,6.484c-2.877-0.894-6.201-1.851-8.179-2.173l-1.763-0.288l0.071,1.787 c0.148,3.675,2.771,8.324,4.198,9.896c0.723,0.794,2.436,2.508,3.941,3.991L21.93,137.83l0.896,2.098 c0.1,0.234,2.493,5.74,7.324,9.943c2.464,2.146,6.876,4.516,10.047,6.088c-2.57,0.653-5.908,1.536-8.518,2.335l-2.402,0.735 l1.246,1.664c0.13,0.173,0.27,0.343,0.407,0.494c3.608,4.04,12.229,5.234,14.412,5.339c-4.774,1.197-9.767,2.451-11.896,2.979 l-2.911,0.728l2.371,1.843c4.708,3.656,13.02,5.841,22.233,5.841c2.588,0,4.539,0.099,8.954-0.081l-6.105,11.467 c0,0-2.038,9.36-3.02,12.658c-2.304-2.226-2.133-3.205-15.52-15.09c-4.829-4.284-15.411-10.026-18.429-13.813 c-1.005-1.263,5.449-1.422,6.179-1.422c0.73,0-6.393-3.385-8.582-6.123c-2.191-2.739-2.895-5.36-2.895-5.36s-0.38-0.847,0.637-1.001 c1.018-0.157,8.65-1.316,9.084-1.611c0.395-0.266,0.332-0.517-0.137-0.75c-0.469-0.236-9.248-4.724-12.548-10.672 c-2.375-4.281-2.357-6.923-2.364-7.32c-0.01-0.64,0.17-0.803,1.385-0.708c0.862,0.068,7.226,0.046,7.774-0.032 c0.546-0.08,0.453-0.324,0.019-0.576c-9.483-5.484-8.546-14.054-8.624-14.601c-0.079-0.548,0-0.783,0.548-0.704 c0.546,0.077,9.342,0.263,9.812,0.263c0.469,0,0.218-0.519,0.218-0.519s-3.452-4.27-6.056-11.001 c-2.077-5.366-2.377-11.169-2.533-11.639c-0.157-0.469-0.034-0.887,0.514-0.808c0.549,0.079,8.558,3.488,8.87,3.567 c0.313,0.077,0.548-0.103,0.235-0.259c-0.314-0.157-2.896-6.383-3.855-12.033c-1.384-8.17-0.488-10.725-0.42-11.269 c0.063-0.502,0.397-0.874,1.105-0.507c0.743,0.385,12.255,10.245,12.646,10.402c0.391,0.157,0.79-0.164,0.477-0.555 c-0.313-0.392-2.392-6.574-2.938-13.145c-0.548-6.571,0.1-14.571,0.274-15.225c0.161-0.604,0.635-0.581,1.339,0.046 c0.704,0.626,10.381,8.489,11.006,9.038c0.625,0.547,0.727,0.252,0.492-0.53c-0.235-0.782-0.484-8.435,0.375-14.381 c0.965-6.686,3.372-10.979,3.685-11.448s0.536-0.474,0.927-0.161c0.391,0.313,5.106,9.045,5.497,9.515 c0.391,0.469,0.809,0.336,0.732-0.524c-0.104-1.14-0.057-4.547,1.845-12.682c1.956-8.371,3.789-9.758,4.052-10.088 c0.313-0.396,0.521-0.392,0.833-0.002c0.309,0.387,3.945,8.536,4.519,9.377c-0.005,0,0,0.008,0.031,0.049 c-0.007-0.009-0.022-0.036-0.031-0.049c0.025,0.008,0.446,0.395,0.34-0.883c-0.058-0.707,0.396-10.055,1.574-12.653 c1.941-4.282,4.404-6.214,4.899-6.463c0.54-0.272,0.658-0.171,0.737,0.212c0.146,0.721,0.478,7.705,0.625,8.312 c0.146,0.606,0.444,0.232,0.437-0.151c-0.015-0.72,1.081-7.977,3.115-12.044c2.033-4.069,4.292-5.681,5.188-6.133 c0.742-0.376,0.989-0.156,1.018,0.391c0.022,0.422,0.645,5.719,1.206,10.452c-0.272,1.24-0.484,2.556-0.639,3.691 C83.251,22.014,82.866,21.718,82.538,21.517z M127.35,141.814c-1.158,12.032-4.978,23.045-6.326,29.486 c-1.643,7.849-4.788,18.061-6.793,20.931c-4.433,6.343-18.036,18.547-20.403,19.732c-1.094,0.547-6.376-4.115-6.56-4.846 c-0.182-0.728,2.883-3.993,2.154-3.627c-0.731,0.364-4.104,0.906-5.06,0.87c-0.753-0.026,0.633-2.728,0.633-2.728 s-1.484,2.217-3.021,2.947c-0.03,0.015,9.433-18.119,9.433-18.119S127.52,140.043,127.35,141.814z M119.7,169.39l3.104-10.647 l-1.869-0.559l-3.152,10.656L119.7,169.39z M114.072,167.242l4.687-10.051l-1.764-0.838l-4.735,10.055L114.072,167.242z  M126.961,159.319l-0.82,11.06l-1.991-0.139l0.867-11.079L126.961,159.319z M131.727,170.391l-1.986,0.167l-0.828-11.078 l1.944-0.144L131.727,170.391z M164.422,186.462c0,0,9.463,18.134,9.434,18.119c-1.54-0.73-3.021-2.947-3.021-2.947 s1.384,2.701,0.633,2.728c-0.957,0.036-4.33-0.506-5.06-0.87c-0.731-0.366,2.334,2.899,2.153,3.627 c-0.185,0.73-5.467,5.393-6.56,4.846c-2.368-1.186-15.973-13.39-20.404-19.732c-2.007-2.87-5.149-13.082-6.792-20.931 c-1.349-6.441-4.621-17.127-5.778-29.16C128.854,140.373,164.422,186.462,164.422,186.462z M142.029,167.242l1.813-0.834 l-4.735-10.055l-1.762,0.838L142.029,167.242z M136.402,169.39l1.917-0.55l-3.152-10.656l-1.868,0.559L136.402,169.39z"}))}},eeM7:function(e,t,n){e.exports={SubText:"shared_common_SubText_iXOar",AvatarImage:"shared_common_AvatarImage_HVcru",STV_HomeGridPreviewDetails:"shared_common_STV_HomeGridPreviewDetails_1FyZE",EditButton:"shared_common_EditButton_DLPvj",Small:"shared_common_Small_lUt7Z"}},fGPn:function(e,t,n){"use strict";n.d(t,"a",function(){return r}),n.d(t,"b",function(){return s});var o=n("tkkQ"),i={success:!0,result:1},r=function(){function e(){this.m_connection=new a,this.m_bAllowAccountMismatch=!1,this.m_mapCacheSubscribedApp=new Map}return e.prototype.FailureResult=function(e){void 0===e&&(e=2);var t={success:!1,result:e};return this.m_connection&&!this.m_connection.browser_supported&&(t.browser_unsupported=!0),this.m_connection&&!this.m_connection.connected_to_client&&(t.connect_failed=!0),7==e&&(t.call_unsupported=!0),t},e.prototype.SetAllowAccountMismatch=function(e){this.m_bAllowAccountMismatch=e},e.prototype.BClientConnected=function(){var e=this;return this.m_connection.Connect().then(function(){return i},function(){return e.FailureResult()})},e.prototype.BClientSupportsMessage=function(e){return!(!this.m_connection.connected_to_client||!this.m_connection.ready)&&-1!==this.m_connection.ClientInfo.rgSupportedMessages.indexOf(e)},e.prototype.OpenFriendChatDialog=function(e){var t={message:"ShowFriendChatDialog",steamid:e};return this.GenericEResultCall(t)},e.prototype.OpenChatRoomGroupDialog=function(e,t){var n={message:"ShowChatRoomGroupDialog",chat_group_id:e};return t&&(n.chat_room_id=t),this.GenericEResultCall(n)},e.prototype.ShowChatRoomGroupInvite=function(e){var t={message:"ShowChatRoomGroupInvite",invite_code:e};return this.GenericEResultCall(t)},e.prototype.OpenJoinGameDialog=function(e){var t={message:"ShowJoinGameDialog",friend_id:e};return this.GenericEResultCall(t)},e.prototype.BIsSubscribedApp=function(n){var o=this;if(this.m_mapCacheSubscribedApp.has(n))return Promise.resolve(this.m_mapCacheSubscribedApp.get(n));var e={message:"IsSubscribedApp",appid:n};return this.GenericEResultCall(e).then(function(e){if(!e.connect_failed){var t=1==e.result;return o.m_mapCacheSubscribedApp.set(n,t),t}})},e.prototype.ViewGameInfoForSteamID=function(e){var t={message:"ViewGameInfoForSteamID",steamid:e};return this.GenericEResultCall(t)},e.prototype.BClientAccountMatches=function(){return!o.d.logged_in||o.d.accountid==this.m_connection.ClientInfo.unAccountID},e.prototype.GenericEResultCall=function(e){var t=this;return this.m_connection.Connect().then(function(){return t.m_bAllowAccountMismatch||t.BClientAccountMatches()?t.m_connection.SendMsgAndAwaitResponse(e).then(function(e){return 1===e.success?i:t.FailureResult(e.success)}):{success:!1,result:19,account_mismatch:!0}}).catch(function(){return t.FailureResult()})},e}(),a=function(){function e(){this.m_mapWaitingCallbacks=new Map,this.m_iCallSeq=1,this.m_bReady=!1,this.m_bClientConnectionFailed=!1,this.m_bSecurityException=!1,this.m_ClientInfo={ulVersion:"",bFriendsUIEnabled:!1,unAccountID:0,rgSupportedMessages:[]}}return Object.defineProperty(e.prototype,"ClientInfo",{get:function(){return this.m_ClientInfo},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ready",{get:function(){return this.m_bReady},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"browser_supported",{get:function(){return!this.m_bSecurityException},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"connected_to_client",{get:function(){return this.m_socket&&this.m_socket.readyState==WebSocket.OPEN},enumerable:!0,configurable:!0}),e.prototype.SendMsgAndAwaitResponse=function(o){var i=this;return new Promise(function(e,t){var n=i.m_iCallSeq++;i.BSendMsg(o,n)?i.m_mapWaitingCallbacks.set(n,{iSeq:n,fnCallback:e,fnError:t}):t()})},e.prototype.BSendMsg=function(e,t){if(!this.m_socket||this.m_socket.readyState!=WebSocket.OPEN)return!1;var n=Object.assign({},e,{universe:o.a.EUNIVERSE,accountid:o.d.accountid});void 0!==t&&(n.sequenceid=t);try{return this.m_socket.send(JSON.stringify(n)),!0}catch(e){return!1}},e.prototype.OnSocketMessage=function(e){try{var t=JSON.parse(e.data);if(t.sequenceid){var n=this.m_mapWaitingCallbacks.get(t.sequenceid);if(n)return this.m_mapWaitingCallbacks.delete(t.sequenceid),void n.fnCallback(t)}}catch(e){console.error("exception parsing response",e)}},e.prototype.Connect=function(){var o=this;if(this.m_bReady&&this.m_socket.readyState==WebSocket.OPEN)return Promise.resolve();if(this.m_promiseConnect)return this.m_promiseConnect;var e=new Promise(function(t,n){try{o.m_socket=new WebSocket("ws://127.0.0.1:27060/clientsocket/")}catch(e){return o.m_bSecurityException=!0,void n(e)}o.m_socket.onerror=function(e){n()},o.m_socket.onmessage=o.OnSocketMessage.bind(o),o.m_socket.onopen=function(e){o.SendMsgAndAwaitResponse({message:"GetClientInfo"}).then(function(e){1==e.success?(o.m_ClientInfo.ulVersion=e.clientversion,o.m_ClientInfo.bFriendsUIEnabled=!!e.friendsui,o.m_ClientInfo.unAccountID=e.accountid,e.supported_messages&&(o.m_ClientInfo.rgSupportedMessages=e.supported_messages),t()):n()}).catch(n)}});return this.m_promiseConnect=e,this.m_promiseConnect.then(function(){o.m_bReady=!0,o.m_promiseConnect=void 0}).catch(function(){o.m_bClientConnectionFailed=!0,o.m_promiseConnect=void 0}),this.m_promiseConnect},e}(),s=new r;window.ClientConnectionAPI=s},gfbn:function(e,t,n){"use strict";n.r(t);var G=n("tkkQ"),_=n("1n9R"),R=n("mrSG"),c=function(){function e(e,t,n){void 0===t&&(t=0),this.m_nOffset=t||0,e instanceof Uint8Array||e instanceof DataView?(this.m_nLength=n||e.byteLength-this.m_nOffset,this.m_nOffset+=e.byteOffset,this.m_viewPacket=new DataView(e.buffer,this.m_nOffset,this.m_nLength)):(this.m_nLength=n||e.byteLength-this.m_nOffset,this.m_viewPacket=new DataView(e,this.m_nOffset,this.m_nLength)),this.m_rgubPacket=new Uint8Array(this.m_viewPacket.buffer,this.m_viewPacket.byteOffset,this.m_viewPacket.byteLength),this.m_iGet=0,this.m_iPut=0}return e.prototype.TellGet=function(){return this.m_iGet+this.m_viewPacket.byteOffset},e.prototype.GetPacket=function(){return this.m_viewPacket.buffer},e.prototype.GetUint8=function(){return this.m_viewPacket.getUint8(this.m_iGet++)},e.prototype.GetUint32=function(e){void 0===e&&(e=!0);var t=this.m_viewPacket.getUint32(this.m_iGet,e);return this.m_iGet+=4,t},e.prototype.SeekGetHead=function(e){void 0===e&&(e=0),this.m_iGet=e||0},e.prototype.SeekGetCurrent=function(e){this.m_iGet+=e},e.prototype.TellPut=function(){return this.m_iPut+this.m_viewPacket.byteOffset},e.prototype.TellMaxPut=function(){return this.m_viewPacket.byteLength},e.prototype.PutUint8=function(e){this.m_viewPacket.setUint8(this.m_iPut++,e)},e.prototype.PutUint32=function(e,t){void 0===t&&(t=!0),this.m_viewPacket.setUint32(this.m_iPut,e,t),this.m_iPut+=4},e.prototype.PutBytes=function(e){this.m_rgubPacket.set(e,this.m_iPut),this.m_iPut+=e.length},e.prototype.SeekPut=function(e){this.m_iPut+=e},e.prototype.GetCountBytesRemaining=function(){return this.m_viewPacket.byteLength-this.m_iGet},e}(),i=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];function p(e){for(var t="",n=0;n<e.length;n++){var o=e[n];t+=i[o>>>4]+i[15&o]}return t}var r=n("hRO2"),o=n("qeMu"),l=n("/511"),D=n("s+DT"),u=function(){function t(e,t,n,o,i){if(o)this.m_eMsg=o.m_eMsg,this.m_bValid=o.m_bValid,this.m_bValid&&(this.m_netPacket=o.m_netPacket,this.m_cubHeader=o.m_cubHeader,this.m_header=o.m_header,this.InitForType(n));else{if(this.m_header=new l.d(null),this.m_bValid=!0,t)if(this.m_netPacket=t,this.m_netPacket.SeekGetHead(),this.m_eMsg=this.m_netPacket.GetUint32(),2147483648&this.m_eMsg){this.m_eMsg=2147483647&this.m_eMsg,this.m_cubHeader=this.m_netPacket.GetUint32();try{l.d.deserializeBinaryFromReader(this.m_header,new r.BinaryReader(this.m_netPacket.GetPacket(),this.m_netPacket.TellGet(),this.m_cubHeader)),this.m_netPacket.SeekGetCurrent(this.m_cubHeader),n&&this.InitForType(n)}catch(e){console.error("Exception deserializing protobuf",e),this.m_bValid=!1}}else this.m_bValid=!1;else e&&(this.m_eMsg=e),n&&(this.m_body=new n);i&&this.m_header.set_jobid_target(i.Hdr().jobid_target())}}return t.InitHeaderFromPacket=function(e){return new t(void 0,e)},t.prototype.InitForType=function(e){if(this.m_body=new e,this.m_netPacket){this.m_netPacket.SeekGetHead(8+this.m_cubHeader);try{e.deserializeBinaryFromReader(this.m_body,new r.BinaryReader(this.m_netPacket.GetPacket(),this.m_netPacket.TellGet(),this.m_netPacket.GetCountBytesRemaining()))}catch(e){this.m_bValid=!1,console.error("Exception parsing protobuf message body.  Definitions may be out of sync with server version."),console.log(e.stack||e)}}},t.prototype.BIsValid=function(){return this.m_bValid},t.prototype.Body=function(){return this.m_body},t.prototype.Hdr=function(){return this.m_header},t.prototype.GetEMsg=function(){return this.m_eMsg},t.prototype.SetEMsg=function(e){this.m_eMsg=e},t.prototype.GetEResult=function(){return this.Hdr().eresult()},t.prototype.Serialize=function(){var e=this.m_header.serializeBinary(),t=this.m_body.serializeBinary(),n=2147483648|this.m_eMsg,o=new Uint8Array(8+e.length+t.length),i=new c(o);return i.PutUint32(n),i.PutUint32(e.length),i.PutBytes(e),i.PutBytes(t),o},t.prototype.SerializeBody=function(){var e=this.m_body.serializeBinary(),t=new Uint8Array(e.length);return new c(t).PutBytes(e),t},t.prototype.DEBUG_ToObject=function(){return{}},t.prototype.DEBUG_LogToConsole=function(){},t}(),m=function(i){function n(e,t,n,o){return void 0===t&&(t=0),i.call(this,t,n,e,o)||this}return R.d(n,i),n.InitFromPacket=function(e,t){return new n(e,0,t)},n.InitFromMsg=function(e,t){return new n(e,void 0,void 0,t)},n.Init=function(e,t){return new n(e,t)},n.prototype.Body=function(){return i.prototype.Body.call(this)},n}(u),d=n("2vnA"),s=new(function(){function e(){this.m_mapCallbacks=new Map,this.m_rgRegisteredEMsgs=[],this.m_mapServiceMethodHandlers=new Map,this.m_rgRegisteredServiceMethodHandlers=[]}return e.prototype.DispatchMsgToHandlers=function(e,t){var n=e.GetEMsg();if(146==n){var o=e.Hdr().target_job_name();if(o)if(a=this.m_mapServiceMethodHandlers.get(o)){this.DEBUG_LogMessageDispatch(e,a[0]);for(var i=0,r=a;i<r.length;i++){r[i].invoke(e,t)}return!0}}else{var a;if(a=this.m_mapCallbacks.get(n)){this.DEBUG_LogMessageDispatch(e,a[0]);for(var s=0,c=a;s<c.length;s++){c[s].invoke(e)}return!0}}return!1},e.prototype.DEBUG_LogMessageDispatch=function(e,t){},Object.defineProperty(e.prototype,"emsg_list",{get:function(){return this.m_rgRegisteredEMsgs},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"servicemethod_list",{get:function(){return this.m_rgRegisteredServiceMethodHandlers},enumerable:!0,configurable:!0}),e.prototype.AddCallback=function(n,e,o){var i=this,t=this.m_mapCallbacks.get(n);return t||(t=[],this.m_mapCallbacks.set(n,t),this.m_rgRegisteredEMsgs.push(n)),t.push({invoke:o,msgClass:e}),{invoke:o,unregister:function(){var e=i.m_mapCallbacks.get(n);if(e)for(var t=0;t<e.length;t++)e[t].invoke==o&&(e.splice(t,1),t--)}}},e.prototype.AddServiceMethodHandler=function(a,s){var n=this,o=function(e,t){var n=m.InitFromMsg(a.request,e),o=m.Init(a.response,147),i=s(n,o),r=function(e){o.Hdr().set_eresult(e),t(o)};i instanceof Promise?i.then(r).catch(function(){r(2)}):r(i)};return this.m_mapServiceMethodHandlers.has(a.name)?console.error("Duplicate registration for method "+a.name):(this.m_mapServiceMethodHandlers.set(a.name,[{invoke:o,msgClass:a.request}]),this.m_rgRegisteredServiceMethodHandlers.push(a.name)),{invoke:o,unregister:function(){var e=n.m_mapServiceMethodHandlers.get(a.name);if(e)for(var t=0;t<e.length;t++)e[t].invoke==o&&(e.splice(t,1),t--)}}},e.prototype.AddServiceNotificationHandler=function(o,i){var n=this,r=function(e,t){var n=m.InitFromMsg(o.request,e);i(n)},e=this.m_mapServiceMethodHandlers.get(o.name);return e||(e=[],this.m_mapServiceMethodHandlers.set(o.name,e),this.m_rgRegisteredServiceMethodHandlers.push(o.name)),e.push({invoke:r,msgClass:o.request}),{invoke:r,unregister:function(){var e=n.m_mapServiceMethodHandlers.get(o.name);if(e)for(var t=0;t<e.length;t++)e[t].invoke==r&&(e.splice(t,1),t--)}}},R.c([d.observable],e.prototype,"m_rgRegisteredEMsgs",void 0),R.c([d.observable],e.prototype,"m_rgRegisteredServiceMethodHandlers",void 0),e}());function h(e,t,n){return s.AddCallback(e,t,function(e){Object(d.runInAction)(function(){n(m.InitFromMsg(t,e))})})}function a(e,t){return s.AddServiceNotificationHandler(e,t)}function f(e,n){return s.AddServiceNotificationHandler(e,function(e){var t;return Object(d.runInAction)(function(){t=n(e)}),t})}var g=n("H7XF"),b=n("R/D/"),v=n("YiOU"),S=n("16wW"),O=n("0N1H"),y=n("vDqi"),C=n.n(y),I=n("XaMz"),E=function(){function e(){this.m_CMList={rgCMList:[],rtLastLoaded:0}}return e.prototype.Init=function(e){var t=this;this.m_Storage=e,this.m_promiseLoadFromStorage=this.m_Storage.GetObject(this.GetLocalStorageKey()).then(function(e){return e&&e.rgCMList&&e.rgCMList.length&&e.rgCMList[0].strHost&&Object.assign(t.m_CMList,e),null}).catch(function(){return null})},e.prototype.GetBestCMToConnectTo=function(){var t=this;return this.m_promiseLoadFromStorage.then(function(){var e=(new Date).getTime()/1e3;return!t.m_CMList.rgCMList.length||604800<e-t.m_CMList.rtLastLoaded?t.GetCMListFromWebAPI():t.PingCMs()})},e.prototype.LogCMDisconnected=function(e,t){t||(e.nConnectFailures=(e.nConnectFailures||0)+1,delete e.msPing,delete e.nCMLoad,this.WriteCMListToLocalStorage())},e.prototype.BuildCMWebSocketURL=function(e){return"wss://"+this.FixDevHost(e)+"/cmsocket/"},e.prototype.FixDevHost=function(e){if(4==_.b.EUNIVERSE&&"dev"==_.b.WEB_UNIVERSE&&e.match(/^127\.0\.0\.1/)){var t=_.b.WEBAPI_BASE_URL.match(/https?:\/\/([^\/:]*)/);if(t&&t[1])return e.replace(/^127\.0\.0\.1/,t[1])}return e},e.prototype.GetLocalStorageKey=function(){return"CCMList_"+_.b.EUNIVERSE},e.prototype.WriteCMListToLocalStorage=function(){this.m_Storage.StoreObject(this.GetLocalStorageKey(),this.m_CMList)},e.prototype.GetCMListFromWebAPI=function(){var a=this,s=_.b.WEBAPI_BASE_URL+"ISteamDirectory/GetCMList/v1/",c="GetCMList_JSONP_"+(new Date).getTime();return s+="?cellid=0",_.b.IN_MOBILE||(s+="&jsonp="+encodeURIComponent(c)),new Promise(function(n,o){var i=!1,r=window.setTimeout(function(){i=!0,a.m_CMList.rgCMList.length?a.PingCMs().then(n,o):o("Request to load CM list timed out")},1e4),t=function(e){delete window[c];var t=0;e&&e.response&&e.response.serverlist_websockets&&(t=e.response.serverlist_websockets.length||0),0<t&&a.OnCMListResponse(e),i||(window.clearInterval(r),a.PingCMs().then(n,o))};if(_.b.IN_MOBILE)C.a.get(s).then(function(e){console.log(e),t(e.data)});else{window[c]=t;var e=window.document.createElement("script");e.type="text/javascript",e.async=!0,e.src=s,e.onerror=o,window.document.head.appendChild(e)}})},e.prototype.OnCMListResponse=function(e){for(var t=new Map,n=0,o=this.m_CMList.rgCMList;n<o.length;n++){var i=o[n];t.set(i.strHost,i)}if(this.m_CMList={rgCMList:[],rtLastLoaded:(new Date).getTime()/1e3},e.response&&e.response.serverlist_websockets)for(var r=0,a=0,s=e.response.serverlist_websockets;a<s.length;a++){var c=s[a],l=t.get(c)||{};this.m_CMList.rgCMList.push(Object.assign(l,{strHost:c,nPriority:r++}))}},e.prototype.PingCMs=function(){for(var p=this,e=(new Date).getTime()/1e3-18e3,u=[],m=void 0,d=1e4,t=0,n=this.m_CMList.rgCMList;t<n.length;t++){var o=n[t],i=(o.msPing||0)+(o.nCMLoad||0),r=!i||o.rtLastCheck<e;r&&u.length<20&&u.push(o),r&&!_.b.IN_MOBILE||i&&i<d&&(m=o,d=i)}if(0==u.length)return m||(m=this.GetCMWithFewestDisconnects()),m?Promise.resolve(m):Promise.reject("No CMs available");var h=!1;return new Promise(function(t,n){var o,i,r="immediate",a=function(e){h||(h=!0,p.WriteCMListToLocalStorage(),o&&window.clearTimeout(o),i&&window.clearTimeout(i),e?t(e):p.m_CMList.rgCMList.length?t(p.GetCMWithFewestDisconnects()):n("No CMs available"))};m&&(p.BCMOkToUse(m,r)||0==u.length)&&a(m),h||(o=window.setTimeout(function(){r="timeout",!h&&m&&p.BCMOkToUse(m,r)&&a(m)},400),i=window.setTimeout(function(){r="seriouslytimeout",a(p.BCMOkToUse(m,r)?m:void 0)},12e3));var s,e=0,c=0;s=function(){if(e<u.length){var n=u[e++];return p.PingCM(n).then(function(){var e,t;(t=((e=n).msPing||0)+(e.nCMLoad||0))<d&&(m=e,d=t,!h&&p.BCMOkToUse(m,r)&&a(m)),!h&&s()||0==--c&&(h?p.WriteCMListToLocalStorage():a(p.BCMOkToUse(m,"seriouslytimeout")?m:void 0))}),!0}return!1};for(var l=0;l<4;l++)s()&&c++;_.b.IN_MOBILE&&m&&!h&&a(m)})},e.prototype.GetCMWithFewestDisconnects=function(){if(this.m_CMList.rgCMList.length){for(var e=this.m_CMList.rgCMList[0],t=1;0<e.nConnectFailures&&t<this.m_CMList.rgCMList.length;){var n=this.m_CMList.rgCMList[t++];(!n.nConnectFailures||n.nConnectFailures<e.nConnectFailures)&&(e=n)}return e}},e.prototype.BCMOkToUse=function(e,t){if(!e)return!1;var n=e.msPing+e.nCMLoad;return n<80&&e.msPing<60||"immediate"!=t&&(n<140&&e.msPing<100||"timeout"!=t&&(n<350&&e.msPing<275))},e.prototype.PingCM=function(l){return R.b(this,void 0,void 0,function(){var t,n,o,i,r,a,s,c;return R.e(this,function(e){switch(e.label){case 0:t="https://"+this.FixDevHost(l.strHost)+"/cmping/",n=performance.now(),o=C.a.CancelToken.source(),i=window.setTimeout(function(){o.cancel()},1e3),e.label=1;case 1:return e.trys.push([1,3,,4]),[4,C.a.head(t,{cancelToken:o.token})];case 2:return r=e.sent(),window.clearTimeout(i),a=performance.now()-n,s=r.headers["x-steam-cmload"]?parseInt(r.headers["x-steam-cmload"]):void 0,l.msPing=a,l.nCMLoad=s,[3,4];case 3:return c=e.sent(),C.a.isCancel(c)||window.clearTimeout(i),l.msPing=1e4,l.nCMLoad=0,[3,4];case 4:return l.rtLastCheck=(new Date).getTime()/1e3,[2,l.msPing]}})})},e}(),w=n("BpBa"),M=n("UqDm"),T=n("1VtQ"),N=function(){function e(){this.m_vecCallbacks=[]}return e.prototype.Register=function(e){var t=this;this.m_vecCallbacks.push(e);return{Unregister:function(){M.d(t.m_vecCallbacks,e)}}},e.prototype.Dispatch=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var n=0,o=this.m_vecCallbacks;n<o.length;n++){o[n].apply(void 0,e)}},e.prototype.ClearAllCallbacks=function(){this.m_vecCallbacks=[]},e}(),L=function(){function e(){}return e.prototype.Schedule=function(e,t){this.IsScheduled()&&this.Cancel(),this.m_fnCallback=t,this.m_schTimer=window.setTimeout(this.ScheduledInternal,e)},e.prototype.IsScheduled=function(){return void 0!==this.m_schTimer},e.prototype.Cancel=function(){this.m_schTimer&&(clearTimeout(this.m_schTimer),this.m_schTimer=void 0)},e.prototype.ScheduledInternal=function(){this.m_schTimer=void 0;var e=this.m_fnCallback;this.m_fnCallback=void 0,e()},R.c([T.a],e.prototype,"ScheduledInternal",null),e}(),k=function(){function e(){this.m_rgListeners=[]}return e.prototype.AddEventListener=function(e,t,n){e.addEventListener(t,n),this.m_rgListeners.push({element:e,type:t,listener:n})},e.prototype.Unregister=function(){for(var e=0,t=this.m_rgListeners;e<t.length;e++){var n=t[e];n.element.removeEventListener(n.type,n.listener)}this.m_rgListeners=[]},e}(),P="DEBUG_LogCMTraffic";var A=function(){function e(e){void 0===e&&(e=!1),this.m_bRunOnce=!1,this.m_ClientConnectionCallbacks=new N,this.m_mapServerTypeCallbacks=new Map,this.m_bRunOnce=e}return e.prototype.RunCallbacks=function(e,t){void 0===e?(this.m_ClientConnectionCallbacks.Dispatch(t),this.m_bRunOnce&&this.m_ClientConnectionCallbacks.ClearAllCallbacks()):this.m_mapServerTypeCallbacks.has(e)&&(this.m_mapServerTypeCallbacks.get(e).Dispatch(),this.m_bRunOnce&&this.m_mapServerTypeCallbacks.delete(e))},e.prototype.RunAllCallbacks=function(e,t){var n=this;this.RunCallbacks(void 0,t),e.forEach(function(e){return n.RunCallbacks(e,t)})},e.prototype.AddCallback=function(e,t){var n=this.m_ClientConnectionCallbacks;return void 0!==t&&(this.m_mapServerTypeCallbacks.has(t)||this.m_mapServerTypeCallbacks.set(t,new N),n=this.m_mapServerTypeCallbacks.get(t)),n.Register(e)},e}();function B(e,t){return function(){try{e()}catch(e){console.error("Error in "+t+" callback:",e)}}}var F,V,x=function(){function e(){var a=this;this.m_steamid=new D.a,this.m_bLoggedOn=!1,this.m_bCompletedInitialConnect=!1,this.m_unAccountFlags=0,this.m_strIPCountry="",this.m_strPersonaName="",this.m_steamidLastLoggedOn=new D.a,this.m_bConnected=!1,this.m_bConnectionFailed=!1,this.m_setConnectedServers=new Set,this.m_callbacksOnConnectOneTime=new A(!0),this.m_callbacksOnConnect=new A,this.m_callbacksOnDisconnect=new A,this.m_bForceDisconnect=!1,this.m_bPerformedInitialClockAdjustment=!1,this.m_nWallClockDriftMS=0,this.m_nPerfClockServerMSOffset=(new Date).getTime()-performance.now(),this.ClientServersAvailableHandler=h(5501,w.f,function(e){for(var t=new Set(a.m_setConnectedServers),n=0,o=e.Body().server_types_available();n<o.length;n++){var i=o[n],r=i.server();void 0!==r&&(a.m_bLoggedOn&&(a.m_setConnectedServers.has(r)&&!i.changed()||(i.changed()&&a.m_setConnectedServers.has(r)&&a.m_callbacksOnDisconnect.RunCallbacks(r),a.m_callbacksOnConnect.RunCallbacks(r),a.m_callbacksOnConnectOneTime.RunCallbacks(r))),a.m_setConnectedServers.add(r),t.delete(r))}t.forEach(function(e){a.m_setConnectedServers.delete(e),a.m_bLoggedOn&&a.m_callbacksOnDisconnect.RunCallbacks(e)})}),this.m_ServiceTransport={SendMsg:function(e,t,n){return t.SetEMsg(151),t.Hdr().set_target_job_name(e),a.SendMsgAndAwaitResponse(t,n)},SendNotification:function(e,t){return t.SetEMsg(151),t.Hdr().set_target_job_name(e),a.Send(t)}},window&&window.addEventListener&&window.addEventListener("unload",function(e){a.ForceDisconnect()})}return e.ConstructClientCMInterface=function(){return new j},e.ConstructWebCMInterface=function(e){return new U(e)},Object.defineProperty(e.prototype,"steamid",{get:function(){return this.m_steamidLastLoggedOn},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"logged_on",{get:function(){return this.m_bLoggedOn},enumerable:!0,configurable:!0}),e.prototype.BDisconnected=function(){return!this.logged_on&&this.m_steamidLastLoggedOn.BIsValid()},e.prototype.BConnectedToServer=function(e){return void 0===e?this.m_bLoggedOn:this.m_setConnectedServers.has(e)},Object.defineProperty(e.prototype,"has_completed_initial_connect",{get:function(){return this.m_bCompletedInitialConnect},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"account_flags",{get:function(){return this.m_unAccountFlags},enumerable:!0,configurable:!0}),e.prototype.GetServiceTransport=function(){return this.m_ServiceTransport},e.prototype.RunWhenLoggedOn=function(e,t){var n=B(e,"RunWhenLoggedOn");this.BConnectedToServer(t)?n():this.m_callbacksOnConnectOneTime.AddCallback(n,t)},e.prototype.WaitUntilLoggedOn=function(){var t=this;return new Promise(function(e){return t.RunWhenLoggedOn(e)})},e.prototype.AddOnLogonCallback=function(e,t){var n=B(e,"AddOnLogonCallback");return this.BConnectedToServer(t)&&n(),this.m_callbacksOnConnect.AddCallback(n,t)},e.prototype.AddOnDisconnectCallback=function(e,t){var n,o,i=(n=e,o="AddOnDisconnectCallback",function(e){try{n(e)}catch(e){console.error("Error in "+o+" callback:",e)}});this.m_callbacksOnDisconnect.AddCallback(i,t)},e.prototype.ForceDisconnect=function(){this.m_bForceDisconnect=!0,this.Disconnect()},Object.defineProperty(e.prototype,"session",{get:function(){return null},enumerable:!0,configurable:!0}),e.prototype.Send=function(e){return!!this.BIsConnected()&&(this.DEBUG_LogCMInterfaceActivity(e,"send"),this.SendInternal(e))},e.prototype.BInternalShouldDispatchMessage=function(e){return!0},e.prototype.ResolveAwaitWithTransportError=function(e,t,n,o){var i=m.Init(t);i.Hdr().set_eresult(2),i.Hdr().set_transport_error(n),o&&i.Hdr().set_error_message(o),e(i)},e.prototype.DispatchMessage=function(t){var n=this;try{if(!this.BInternalShouldDispatchMessage(t))return;if(t.BIsValid()){s.DispatchMsgToHandlers(t,function(e){e.Hdr().set_jobid_target(t.Hdr().jobid_source()),n.Send(e)})||this.DEBUG_LogCMInterfaceActivity(t,"receive",!1)}else console.error("CMInterface RECV could not parse message of type "+Object(o.a)(t.GetEMsg())+" "+t.GetEMsg())}catch(e){console.error("CMInterface RECV exception thrown while processing message of type "+Object(o.a)(t.GetEMsg()),e),t.DEBUG_LogToConsole()}},e.prototype.BIsConnected=function(){return this.m_bConnected},e.prototype.OnConnect=function(){this.m_bConnected=!0,this.m_bConnectionFailed=!1,this.m_bForceDisconnect=!1},e.prototype.OnLoggedOn=function(){this.m_bCompletedInitialConnect=!0,this.InternalAdjustClock(),this.m_callbacksOnConnect.RunAllCallbacks(this.m_setConnectedServers),this.m_callbacksOnConnectOneTime.RunAllCallbacks(this.m_setConnectedServers)},e.prototype.OnDisconnect=function(){this.m_bConnected;this.m_bConnected=!1,this.m_bConnectionFailed=!0,this.m_onConnect=void 0,this.m_steamid=new D.a,this.m_bLoggedOn=!1,this.m_unAccountFlags=0,this.m_strIPCountry="",this.m_strPersonaName="",this.m_callbacksOnDisconnect.RunAllCallbacks(this.m_setConnectedServers,this.m_bForceDisconnect),this.m_setConnectedServers.clear()},e.prototype.DEBUG_LogCMInterfaceActivity=function(e,t,n){void 0===n&&(n=!0)},e.prototype.DEBUG_LogMessage=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n]},e.prototype.InternalAdjustClock=function(){return R.b(this,void 0,void 0,function(){var t,r=this;return R.e(this,function(e){return(t=m.Init(v.f,9802)).Body().set_client_request_timestamp(Math.floor(performance.now()).toString()),[2,this.SendMsgAndAwaitResponse(t,v.g).then(function(e){var t=performance.now(),n=new Date,o=parseInt(e.Body().client_request_timestamp()),i=parseInt(e.Body().server_timestamp_ms())-(t-o>>1);return i&&!isNaN(i)&&t&&!isNaN(t)?(r.m_bPerformedInitialClockAdjustment=!0,r.m_nPerfClockServerMSOffset=i-t,r.m_nWallClockDriftMS=n.getTime()-i):Object(I.a)(!1,"Error computing server time, server echo: "+o+" server time "+i),!0})]})})},e.prototype.BPerformedInitialClockAdjustment=function(){return this.m_bPerformedInitialClockAdjustment},e.prototype.GetServerTimeMS=function(){return performance.now()+this.m_nPerfClockServerMSOffset},e.prototype.GetServerRTime32=function(){return Math.floor((performance.now()+this.m_nPerfClockServerMSOffset)/1e3)},e.prototype.RTime32ToDate=function(e){return new Date(1e3*e+this.m_nWallClockDriftMS)},R.c([d.observable],e.prototype,"m_steamid",void 0),R.c([d.observable],e.prototype,"m_bLoggedOn",void 0),R.c([d.observable],e.prototype,"m_bCompletedInitialConnect",void 0),R.c([d.observable],e.prototype,"m_unAccountFlags",void 0),R.c([d.observable],e.prototype,"m_strIPCountry",void 0),R.c([d.observable],e.prototype,"m_strPersonaName",void 0),R.c([d.observable],e.prototype,"m_steamidLastLoggedOn",void 0),R.c([d.observable],e.prototype,"m_bPerformedInitialClockAdjustment",void 0),R.c([d.action],e.prototype,"DispatchMessage",null),R.c([d.action],e.prototype,"OnDisconnect",null),e}(),U=function(n){function e(e){var t=n.call(this)||this;return t.m_Session={m_bWaitingForLogonResponse:!1,m_nSessionID:0,m_eResultLogonSuccess:2,m_nSessionIDLast:0,m_nClientInstanceID:"0"},t.m_bLoadingCMList=!1,t.m_iCallSeq=1,t.m_mapWaitingCallbacks=new Map,t.m_CMList=new E,t.LogOnResponseHandler=h(751,v.e,function(e){t.m_Session.m_bWaitingForLogonResponse=!1,t.m_Session.m_eResultLogonSuccess=e.Body().eresult(),1==e.Body().eresult()?(t.m_steamid=new D.a(e.Body().client_supplied_steamid()),t.m_steamidLastLoggedOn=t.m_steamid,t.m_bLoggedOn=!0,t.m_Session.m_nSessionID=e.Hdr().client_sessionid(),t.m_Session.m_nSessionIDLast=t.m_Session.m_nSessionID,t.m_Session.m_nClientInstanceID=e.Body().client_instance_id(),t.OnLoggedOn()):(console.warn("Received error code from LogOnResponse, disconnecting. EResult=",e.Body().eresult()),48==e.Body().eresult()&&t.m_CMList.LogCMDisconnected(t.m_SocketCMHost,t.m_bLoggedOn),t.Disconnect())}),t.ClientAccountInfoHandler=h(768,v.a,function(e){t.m_unAccountFlags=e.Body().account_flags()||0,t.m_strIPCountry=e.Body().ip_country()||"",t.m_strPersonaName=e.Body().persona_name()||""}),t.m_CMList.Init(e),t}return R.d(e,n),e.prototype.BIsConnected=function(){return this.m_Socket&&this.m_Socket.readyState==WebSocket.OPEN},e.prototype.Connect=function(){var s=this;return this.m_Socket||this.m_bLoadingCMList?this.m_onConnect||(this.m_onConnect=Promise.resolve()):(console.log("Loading CM List"),this.m_bConnected=!1,this.m_bLoggedOn=!1,this.m_Session.m_bWaitingForLogonResponse=!0,this.m_bLoadingCMList=!0,this.m_onConnect=this.m_CMList.GetBestCMToConnectTo().then(function(r){console.log("Connecting socket to host "+r.strHost),s.m_bLoadingCMList=!1;var a=s.m_Socket=new WebSocket(s.m_CMList.BuildCMWebSocketURL(r.strHost));return s.m_SocketCMHost=r,a.binaryType="arraybuffer",a.onmessage=function(e){var t=new c(e.data),n=u.InitHeaderFromPacket(t);1==n.GetEMsg()?s.DecodeAndDispatchMultiMsg(m.InitFromMsg(l.c,n)):s.DispatchMessage(n)},new Promise(function(t,n){var o=!1,i=window.setTimeout(function(){console.warn("Socket connection timed out after 3000ms"),o=!0,a.close(4e3)},3e3);a.onopen=function(e){console.log("Connected socket to host "+r.strHost),Object(I.a)(!o,"Socket connection was opened after timing out."),o||window.clearTimeout(i),a==s.m_Socket?(s.m_bConnected=!0,s.OnConnect(),t()):n()},a.onerror=function(e){o||(window.clearTimeout(i),Object(I.a)(!1,"Socket connect failed",e)),s.m_CMList.LogCMDisconnected(r,s.m_bLoggedOn),n()}})}).catch(function(){s.m_bLoadingCMList=!1,s.OnDisconnect()})),this.m_onConnect},Object.defineProperty(e.prototype,"session",{get:function(){return this.m_Session},enumerable:!0,configurable:!0}),e.prototype.ClearHeartbeatInterval=function(){this.m_iIntervalHeartbeat&&(window.clearInterval(this.m_iIntervalHeartbeat),this.m_iIntervalHeartbeat=void 0)},e.prototype.ResetHeartbeatInterval=function(){var e=this;this.ClearHeartbeatInterval(),this.m_iIntervalHeartbeat=window.setInterval(function(){return e.SendHeartbeat()},27e3)},e.prototype.SendHeartbeat=function(){var e=m.Init(v.b,703);this.Send(e)},e.prototype.OnConnect=function(){var t=this;n.prototype.OnConnect.call(this),this.m_Socket&&(this.m_Socket.onerror=function(e){},this.ResetHeartbeatInterval(),this.m_Socket.onclose=function(e){t.OnDisconnect()})},e.prototype.Disconnect=function(){this.m_Socket&&this.m_Socket.close()},e.prototype.OnDisconnect=function(){n.prototype.OnDisconnect.call(this),this.m_Socket=void 0,this.m_SocketCMHost=void 0,this.ClearHeartbeatInterval()},e.prototype.SendMsgAndAwaitResponse=function(o,i){var r=this;return new Promise(function(e,t){var n=r.m_iCallSeq++;o.Hdr().set_jobid_source(""+n),r.Send(o)?r.m_mapWaitingCallbacks.set(n,{iSeq:n,msgClass:i,fnCallback:e}):r.ResolveAwaitWithTransportError(e,i,2,"Web socket not connected")})},e.prototype.SendInternal=function(e){return!!this.m_Socket&&(this.m_steamid.BIsValid()&&e.Hdr().set_steamid(this.m_steamid.ConvertTo64BitString()),this.m_Session.m_nSessionID&&e.Hdr().set_client_sessionid(this.m_Session.m_nSessionID),this.m_Socket.send(e.Serialize()),703!=e.GetEMsg()&&this.ResetHeartbeatInterval(),!0)},e.prototype.BInternalShouldDispatchMessage=function(e){if(e.BIsValid()&&e.Hdr().jobid_target()&&e.Hdr().jobid_target()!==O.c){var t=parseInt(e.Hdr().jobid_target());if(this.m_mapWaitingCallbacks.has(t)){var n=this.m_mapWaitingCallbacks.get(t);if(n){var o=m.InitFromMsg(n.msgClass,e);this.DEBUG_LogCMInterfaceActivity(o,"receive",!0),o.BIsValid()?n.fnCallback(o):this.ResolveAwaitWithTransportError(n.fnCallback,n.msgClass,102,"Failed to parse response from server"),this.m_mapWaitingCallbacks.delete(t)}return!1}this.DEBUG_LogCMInterfaceActivity(e,"receive",!1)}return!0},e.prototype.DecodeAndDispatchMultiMsg=function(e){var t=e.Body().message_body();if(t){e.Body().size_unzipped()&&(t=S.inflate(t));for(var n=new c(t);0<n.GetCountBytesRemaining();){var o=n.GetUint32(),i=u.InitHeaderFromPacket(new c(n.GetPacket(),n.TellGet(),o));this.DispatchMessage(i),n.SeekGetCurrent(o)}}},R.c([d.action],e.prototype,"DecodeAndDispatchMultiMsg",null),e}(x),j=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.m_setEMsgHandlers=new Set,e.m_setServiceMethodHandlers=new Set,e}return R.d(e,t),e.prototype.SendMsgAndAwaitResponse=function(n,i){var r=this;return new Promise(function(o,e){if(r.m_hSharedConnection){r.DEBUG_LogCMInterfaceActivity(n,"send");var t=g.fromByteArray(n.Serialize());SteamClient.SharedConnection.SendMsgAndAwaitResponse(r.m_hSharedConnection,t).then(function(e){var t=new c(g.toByteArray(e)),n=m.InitFromPacket(i,t);r.DEBUG_LogCMInterfaceActivity(n,"receive",!0),n.BIsValid()?o(n):r.ResolveAwaitWithTransportError(o,i,102,"Failed to parse response from server")}).catch(function(e){r.ResolveAwaitWithTransportError(o,i,2,e)})}})},e.prototype.SendInternal=function(e){var t=g.fromByteArray(e.Serialize());return SteamClient.SharedConnection.SendMsg(this.m_hSharedConnection,t),!0},e.prototype.OnMsgRecvd=function(e){var t=new c(g.toByteArray(e)),n=u.InitHeaderFromPacket(t);this.DispatchMessage(n)},e.prototype.OnLogonInfoChanged=function(e){this.DEBUG_LogMessage("Login info from client: ",e),this.m_bLoggedOn=e.bLoggedOn,_.b.EUNIVERSE=e.eUniverse,_.b.MEDIA_CDN_COMMUNITY_URL=e.strCommunityImagesURL,e.strSteamid?(this.m_steamid=new D.a(e.strSteamid),this.m_steamidLastLoggedOn=this.m_steamid,_.e.logged_in=!0,_.e.steamid=e.strSteamid,_.e.accountid=this.m_steamid.GetAccountID(),_.e.account_name=e.strAccountName):0!=this.m_steamid.GetAccountID()&&(this.m_steamid=new D.a),this.m_bLoggedOn?(this.m_bConnected||this.OnConnect(),this.OnLoggedOn()):this.OnDisconnect()},e.prototype.Connect=function(){var o=this;return this.m_hSharedConnection?Promise.resolve():this.m_onConnect=new Promise(function(t,n){SteamClient.SharedConnection.AllocateSharedConnection().then(function(e){e?(o.OnSharedConnectionEstablished(e),o.DEBUG_LogMessage("obtained handle ",o.m_hSharedConnection),o.OnConnect(),t()):n()}).catch(n)})},e.prototype.OnSharedConnectionEstablished=function(e){var a=this;this.m_hSharedConnection=e,this.m_setEMsgHandlers.clear(),this.m_setServiceMethodHandlers.clear(),this.m_hEMsgRegistrationObserver&&this.m_hEMsgRegistrationObserver(),this.m_hEMsgRegistrationObserver=Object(d.autorun)(function(){if(a.m_hSharedConnection){for(var e=0,t=s.emsg_list;e<t.length;e++){var n=t[e];a.m_setEMsgHandlers.has(n)||(a.m_setEMsgHandlers.add(n),SteamClient.SharedConnection.SubscribeToEMsg(a.m_hSharedConnection,n))}for(var o=0,i=s.servicemethod_list;o<i.length;o++){var r=i[o];a.m_setServiceMethodHandlers.has(r)||(a.m_setServiceMethodHandlers.add(r),SteamClient.SharedConnection.SubscribeToClientServiceMethod(a.m_hSharedConnection,r))}}});var t=!1;SteamClient.SharedConnection.RegisterOnLogonInfoChanged(this.m_hSharedConnection,function(e){a.OnLogonInfoChanged(e),t||(t=!0,SteamClient.SharedConnection.RegisterOnMessageReceived(a.m_hSharedConnection,a.OnMsgRecvd.bind(a)))})},e.prototype.OnConnect=function(){t.prototype.OnConnect.call(this)},e.prototype.Disconnect=function(){if(this.m_hSharedConnection){var e=m.Init(b.c,716);e.Body().set_persona_state(0),e.Body().set_persona_set_by_user(!1),this.Send(e),SteamClient.SharedConnection.Close(this.m_hSharedConnection),this.OnSharedConnectionClosed()}},e.prototype.OnSharedConnectionClosed=function(){t.prototype.OnDisconnect.call(this),this.m_hSharedConnection=void 0,this.m_setEMsgHandlers.clear(),this.m_hEMsgRegistrationObserver&&(this.m_hEMsgRegistrationObserver(),this.m_hEMsgRegistrationObserver=void 0)},e.prototype.SendHeartbeat=function(){},e.prototype.ClearHeartbeatInterval=function(){},e.prototype.ResetHeartbeatInterval=function(){},R.c([d.action],e.prototype,"OnLogonInfoChanged",null),e}(x),H=function(){function e(e){var t,n,o,i=this;this.m_bLogonFailed=!1,this.m_bForcedDisconnect=!1,this.m_bConnectSucceeded=!1,this.m_bEverConnected=!1,this.m_bEverLoggedOn=!1,this.m_cConsecutiveConnectionFailures=0,this.m_bWaitingToReconnect=!1,this.m_rgdtRecentFailures=[],this.m_eWebLogonState=0,this.m_ClientLogoffHandler=(t=757,n=v.c,o=function(e){34==e.Body().eresult()&&(i.m_eWebLogonState=15,i.m_bWaitingToReconnect=!0)},s.AddCallback(t,n,function(e){o(m.InitFromMsg(n,e))})),this.m_CMInterface=e,this.m_CMInterface.AddOnDisconnectCallback(this.OnCMDisconnected),this.m_CMInterface.AddOnLogonCallback(this.OnCMLoggedOn)}return Object.defineProperty(e.prototype,"web_logon_state",{get:function(){return this.m_eWebLogonState},enumerable:!0,configurable:!0}),e.prototype.BIsInInitialConnect=function(){return 1==this.m_eWebLogonState||5==this.m_eWebLogonState},e.prototype.BIsWaitingToReconnect=function(){return this.m_bWaitingToReconnect},e.prototype.BWillAutoReconnect=function(){return void 0!==this.m_iTimeoutRetryLogon},e.prototype.ClearRetryTimeout=function(){this.m_iTimeoutRetryLogon&&(window.clearTimeout(this.m_iTimeoutRetryLogon),this.m_iTimeoutRetryLogon=void 0)},e.prototype.GetMSUntilNextReconnectAttempt=function(){return this.m_dtNextLogonAttempt?Math.max(0,this.m_dtNextLogonAttempt.getTime()-(new Date).getTime()):0},e.prototype.ReconnectNow=function(){this.m_bWaitingToReconnect&&(this.m_rgdtRecentFailures=[],this.RetryLogin())},e.prototype.OnCMDisconnected=function(e){if(13!=this.m_eWebLogonState&&14!=this.m_eWebLogonState&&15!=this.m_eWebLogonState)if(this.m_bForcedDisconnect)this.RetryLogin();else{for(;24<=this.m_rgdtRecentFailures.length;)this.m_rgdtRecentFailures.shift();if(this.m_rgdtRecentFailures.push(new Date),this.m_bConnectSucceeded&&!this.m_CMInterface.session.m_bWaitingForLogonResponse){var t=this.m_CMInterface.session.m_eResultLogonSuccess;this.m_eWebLogonState=1!=t?this.m_bEverLoggedOn?6:8:10}else this.m_eWebLogonState=this.m_bEverConnected?10:2;this.m_cConsecutiveConnectionFailures++,e||this.RescheduleLogin()}},e.prototype.OnCMLoggedOn=function(){this.m_eWebLogonState=9,this.m_bEverLoggedOn=!0,this.m_cConsecutiveConnectionFailures=0},e.prototype.PerformInitialLogon=function(e){e.token_use_id&&(window.sessionStorage.getItem("token_use_id")==e.token_use_id?(console.log("In-page token has already been consumed, requesting a new token."),e=null):window.sessionStorage.setItem("token_use_id",e.token_use_id)),this.PerformWebLogOn(e)},e.prototype.PerformWebLogOn=function(e){var t=this;if(this.m_bConnectSucceeded=!1,this.m_eWebLogonState=this.m_bEverConnected?3:1,e&&e.steamid&&e.token&&e.account_name){G.d.steamid=e.steamid,G.d.accountid=new D.a(e.steamid).GetAccountID(),G.d.account_name=e.account_name;var n=m.Init(v.d,5514);n.Body().set_account_name(e.account_name),n.Body().set_protocol_version(65580),n.Body().set_qos_level(2),n.Body().set_client_os_type(4294966596),n.Body().set_ui_mode(4),n.Body().set_chat_mode(2),n.Body().set_web_logon_nonce(e.token),n.Hdr().set_steamid(e.steamid),this.m_CMInterface.session.m_nSessionIDLast&&n.Body().set_last_session_id(this.m_CMInterface.session.m_nSessionIDLast>>>0),n.Body().set_client_instance_id(this.m_CMInterface.session.m_nClientInstanceID),this.m_CMInterface.Connect().then(function(){G.d.logged_in=!0,t.m_bConnectSucceeded=!0,t.m_bEverConnected=!0,t.m_eWebLogonState=t.m_bEverLoggedOn?7:5,t.m_CMInterface.Send(n)})}else this.RetryLogin()},e.prototype.RetryLogin=function(){var o=this;if(this.m_bWaitingToReconnect=!1,this.ClearRetryTimeout(),this.m_CMInterface.BIsConnected()&&this.m_bConnectSucceeded)return this.m_bForcedDisconnect=!0,void this.m_CMInterface.ForceDisconnect();Object(I.a)(11!=this.m_eWebLogonState,"RetryLogin called while request in flight"),11!=this.m_eWebLogonState&&(this.m_eWebLogonState=11,this.m_CMInterface.Connect(),C.a.get(G.a.TOKEN_URL,{method:"POST"}).then(function(e){var t=e.data;if(t.logged_in&&t.steamid&&t.token&&t.account_name){var n=new D.a(t.steamid);o.m_bEverLoggedOn&&o.m_CMInterface.steamid.GetAccountID()!=n.GetAccountID()?(o.m_eWebLogonState=14,o.m_CMInterface.ForceDisconnect()):o.PerformWebLogOn(t)}else o.m_eWebLogonState=13,o.m_CMInterface.ForceDisconnect()}).catch(function(e){o.m_eWebLogonState=12,o.RescheduleLogin()}))},e.prototype.RescheduleLogin=function(){for(var e=this,t=0,n=0,o=new Date,i=0,r=this.m_rgdtRecentFailures;i<r.length;i++){var a=r[i];a.getTime()>=o.getTime()-6e4?t++:a.getTime()>=o.getTime()-36e5&&n++}n+=t;var s=this.m_cConsecutiveConnectionFailures+t;if(s<=2)this.RetryLogin();else if(s<=10&&n<=10){var c=5e3*(s-2);this.m_dtNextLogonAttempt=new Date((new Date).getTime()+c),this.m_bWaitingToReconnect=!0,this.ClearRetryTimeout(),this.m_iTimeoutRetryLogon=window.setTimeout(function(){e.m_dtNextLogonAttempt=void 0,e.RetryLogin()},c)}else this.m_bWaitingToReconnect=!0},R.c([d.observable],e.prototype,"m_eWebLogonState",void 0),R.c([T.a],e.prototype,"OnCMDisconnected",null),R.c([T.a],e.prototype,"OnCMLoggedOn",null),e}(),W=n("i8i4"),z=n("+9/f");(V=F||(F={}))[V.Chat=0]="Chat",V[V.Notification=1]="Notification",V[V.Error=2]="Error";var q,K,Y,J,X=function(){return function(){}}(),Q=new(function(){function e(e){this.init(e)}return e.prototype.init=function(e){this.bValid=e.bValid,this.stream=e.stream,this.name=e.name,this.appID=e.appID,this.link=e.link,this.linkName=e.linkName,this.tabIcon=e.tabIcon,this.offlineClassName=e.offlineClassName},R.c([d.observable],e.prototype,"bValid",void 0),R.c([d.observable],e.prototype,"stream",void 0),R.c([d.observable],e.prototype,"name",void 0),R.c([d.observable],e.prototype,"appID",void 0),R.c([d.observable],e.prototype,"link",void 0),R.c([d.observable],e.prototype,"linkName",void 0),R.c([d.observable],e.prototype,"tabIcon",void 0),R.c([d.observable],e.prototype,"offlineClassName",void 0),e}())({bValid:!1,stream:{0:"#Broadcast_EnglishMain"},name:"",appID:0,link:"",linkName:"",tabIcon:"",offlineClassName:""});(K=q||(q={}))[K.Terminator=0]="Terminator",K[K.MatchStarted=1]="MatchStarted",K[K.GameStateChanged=2]="GameStateChanged",K[K.TowerDeath=3]="TowerDeath",K[K.BarracksDeath=4]="BarracksDeath",K[K.AncientDeath=5]="AncientDeath",K[K.RoshanDeath=6]="RoshanDeath",K[K.HeroDeath=7]="HeroDeath",K[K.TeamFight=8]="TeamFight",K[K.FirstBlood=9]="FirstBlood",(J=Y||(Y={}))[J.INIT=0]="INIT",J[J.WAIT_FOR_PLAYERS_TO_LOAD=1]="WAIT_FOR_PLAYERS_TO_LOAD",J[J.HERO_SELECTION=2]="HERO_SELECTION",J[J.STRATEGY_TIME=3]="STRATEGY_TIME",J[J.PRE_GAME=4]="PRE_GAME",J[J.GAME_IN_PROGRESS=5]="GAME_IN_PROGRESS",J[J.POST_GAME=6]="POST_GAME",J[J.DISCONNECT=7]="DISCONNECT",J[J.TEAM_SHOWCASE=8]="TEAM_SHOWCASE",J[J.CUSTOM_GAME_SETUP=9]="CUSTOM_GAME_SETUP",J[J.WAIT_FOR_MAP_TO_LOAD=10]="WAIT_FOR_MAP_TO_LOAD",J[J.LAST=11]="LAST";var Z=n("Gp1o"),$=n("oh5H"),ee="fef49e7fa7e1997310d705b2a6158ff8dc1cdfeb";function te(e,t){var n=".jpg";"0000000000000000000000000000000000000000"===e&&(e=ee),44==e.length&&(n=e.substr(-4),e=e.substr(0,40));var o=_.b.MEDIA_CDN_COMMUNITY_URL+"images/avatars/";return o+=e.substr(0,2)+"/"+e,t&&(o+=t),o+=n}function ne(e){var t="offline";return e.is_golden&&e.is_online?t="golden":e.is_ingame?t="ingame":e.m_broadcastAccountId?t="watchingbroadcast":e.is_online&&(t="online"),e.is_awayOrSnooze&&(t+=" awayOrSnooze"),t}var oe=function(){function e(e){this.m_bInitialized=!1,this.m_ePersonaState=0,this.m_unGamePlayedAppID=0,this.m_gameid="0",this.m_unPersonaStateFlags=0,this.m_strPlayerName="",this.m_strAvatarHash=ee,this.m_rtLastSeenOnline=0,this.m_strGameExtraInfo="",this.m_unGameServerIP=0,this.m_unGameServerPort=0,this.m_game_lobby_id="",this.m_mapRichPresence=d.observable.map(),this.m_bNameInitialized=!1,this.m_bStatusInitialized=!1,this.m_steamid=e}return e.prototype.Reset=function(){this.m_ePersonaState=0,this.m_unGamePlayedAppID=0,this.m_gameid="0",this.m_strGameExtraInfo="",this.m_unGameServerIP=0,this.m_unGameServerPort=0,this.m_game_lobby_id="",this.m_mapRichPresence.clear(),this.m_broadcastId=void 0,this.m_broadcastAccountId=void 0,this.m_broadcastAppId=void 0,this.m_broadcastViewerCount=void 0,this.m_strBroadcastTitle=void 0},e.prototype.UpdateFromMessage=function(e,t){if(0!=(1&e)&&(this.m_bStatusInitialized=!0,this.m_ePersonaState=t.persona_state()||0,0!=this.m_ePersonaState?(this.m_unGamePlayedAppID=t.game_played_app_id()||0,this.m_gameid=t.gameid()||"0",this.m_strGameExtraInfo=t.game_name()||"",this.m_unGameServerIP=t.game_server_ip()||0,this.m_unGameServerPort=t.game_server_port()||0,this.m_game_lobby_id=t.game_lobby_id()||""):this.Reset()),0!=(2&e)&&(this.m_bNameInitialized=!0,this.m_strPlayerName=t.player_name()||""),0!=(64&e)&&(this.m_rtLastSeenOnline=t.last_seen_online()||t.last_logoff()||0),0!=(16&e)){var n=t.avatar_hash(),o=!0;if(n){for(var i=0;i<n.length&&o;i++)o=!n[i];this.m_strAvatarHash=o?ee:p(n)}}if(void 0!==t.persona_state_flags()&&(this.m_unPersonaStateFlags=t.persona_state_flags()),0!=(4096&e)){this.m_mapRichPresence.clear();for(var r=0,a=t.rich_presence();r<a.length;r++){var s=a[r];this.m_mapRichPresence.set(s.key().toLowerCase(),s.value())}}if(0!=(8192&e)&&(this.m_broadcastId=t.broadcast_id()),0!=(16384&e)){var c=D.a.InitFromAccountID(t.watching_broadcast_accountid()),l=c.ConvertTo64BitString();"public"!=_.b.WEB_UNIVERSE||Q.stream[l]?(this.m_broadcastAccountId=t.watching_broadcast_accountid(),this.m_broadcastAppId=t.watching_broadcast_appid(),this.m_broadcastViewerCount=t.watching_broadcast_viewers(),this.m_strBroadcastTitle=t.watching_broadcast_title(),c.BIsValid()&&Q.bValid&&(this.m_broadcastAppId||(this.m_broadcastAppId=Q.appID),this.m_strBroadcastTitle=Q.name)):(this.m_broadcastAccountId=0,this.m_broadcastAppId=0,this.m_broadcastViewerCount=0,this.m_strBroadcastTitle="")}this.m_bNameInitialized&&this.m_bStatusInitialized&&(this.m_bInitialized=!0)},e.prototype.GetAccountID=function(){return this.m_steamid.GetAccountID()},Object.defineProperty(e.prototype,"is_online",{get:function(){return 0!=this.m_ePersonaState&&7!=this.m_ePersonaState},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"is_ingame",{get:function(){return this.is_online&&(0!=this.m_unGamePlayedAppID||"0"!=this.m_gameid)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"is_watchingbroadcast",{get:function(){return!!this.m_broadcastAccountId},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"is_in_nonsteam_game",{get:function(){return 0==this.m_unGamePlayedAppID&&"0"!=this.m_gameid},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"is_in_joinable_game",{get:function(){return this.has_joinable_game_flag||this.is_in_valid_lobby||this.has_server_ip},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"has_joinable_game_flag",{get:function(){return 0!=(2&this.m_unPersonaStateFlags)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"is_in_valid_lobby",{get:function(){return this.m_game_lobby_id&&"0"!=this.m_game_lobby_id},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"has_server_ip",{get:function(){return 0!=this.m_unGameServerIP},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"is_awayOrSnooze",{get:function(){return 3==this.m_ePersonaState||4==this.m_ePersonaState},enumerable:!0,configurable:!0}),e.prototype.HasStateFlag=function(e){return 0!=(this.m_unPersonaStateFlags&e)},Object.defineProperty(e.prototype,"last_seen_online",{get:function(){return this.m_rtLastSeenOnline},enumerable:!0,configurable:!0}),e.prototype.ClearStateOnDisconnect=function(){0!=this.m_ePersonaState&&this.Reset()},Object.defineProperty(e.prototype,"is_golden",{get:function(){return this.HasStateFlag(4)},enumerable:!0,configurable:!0}),e.prototype.GetCurrentGameName=function(){return this.m_strGameExtraInfo?this.m_strGameExtraInfo:this.m_unGamePlayedAppID?le.GetAppInfo(this.m_unGamePlayedAppID).m_strName:""},e.prototype.GetCurrentGameIconURL=function(){return this.m_unGamePlayedAppID?le.GetAppInfo(this.m_unGamePlayedAppID).icon_url:""},e.prototype.GetCurrentGameLogoURL=function(){return this.m_unGamePlayedAppID?le.GetAppInfo(this.m_unGamePlayedAppID).logo_url:""},e.prototype.GetBroadcastGameLogoURL=function(){return this.m_broadcastAppId?le.GetAppInfo(this.m_broadcastAppId).logo_url:""},e.prototype.BIsAppInfoReady=function(){return!this.m_unGamePlayedAppID||le.GetAppInfo(this.m_unGamePlayedAppID).m_bInitialized},e.prototype.HasCurrentGameRichPresence=function(){return this.m_mapRichPresence.has("steam_display")},e.prototype.GetCurrentGameRichPresence=function(){if(this.HasCurrentGameRichPresence()){var e=le.GetRichPresenceLoc(this.m_unGamePlayedAppID);if(e){var t=this.m_mapRichPresence.get("steam_display");return e.Localize(t,this.m_mapRichPresence)}}return""},e.prototype.GetOfflineStatusUpdateRate=function(){if(0==this.last_seen_online)return 3e4;var e=1e3,t=le.CMInterface.GetServerRTime32()-this.last_seen_online;return e*=86400<t?3600:7200<t?60:15},e.prototype.GetOfflineStatusTime=function(){if(0==this.last_seen_online)return Object($.b)("#PersonaStateOffline");var e=this.GetOfflineStatusUpdateRate();(!_.b.IN_MOBILE||e<=60)&&Object(Z.a)(e);var t=le.CMInterface.GetServerRTime32()-this.last_seen_online;return t<60?Object($.b)("#PersonaStateLastSeen_JustNow"):Object($.b)("#PersonaStateLastSeen",Object($.e)(t))},e.prototype.GetLocalizedOnlineStatus=function(){switch(this.m_ePersonaState){case 0:case 7:return this.GetOfflineStatusTime();case 1:return Object($.b)("#PersonaStateOnline");case 2:return Object($.b)("#PersonaStateBusy");case 3:return Object($.b)("#PersonaStateAway");case 4:return Object($.b)("#PersonaStateSnooze");case 5:return Object($.b)("#PersonaStateLookingToTrade");case 6:return Object($.b)("#PersonaStateLookingToPlay");default:return""}},Object.defineProperty(e.prototype,"has_public_party_beacon",{get:function(){return!(!this.m_mapRichPresence.has("__beacon")||!this.is_ingame)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"player_group",{get:function(){return this.m_mapRichPresence.has("steam_player_group")?this.m_mapRichPresence.get("steam_player_group"):""},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"player_group_size",{get:function(){return this.m_mapRichPresence.has("steam_player_group_size")?Number.parseInt(this.m_mapRichPresence.get("steam_player_group_size")):0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"online_state",{get:function(){return this.is_online?this.is_golden?"golden":this.is_ingame?"in-game":this.m_broadcastAccountId?"watchingbroadcast":"online":"offline"},enumerable:!0,configurable:!0}),e.prototype.BHasAvatarSet=function(){return this.m_strAvatarHash!=ee},Object.defineProperty(e.prototype,"avatar_url",{get:function(){return te(this.m_strAvatarHash)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"avatar_url_medium",{get:function(){return te(this.m_strAvatarHash,"_medium")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"avatar_url_full",{get:function(){return te(this.m_strAvatarHash,"_full")},enumerable:!0,configurable:!0}),e.SortStatusComparator=function(e,t,n){if(t.has_public_party_beacon){if(!n.has_public_party_beacon)return-1}else{if(n.has_public_party_beacon)return 1;if(t.is_ingame){if(!n.is_ingame)return-1;if(!e)return 0;if(t.is_awayOrSnooze){if(!n.is_awayOrSnooze)return 1}else if(n.is_awayOrSnooze)return-1}else if(n.is_ingame)return 1}if(t.is_online){if(!n.is_online)return-1}else if(n.is_online)return 1;if(e)if(t.is_awayOrSnooze){if(!n.is_awayOrSnooze)return 1}else if(n.is_awayOrSnooze)return-1;return 0},R.c([d.observable],e.prototype,"m_bInitialized",void 0),R.c([d.observable],e.prototype,"m_ePersonaState",void 0),R.c([d.observable],e.prototype,"m_unGamePlayedAppID",void 0),R.c([d.observable],e.prototype,"m_gameid",void 0),R.c([d.observable],e.prototype,"m_unPersonaStateFlags",void 0),R.c([d.observable],e.prototype,"m_strPlayerName",void 0),R.c([d.observable],e.prototype,"m_strAvatarHash",void 0),R.c([d.observable],e.prototype,"m_rtLastSeenOnline",void 0),R.c([d.observable],e.prototype,"m_strGameExtraInfo",void 0),R.c([d.observable],e.prototype,"m_unGameServerIP",void 0),R.c([d.observable],e.prototype,"m_unGameServerPort",void 0),R.c([d.observable],e.prototype,"m_game_lobby_id",void 0),R.c([d.observable],e.prototype,"m_broadcastId",void 0),R.c([d.observable],e.prototype,"m_broadcastAccountId",void 0),R.c([d.observable],e.prototype,"m_broadcastAppId",void 0),R.c([d.observable],e.prototype,"m_broadcastViewerCount",void 0),R.c([d.observable],e.prototype,"m_strBroadcastTitle",void 0),R.c([d.computed],e.prototype,"has_public_party_beacon",null),R.c([d.computed],e.prototype,"avatar_url",null),R.c([d.computed],e.prototype,"avatar_url_medium",null),R.c([d.computed],e.prototype,"avatar_url_full",null),e}(),ie=function(){function e(e){this.m_bInitialized=!1,this.m_unAppID=e}return Object.defineProperty(e.prototype,"appid",{get:function(){return this.m_unAppID},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"is_initialized",{get:function(){return this.m_bInitialized},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"is_valid",{get:function(){return this.m_bInitialized&&!!this.m_strName},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"name",{get:function(){return this.m_strName},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"header_image_url",{get:function(){return _.b.MEDIA_CDN_URL+"steam/apps/"+this.m_unAppID+"/header.jpg"},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"icon_url",{get:function(){return this.BuildAppURL(this.m_strIconURL,"061818254b2c99ac49e6626adb128ed1282a392f")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"logo_url",{get:function(){return this.BuildAppURL(this.m_strLogoURL,"338200c5d6c4d9bdcf6632642a2aeb591fb8a5c2.gif")},enumerable:!0,configurable:!0}),e.prototype.BuildAppURL=function(e,t){return e?_.b.MEDIA_CDN_COMMUNITY_URL+"images/apps/"+this.appid+"/"+e+".jpg":te(t)},R.c([d.observable],e.prototype,"m_bInitialized",void 0),R.c([d.observable],e.prototype,"m_strName",void 0),R.c([d.observable],e.prototype,"m_strIconURL",void 0),R.c([d.observable],e.prototype,"m_strLogoURL",void 0),R.c([d.observable],e.prototype,"m_dtUpdatedFromServer",void 0),R.c([d.computed],e.prototype,"icon_url",null),R.c([d.computed],e.prototype,"logo_url",null),e}(),re=function(){function e(e){this.m_nLastUpdated=0,this.m_mapLanguages=d.observable.map(),this.m_fetching=null,this.m_appid=e}return e.prototype.GetAppID=function(){return this.m_appid},e.prototype.GetTokenList=function(e){return this.m_mapLanguages.has(e)?this.m_mapLanguages.get(e):null},e.prototype.Localize=function(e,t){var n=_.b.LANGUAGE;return ae(e,this.GetTokenList(n),"english"!=n?this.GetTokenList("english"):null,this.m_appid,t)},e.prototype.SubstituteParams=function(e,t){var n=_.b.LANGUAGE;return se(e,this.GetTokenList(n),"english"!=n?this.GetTokenList("english"):null,this.m_appid,t)},e}();function ae(e,t,n,o,i){if(!e.startsWith("#"))return console.log("Token doesn't start with #:",e),"";var r=e;e=e.toLowerCase();var a="";if(t&&t.has(e)&&(a=t.get(e)),!a&&n&&n.has(e)&&(a=n.get(e)),a)a=se(a,t,n,o,i);else if((t||n)&&console.log("No loc found for appid",o,r,"Tokens:",t,"Fallback:",n),t&&1!=_.b.EUNIVERSE)return e;return a}function se(e,t,n,o,i){var r=e.match(/{[A-za-z0-9_%#:]+}/g);if(r)for(var a=0,s=r;a<s.length;a++){var c=s[a],l=ae(ce(c.slice(1,-1),i),t,n,o,i);if(!l)return"";e=e.replace(c,l)}return e=ce(e,i)}function ce(e,t){var n=e.match(/%[A-Za-z0-9_:]+%/g);if(n)for(var o=0,i=n;o<i.length;o++){var r=i[o],a=r.slice(1,-1).toLowerCase(),s=t.get(a);null==s?console.log("No rich presence found for",a):e=e.replace(r,s)}return e}var le=new(function(){function e(){this.m_mapAppInfo=new Map,this.m_mapRichPresenceLoc=d.observable.map(),this.m_cAppInfoRequestsInFlight=0,this.m_setPendingAppInfo=new Set,this.m_CacheStorage=null,this.m_fnCallbackOnAppInfoLoaded=new N}return e.prototype.Init=function(e){this.m_CMInterface=e,_.b.IN_CLIENT&&void 0!==SteamClient.Apps&&SteamClient.Apps.RegisterForAppOverviewChanges(this.OnAppOverviewChange)},e.prototype.BHavePendingAppInfoRequests=function(){return 0<this.m_setPendingAppInfo.size||0<this.m_cAppInfoRequestsInFlight},Object.defineProperty(e.prototype,"CMInterface",{get:function(){return this.m_CMInterface},enumerable:!0,configurable:!0}),e.prototype.RegisterCallbackOnLoad=function(e){if(!this.BHavePendingAppInfoRequests())return Object(I.a)(!1,"Registering for callback on appinfo load, but nothing queued"),void e();this.m_fnCallbackOnAppInfoLoaded.Register(e)},e.prototype.GetAppInfo=function(e){Object(I.a)(this.m_CMInterface,"CAppInfoStore.GetAppInfo called before Init"),Object(I.a)(e,"Requesting App ID 0, which won't ever exist");var t=this.m_mapAppInfo.get(e);return t||(t=new ie(e),this.m_mapAppInfo.set(e,t),this.QueueAppInfoRequest(e)),t},e.prototype.QueueAppInfoRequest=function(e){var t=this;return e?(this.m_setPendingAppInfo.size||(this.m_PendingAppInfoPromise=new Promise(function(e){return t.m_PendingAppInfoResolve=e}),SetBackgroundTimeout(function(){return t.FlushPendingAppInfo()},25)),this.m_setPendingAppInfo.add(e),this.m_PendingAppInfoPromise):Promise.resolve()},e.prototype.FlushPendingAppInfo=function(){return R.b(this,void 0,void 0,function(){var t,n;return R.e(this,function(e){switch(e.label){case 0:return t=this.m_PendingAppInfoResolve,n=Array.from(this.m_setPendingAppInfo),this.m_PendingAppInfoPromise=void 0,this.m_PendingAppInfoResolve=void 0,this.m_setPendingAppInfo.clear(),[4,this.LoadAppInfoBatch(n)];case 1:return e.sent(),t(),[2]}})})},e.prototype.LoadAppInfoBatch=function(i){return R.b(this,void 0,void 0,function(){var t,n,o;return R.e(this,function(e){switch(e.label){case 0:return this.m_cAppInfoRequestsInFlight++,[4,this.LoadAppInfoBatchFromLocalCache(i)];case 1:return(t=e.sent()).length?(console.log("Loading batch of App Info from Steam: ",t),[4,this.m_CMInterface.WaitUntilLoggedOn()]):[3,4];case 2:return e.sent(),(n=m.Init(z.b)).Body().set_appids(t),[4,z.c.GetApps(this.m_CMInterface.GetServiceTransport(),n)];case 3:1==(o=e.sent()).GetEResult()?this.OnGetAppsResponse(o):console.error("Error when calling CommunityService.GetApps: EResult="+o.GetEResult()+", rgUncachedAppIDs:",t),e.label=4;case 4:return 0==--this.m_cAppInfoRequestsInFlight&&0==this.m_setPendingAppInfo.size&&(this.m_fnCallbackOnAppInfoLoaded.Dispatch(),this.m_fnCallbackOnAppInfoLoaded.ClearAllCallbacks()),[2]}})})},e.prototype.OnGetAppsResponse=function(e){for(var t=[],n=0,o=e.Body().apps();n<o.length;n++){var i=o[n],r=this.m_mapAppInfo.get(i.appid());Object(I.a)(r,"Got AppInfo response for unrequested AppID: "+i.appid()),r&&(this.DeserializeAppInfoFromMessage(r,i),t.push(r))}this.SaveAppInfoBatchToLocalCache(t)},e.prototype.OnAppOverviewChange=function(e,t){for(var n=0,o=e;n<o.length;n++){var i=o[n],r=this.m_mapAppInfo.get(i.appid);r||(r=new ie(i.appid),this.m_mapAppInfo.set(i.appid,r)),this.DeserializeAppInfoFromAppOverview(r,i)}},e.prototype.EnsureAppInfoForAppIDs=function(t){return R.b(this,void 0,void 0,function(){var n=this;return R.e(this,function(e){return t.forEach(function(e){var t=n.m_mapAppInfo.get(e);t||(t=new ie(e),n.m_mapAppInfo.set(e,t),n.QueueAppInfoRequest(e))}),void 0!==this.m_PendingAppInfoPromise?[2,this.m_PendingAppInfoPromise]:[2,Promise.resolve()]})})},e.prototype.SetCacheStorage=function(e){this.m_CacheStorage=e},e.prototype.GetCacheKeyForAppID=function(e){return"APPINFO_"+e},e.prototype.LoadAppInfoBatchFromLocalCache=function(a){return R.b(this,void 0,void 0,function(){var i,t,n,o,r=this;return R.e(this,function(e){switch(e.label){case 0:return this.m_CacheStorage?(console.log("Loading batch of App Info from Local Cache: ",a),i=new Date((new Date).getTime()-12096e5),t=function(o){return R.b(r,void 0,void 0,function(){var t,n;return R.e(this,function(e){switch(e.label){case 0:return[4,this.m_CacheStorage.GetObject(this.GetCacheKeyForAppID(o))];case 1:return(t=e.sent())?(n=this.m_mapAppInfo.get(o),Object(I.a)(n,"Didn't find AppInfo in our map when loading from cache but it should've been there?"),n?(this.DeserializeAppInfoFromCacheObject(n,t),n.m_bInitialized?n.m_dtUpdatedFromServer<i?[2,o]:[2,null]:(console.warn("Failed to deserialize cached App Info: ",o,t),[2,o])):[2,o]):[2,o]}})})},n=a.map(function(e){return t(e)}),[4,Promise.all(n)]):[2,a];case 1:return o=e.sent(),[2,o.filter(function(e){return null!==e})]}})})},e.prototype.SaveAppInfoBatchToLocalCache=function(r){return R.b(this,void 0,void 0,function(){var t,n,o,i;return R.e(this,function(e){if(!this.m_CacheStorage)return[2];for(console.log("Saving batch of App Info to Local Cache: ",r.map(function(e){return e.appid})),t=0,n=r;t<n.length;t++)o=n[t],(i=this.SerializeAppInfoToCacheObject(o))&&this.m_CacheStorage.StoreObject(this.GetCacheKeyForAppID(o.appid),i);return[2]})})},e.prototype.DeserializeAppInfoFromMessage=function(e,t){e.m_bInitialized=!0,e.m_strName=t.name(),e.m_strIconURL=t.icon(),e.m_strLogoURL=t.logo(),e.m_dtUpdatedFromServer=new Date},e.prototype.DeserializeAppInfoFromAppOverview=function(e,t){t.strLogoHash&&1073741824!=t.appType?(e.m_bInitialized=!0,e.m_strName=t.displayName,e.m_strIconURL=t.strIconHash,e.m_strLogoURL=t.strLogoHash,e.m_dtUpdatedFromServer=new Date):e.m_bInitialized=!1},e.prototype.DeserializeAppInfoFromCacheObject=function(e,t){try{e.m_strName=t.strName,e.m_strIconURL=t.strIconURL,e.m_strLogoURL=t.strLogoURL,e.m_dtUpdatedFromServer=new Date(t.strUpdatedFromServer),e.m_bInitialized=!0}catch(e){}},e.prototype.SerializeAppInfoToCacheObject=function(e){return Object(I.a)(e.m_bInitialized,"Attempting to serialize an uninitialized AppInfo object for caching!"),e.m_bInitialized?{strName:e.m_strName,strIconURL:e.m_strIconURL,strLogoURL:e.m_strLogoURL,strUpdatedFromServer:e.m_dtUpdatedFromServer.toJSON()}:null},e.prototype.Localize=function(e,t,n){var o=this.GetRichPresenceLoc(e);return o?o.Localize(t,n):1!=_.b.EUNIVERSE?(console.log("Unable to find app localization information for app "+e+" token "+t+", this may not have had a chance to load yet"),t):""},e.prototype.GetRichPresenceLoc=function(e){if(this.m_mapRichPresenceLoc.has(e.toString())){var t=this.m_mapRichPresenceLoc.get(e.toString());return t.m_nLastUpdated+72e5<Date.now()&&this.QueueRichPresenceLocRequest(t),t}var n=new re(e);return this.m_mapRichPresenceLoc.set(e.toString(),n),this.QueueRichPresenceLocRequest(n),n},e.prototype.GetRichPresenceLocAsync=function(e){var t=this.GetRichPresenceLoc(e);return t.m_nLastUpdated?Promise.resolve(t):t.m_fetching},e.prototype.OnRichPresenceLocUpdate=function(e,t){e.m_nLastUpdated=Date.now();for(var n=0,o=t;n<o.length;n++){var i=o[n],r=i.language(),a=e.m_mapLanguages.get(r);a?a.clear():(e.m_mapLanguages.set(r,new Map),a=e.m_mapLanguages.get(r));for(var s=0,c=i.tokens();s<c.length;s++){var l=c[s];a.set(l.name().toLowerCase(),l.value())}}},e.prototype.QueueRichPresenceLocRequest=function(t){var n=this;return t.m_fetching||(t.m_fetching=this.m_CMInterface.WaitUntilLoggedOn().then(function(){var e=m.Init(z.a);return e.Body().set_appid(t.GetAppID()),e.Body().set_language(_.b.LANGUAGE),z.c.GetAppRichPresenceLocalization(n.m_CMInterface.GetServiceTransport(),e)}).then(function(e){return t.m_fetching=null,1!=e.GetEResult()?Promise.reject():(n.OnRichPresenceLocUpdate(t,e.Body().token_lists()),Promise.resolve(t))}),t.m_fetching.catch(function(){t.m_fetching=null})),t.m_fetching},R.c([d.action],e.prototype,"OnGetAppsResponse",null),R.c([d.action.bound],e.prototype,"OnAppOverviewChange",null),R.c([d.action],e.prototype,"OnRichPresenceLocUpdate",null),e}()),pe=n("RBVV"),ue=function(){function e(){}return e.prototype.OnTabActivate=function(){this.m_msLastActive=performance.now(),this.InternalOnTabActivate()},e.prototype.GetTimeLastActivate=function(){return this.m_msLastActive||0},e.prototype.IsChatRoom=function(){return!1},e.prototype.IsFriendChat=function(){return!1},e}(),me=0,de=function(){function e(e){this.m_vecTabs=d.observable.array(null,{deep:!1}),this.m_id=me++,this.m_browserContext=e}return e.prototype.GetBrowserContext=function(){return this.m_browserContext},e.prototype.GetTitle=function(){return this.m_activeTab?2==this.tabCount?Object($.b)("#WindowTitle_ChatTabTitle",this.m_activeTab.GetTabName()):2<this.tabCount?Object($.b)("#WindowTitle_ChatTabTitlePlural",this.m_activeTab.GetTabName(),this.tabCount-1):this.m_activeTab.GetTabName():""},e.prototype.OnWindowFocus=function(){this.m_activeTab&&this.m_activeTab.OnTabFocus()},Object.defineProperty(e.prototype,"tabs",{get:function(){return this.m_vecTabs},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"tabCount",{get:function(){return this.m_vecTabs.length},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"activeTab",{get:function(){return this.m_activeTab},enumerable:!0,configurable:!0}),e.prototype.GetTabSetIdentifier=function(){return this.m_vecTabs.map(function(e){return e.GetUniqueID()}).join("_")},e.prototype.GetTabForChat=function(e){for(var t=0,n=this.m_vecTabs;t<n.length;t++){var o=n[t];if(o.IsTabForChat(e))return o}return null},e.prototype.GetTabByUniqueID=function(e){for(var t=0,n=this.m_vecTabs;t<n.length;t++){var o=n[t];if(o.GetUniqueID()==e)return o}return null},e.prototype.BHasTab=function(e){return-1!==this.m_vecTabs.indexOf(e)},e.prototype.AddTab=function(e){-1==this.m_vecTabs.indexOf(e)&&(this.m_vecTabs.push(e),!this.m_activeTab&&0<this.m_vecTabs.length&&(this.m_activeTab=this.m_vecTabs[0]))},e.prototype.ActivateTab=function(e){-1!=this.m_vecTabs.indexOf(e)?(this.activeTab&&this.activeTab!=e&&this.activeTab.OnTabDeactivate(),(this.m_activeTab=e).OnTabActivate(),this.Focus()):console.log("Tab not found")},e.prototype.ActivateNextTab=function(){var e=this.m_vecTabs.indexOf(this.m_activeTab);e=(e+1)%this.m_vecTabs.length,this.ActivateTab(this.m_vecTabs[e])},e.prototype.ActivatePreviousTab=function(){var e=this.m_vecTabs.indexOf(this.m_activeTab);e=(e+this.m_vecTabs.length-1)%this.m_vecTabs.length,this.ActivateTab(this.m_vecTabs[e])},e.prototype.DeactivateTab=function(e){-1!==this.m_vecTabs.indexOf(e)?this.activeTab&&this.activeTab===e&&(e.OnTabDeactivate(),this.m_activeTab=void 0):console.log("Tab not found")},e.prototype.RemoveTab=function(e){var t=this.m_vecTabs.indexOf(e);if(-1==t)return!1;var n=e&&e==this.m_activeTab;if(this.m_vecTabs.splice(t,1),n)if(this.m_vecTabs.length){for(var o=void 0,i=0,r=this.m_vecTabs;i<r.length;i++){var a=r[i];(!o||a.GetTimeLastActivate()>o.GetTimeLastActivate())&&(o=a)}this.m_activeTab=o||this.m_vecTabs[Math.max(t-1,0)]}else this.m_activeTab=void 0;return 0==this.m_vecTabs.length&&ci.UIStore.CloseTabSet(this),!0},e.prototype.MoveTabAfter=function(e,t){var n=this.m_vecTabs.indexOf(t);-1!=n&&this.MoveTabToIndex(e,n+1)},e.prototype.MoveTabToIndex=function(e,t){var n=this.m_vecTabs.indexOf(e);-1!=n&&M.f(this.m_vecTabs,n,Math.min(t,this.m_vecTabs.length-1))},e.prototype.Focus=function(){ci.UIStore.FocusTabSet(this)},e.prototype.OnPopupClosed=function(e){e&&ci.UIStore.SetSuppressBrowserContextBroadcasting(!0),ci.UIStore.OnTabSetClosed(this),this.CloseAllTabs(),e&&ci.UIStore.SetSuppressBrowserContextBroadcasting(!1)},e.prototype.CloseAllTabs=function(){this.m_activeTab=void 0;for(var e=0,t=this.m_vecTabs;e<t.length;e++){var n=t[e];ci.UIStore.CloseTab(this.m_browserContext,n,!0)}this.m_vecTabs.clear()},Object.defineProperty(e.prototype,"is_popup_active",{get:function(){return ci.UIStore.BIsTabSetActive(this)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"is_popup_visible",{get:function(){return ci.UIStore.BIsTabSetVisible(this)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"is_popup_focused",{get:function(){return ci.UIStore.BIsTabSetFocused(this)},enumerable:!0,configurable:!0}),e.prototype.Serialize=function(){for(var e=[],t=0,n=this.m_vecTabs;t<n.length;t++){var o=n[t];o.GetUniqueID().startsWith("br")||e.push(o.GetUniqueID())}return{tabs:e,active_tab:this.activeTab&&this.activeTab.GetUniqueID()}},R.c([d.observable],e.prototype,"m_id",void 0),R.c([d.observable],e.prototype,"m_activeTab",void 0),R.c([d.action],e.prototype,"AddTab",null),R.c([d.action],e.prototype,"ActivateTab",null),R.c([d.action],e.prototype,"ActivateNextTab",null),R.c([d.action],e.prototype,"ActivatePreviousTab",null),R.c([d.action],e.prototype,"DeactivateTab",null),R.c([d.action],e.prototype,"RemoveTab",null),R.c([d.action],e.prototype,"OnPopupClosed",null),R.c([d.action],e.prototype,"CloseAllTabs",null),e}(),he=n("J0bI"),_e=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return R.d(t,e),t.prototype.BIsExpired=function(){return ci.GetServerRTime32()>=this.m_rtTimeExpires},t.prototype.InitFromInviteLinkInfo=function(e){this.m_ulChatRoomGroupID=e.group_summary().chat_group_id(),this.m_ulChatID=e.chat_id();var t=new D.a(e.steamid_sender());t.BIsIndividualAccount()&&(this.m_unAccountIDInviter=t.GetAccountID()),this.m_rtTimeExpires=e.time_expires(),this.m_bIsBanned=e.banned(),this.m_rtKickExpires=e.time_kick_expire(),this.m_bValid=!0,this.m_bReady=!0},t.prototype.InitInvalid=function(){this.m_bValid=!1,this.m_bReady=!0},t.prototype.InitDirectInvite=function(e,t,n,o){void 0===n&&(n=!1),void 0===o&&(o=void 0),this.m_ulChatRoomGroupID=e,this.m_ulChatID=t,this.m_bIsBanned=n,this.m_rtKickExpires=o,this.m_rtTimeExpires=O.d,this.m_bValid=!0,this.m_bReady=!0},R.c([d.action],t.prototype,"InitFromInviteLinkInfo",null),R.c([d.action],t.prototype,"InitInvalid",null),R.c([d.action],t.prototype,"InitDirectInvite",null),t}(he.b),fe=function(){function e(e){this.m_mapInviteByCode=new Map,this.m_ChatStore=e}return e.prototype.JoinChatGroup=function(e,t,n){var o=new _e;return o.InitDirectInvite(e,t),this.AcceptInvite(o,n)},e.prototype.AcceptInvite=function(e,r){var a=this;null==r&&(r=ci.GetDefaultBrowserContext());var t=m.Init(pe.v);return t.Body().set_chat_group_id(e.GetChatRoomGroupID()),e.BIsInviteLink()&&t.Body().set_invite_code(e.GetInviteCode()),e.GetChatID()&&t.Body().set_chat_id(e.GetChatID()),pe.V.JoinChatRoomGroup(this.m_ChatStore.CMInterface.GetServiceTransport(),t).then(function(e){var t={result:e.GetEResult()};if(1==t.result){var n=a.m_ChatStore.AddJoinedChatRoomGroup(e.Body().state(),e.Body().user_chat_state());ci.UIStore.ShowAndOrActivateChatRoomGroup(r,n,!0);var o=e.Body().join_chat_id();if(n){var i=n.GetChatRoom(o);i&&i.StartVoiceChat()}}else 15==t.result&&(t.time=e.Body().time_expire());return t})},e.prototype.GetInviteFromCode=function(e){var t=this,n=this.m_mapInviteByCode.get(e);if(n||(n=new _e(e),this.m_mapInviteByCode.set(e,n)),!n.BIsReady()||!this.m_ChatStore.GetChatRoomGroup(n.GetChatRoomGroupID())){var o=m.Init(pe.p);o.Body().set_invite_code(e),pe.V.GetInviteLinkInfo(this.m_ChatStore.CMInterface.GetServiceTransport(),o).then(function(e){1==e.GetEResult()?(t.m_ChatStore.AddKnownChatRoomGroup(e.Body().group_summary(),e.Body().user_chat_group_state()),n.InitFromInviteLinkInfo(e.Body())):n.InitInvalid()})}return n},e.prototype.GetDirectInviteInfo=function(t,n,e){var o=this,i=new _e,r=this.m_ChatStore.GetChatRoomGroup(t);if(r&&r.GetChatRoom(n))i.InitDirectInvite(t,n);else{var a=m.Init(pe.o);a.Body().set_steamid_invitee(D.a.InitFromAccountID(e).ConvertTo64BitString()),a.Body().set_chat_group_id(t),a.Body().set_chat_id(n),pe.V.GetInviteInfo(this.m_ChatStore.CMInterface.GetServiceTransport(),a).then(function(e){if(1!=e.GetEResult()||!e.Body().group_summary().chat_group_id())return console.log("GetDirectInviteInfo: respose EResult "+e.GetEResult()),void i.InitInvalid();o.m_ChatStore.AddKnownChatRoomGroup(e.Body().group_summary(),null),i.InitDirectInvite(t,n,e.Body().banned(),e.Body().time_kick_expire())})}return i},e}();var ge=function(){function e(e,t,n,o,i,r){this.unAccountIDInviter=e,this.rtTimestamp=t,this.appID=n,this.connectString=o,this.lobbyID=r,this.bDismissed=i,this.bAccepted=!1}return e.prototype.AcceptGameInvite=function(){var e,t=D.a.InitFromAccountID(this.unAccountIDInviter);null!=this.lobbyID?e="steam://joinlobby/"+this.appID+"/"+this.lobbyID+"/"+t.ConvertTo64BitString():(e="steam://rungame/"+this.appID+"/"+t.ConvertTo64BitString(),void 0!==this.connectString&&(e+="/"+encodeURIComponent(this.connectString))),ci.OpenURLInBrowser(e,ai),this.bAccepted=!0,ci.ChatStore.GameInviteStore.RecordDismissTime(this)},e.prototype.DismissInvite=function(){this.bDismissed=!0,ci.ChatStore.GameInviteStore.RecordDismissTime(this)},Object.defineProperty(e.prototype,"bOld",{get:function(){return 21600<ci.GetServerRTime32()-this.rtTimestamp},enumerable:!0,configurable:!0}),R.c([d.observable],e.prototype,"bDismissed",void 0),R.c([d.observable],e.prototype,"bAccepted",void 0),R.c([d.action],e.prototype,"AcceptGameInvite",null),R.c([d.action],e.prototype,"DismissInvite",null),e}(),be={dismisstimes:{}},ve="GameInvites",Se=function(){function e(){this.m_mapGameInvites=new Map,this.m_mapDismissedInvites=d.observable.map(),this.m_mapInviteByCode=new Map}return e.prototype.Init=function(){var r=this;ci.SettingsStore.GetObjectFromLocalStorageWhenReady(ve,be).then(function(e){var t=new Date;for(var n in t.setDate(t.getDate()-14),r.m_mapDismissedInvites.clear(),e.dismisstimes){var o=parseInt(n),i=e.dismisstimes[n];new Date(1e3*i)<t||r.m_mapDismissedInvites.set(o,i)}})},e.prototype.RegisterGameInvite=function(e,t,n,o,i){var r=this.m_mapGameInvites.get(e);r||(r=new Map,this.m_mapGameInvites.set(e,r));var a=r.get(t);if(!a){var s=!1,c=this.m_mapDismissedInvites.get(e);c&&(s=t<=c),a=new ge(e,t,n,o,s,i),r.set(t,a),r.forEach(function(e){e.rtTimestamp<t&&e.DismissInvite()})}return a},e.prototype.RecordDismissTime=function(e){var t=this.m_mapDismissedInvites.get(e.unAccountIDInviter);t&&t>e.rtTimestamp||(this.m_mapDismissedInvites.set(e.unAccountIDInviter,e.rtTimestamp),this.WriteToLocalStorage())},e.prototype.WriteToLocalStorage=function(){ci.SettingsStore.StoreObjectInLocalStorage(ve,{dismisstimes:this.m_mapDismissedInvites})},e}(),ye=function(){function e(){this.bCollapsed=!1}return e.prototype.IsEmpty=function(){return!this.bCollapsed&&void 0===this.nDefaultWidth&&void 0===this.nDesiredWidth},e}(),Ce="ChatEmbeds",Ie=function(){function e(){this.m_mapEmbed=new d.ObservableMap}return e.prototype.Init=function(){var o=this;ci.SettingsStore.GetObjectFromLocalStorageWhenReady(Ce,{}).then(function(e){for(var t in o.m_mapEmbed.clear(),e){var n=new ye;Object.assign(n,e[t]),o.m_mapEmbed.set(t,n)}})},e.prototype.GetKey=function(e,t){return t+"_"+e},e.prototype.EvictOldestIfNecessary=function(){if(100<this.m_mapEmbed.size){var e=Array.from(this.m_mapEmbed.keys()).sort()[0];this.m_mapEmbed.delete(e)}},e.prototype.GetOrCreateEmbedData=function(e,t){var n=this.GetKey(e,t),o=this.m_mapEmbed.get(n);return o||((o=new ye).bCollapsed=!1),o},e.prototype.SaveEmbedData=function(e,t,n){n.IsEmpty()?this.m_mapEmbed.delete(this.GetKey(e,t)):this.m_mapEmbed.set(this.GetKey(e,t),n),this.EvictOldestIfNecessary(),this.WriteToLocalStorage()},e.prototype.WriteToLocalStorage=function(){ci.SettingsStore.StoreObjectInLocalStorage(Ce,this.m_mapEmbed)},e.prototype.GetCollapsedState=function(e,t){var n=this.m_mapEmbed.get(this.GetKey(e,t));return!(!n||!n.bCollapsed)},e.prototype.SetCollapsedState=function(e,t,n){var o=this.GetOrCreateEmbedData(e,t);o.bCollapsed=n,this.SaveEmbedData(e,t,o)},e.prototype.GetWidths=function(e,t){var n=this.m_mapEmbed.get(this.GetKey(e,t));if(n&&n.nDesiredWidth&&n.nDefaultWidth)return{nDesiredWidth:n.nDesiredWidth,nDefaultWidth:n.nDefaultWidth}},e.prototype.SetWidths=function(e,t,n,o){var i=this.GetOrCreateEmbedData(e,t);n==o?(delete i.nDefaultWidth,delete i.nDesiredWidth):(i.nDesiredWidth=n,i.nDefaultWidth=o),this.SaveEmbedData(e,t,i)},e}(),Ee=n("q1tI"),Oe=n.n(Ee),we=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return R.d(t,e),t.prototype.GetArgument=function(e,t){return void 0===t&&(t=!1),!e||t&&void 0===this.props.args[e]?this.props.args[""]:this.props.args[e]},t}(Ee.Component),Me=function(n){function e(e){var t=n.call(this,e)||this;return t.state={failedToRender:!1},t}return R.d(e,n),e.prototype.componentDidCatch=function(e,t){this.setState({failedToRender:!0})},e.prototype.render=function(){if(this.state.failedToRender)return this.props.bbcode;var e=this.props.bbcode;return!0!==this.props.bSkipTrimInput&&(e=e.trim()),this.props.parser.ParseBBCode(e,this.props.context)},e}(Ee.PureComponent);function De(e,t,n){if(void 0===n&&(n=0),2==t.type){var o=t.text.indexOf("="),i=t.text.indexOf(" ");if(-1!=i&&(-1==o||i<o)&&(o=i),0<o){t.tag=t.text.substr(0,o);var r=t.text.substr(o);t.args=function(e){if(!e||e.length<1)return{};var t={},n="",o="",i=0,r=0;"="==e[0]&&(i=2);var a=!1;for(r++;r<e.length;r++){var s=e[r],c=!0,l=!1;switch(i){case 0:if("="==s)return{};if(" "==s)continue;i=1;break;case 1:"="!=s&&" "!=s||a||(i=" "==s?0:2,c=!1);break;case 2:" "==s?(i=0,l=!(c=!1)):'"'==s?c=!(i=4):i=3;break;case 3:case 4:(" "==s&&4!=i&&!a||'"'==s&&4==i&&!a)&&(i=0,l=!(c=!1))}c&&("\\"!=s||a?(a=!1,1==i?n+=s:3==i||4==i?o+=s:Object(I.a)(!1,"Not expecting to accumulate buffer in state %u",i)):a=!0),l&&(t[n]=o,o=n="")}0!=i&&(t[n]=o);return t}(r)}else t.args={},t.tag=t.text}e.push(t);var a=new Pe;return a.type=n,a}function Te(e){for(var t=[],n=new Pe,o=!1,i=!1,r=0;r<e.length;r++){var a=e[r];switch(n.type){case 0:"["==a?(n.type=2,i=!0):(n.type=1,"\\"==a?o=!o:n.text+=a);break;case 2:case 3:i="/"==a&&i?(n.type=3,n.text="",!1):"["!=a||o?"]"!=a||o?"\\"==a?(n.text+=a,o=!o,!1):(n.text+=a,o=!1):(i&&n.ConvertMalformedNodeToText(),n=De(t,n),!1):(n.ConvertMalformedNodeToText(),n=De(t,n,2),!0);break;case 1:"["!=a||o?o="\\"==a?(o&&(n.text+=a),!o):(n.text+=a,!1):(n=De(t,n,2),i=!0)}}return 0!=n.type&&(2!=n.type&&3!=n.type||n.ConvertMalformedNodeToText(),t.push(n)),t}var Ge=function(){function e(e){this.m_dictComponents=e}return e.prototype.dictComponents=function(){return this.m_dictComponents},e.EscapeBBCode=function(e){return e.replace(/[\[\\]/g,"\\$&")},e.prototype.StripBBCode=function(e,t){for(var n="",o=0,i=Te(e.trim());o<i.length;o++){var r=i[o];1==r.type&&(n+=r.text)}return n},e}(),Re=function(t){function e(e){return t.call(this,e)||this}return R.d(e,t),e.prototype.ParseBBCode=function(e,t){var n=Te(e);return this.Parse_NotificationHandlers(n,t)},e.prototype.Parse_NotificationHandlers=function(e,t){for(var n=void 0,o=this.dictComponents(),i="",r=0,a=e;r<a.length;r++){var s=a[r];if(2==s.type)n||(n=[]),n.push(s);else if(3==s.type){var c=n&&n.pop();if(c&&c.tag==s.text&&o[c.tag])return o[c.tag]({context:t,tagname:c.tag,args:c.args,text:i})}else 1==s.type&&(i+=s.text)}},e}(Ge),Ne=function(){function e(){this.m_rctElements=[]}return e.prototype.AppendText=function(e,t){void 0===t&&(t=!1),e.length&&(t?this.m_rctElements.push(Ee.createElement("span",{"data-copytext":"","data-copystyle":"merge-adjacent","bbcode-text":e},e)):this.m_rctElements.push(e))},e.prototype.AppendNode=function(e,t){this.m_rctElements.push(e)},e.prototype.GetElements=function(e){return this.m_rctElements},e}(),Le=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return R.d(t,e),t.prototype.AppendText=function(e,t){void 0===t&&(t=!1);for(var n=e,o=[],i=n.indexOf("\n");-1!==i;i=n.indexOf("\n"))o.push(n.substr(0,i)),o.push(Ee.createElement("br")),n=n.substr(i+1);n.length&&o.push(n),t?this.m_rctElements.push(Ee.createElement.apply(Ee,["span",{"data-copytext":"","data-copystyle":"merge-adjacent","bbcode-text":e}].concat(o))):this.m_rctElements.push(e)},t}(Ne),ke=function(o){function e(e,t){void 0===t&&(t=Ne);var n=o.call(this,e)||this;return n.m_accumulatorType=t,n}return R.d(e,o),e.prototype.ParseBBCode=function(e,t){var n=Te(e);return this.Parse_BuildReactComponents(n,t)},e.prototype.Parse_BuildReactComponents=function(e,c){var l=this,p=new this.m_accumulatorType,u=void 0,m=this.dictComponents();e.forEach(function(e,t){if(1==e.type)p.AppendText(e.text,!u||0==u.length);else if(2==e.type)u||(u=[]),u.push({accumulator:p,node:e}),p=new l.m_accumulatorType;else if(3==e.type){var n=u&&u.pop();if(n&&n.node.tag===e.text&&m[n.node.tag]){var o=m[n.node.tag],i=u.map(function(e){return e.node.tag}),r={context:c,parentTags:i,tagname:n.node.tag,args:n.node.args,key:e.tag+"_"+t},a=Ee.createElement.apply(Ee,[o,r].concat(p.GetElements(e)));(p=n.accumulator).AppendNode(a,e)}else if(n){var s=n.accumulator;s.AppendText("["+n.node.text+"]"),p.GetElements(e).forEach(function(e){return s.AppendNode(e)}),s.AppendText("[/"+e.text+"]"),p=s}}});for(var t=function(){var e=u.pop(),t=e.accumulator;t.AppendText("["+e.node.text+"]"),p.GetElements().forEach(function(e){return t.AppendNode(e)}),p=t};u&&u.length;)t();var n=p.GetElements();return 1<n.length?Ee.createElement.apply(Ee,[Ee.Fragment,null].concat(n)):1==n.length?n[0]:null},e}(Ge),Pe=function(){function e(){this.type=0,this.text=""}return e.prototype.ConvertMalformedNodeToText=function(){3==this.type?this.text="[/"+this.text:2==this.type&&(this.text="["+this.text),this.type=1},e}(),Ae=function(){function o(e){this.idGenerator=e||function(){return""}}return o.prototype.LOG=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.enabled&&console.log.apply(console,[this.idGenerator()+":"].concat(e))},o.create=function(e,t){void 0===t&&(t=!1);var n=new o(e);return n.enabled=t,n.LOG.bind(n)},o}(),Be=n("rrR9"),Fe=function(){function e(){}return e.prototype.Init=function(e){this.m_CMInterface=e},e.prototype.GetTradeOfferURL=function(){var t=this;if(this.m_strTradeOfferToken)return Promise.resolve(this.GetConstructedTradeOfferURL());var e=m.Init(Be.b);return Be.c.GetTradeOfferAccessToken(this.m_CMInterface.GetServiceTransport(),e).then(function(e){if(1==e.GetEResult())return t.m_strTradeOfferToken=e.Body().trade_offer_access_token(),t.GetConstructedTradeOfferURL();throw new Error("Error getting Trade Offer token")})},e.prototype.GetDefaultTradeOfferURLForFriend=function(e){return G.a.COMMUNITY_BASE_URL+"tradeoffer/new/?partner="+e},e.prototype.GetConstructedTradeOfferURL=function(){var e=this.m_CMInterface.steamid.GetAccountID();return G.a.COMMUNITY_BASE_URL+"tradeoffer/new/?partner="+e+"&token="+encodeURIComponent(this.m_strTradeOfferToken)},e}(),Ve=function(){return function(e){this.result=50,this.steamguard_required_days=0,this.new_device_cooldown_days=0,this.default_password_reset_probation_days=0,this.password_reset_probation_days=0,this.default_email_change_probation_days=0,this.email_change_probation_days=0,this.result=e}}();var xe,Ue,je,He,We,ze,qe={"/me":{strDescriptionToken:"#SlashCommandDescription_Me"},"/code":{strDescriptionToken:"#SlashCommandDescription_Code"},"/pre":{strDescriptionToken:"#SlashCommandDescription_Pre"},"/giphy":{strDescriptionToken:"#SlashCommandDescription_Giphy"},"/spoiler":{strDescriptionToken:"#SlashCommandDescription_Spoiler"},"/quote":{strDescriptionToken:"#SlashCommandDescription_Quote"},"/random":{strDescriptionToken:"#SlashCommandDescription_Random",unExpectedArguments:[1,2]},"/flip":{strDescriptionToken:"#SlashCommandDescription_Flip",unExpectedArguments:0}};function Ke(e){return qe[e]}(Ue=xe||(xe={}))[Ue.None=0]="None",Ue[Ue.Deleting=1]="Deleting",Ue[Ue.Deleted=2]="Deleted",(He=je||(je={}))[He.None=0]="None",He[He.Animating=1]="Animating",(ze=We||(We={}))[ze.None=0]="None",ze[ze.Generic=1]="Generic",ze[ze.NotFriends=2]="NotFriends",ze[ze.NoChatPermissionInGroup=3]="NoChatPermissionInGroup",ze[ze.RateLimitExceeded=4]="RateLimitExceeded";var Ye=function(){function e(e,t,n,o,i,r,a){this.unOrdinal=0,this.eDeleteState=xe.None,this.eAnimationState=je.None,this.unAccountID=e,this.rtTimestamp=t,this.unOrdinal=n||0,o&&13e3<o.length?this.strMessage=o.substr(0,13e3):this.strMessage=o,this.m_strSlashCommand=function(e){if(!e)return null;var t=e.split(/\s/),n=t[0],o=t.slice(1);if(qe[n]){var i=qe[n].unExpectedArguments;if(void 0===i||("number"==typeof i?i===o.length:-1<i.indexOf(o.length)))return n}return null}(o),this.strMessage=this.HandleSpecialMessage(this.strMessage),void 0!==i&&(this.eServerMsgType=i,this.strServerMsgParam=r,this.unServerMsgParamAccountID=a)}return e.prototype.UniqueKey=function(){return this.unOrdinal?this.rtTimestamp+"_"+this.unOrdinal:this.rtTimestamp},Object.defineProperty(e.prototype,"Mentions",{get:function(){return this.m_mentions||{}},set:function(e){this.m_mentions=e},enumerable:!0,configurable:!0}),e.prototype.BIsLocalEcho=function(){return!1},e.prototype.BHasServerAcknowledged=function(){return!0},Object.defineProperty(e.prototype,"eErrorSending",{get:function(){return We.None},enumerable:!0,configurable:!0}),e.prototype.BIsServerMessage=function(){return null!=this.eServerMsgType&&0!=this.eServerMsgType},e.prototype.BIsInvite=function(){return 5==this.eServerMsgType},e.prototype.GetSlashCommand=function(){return this.m_strSlashCommand},e.prototype.BIsOlderThan=function(e){return this.rtTimestamp<e.rtTimestamp||this.rtTimestamp==e.rtTimestamp&&this.unOrdinal<e.unOrdinal},e.prototype.BIsNewerThan=function(e){return this.rtTimestamp>e.rtTimestamp||this.rtTimestamp==e.rtTimestamp&&this.unOrdinal>e.unOrdinal},e.prototype.HasUserContent=function(){return!this.m_bNoUserContent},e.prototype.HandleSpecialMessage=function(e){return"+1"==e?(this.m_bNoUserContent=!0,"[plusone][/plusone]"):e},e.prototype.OnAnimationEnd=function(){this.eAnimationState=je.None},R.c([d.observable],e.prototype,"rtTimestamp",void 0),R.c([d.observable],e.prototype,"unOrdinal",void 0),R.c([d.observable],e.prototype,"eDeleteState",void 0),R.c([d.observable],e.prototype,"eAnimationState",void 0),R.c([d.observable],e.prototype,"strServerMsgAppCustomLocalized",void 0),e}(),Je=function(i){function r(e,t,n){var o=i.call(this,e,t,-1,n)||this;return o.eErrorSending=We.None,o.m_bServerAcknowledged=!1,o.strMessageObservable=o.HandleSpecialMessage(n),o.m_iLocalEchoID=r.sm_iLocalEchoID++,o}return R.d(r,i),Object.defineProperty(r.prototype,"strMessage",{get:function(){return this.strMessageObservable},set:function(e){this.strMessageObservable=this.HandleSpecialMessage(e)},enumerable:!0,configurable:!0}),r.prototype.BIsLocalEcho=function(){return!0},r.prototype.UniqueKey=function(){return this.m_bServerAcknowledged?i.prototype.UniqueKey.call(this):"localecho_"+this.m_iLocalEchoID},r.prototype.BHasServerAcknowledged=function(){return this.m_bServerAcknowledged},r.prototype.OnServerAcknowledged=function(){this.m_bServerAcknowledged=!0},r.sm_iLocalEchoID=0,R.c([d.observable],r.prototype,"eErrorSending",void 0),R.c([d.observable],r.prototype,"strMessageObservable",void 0),R.c([d.observable],r.prototype,"m_bServerAcknowledged",void 0),R.c([d.action],r.prototype,"OnServerAcknowledged",null),r}(Ye),Xe=function(o){function i(e,t,n){return o.call(this,e,t,++i.m_nOrdinal,n)||this}return R.d(i,o),i.m_nOrdinal=0,i}(Ye),Qe=function(r){function e(e,t,n,o){var i=r.call(this,e,t,0,"")||this;return i.m_targetSteamID=n,i.m_tradeRequestID=o,i.m_bCancelled=!1,i.m_bDeclined=!1,i.m_bAccepted=!1,i.m_bPopupBlocked=!1,i.m_ErrorDetails=new Ve(50),i}return R.d(e,r),e.prototype.TargetSteamID=function(){return this.m_targetSteamID},e.prototype.TradeRequestID=function(){return this.m_tradeRequestID},e.prototype.MarkAsCancelled=function(e){this.m_bCancelled=!0,this.m_ErrorDetails=e||new Ve(7)},e.prototype.MarkAsDeclined=function(){this.m_bDeclined=!0},e.prototype.MarkAsAccepted=function(e){this.m_bAccepted=!0,e||this.ShowPopupBlockedWarning()},e.prototype.ShowPopupBlockedWarning=function(){this.m_bPopupBlocked=!0},R.c([d.observable],e.prototype,"m_bCancelled",void 0),R.c([d.observable],e.prototype,"m_bDeclined",void 0),R.c([d.observable],e.prototype,"m_bAccepted",void 0),R.c([d.observable],e.prototype,"m_bPopupBlocked",void 0),R.c([d.action],e.prototype,"MarkAsCancelled",null),R.c([d.action],e.prototype,"MarkAsDeclined",null),R.c([d.action],e.prototype,"MarkAsAccepted",null),R.c([d.action],e.prototype,"ShowPopupBlockedWarning",null),e}(Ye);function Ze(e){switch(e){case 1:case 5:case 2:case 3:case 3:case 4:case 9:case 10:case 11:return!0}return!1}var $e=function(){function e(){this.m_rgMessageBlocks=d.observable.array([],{deep:!1}),this.Clear()}return Object.defineProperty(e.prototype,"message_blocks",{get:function(){return this.m_rgMessageBlocks},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"time_passes_index",{get:function(){return this.m_iIndexLastTimePassesGap},enumerable:!0,configurable:!0}),e.prototype.Clear=function(){this.m_rgMessageBlocks.clear(),this.m_rgMessageBlocks.push(new et),this.m_iIndexLastTimePassesGap=void 0},e.prototype.AppendMessage=function(e){var t=this.m_rgMessageBlocks[this.m_rgMessageBlocks.length-1];if(!t.BCanAccumulateMessage(e)){var n=t;t=new et,this.m_rgMessageBlocks.push(t),n.SetNextBlock(t),3600<=e.rtTimestamp-n.GetRTimeLastMessage()&&(n.GetRTimeMidnightBeforeBlock()==ci.GetLocalMidnightInRTime32(e.rtTimestamp)?this.m_iIndexLastTimePassesGap=this.m_rgMessageBlocks.length-1:this.m_iIndexLastTimePassesGap=void 0)}t.AppendMessage(e)},e.prototype.BuildMessageBlocks=function(e){this.Clear();for(var t=0,n=e;t<n.length;t++){var o=n[t];this.AppendMessage(o)}},e.prototype.AppendNewMessage=function(e){this.AppendMessage(e)},e.prototype.RemoveOldestMessages=function(e){for(var t=0;0<e&&!(t>=this.m_rgMessageBlocks.length);){if((i=this.m_rgMessageBlocks[t].messages).length>e)break;e-=i.length,t++}if(0==t)return null;for(var n=null,o=t-1;0<=o;o--){var i;if(0!=(i=this.m_rgMessageBlocks[o].messages).length){n=i[i.length-1];break}}return this.m_rgMessageBlocks.splice(0,t),n},R.c([d.observable],e.prototype,"m_iIndexLastTimePassesGap",void 0),R.c([d.action],e.prototype,"BuildMessageBlocks",null),R.c([d.action],e.prototype,"AppendNewMessage",null),R.c([d.action],e.prototype,"RemoveOldestMessages",null),e}(),et=function(){function a(){this.m_rgMessages=[],this.m_bMessageBlockIsOnlyEmotes=!0}return a.prototype.CreateVirtualSplitOnTimestamp=function(e){var t=new a,n=new a;t.SetNextBlock(n),n.SetNextBlock(this.m_nextBlock);for(var o=0,i=this.m_rgMessages;o<i.length;o++){var r=i[o];r.rtTimestamp<e?t.AppendMessage(r):n.AppendMessage(r)}return[t,n]},a.prototype.UniqueKey=function(){return this.m_rgMessages.length?this.m_rgMessages[0].UniqueKey():"EmptyBlock"},Object.defineProperty(a.prototype,"messages",{get:function(){return this.m_rgMessages},enumerable:!0,configurable:!0}),a.prototype.SetNextBlock=function(e){this.m_nextBlock=e},Object.defineProperty(a.prototype,"is_last_block",{get:function(){return void 0===this.m_nextBlock},enumerable:!0,configurable:!0}),a.prototype.GetRTimeMidnightBeforeBlock=function(){return this.m_rtMidnightBeforeBlock},a.prototype.GetRTimeMidnightBeforeNextBlock=function(){return this.m_nextBlock?this.m_nextBlock.GetRTimeMidnightBeforeBlock():ci.GetLocalMidnightInRTime32()},a.prototype.GetRTimeLastMessage=function(){return this.m_rgMessages.length?this.m_rgMessages[this.m_rgMessages.length-1].rtTimestamp:O.d},a.prototype.GetRTimeFirstMessage=function(){return this.m_rgMessages.length?this.m_rgMessages[0].rtTimestamp:0},a.prototype.AppendMessage=function(e){"/me"===e.GetSlashCommand()||(this.m_bMessageBlockIsOnlyEmotes=!1),this.m_rgMessages.length||(this.m_rtMidnightBeforeBlock=ci.GetLocalMidnightInRTime32(e.rtTimestamp)),this.m_rgMessages.push(e)},a.prototype.BCanAccumulateMessage=function(e){if(!this.m_rgMessages.length)return!0;var t=this.m_rgMessages[0].unAccountID,n=this.m_rgMessages[this.m_rgMessages.length-1].rtTimestamp,o=this.m_rgMessages[this.m_rgMessages.length-1];return e.BIsServerMessage()==this.m_rgMessages[0].BIsServerMessage()&&(!(!e.BIsServerMessage()||e.BIsInvite()||this.m_rgMessages[0].BIsInvite())||!(!t||t!=e.unAccountID)&&(e.BIsInvite()==this.m_rgMessages[0].BIsInvite()&&(!(300<e.rtTimestamp-n)&&((!this.m_bMessageBlockIsOnlyEmotes||"/me"===e.GetSlashCommand())&&(!(e instanceof Xe||o instanceof Xe)&&!(ci.GetLocalMidnightInRTime32(e.rtTimestamp)>this.m_rtMidnightBeforeBlock))))))},a.prototype.BIsInvite=function(){return 0<this.m_rgMessages.length&&this.m_rgMessages[0].BIsInvite()},a.prototype.BIsServerMsg=function(){return 0<this.m_rgMessages.length&&this.m_rgMessages[0].BIsServerMessage()&&!this.m_rgMessages[0].BIsInvite()},R.c([d.observable.shallow],a.prototype,"m_rgMessages",void 0),R.c([d.observable.shallow],a.prototype,"m_nextBlock",void 0),R.c([d.action],a.prototype,"CreateVirtualSplitOnTimestamp",null),a}(),tt=function(){function a(e,t,n){var o=this;this.BASELOG=Ae.create(function(){return"CChat-"+o.unique_id},!1),this.m_rgChatViews=[],this.m_bChatLogsLoaded=!1,this.m_bMoreAvailable=!1,this.m_nLoadingHistoryInProgressCount=0,this.m_rgChatMessages=[],this.m_ChatMessageBlockList=new $e,this.m_cUnreadChatMessages=0,this.m_bHasUnreadPriorityChatMessages=!1,this.m_rtFirstUnreadChatMsg=0,this.m_rtLastAckedChatMsg=0,this.m_rtLastServerAckedChatMsg=0,this.m_rtLastMessageReceived=0,this.m_rtLastServerMessageReceived=0,this.m_msTimeActivated=0,this.m_bPrepended=!1,this.m_FriendStore=e,this.m_ChatStore=t,this.m_CMInterface=n}return a.prototype.UnloadChatState=function(){this.UnloadActiveChatState(),this.m_rtLastMessageReceived=0,this.m_rtLastServerMessageReceived=0},a.prototype.UnloadActiveChatState=function(){this.m_rgChatMessages=[],this.m_ChatMessageBlockList.Clear(),this.m_bChatLogsLoaded=!1},Object.defineProperty(a.prototype,"BIsPrepend",{get:function(){return this.m_bPrepended},enumerable:!0,configurable:!0}),a.prototype.ResetPrepended=function(){this.m_bPrepended=!1},a.prototype.OnTyping=function(){},Object.defineProperty(a.prototype,"is_friend_typing",{get:function(){return!1},enumerable:!0,configurable:!0}),a.prototype.OnReceivedNewMessage=function(e,t,n,o){},a.prototype.BShouldTrackUnreadMessages=function(){return!0},a.prototype.BIsVoiceAllowed=function(){return!0},a.prototype.GetVoiceNotAllowedReason=function(){return null},a.prototype.InitUnreadMessageCountFromServer=function(e,t,n){this.m_cUnreadChatMessages=e,this.m_bHasUnreadPriorityChatMessages=!1,this.m_rtLastAckedChatMsg=this.m_rtLastServerAckedChatMsg=t,this.m_rtLastMessageReceived=n,this.m_rtLastAckedChatMsg<this.m_rtLastMessageReceived&&(this.m_rtFirstUnreadChatMsg=this.m_rtLastAckedChatMsg+1),ci.FriendStore.UpdateUnreadMessagesGlobal()},a.prototype.AddChatView=function(e){this.m_rgChatViews.push(e)},a.prototype.RemoveChatView=function(e){var t=this.m_rgChatViews.indexOf(e);-1!=t&&this.m_rgChatViews.splice(t,1)},a.prototype.IsMoreHistoryAvailable=function(){return this.m_bMoreAvailable},a.prototype.InternalLoadChatLogs=function(e){var t,n,o,i=this;if(void 0===e&&(e=!1),e){var r=this.GetMostRecentChatMsg();n=r?(t=r.rtTimestamp,r.unOrdinal):(t=O.e,0)}else t=O.e,n=0;o=O.d,this.m_nLoadingHistoryInProgressCount+=1,this.GetMessagesFromTimeRange(t,n,o,0,a.k_InitialMessageCount).then(function(e){var t=e.messages,n=e.moreAvailable;i.AddMessagesToHistory(t,n),i.m_nLoadingHistoryInProgressCount-=1}).catch(function(e){return i.m_nLoadingHistoryInProgressCount-=1,Promise.reject(e)})},a.prototype.LoadMoreHistory=function(){var o=this;return 0!=this.m_nLoadingHistoryInProgressCount?Promise.resolve(!0):(this.m_nLoadingHistoryInProgressCount+=1,this.GetMessagesFromTimeRange(O.e,0,this.m_oldestMessageTime,this.m_oldestMessageOrdinal,a.k_LoadMoreMessageCount).then(function(e){var t=e.messages,n=e.moreAvailable;return o.AddMessagesToHistory(t,n),o.m_nLoadingHistoryInProgressCount-=1,!0}).catch(function(e){return o.m_nLoadingHistoryInProgressCount-=1,Promise.reject(e)}))},a.prototype.AddMessagesToHistory=function(e,t){this.BASELOG("merging "+e.length+" messages"),this.MergeChatHistoryChunk(e),this.BASELOG(this.m_rgChatMessages.length+" total messages"),this.m_bMoreAvailable=t,this.BASELOG("friend chat oldest time "+this.m_oldestMessageTime+" oldest ordinal "+this.m_oldestMessageOrdinal+" bMoreAvailable "+this.m_bMoreAvailable)},Object.defineProperty(a.prototype,"ChatStore",{get:function(){return this.m_ChatStore},enumerable:!0,configurable:!0}),a.prototype.OnActivate=function(){(this.m_cUnreadChatMessages||this.m_bHasUnreadPriorityChatMessages)&&(this.m_cUnreadChatMessages=0,this.m_bHasUnreadPriorityChatMessages=!1,this.m_rtLastMessageReceived&&(this.m_rtLastAckedChatMsg=this.m_rtLastMessageReceived,this.AckChatMsg(this.m_rtLastMessageReceived)),ci.FriendStore.UpdateUnreadMessagesGlobal())},a.prototype.OnDeactivate=function(){this.m_rtFirstUnreadChatMsg=0},Object.defineProperty(a.prototype,"self",{get:function(){return this.m_FriendStore.self},enumerable:!0,configurable:!0}),a.prototype.InternalAppendChatMsg=function(e){(0!=this.m_rgChatViews.length||this.m_bChatLogsLoaded)&&(this.m_rgChatMessages.push(e),this.m_ChatMessageBlockList.AppendNewMessage(e),this.TrimLogsIfPossible())},a.prototype.TrimLogsIfPossible=function(){var e=this.m_rgChatMessages.length-a.k_KeepLoadedWhenAtScrollBottom;if(!(e<=0)){for(var t=0,n=this.m_rgChatViews;t<n.length;t++){if(!n[t].is_scrolled_to_bottom)return}var o=this.m_ChatMessageBlockList.RemoveOldestMessages(e);if(o){var i=this.m_rgChatMessages.indexOf(o);i<0?Object(I.a)(!1,"Failed to find message being removed"):this.m_rgChatMessages.splice(0,i+1)}}},a.prototype.AppendChatMsg=function(e,t,n,o){var i=new Ye(e,t,n,o);return i.eAnimationState=je.Animating,this.InternalAppendChatMsg(i),i},a.prototype.AppendLocalEchoChatMsg=function(e){var t=new Je(this.self.accountid,ci.GetServerRTime32(),e);return t.eAnimationState=je.Animating,this.InternalAppendChatMsg(t),t},a.prototype.AddNewChatMsgAndNotify=function(e,t,n,o,i,r){var a=this.AppendChatMsg(e,t,n,o);a.Mentions=r;var s=void 0!==i;this.CheckShouldNotify(a,s?i:o,o)},a.prototype.UpdateChatMessageDeletedState=function(e,t){for(var n=0,o=this.m_rgChatMessages;n<o.length;n++)for(var i=o[n],r=0,a=e;r<a.length;r++){var s=a[r];i.rtTimestamp==s.rtTimestamp&&i.unOrdinal==s.unOrdinal&&(i.eDeleteState!=xe.Deleted&&(i.eDeleteState=t))}},a.prototype.BShouldSilentlyAddMessage=function(e){return!1},a.prototype.DecorateNotification=function(e,t,n,o){if(o!==n){var i=this.m_ChatStore.NotificationBBCodeParser,r={chat:this,unAccountIDSender:e.unAccountID,key:e.UniqueKey(),rtTimestamp:e.rtTimestamp,onLoad:function(){}},a=i.ParseBBCode(o,r);if(a)return R.a({},t,a)}return t},a.prototype.CheckShouldNotify=function(e,t,n){var o=this,i=this.self.accountid==e.unAccountID,r=!1,a=!1,s=this.GetVisibilityState(),c=this.BShouldSilentlyAddMessage(e),l=e.Mentions;if(!e.BIsServerMessage()||l.mention_all||l.mention_here||l.mention_user){i?a=r=!0:c&&0==this.m_cUnreadChatMessages?r=!0:4==s?r=!0:3==s&&0==this.m_cUnreadChatMessages&&ci.IdleTracker.AddOnNextActivityCallback(function(){4==o.GetVisibilityState()&&o.OnActivate()}),this.m_rtLastMessageReceived=e.rtTimestamp;var p=this.m_cUnreadChatMessages,u=this.m_bHasUnreadPriorityChatMessages;this.BShouldTrackUnreadMessages()&&(r?(this.m_rtLastAckedChatMsg=e.rtTimestamp,this.m_cUnreadChatMessages=0,this.m_bHasUnreadPriorityChatMessages=!1,a||this.AckChatMsg(e.rtTimestamp)):(0==this.m_rtFirstUnreadChatMsg&&(this.m_rtFirstUnreadChatMsg=this.m_rtLastMessageReceived),this.m_cUnreadChatMessages++)),c||this.OnReceivedNewMessage(e,s,t,n),p==this.m_cUnreadChatMessages&&u==this.m_bHasUnreadPriorityChatMessages||ci.FriendStore.UpdateUnreadMessagesGlobal()}else this.m_rtLastServerMessageReceived=e.rtTimestamp},a.prototype.AddVoiceChannelInviteMsg=function(e,t,n){this.InternalAppendChatMsg(new Xe(e,t,n))},a.prototype.AddNewServerMsg=function(e,t,n,o,i,r,a){var s=this;if(Ze(o)){var c=new Ye(e,t,n,i,o,r,a);11==c.eServerMsgType&&this.SetupAppCustomServerMsg(c).then(function(e){s.CheckShouldNotify(c,e,c.strServerMsgAppCustomLocalized)}),this.InternalAppendChatMsg(c)}},a.prototype.AckChatMsg=function(e){this.m_rtLastServerAckedChatMsg!=e&&(this.AckChatMsgOnServer(e),this.m_rtLastServerAckedChatMsg=e)},a.prototype.OnUserChatEcho=function(e,t){e>=this.m_rtLastAckedChatMsg&&(this.m_rtLastMessageReceived=e,this.UpdateLastAckTimeFromServer(e))},a.prototype.UpdateLastAckTimeFromServer=function(e){this.m_rtLastServerAckedChatMsg<=e&&(this.m_rtLastServerAckedChatMsg=e,this.m_rtLastAckedChatMsg=e,this.m_rtLastMessageReceived<=e&&(this.m_cUnreadChatMessages=0,this.m_bHasUnreadPriorityChatMessages=!1,ci.FriendStore.UpdateUnreadMessagesGlobal()))},a.prototype.GetMostRecentChatMsg=function(){for(var e=this.m_rgChatMessages.length-1;0<=e;e--)if(-1!=this.m_rgChatMessages[e].unOrdinal)return this.m_rgChatMessages[e];return null},a.prototype.MergeChatHistoryChunk=function(e){var t;if(e.length){var n,o=e[0],i=e[e.length-1],r=0;for(n=this.m_rgChatMessages.length-1;0<=n;n--)if(-1!=this.m_rgChatMessages[n].unOrdinal){if(this.m_rgChatMessages[n].BIsOlderThan(o))break;this.m_rgChatMessages[n].BIsNewerThan(i)&&r++}for(var a=0,s=e;a<s.length;a++){var c=s[a];this.MsgLoadedFromHistory(c)}for(n++,(t=this.m_rgChatMessages).splice.apply(t,[n,this.m_rgChatMessages.length-n-r].concat(e)),n=0;n<this.m_rgChatMessages.length&&-1==this.m_rgChatMessages[n].unOrdinal;n++);n>=this.m_rgChatMessages.length?(this.m_oldestMessageTime=O.d,this.m_oldestMessageOrdinal=0):(this.m_oldestMessageTime=this.m_rgChatMessages[n].rtTimestamp,this.m_oldestMessageOrdinal=this.m_rgChatMessages[n].unOrdinal),this.m_ChatMessageBlockList.BuildMessageBlocks(this.m_rgChatMessages),this.m_bPrepended=!0}},a.prototype.GetBeginFileUploadURL=function(){return G.a.CHAT_BASE_URL+"chat/beginfileupload/"},a.prototype.GetCommitFileUploadURL=function(){return G.a.CHAT_BASE_URL+"chat/commitfileupload/"},a.prototype.LogFileUploadMessage=function(e){this.BASELOG(e)},a.prototype.MsgLoadedFromHistory=function(e){11==e.eServerMsgType&&this.SetupAppCustomServerMsg(e)},a.prototype.SetupAppCustomServerMsg=function(e){return R.b(this,void 0,void 0,function(){return R.e(this,function(e){return console.warn("App custom server message should only be used in a class that knows what to do with it"),[2,""]})})},a.prototype.GetVisibilityState=function(e){for(var t=0,n=0,o=this.m_rgChatViews;n<o.length;n++){var i=o[n];if(!e||i.BIsInBrowserContext(e)){var r=i.GetVisibilityState();t<r&&(t=r)}}return t},Object.defineProperty(a.prototype,"unread_message_count",{get:function(){return this.m_cUnreadChatMessages},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"has_unread_priority_messages",{get:function(){return this.m_bHasUnreadPriorityChatMessages},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"first_unread_msg_time",{get:function(){return this.m_rtFirstUnreadChatMsg},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"time_last_message",{get:function(){return this.m_rtLastMessageReceived},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"time_last_ack",{get:function(){return this.m_rtLastAckedChatMsg},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"chat_messages",{get:function(){return this.m_rgChatMessages},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"chat_message_blocks",{get:function(){return this.m_ChatMessageBlockList},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"last_voice_participation_time",{get:function(){return this.m_rtLastAckedChatMsg},enumerable:!0,configurable:!0}),a.prototype.LoadChatLogs=function(){this.m_bChatLogsLoaded||(this.m_bChatLogsLoaded=!0,this.InternalLoadChatLogs(!1))},a.prototype.OnConnectionRestored=function(){this.m_bChatLogsLoaded&&this.InternalLoadChatLogs(!0)},a.k_KeepLoadedWhenAtScrollBottom=2*(a.k_InitialMessageCount=100),a.k_LoadMoreMessageCount=50,R.c([d.observable],a.prototype,"m_bMoreAvailable",void 0),R.c([d.observable.shallow],a.prototype,"m_rgChatMessages",void 0),R.c([d.observable],a.prototype,"m_cUnreadChatMessages",void 0),R.c([d.observable],a.prototype,"m_rtFirstUnreadChatMsg",void 0),R.c([d.observable],a.prototype,"m_rtLastAckedChatMsg",void 0),R.c([d.observable],a.prototype,"m_rtLastMessageReceived",void 0),R.c([d.observable],a.prototype,"m_rtLastServerMessageReceived",void 0),R.c([d.action],a.prototype,"AddMessagesToHistory",null),R.c([d.action],a.prototype,"OnActivate",null),R.c([d.action],a.prototype,"OnDeactivate",null),R.c([d.action],a.prototype,"AppendChatMsg",null),R.c([d.action],a.prototype,"AppendLocalEchoChatMsg",null),R.c([d.action],a.prototype,"AddNewChatMsgAndNotify",null),R.c([d.action],a.prototype,"UpdateChatMessageDeletedState",null),R.c([d.action],a.prototype,"AddVoiceChannelInviteMsg",null),R.c([d.action],a.prototype,"AddNewServerMsg",null),a}(),nt=n("3Liw"),ot=n("KrQr"),it=n("p7Z6"),rt=n("nRcY"),at=n("HxRt"),st=n("lgHT"),ct=function(){function e(e,t){this.m_bInitialized=!1,this.m_bGotInitialState=!1,this.m_strClanName="",this.m_strClanTag="",this.m_strAvatarHash=ee,this.m_eClanAccountFlags=0,this.m_cMemberCount=0,this.m_cUsersOnline=0,this.m_cUsersInGame=0,this.m_cChatRoomMembers=0,this.m_bPersonaStateLoadRequested=!1,this.m_steamid=e,this.m_eClanRelationship=t}return e.prototype.BNeedsPersonaData=function(){return!this.m_bInitialized&&!this.m_bPersonaStateLoadRequested},e.prototype.SetPersonaStateLoadRequested=function(){this.m_bPersonaStateLoadRequested=!0},Object.defineProperty(e.prototype,"name",{get:function(){return this.m_bInitialized?this.m_strClanName:""},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"steamid",{get:function(){return this.m_steamid},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"clanid",{get:function(){return this.m_steamid.GetAccountID()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"member_count",{get:function(){return this.m_cMemberCount},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"users_online",{get:function(){return this.m_cUsersOnline},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"users_ingame",{get:function(){return this.m_cUsersInGame},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"count_chat_room_members",{get:function(){return this.m_cChatRoomMembers},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"chat_room_private",{get:function(){return this.m_bChatRoomPrivate},enumerable:!0,configurable:!0}),e.prototype.BIsMember=function(){return 3==this.m_eClanRelationship},e.prototype.BIsInvite=function(){return 2==this.m_eClanRelationship},e.prototype.SetRelationship=function(e){this.m_eClanRelationship=e},e.prototype.BIsOGG=function(){return!!this.m_unOGGAppID||this.m_bGotInitialState&&0!=(16&this.m_eClanAccountFlags)},e.prototype.GetOGGAppID=function(){return this.m_unOGGAppID},e.prototype.BMatchesSearchString=function(e){return-1!==this.m_strClanName.toLocaleLowerCase().indexOf(e)},Object.defineProperty(e.prototype,"avatar_url",{get:function(){return te(this.m_strAvatarHash)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"avatar_url_medium",{get:function(){return this.BIsOGG()?this.avatar_url:te(this.m_strAvatarHash,"_medium")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"avatar_url_full",{get:function(){return this.BIsOGG()?this.avatar_url:te(this.m_strAvatarHash,"_full")},enumerable:!0,configurable:!0}),e.prototype.OpenChatDialog=function(t,n){return void 0===n&&(n=!0),this.GetChatRoomGroupID().then(function(e){return ci.ChatStore.JoinAndShowChatRoomGroup(t,e,n),e})},e.prototype.ReadPersonaStateUpdate=function(e,t){if(this.m_bInitialized=!0,0!=(2&e)&&(this.m_strClanName=t.player_name()),0!=(1024&e)&&(this.m_strClanTag=t.clan_tag(),t.clan_data().chat_group_id()&&(this.m_ulChatRoomGroupID=t.clan_data().chat_group_id()),t.clan_data().ogg_app_id()&&(this.m_unOGGAppID=t.clan_data().ogg_app_id())),0!=(16&e)){var n=t.avatar_hash(),o=!0;if(n){for(var i=0;i<n.length&&o;i++)o=!n[i];this.m_strAvatarHash=o?ee:p(n)}}},e.prototype.ReadStateUpdate=function(e){if(this.m_bGotInitialState=!0,this.m_eClanAccountFlags=e.clan_account_flags(),this.m_bChatRoomPrivate=e.chat_room_private(),void 0!==e.user_counts()&&e.user_counts().members()){var t=e.user_counts();this.m_cMemberCount=t.members(),this.m_cUsersOnline=t.online(),this.m_cUsersInGame=t.in_game(),this.m_cChatRoomMembers=t.chat_room_members()}},e.prototype.GetChatGroupIDIfLoaded=function(){return this.m_ulChatRoomGroupID},e.prototype.GetChatRoomGroupID=function(){var t=this;if(this.m_ulChatRoomGroupID)return Promise.resolve(this.m_ulChatRoomGroupID);var e=m.Init(pe.S);return e.Body().set_steamid(this.steamid.ConvertTo64BitString()),e.Body().set_autocreate(!0),pe.Z.GetClanChatRoomInfo(ci.CMInterface.GetServiceTransport(),e).then(function(e){return 1==e.GetEResult()&&e.Body().chat_group_summary().chat_group_id()?(t.m_ulChatRoomGroupID=e.Body().chat_group_summary().chat_group_id(),t.m_ulChatRoomGroupID):null})},e.prototype.SetChatGroupID=function(e){this.m_ulChatRoomGroupID=e},R.c([d.observable],e.prototype,"m_bInitialized",void 0),R.c([d.observable],e.prototype,"m_bGotInitialState",void 0),R.c([d.observable],e.prototype,"m_eClanRelationship",void 0),R.c([d.observable],e.prototype,"m_strAvatarHash",void 0),R.c([d.observable],e.prototype,"m_ulChatRoomGroupID",void 0),R.c([d.observable],e.prototype,"m_cMemberCount",void 0),R.c([d.observable],e.prototype,"m_cUsersOnline",void 0),R.c([d.observable],e.prototype,"m_cUsersInGame",void 0),R.c([d.observable],e.prototype,"m_cChatRoomMembers",void 0),R.c([d.observable],e.prototype,"m_bChatRoomPrivate",void 0),R.c([d.computed],e.prototype,"avatar_url",null),R.c([d.computed],e.prototype,"avatar_url_medium",null),R.c([d.computed],e.prototype,"avatar_url_full",null),e}(),lt=function(){function e(e){var n=this;this.m_mapClans=d.observable.map(),this.m_eClanStateHandler=h(822,w.c,function(e){var t=new D.a(e.Body().steamid_clan());n.GetOrCreateClan(t).ReadStateUpdate(e.Body())}),this.m_FriendStore=e}return e.prototype.Init=function(e){this.m_CMInterface=e,this.m_CMInterface.AddOnLogonCallback(this.OnLogOn.bind(this))},e.prototype.OnLogOn=function(){},Object.defineProperty(e.prototype,"clan_invites",{get:function(){var t=[];return this.m_mapClans.forEach(function(e){e.m_bInitialized&&e.BIsInvite()&&t.push(e)}),t.sort(function(e,t){return e.name.localeCompare(t.name)}),t},enumerable:!0,configurable:!0}),e.prototype.GetClan=function(e){var t;return t=e instanceof D.a?(Object(I.a)(e.BIsClanAccount(),"expected clan steamid in GetClan()"),e.GetAccountID()):e,this.m_mapClans.get(t)},e.prototype.JoinClanChatRoom=function(e,t){var n=this.GetOrCreateClan(t);n.OpenChatDialog(e,!0),n.BNeedsPersonaData()&&this.LoadMissingClanPersonas()},e.prototype.ClearClanMembershipData=function(){this.m_mapClans.forEach(function(e){e.SetRelationship(0)})},e.prototype.SetClanChatGroupID=function(e,t){var n=this.GetOrCreateClan(e);n.SetChatGroupID(t),n.BNeedsPersonaData()&&this.ScheduleLoadMissingClanPersonas()},e.prototype.GetOrCreateClan=function(e,t){var n;n=e instanceof D.a?e:D.a.InitFromClanID(e);var o=this.m_mapClans.get(n.GetAccountID());return o?void 0!==t&&o.SetRelationship(t):(o=new ct(n,t||0),this.m_mapClans.set(n.GetAccountID(),o)),o},e.prototype.OnClanRelationshipChanged=function(e,t){this.GetOrCreateClan(e,t)},e.prototype.RespondToClanInvite=function(e,t){var n=m.Init(st.a);return n.Body().set_steamid(e.ConvertTo64BitString()),n.Body().set_accept(t),st.b.RespondToClanInvite(this.m_CMInterface.GetServiceTransport(),n).then(function(e){return 1==e.GetEResult()})},e.prototype.EnsureInitialStateForClanInvites=function(){var t=m.Init(ot.e,5554);this.clan_invites.forEach(function(e){e.m_bGotInitialState||t.Body().add_steamid_clans(e.steamid.ConvertTo64BitString())}),t.Body().steamid_clans().length<=0||this.m_CMInterface.Send(t)},e.prototype.ScheduleLoadMissingClanPersonas=function(){this.m_iIntervalLoadClanData||(this.m_iIntervalLoadClanData=SetBackgroundTimeout(this.LoadMissingClanPersonas.bind(this),100))},e.prototype.LoadMissingClanPersonas=function(){this.m_iIntervalLoadClanData&&(ClearBackgroundTimeout(this.m_iIntervalLoadClanData),this.m_iIntervalLoadClanData=void 0);var t=m.Init(b.p,815);t.Body().set_persona_state_requested(1042),this.m_mapClans.forEach(function(e){e.BNeedsPersonaData()&&(t.Body().add_friends(e.steamid.ConvertTo64BitString()),e.SetPersonaStateLoadRequested())}),t.Body().friends().length&&this.m_CMInterface.Send(t)},e.prototype.OnClanPersonaStateUpdate=function(e,t){var n=new D.a(t.friendid());this.GetOrCreateClan(n).ReadPersonaStateUpdate(e,t)},R.c([d.computed],e.prototype,"clan_invites",null),e}();function pt(e,t){return e==t||e&&t&&e.friend==t.friend&&e.clan==t.clan&&e.chat==t.chat}var ut,mt,dt=function(){function e(e){var t=this;this.m_rgFavorites=d.observable.array(),this.m_IncomingFavoritesHandler=f(at.e.FavoritesChangedHandler,function(e){return t.RecvFavoritesList(e.Body().favorites()),1}),this.m_FriendStore=e,this.m_ClanStore=e.ClanStore}return e.prototype.Init=function(e){var t=this;this.m_CMInterface=e,this.m_ChatStore=ci.ChatStore,this.m_CMInterface.AddOnLogonCallback(function(){var e=m.Init(at.b);at.f.GetFavorites(t.m_CMInterface.GetServiceTransport(),e).then(function(e){1==e.GetEResult()&&t.RecvFavoritesList(e.Body().favorites())})},47)},e.prototype.BIsFavorited=function(e){for(var t=0,n=this.m_rgFavorites;t<n.length;t++){if(pt(n[t],e))return!0}return!1},Object.defineProperty(e.prototype,"favorites",{get:function(){return this.m_rgFavorites},enumerable:!0,configurable:!0}),e.prototype.AddToFavorites=function(t,e){var n=this.m_rgFavorites.findIndex(function(e){return pt(e,t)});return-1===n||void 0!==e&&n!==e?(-1!==n?M.f(this.m_rgFavorites,n,n<e?e-1:e):void 0!==e?this.m_rgFavorites.splice(e,0,t):this.m_rgFavorites.push(t),this.SaveFavorites()):Promise.resolve(!0)},e.prototype.RemoveFromFavorites=function(t){return M.e(this.m_rgFavorites,function(e){return pt(e,t)})?this.SaveFavorites():Promise.resolve(!0)},e.prototype.OnFriendRemoved=function(e){var t=this.m_FriendStore.GetPlayer(e);this.RemoveFromFavorites({friend:t})},e.prototype.SaveFavorites=function(){for(var e=m.Init(at.d),t=0,n=this.m_rgFavorites;t<n.length;t++){var o=n[t],i=e.Body().add_favorites();o.friend?i.set_accountid(o.friend.accountid):o.clan?i.set_clanid(o.clan.clanid):o.chat?i.set_chat_group_id(o.chat.GetGroupID()):Object(I.a)(!1,"empty favorite struct")}return at.f.SetFavorites(this.m_CMInterface.GetServiceTransport(),e).then(function(e){return 1==e.GetEResult()})},e.prototype.ReadFavorites=function(e){this.m_rgFavorites.clear();for(var t=0,n=e;t<n.length;t++){var o=n[t];if(o.accountid()){var i=this.m_FriendStore.GetFriend(o.accountid());i&&this.m_rgFavorites.push({friend:i})}else if(o.clanid()){var r=this.m_ClanStore.GetClan(o.clanid());r&&this.m_rgFavorites.push({clan:r})}else if(o.chat_group_id()){var a=this.m_ChatStore.GetChatRoomGroup(o.chat_group_id());a&&this.m_rgFavorites.push({chat:a})}}},e.prototype.RecvFavoritesList=function(e){var t=this;Object(d.when)(function(){return t.m_FriendStore.friends_list_ready&&t.m_ChatStore.chat_group_list_ready},this.ReadFavorites.bind(this,e))},e.prototype.FillInChatUsabilityMetrics=function(e){e.metrics().set_friends_favorite_count(M.b(this.m_rgFavorites,function(e){return!!e.friend})),e.metrics().set_group_chat_favorite_count(M.b(this.m_rgFavorites,function(e){return!!e.chat||!!e.clan}))},R.c([d.action],e.prototype,"AddToFavorites",null),R.c([d.action],e.prototype,"RemoveFromFavorites",null),R.c([d.action],e.prototype,"OnFriendRemoved",null),R.c([d.action],e.prototype,"ReadFavorites",null),e}(),ht=n("WpBz"),_t=function(){return function(){this.Notifications_ShowInGame=0,this.Notifications_ShowOnline=0,this.Notifications_ShowMessage=0,this.Notifications_SendMobile=0,this.Sounds_PlayInGame=0,this.Sounds_PlayOnline=0,this.Sounds_PlayMessage=0}}(),ft=function(){function i(e){this.m_eFriendRelationship=0,this.m_bPersonaStateLoadRequested=!1,this.m_bPersonaStateReady=!1,this.m_bPersonaNameHistoryLoaded=void 0,this.m_rgPersonaNameHistory=[],this.m_bBetaStatusLoading=!1,this.m_bBetaStatusStale=!0,this.m_bIsOnlineInBeta=void 0,this.m_bIsInBeta=void 0,this.m_unAccountID=e,this.m_persona=new oe(D.a.InitFromAccountID(e)),0==e&&(Object(I.a)(!1,"unset accountid"),this.m_bPersonaStateReady=!0,this.m_persona.m_bInitialized=!0)}return i.prototype.LoadIfNecessary=function(){this.m_persona.m_bInitialized||this.m_bPersonaStateLoadRequested||(this.m_bPersonaStateLoadRequested=!0,ci.FriendStore.QueueFriendPersonaStateLoad(this))},Object.defineProperty(i.prototype,"is_ready",{get:function(){return!(!this.m_persona.m_bInitialized&&!this.m_bPersonaStateReady)&&(Object.defineProperty(this,"is_ready",{value:!0}),!0)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"persona",{get:function(){return this.LoadIfNecessary(),Object.defineProperty(this,"persona",{value:this.m_persona}),this.m_persona},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"accountid",{get:function(){return this.m_unAccountID},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"steamid",{get:function(){return this.m_persona.m_steamid},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"steamid64",{get:function(){return this.m_persona.m_steamid.ConvertTo64BitString()},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"efriendrelationship",{get:function(){return this.m_eFriendRelationship},set:function(e){this.m_eFriendRelationship=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"is_friend",{get:function(){return Object(O.b)(this.m_eFriendRelationship)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"is_blocked",{get:function(){return Object(O.a)(this.m_eFriendRelationship)},enumerable:!0,configurable:!0}),i.prototype.GetCommunityProfileURL=function(){return G.a.COMMUNITY_BASE_URL+"profiles/"+this.steamid64+"/"},Object.defineProperty(i.prototype,"has_nickname",{get:function(){return!!this.m_strNickname},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"nickname",{get:function(){return this.m_strNickname},set:function(e){this.m_strNickname=e,this.m_strPlayerNicknameNormalized=e?i.NormalizeNameForSearch(e):""},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"notification_settings",{get:function(){return this.m_NotificationSettings||(this.m_NotificationSettings=new _t),this.m_NotificationSettings},set:function(e){this.m_NotificationSettings=e},enumerable:!0,configurable:!0}),i.prototype.BShowInGameNotification=function(){return 1==this.notification_settings.Notifications_ShowInGame||ci.SettingsStore.FriendsSettings.bNotifications_ShowIngame&&2!=this.notification_settings.Notifications_ShowInGame},i.prototype.BShowMessageNotification=function(){return 1==this.notification_settings.Notifications_ShowMessage||ci.SettingsStore.FriendsSettings.bNotifications_ShowMessage&&2!=this.notification_settings.Notifications_ShowMessage},i.prototype.BShowOnlineNotification=function(){return 1==this.notification_settings.Notifications_ShowOnline||ci.SettingsStore.FriendsSettings.bNotifications_ShowOnline&&2!=this.notification_settings.Notifications_ShowOnline},i.prototype.BPlayInGameSound=function(){return 1==this.notification_settings.Sounds_PlayInGame||ci.SettingsStore.FriendsSettings.bSounds_PlayIngame&&2!=this.notification_settings.Sounds_PlayInGame},i.prototype.BPlayMessageSound=function(){return 1==this.notification_settings.Sounds_PlayMessage||ci.SettingsStore.FriendsSettings.bSounds_PlayMessage&&2!=this.notification_settings.Sounds_PlayMessage},i.prototype.BPlayOnlineSound=function(){return 1==this.notification_settings.Sounds_PlayOnline||ci.SettingsStore.FriendsSettings.bSounds_PlayOnline&&2!=this.notification_settings.Sounds_PlayOnline},Object.defineProperty(i.prototype,"display_name",{get:function(){if(this.has_nickname){var e=this.primary_display_name;return this.showing_secondary_display_name&&(e+=" ("+this.secondary_display_name+")"),e}return this.persona.m_strPlayerName},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"primary_display_name",{get:function(){if(this.has_nickname&&!ci.SettingsStore.CommunityPreferences.bParenthesizeNicknames)return this.nickname;return this.persona.m_strPlayerName},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"has_secondary_display_name",{get:function(){return this.has_nickname},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"showing_secondary_display_name",{get:function(){return!!ci.SettingsStore.CommunityPreferences.bParenthesizeNicknames&&this.has_secondary_display_name},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"secondary_display_name",{get:function(){return ci.SettingsStore.CommunityPreferences.bParenthesizeNicknames&&this.has_nickname?this.nickname:this.persona.m_strPlayerName},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"is_display_name_nickname",{get:function(){return this.has_nickname&&!ci.SettingsStore.CommunityPreferences.bParenthesizeNicknames},enumerable:!0,configurable:!0}),i.NormalizeNameForSearch=function(e){return e.toLocaleLowerCase()},Object.defineProperty(i.prototype,"player_name_normalized",{get:function(){var e=this;if(void 0===this.m_strPlayerNameNormalized){if(!this.is_ready)return"";var t=function(){e.m_strPlayerNameNormalized=i.NormalizeNameForSearch(e.m_persona.m_strPlayerName)};Object(d.autorun)(t),void 0===this.m_strPlayerNameNormalized&&t()}return this.m_strPlayerNameNormalized},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"current_game_name",{get:function(){return this.m_persona.GetCurrentGameName()},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"current_game_icon_url",{get:function(){return this.m_persona.GetCurrentGameIconURL()},enumerable:!0,configurable:!0}),i.prototype.is_appinfo_ready=function(){return this.m_persona.BIsAppInfoReady()},Object.defineProperty(i.prototype,"current_game_rich_presence",{get:function(){return this.m_persona.GetCurrentGameRichPresence()},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"game_name_normalized",{get:function(){var e=this;if(void 0===this.m_strGameNameNormalized){if(!this.is_ready)return"";var t=function(){e.m_strGameNameNormalized=i.NormalizeNameForSearch(e.current_game_name)};Object(d.autorun)(t),void 0===this.m_strGameNameNormalized&&t()}return this.m_strGameNameNormalized},enumerable:!0,configurable:!0}),i.prototype.MatchSearchString=function(e){var t=this.player_name_normalized.indexOf(e);return-1!==t?{match:1,iOffset:t,bFullMatch:0===t&&this.player_name_normalized.length===e.length}:this.has_nickname&&-1!==(t=this.m_strPlayerNicknameNormalized.indexOf(e))?{match:2,iOffset:t,bFullMatch:0===t&&this.m_strPlayerNicknameNormalized.length===e.length}:{match:0}},i.prototype.BMatchesSearchString=function(e,t){if(-1!==this.player_name_normalized.indexOf(e))return!0;if(this.has_nickname){if(-1!==this.m_strPlayerNicknameNormalized.indexOf(e))return!0}else if(t&&this.m_persona.is_ingame&&-1!==this.game_name_normalized.indexOf(e))return!0;return!1},Object.defineProperty(i.prototype,"persona_name_history",{get:function(){var i=this;if(void 0===this.m_bPersonaNameHistoryLoaded){var e=m.Init(w.a,5570);e.Body().add_Ids().set_steamid(this.steamid64),e.Body().set_id_count(1),ci.CMInterface.SendMsgAndAwaitResponse(e,w.b).then(function(e){if(Object(I.a)(1==e.Body().responses().length,"Got an invalid number of responses to CMsgClientAMGetPersonaNameHistory"),1==e.Body().responses().length){var o=e.Body().responses()[0];Object(I.a)(o.steamid()==i.steamid64,"Got a response for the wrong user from CMsgClientAMGetPersonaNameHistory"),o.steamid()==i.steamid64&&(Object(I.a)(0==i.m_rgPersonaNameHistory.length,"Got persona name history response for same user twice."),Object(d.runInAction)(function(){for(var e=0,t=o.names();e<t.length;e++){var n=t[e];i.m_rgPersonaNameHistory.push(n.name())}i.m_bPersonaNameHistoryLoaded=!0}))}}),this.m_bPersonaNameHistoryLoaded=!1}return this.m_rgPersonaNameHistory},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"persona_name_history_loaded",{get:function(){return!0===this.m_bPersonaNameHistoryLoaded},enumerable:!0,configurable:!0}),i.prototype.OpenChatDialog=function(e){return this.is_blocked?(G.a.IN_MOBILE?ci.ShowAlert(Object($.b)("#Friend_Chat_OpenError_Blocked"),Object($.b)("#Friend_Chat_OpenError_BlockedBody")):ci.OpenURLInBrowser(this.GetCommunityProfileURL(),e),null):ci.ShowFriendChatDialog(e,this.m_unAccountID,!0)},Object.defineProperty(i,"FriendSortStatusComparator",{get:function(){var e=ci.SettingsStore.BForceAlphabeticFriendSorting();return i.FriendSortStatusComparatorInternal.bind(null,e)},enumerable:!0,configurable:!0}),i.FriendSortStatusComparatorInternal=function(e,t,n){var o=t.persona,i=n.persona;return oe.SortStatusComparator(!e,o,i)},Object.defineProperty(i,"DefaultFriendSortComparator",{get:function(){var o=ci.SettingsStore.BForceAlphabeticFriendSorting();return function(e,t){var n=i.FriendSortStatusComparatorInternal(o,e,t);return 0!=n?n:e.display_name.localeCompare(t.display_name)}},enumerable:!0,configurable:!0}),i.FriendSortByLastSeenComparator=function(e,t){var n=e.persona,o=t.persona;if(!n.is_online&&!o.is_online){var i=ci.GetServerRTime32()-n.last_seen_online,r=ci.GetServerRTime32()-o.last_seen_online;if(r<i)return 1;if(i<r)return-1}return e.display_name.localeCompare(t.display_name)},i.FriendSortByFriendOrNotComparator=function(e,t){return e.is_friend&&!t.is_friend||!e.is_friend&&t.is_friend?e.is_friend?-1:1:e.display_name.localeCompare(t.display_name)},Object.defineProperty(i.prototype,"localized_online_status",{get:function(){return this.persona.GetLocalizedOnlineStatus()},enumerable:!0,configurable:!0}),i.prototype.GetBroadcastDescription=function(){if(this.persona.m_strBroadcastTitle)return this.persona.m_strBroadcastTitle;if(this.persona.m_broadcastAccountId){var e=ci.FriendStore.GetPlayer(this.persona.m_broadcastAccountId),t=this.persona.m_broadcastAppId?ci.AppInfoStore.GetAppInfo(this.persona.m_broadcastAppId):null;if(e.is_ready)return t&&t.is_valid?Object($.b)("#PersonaStateWatchingBroadcast_PlayerGame",e.display_name,t.name):Object($.b)("#PersonaStateWatchingBroadcast_Player",e.display_name)}return null},i.prototype.LoadFriendsUIBetaStatus=function(){var t=this;if(this.is_friend&&this.m_bBetaStatusStale&&!this.m_bBetaStatusLoading){this.m_bBetaStatusLoading=!0;var n=this.persona.is_online,e=m.Init(rt.c);e.Body().set_steamid(this.steamid64),rt.g.IsInFriendsUIBeta(ci.CMInterface.GetServiceTransport(),e).then(function(e){t.m_bBetaStatusLoading=!1,t.m_bBetaStatusStale=!1,t.m_bIsOnlineInBeta=e.Body().online_in_friendsui()||!1,t.m_bIsInBeta=e.Body().has_used_friendsui()||!1,Object(d.when)(function(){return t.persona.is_online!=n}).then(function(){t.m_bBetaStatusStale=!0})})}},Object.defineProperty(i.prototype,"is_in_beta",{get:function(){return this.LoadFriendsUIBetaStatus(),this.m_bIsInBeta},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"is_online_in_beta",{get:function(){return this.LoadFriendsUIBetaStatus(),this.m_bIsOnlineInBeta},enumerable:!0,configurable:!0}),R.c([d.observable],i.prototype,"m_eFriendRelationship",void 0),R.c([d.observable],i.prototype,"m_bPersonaStateReady",void 0),R.c([d.observable],i.prototype,"m_bPersonaNameHistoryLoaded",void 0),R.c([d.observable],i.prototype,"m_rgPersonaNameHistory",void 0),R.c([d.observable],i.prototype,"m_strPlayerNicknameNormalized",void 0),R.c([d.observable],i.prototype,"m_strNickname",void 0),R.c([d.observable],i.prototype,"m_bBetaStatusStale",void 0),R.c([d.observable],i.prototype,"m_bIsOnlineInBeta",void 0),R.c([d.observable],i.prototype,"m_bIsInBeta",void 0),R.c([d.computed],i.prototype,"display_name",null),R.c([d.computed],i.prototype,"secondary_display_name",null),R.c([d.computed],i.prototype,"current_game_name",null),R.c([d.computed],i.prototype,"current_game_icon_url",null),R.c([d.computed],i.prototype,"current_game_rich_presence",null),R.c([d.computed],i.prototype,"persona_name_history",null),R.c([d.computed],i.prototype,"persona_name_history_loaded",null),R.c([d.computed],i.prototype,"localized_online_status",null),i}(),gt="FriendStoreLocalPrefs",bt=function(){function e(){this.m_currentMsg=null,this.m_mapLastSeenApp=new Map}return e.prototype.Init=function(e){this.m_CMInterface=e,G.a.IN_MOBILE||SetBackgroundInterval(this.NotifyImpressions,12e4)},e.prototype.RecordFriendInGameImpression=function(e){if(!G.a.IN_MOBILE&&!(e==O.l||e>=O.f&&e<=O.g)){this.m_currentMsg||(this.m_currentMsg=m.Init(it.a));var t=!0;if(this.m_mapLastSeenApp.has(e)){var n=this.m_mapLastSeenApp.get(e);t=864e5<Date.now()-n}var o=null;if(t)this.m_mapLastSeenApp.set(e,Date.now()),(o=this.m_currentMsg.Body().add_impressions()).set_appid(e),o.set_type(2),o.set_num_impressions(0);else{for(var i=0;i<this.m_currentMsg.Body().impressions().length;++i){var r=this.m_currentMsg.Body().impressions()[i];if(r.appid()==e&&1==r.type()){o=r;break}}o||((o=this.m_currentMsg.Body().add_impressions()).set_appid(e),o.set_type(1),o.set_num_impressions(0))}o.set_num_impressions(o.num_impressions()+1)}},e.prototype.NotifyImpressions=function(){if(this.m_currentMsg){var e=this.m_currentMsg;this.m_currentMsg=null,it.b.ReportProductImpressionsFromClient(this.m_CMInterface.GetServiceTransport(),e)}},R.c([d.action.bound],e.prototype,"NotifyImpressions",null),e}(),vt=function(){function e(){var M=this;this.m_FriendGroupStore=new Lt(this),this.m_ClanStore=new lt(this),this.m_FavoritesStore=new dt(this),this.m_mapPlayerCache=new Map,this.m_mapApprovedNonFriendMessages=d.observable.map(),this.m_setFriendsNeedingPersonaStateLoad=new Set,this.m_iIntervalSubscribeToPersonaStateUpdates=0,this.m_setFriendAccountIDs=new Set,this.m_setIncomingInviteAccountIDs=new Set,this.m_bUserSetPersonaState=!1,this.m_eUserPersonaState=0,this.m_FriendStorePrefs={ePersonaState:1,strNonFriendsAllowedToMsg:""},this.m_cFriendPersonaStatesInitialized=0,this.m_bReadyToRender=!1,this.m_bPerFriendPreferencesLoaded=!1,this.m_bReceivedFriendsList=!1,this.m_bInitialPersonaStatesLoaded=!1,this.m_InitialAppInfoPromises=[],this.m_bInitialAppInfoLoaded=!1,this.m_bParentalLocked=void 0,this.m_eUserPersonaStateParental=1,this.m_rgPersonaStateChangeCallbacks=new N,this.m_rgPlayerGameChangedCallbacks=new N,this.m_nMissingPersonaStateRetryCount=0,this.m_nMissingPersonaStateMaxRetries=5,this.m_FriendInGameNotificationStore=new bt,this.m_bSnoozeCallbackFired=!0,this.m_bAwayCallbackFired=!0,this.m_bNextActivityCallbackRegistered=!1,this.fnRecvMsgClientFriendsList=h(767,b.i,function(e){e.Body().bincremental()&&M.SetFriendsList(e.Body())}),this.fnRecvMsgClientPersonaState=h(766,b.m,function(e){for(var t=e.Body().status_flags(),n=new Set,o=new Set,i=0,r=e.Body().friends();i<r.length;i++){var a=r[i],s=new D.a(a.friendid());if(s.BIsClanAccount())M.m_ClanStore.OnClanPersonaStateUpdate(t,a);else if(s.BIsIndividualAccount()){var c=M.GetPlayerIfCached(s.GetAccountID());c||(c=M.GetPlayer(s.GetAccountID()));var l=c.persona,p=l.m_ePersonaState,u=l.m_strPlayerName,m=l.m_unGamePlayedAppID,d=l.m_strGameExtraInfo,h=l.is_in_nonsteam_game,_=l.m_broadcastAppId,f=l.m_bInitialized;l.UpdateFromMessage(t,a),!f&&l.m_bInitialized&&M.m_setFriendAccountIDs.has(c.accountid)&&M.m_cFriendPersonaStatesInitialized++;var g=0!=(1&t);if(s.GetAccountID()==M.self.accountid&&g){var b=!!a.persona_set_by_user(),v=l.m_ePersonaState;M.UpdateUserPersonaStateInternal(v,b,!0),1==v&&1!=(v=M.AdjustPersonaStateForIdleTime(v))&&M.UpdateUserPersonaStateInternal(v,!1)}var S=!1,y=l.m_unGamePlayedAppID,C=l.m_broadcastAppId;Q.bValid&&_&&_!=Q.appID&&(_=void 0),Q.bValid&&C&&C!=Q.appID&&(C=void 0);var I=!1;if(y||m||h||l.is_in_nonsteam_game||C||_){if(S=m!=y,y&&n.add(y),C&&n.add(C),l.GetAccountID()!=M.m_self.accountid){var E=m,O=y;0==l.m_ePersonaState&&(O=0),h&&(E=St),l.is_in_nonsteam_game&&(O=St),!E&&_&&(E=_),!O&&C&&(O=C),c.is_friend&&M.m_FriendGroupStore.OnFriendGameChanged(s.GetAccountID(),E,O),M.m_rgPlayerGameChangedCallbacks.Dispatch(s.GetAccountID(),E,O),I=!0}}else l.m_strGameExtraInfo&&(S=d!=l.m_strGameExtraInfo);(4096&t||S)&&y&&l.HasCurrentGameRichPresence()&&o.add(y),f&&c.is_friend&&c.accountid!=M.m_self.accountid&&(p!=l.m_ePersonaState||S)&&(c.BPlayInGameSound()&&S&&c.persona.is_ingame?M.PlayJoinGameSound():c.BPlayOnlineSound()&&p!=l.m_ePersonaState&&1==l.m_ePersonaState&&M.PlayFriendOnlineSound(),M.OnFriendPersonaStateChanged(c,p,l.m_ePersonaState,S)),I||l.m_ePersonaState==p&&!S&&l.m_strPlayerName==u||M.m_rgPersonaStateChangeCallbacks.Dispatch(c)}}var w=ci.AppInfoStore.EnsureAppInfoForAppIDs(n);M.m_bInitialPersonaStatesLoaded||M.m_InitialAppInfoPromises.push(w),!M.m_bInitialPersonaStatesLoaded&&o.size&&(console.log("Preloading Game Rich Presence for AppIDs:",Array.from(o)),o.forEach(function(e){return ci.AppInfoStore.GetRichPresenceLoc(e)})),M.m_cFriendPersonaStatesInitialized>=M.m_setFriendAccountIDs.size&&M.m_bReceivedFriendsList&&!M.m_bInitialPersonaStatesLoaded&&(M.m_bInitialPersonaStatesLoaded=!0,M.StartWaitForInitialAppInfo())}),this.m_PerFriendPreferencesChangedHandler=f(nt.j.NotifyPerFriendPreferencesChangedHandler,function(e){var t=M.GetPlayer(e.Body().accountid());if(t){var n=e.Body().preferences();t.nickname=n.nickname()||void 0;var o=new _t;M.FillPerFriendNotificationSettingsFromMessage(o,n),t.notification_settings=o}return 1}),this.m_InitiateTradeResult=h(7704,ot.h,function(e){var t=e.Body().response(),n=(e.Body().trade_request_id(),new D.a(e.Body().other_steamid()));switch(t){case 0:case 50:break;case 1:(o=ci.ShowFriendChatDialog(ci.GetDefaultBrowserContext(),n.GetAccountID(),!1))&&o.MarkTradeRequestDeclined();break;case 11:case 4:case 12:case 9:case 8:case 13:case 7:case 26:case 22:var o,i=new Ve(e.Body().response());i.steamguard_required_days=e.Body().steamguard_required_days(),i.new_device_cooldown_days=e.Body().new_device_cooldown_days(),i.default_password_reset_probation_days=e.Body().default_password_reset_probation_days(),i.password_reset_probation_days=e.Body().password_reset_probation_days(),i.default_email_change_probation_days=e.Body().default_email_change_probation_days(),i.email_change_probation_days=e.Body().email_change_probation_days(),(o=ci.ShowFriendChatDialog(ci.GetDefaultBrowserContext(),n.GetAccountID(),!1))&&o.CancelTradeRequest(i)}}),this.m_InitiateTradeProposed=h(7702,ot.g,function(e){var t=new D.a(e.Body().other_steamid()),n=M.GetFriend(t.GetAccountID());if(n){var o=e.Body().trade_request_id(),i=ci.ShowFriendChatDialog(ci.GetDefaultBrowserContext(),n.accountid,!1);i&&i.AddNewTradeRequestAndNotify(t.GetAccountID(),ci.GetServerRTime32(),e.Body().other_steamid(),o)}}),this.m_StartTradingSession=h(7705,ot.i,function(e){var t=new D.a(e.Body().other_steamid()),n=M.OpenTradeWindow(e.Body().other_steamid()),o=ci.ShowFriendChatDialog(ci.GetDefaultBrowserContext(),t.GetAccountID(),!1);o&&o.MarkTradeRequestAccepted(n)})}return e.prototype.Init=function(e){var s=this;this.m_CMInterface=e,this.m_FriendGroupStore.Init(e),this.m_ClanStore.Init(e),this.m_FavoritesStore.Init(e),this.m_FriendInGameNotificationStore.Init(e);var t=!1;return this.m_CMInterface.AddOnLogonCallback(function(){t?s.SendPersonaStateToServer(!0):(t=!0,s.m_self=s.AddPlayerToCache(s.m_CMInterface.steamid.GetAccountID(),1),ci.SettingsStore.GetObjectFromLocalStorage(gt,s.m_FriendStorePrefs).then(function(e){if(null!=(s.m_FriendStorePrefs=e).strNonFriendsAllowedToMsg&&""!=e.strNonFriendsAllowedToMsg)for(var t=(new Date).getTime(),n=e.strNonFriendsAllowedToMsg.split(","),o=0;o<n.length;++o){var i=n[o].split("=");if(2==i.length){var r=Number(i[0]),a=Number(i[1]);t<a&&s.m_mapApprovedNonFriendMessages.set(r,a)}}s.m_eUserPersonaState=e.ePersonaState,s.m_bUserSetPersonaState=!1,s.SendPersonaStateToServer(!0)}),s.m_bReadyToRender||SetBackgroundTimeout(s.ForceReadyToRender.bind(s),1e3)),s.GetFriendsList()}),this.m_CMInterface.AddOnDisconnectCallback(function(){s.SetPersonasOffline(!0)},102),Object(d.autorun)(function(){var e=ci.ParentalStore.BIsFriendsBlocked();s.OnParentalLockChanged(e)}),this.InitializeIdleTracking(),this.m_bReadyToRender?Promise.resolve():new Promise(function(e,t){s.m_fnOnReadyToRender=e})},e.prototype.UpdateUnreadMessagesGlobal=function(){if(void 0!==window.SteamClient&&null!=window.SteamClient.WebChat&&null!=window.SteamClient.WebChat.SetNumChatsWithUnreadPriorityMessages){var e=ci.ChatStore.GetChatsWithUnreadPriorityMessages().length;window.SteamClient.WebChat.SetNumChatsWithUnreadPriorityMessages(e)}},e.prototype.GetFriendsList=function(){return R.b(this,void 0,void 0,function(){var t,n,o;return R.e(this,function(e){switch(e.label){case 0:return t=m.Init(at.c),[4,at.f.GetFriendsList(this.m_CMInterface.GetServiceTransport(),t)];case 1:return 1==(n=e.sent()).GetEResult()?this.SetFriendsList(n.Body().friendslist()):(o={message:"ShowFriendsErrorRetryDialog"},window.parent.postMessage(o,"https://steamloopback.host"),Object(I.a)(!1,"GetFriendsList returned",n.GetEResult())),[2]}})})},Object.defineProperty(e.prototype,"not_ready_to_render_reason",{get:function(){if(this.m_bReadyToRender)return"";var e="";return this.m_bPerFriendPreferencesLoaded||(e+="P"),this.m_bReceivedFriendsList||(e+="F"),this.m_bInitialPersonaStatesLoaded||(e+="I"),this.m_bInitialAppInfoLoaded||(e+="A"),e},enumerable:!0,configurable:!0}),e.prototype.UpdateReadyToRenderState=function(){this.m_bReadyToRender||this.m_bReceivedFriendsList&&this.m_bInitialPersonaStatesLoaded&&this.m_bPerFriendPreferencesLoaded&&this.m_bInitialAppInfoLoaded&&(this.m_bReadyToRender=!0,this.m_fnOnReadyToRender&&(this.m_fnOnReadyToRender(),this.m_fnOnReadyToRender=void 0))},e.prototype.ForceReadyToRender=function(){Object(I.a)(this.m_bReadyToRender,"FriendStore: Forcing ready to render, was not ready in time."),this.m_bInitialPersonaStatesLoaded=!0,this.m_bPerFriendPreferencesLoaded=!0,this.m_bInitialAppInfoLoaded=!0,this.UpdateReadyToRenderState()},e.prototype.AddPersonaStateChangedCallback=function(e){return this.m_rgPersonaStateChangeCallbacks.Register(e)},e.prototype.AddPlayerGameChangedCallback=function(e){return this.m_rgPlayerGameChangedCallbacks.Register(e)},e.prototype.BIsInvisibleMode=function(){return 7==this.m_eUserPersonaState},e.prototype.GetUserDoNotDisturb=function(){return ci.SettingsStore.FriendsSettings.bDoNotDisturbMode},e.prototype.SetUserDoNotDisturb=function(e){ci.SettingsStore.FriendsSettings.bDoNotDisturbMode=e,ci.SettingsStore.BUpdateFriendsSettings(ci.SettingsStore.FriendsSettings)},e.prototype.SetUserPersonaState=function(e){this.UpdateUserPersonaStateInternal(e,!0)},e.prototype.BApprovedNonFriendMessages=function(e){var t=new Date,n=this.m_mapApprovedNonFriendMessages.get(e);return null!=n&&n>t.getTime()},e.prototype.SetApprovedNonFriendMessages=function(e){var o=(new Date).getTime();this.m_mapApprovedNonFriendMessages.set(e,o+864e5);var i="";this.m_mapApprovedNonFriendMessages.forEach(function(e,t,n){o<e&&(0!=i.length&&(i+=","),i+=t.toString()+"="+e.toString())}),this.m_FriendStorePrefs.strNonFriendsAllowedToMsg=i,ci.SettingsStore.StoreObjectInLocalStorage(gt,this.m_FriendStorePrefs)},e.prototype.OnParentalLockChanged=function(e){!this.m_bParentalLocked&&e?(this.m_eUserPersonaStateParental=this.m_eUserPersonaState,this.UpdateUserPersonaStateInternal(0,!1),this.m_bParentalLocked=e):this.m_bParentalLocked&&!e&&(this.m_bParentalLocked=e,this.UpdateUserPersonaStateInternal(this.m_eUserPersonaStateParental,!1))},e.prototype.UpdateUserPersonaStateInternal=function(e,t,n){void 0===n&&(n=!1),this.m_bParentalLocked||e==this.m_eUserPersonaState&&this.m_bUserSetPersonaState==t||(0==e&&t?ci.SignOutOfFriends(void 0):(this.m_eUserPersonaState=e,this.m_bUserSetPersonaState=t,n||this.SendPersonaStateToServer(),(t||1==this.m_eUserPersonaState)&&(this.m_FriendStorePrefs.ePersonaState=e,ci.SettingsStore.StoreObjectInLocalStorage(gt,this.m_FriendStorePrefs))))},e.prototype.SendPersonaStateToServer=function(e){void 0===e&&(e=!1);var t=m.Init(b.c,716);t.Body().set_persona_state(this.m_eUserPersonaState),t.Body().set_persona_set_by_user(this.m_bUserSetPersonaState),t.Body().set_need_persona_response(e),this.m_CMInterface.Send(t)},e.prototype.AdjustPersonaStateForIdleTime=function(e){return(1==e||3==e)&&7200<=ci.IdleTracker.GetUserIdleTime()?4:1==e&&300<=ci.IdleTracker.GetUserIdleTime()?3:e},Object.defineProperty(e.prototype,"FriendGroupStore",{get:function(){return this.m_FriendGroupStore},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ClanStore",{get:function(){return this.m_ClanStore},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"FavoritesStore",{get:function(){return this.m_FavoritesStore},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"all_friends",{get:function(){var t=this,n=[];return this.m_setFriendAccountIDs.forEach(function(e){n.push(t.GetFriend(e))}),n},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"all_friends_accountids",{get:function(){return this.m_setFriendAccountIDs},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"friends_list_ready",{get:function(){return this.m_bReceivedFriendsList},enumerable:!0,configurable:!0}),e.prototype.GetFriend=function(e){var t=this.m_mapPlayerCache.get(e);if(t){if(!t.is_friend)return null}else Object(I.a)(!1,"Friend missing from cache: "+e);return t},e.prototype.GetPlayer=function(e){var t=this.m_mapPlayerCache.get(e);return t||(t=this.AddPlayerToCache(e,3)),t},e.prototype.AddPlayerToCache=function(e,t,n){if(void 0===n&&(n=!0),this.m_mapPlayerCache.has(e))return this.m_mapPlayerCache.get(e);var o=new ft(e);return this.m_mapPlayerCache.set(e,o),o},e.prototype.GetPlayerIfCached=function(e){return this.m_mapPlayerCache.get(e)},e.prototype.GetFriendIfCached=function(e){var t=this.m_mapPlayerCache.get(e);return t&&t.is_friend?t:null},e.prototype.SetPersonasOffline=function(t){var n=this;this.m_mapPlayerCache.forEach(function(e){t&&(e.is_friend||e.accountid==n.self.accountid)||e.persona.is_online&&e.persona.ClearStateOnDisconnect()})},e.prototype.QueueFriendPersonaStateLoad=function(e){this.m_setFriendsNeedingPersonaStateLoad.add(e.accountid),this.m_iIntervalSubscribeToPersonaStateUpdates||(this.m_iIntervalSubscribeToPersonaStateUpdates=SetBackgroundTimeout(this.SubscribeToMissingPersonaStates.bind(this),50))},Object.defineProperty(e.prototype,"self",{get:function(){return this.m_self},enumerable:!0,configurable:!0}),e.prototype.SubscribeToMissingPersonaStates=function(){var r=this;this.m_iIntervalSubscribeToPersonaStateUpdates&&(ClearBackgroundTimeout(this.m_iIntervalSubscribeToPersonaStateUpdates),this.m_iIntervalSubscribeToPersonaStateUpdates=0);var a=[];if(this.m_setFriendsNeedingPersonaStateLoad.forEach(function(e){var t=r.m_mapPlayerCache.get(e);t&&!t.persona.m_bInitialized&&a.push(t.accountid)}),this.m_setFriendsNeedingPersonaStateLoad.clear(),a.length){var e=m.Init(b.p,815);e.Body().set_persona_state_requested(1106);for(var t=0,n=a;t<n.length;t++){var o=n[t];e.Body().add_friends(D.a.InitFromAccountID(o).ConvertTo64BitString())}this.m_CMInterface.Send(e),SetBackgroundTimeout(function(){for(var e=0,t=0,n=a;t<n.length;t++){var o=n[t],i=r.GetPlayer(o);i&&!i.persona.m_bInitialized&&(i.m_bPersonaStateReady=!0,i.persona.m_bNameInitialized||(Object(I.a)(i.m_bPersonaStateLoadRequested,"PersonaStateLoadRequested not set"),r.m_setFriendsNeedingPersonaStateLoad.add(o)),e++)}0<e?r.m_nMissingPersonaStateRetryCount<r.m_nMissingPersonaStateMaxRetries?(r.m_nMissingPersonaStateRetryCount++,r.m_iIntervalSubscribeToPersonaStateUpdates||(r.m_iIntervalSubscribeToPersonaStateUpdates=SetBackgroundTimeout(r.SubscribeToMissingPersonaStates.bind(r),1e3))):console.log("Giving up persona state retries with",e,"still not filled",r.m_setFriendsNeedingPersonaStateLoad):r.m_nMissingPersonaStateRetryCount=0},500)}},e.prototype.InitializeIdleTracking=function(){this.m_bAwayCallbackFired&&(this.m_bAwayCallbackFired=!1,ci.IdleTracker.AddOnIdleCallback(this.OnIdle.bind(this,3),300)),this.m_bSnoozeCallbackFired&&(this.m_bSnoozeCallbackFired=!1,ci.IdleTracker.AddOnIdleCallback(this.OnIdle.bind(this,4),7200))},e.prototype.ResetIdleState=function(){this.m_bUserSetPersonaState||3!=this.m_eUserPersonaState&&4!=this.m_eUserPersonaState||this.UpdateUserPersonaStateInternal(1,!1),this.m_bNextActivityCallbackRegistered=!1,this.InitializeIdleTracking()},e.prototype.OnIdle=function(e){3==e?(this.m_bAwayCallbackFired=!0,this.m_bUserSetPersonaState||4==this.m_eUserPersonaState||this.UpdateUserPersonaStateInternal(e,!1)):4==e&&(this.m_bSnoozeCallbackFired=!0,this.m_bUserSetPersonaState||this.UpdateUserPersonaStateInternal(e,!1)),this.m_bNextActivityCallbackRegistered||(this.m_bNextActivityCallbackRegistered=!0,ci.IdleTracker.AddOnNextActivityCallback(this.ResetIdleState.bind(this)))},e.prototype.SendFriendInvite=function(e){var t=m.Init(nt.a);return t.Body().set_steamid(e.persona.m_steamid.ConvertTo64BitString()),nt.k.AddFriend(this.m_CMInterface.GetServiceTransport(),t).then(function(e){return e.Body().friend_relationship()})},e.prototype.RemoveFriend=function(e){var t=m.Init(nt.g);return t.Body().set_steamid(e.persona.m_steamid.ConvertTo64BitString()),nt.k.RemoveFriend(this.m_CMInterface.GetServiceTransport(),t).then(function(e){return e.Body().friend_relationship()})},e.prototype.BlockPlayer=function(e,t){void 0===t&&(t=!1);var n=m.Init(nt.f);return n.Body().set_steamid(e.persona.m_steamid.ConvertTo64BitString()),t&&n.Body().set_unignore(!0),nt.k.IgnoreFriend(this.m_CMInterface.GetServiceTransport(),n).then(function(e){return e.Body().friend_relationship()})},e.prototype.AddFriend=function(e,t){var n=new D.a(e).GetAccountID(),o=this.m_setIncomingInviteAccountIDs.has(n);2==t?o||((a=this.AddPlayerToCache(n,3,!1)).efriendrelationship=t,a.LoadIfNecessary(),this.m_setIncomingInviteAccountIDs.add(n),this.m_FriendGroupStore.OnIncomingInviteAdded(n)):o&&((a=this.AddPlayerToCache(n,3,!1)).efriendrelationship=t,this.m_setIncomingInviteAccountIDs.delete(n),this.m_FriendGroupStore.OnIncomingInviteRemoved(n));4==t?((a=this.AddPlayerToCache(n,3,!1)).efriendrelationship=t,a.LoadIfNecessary(),this.m_FriendGroupStore.OnOutgoingInviteAdded(n)):this.m_FriendGroupStore.OnOutgoingInviteRemoved(n);var i=this.m_setFriendAccountIDs.has(n);if(Object(O.b)(t)){var r=void 0;i?r=this.GetFriend(n):(this.m_setFriendAccountIDs.add(n),(r=this.AddPlayerToCache(n,2,!1)).LoadIfNecessary(),this.m_FriendGroupStore.OnFriendAdded(n)),r.efriendrelationship=t}else{var a;i&&(this.m_FriendGroupStore.OnFriendRemoved(n),this.m_FavoritesStore.OnFriendRemoved(n),this.m_setFriendAccountIDs.delete(n)),(a=this.AddPlayerToCache(n,3,!1)).efriendrelationship=t}},e.prototype.SetFriendsList=function(e){var t=e.friends();if(!e.bincremental()){for(var n=0,o=this.all_friends;n<o.length;n++){o[n].efriendrelationship=0}this.m_setFriendAccountIDs.clear(),this.m_setIncomingInviteAccountIDs.clear(),this.m_FriendGroupStore.OnFullFriendsListUpdateStart(),this.m_ClanStore.ClearClanMembershipData()}for(var i=0,r=t;i<r.length;i++){var a=r[i],s=new D.a(a.ulfriendid());if(s.BIsIndividualAccount()){var c=a.efriendrelationship();this.AddFriend(s.ConvertTo64BitString(),c)}else s.BIsClanAccount()&&this.m_ClanStore.OnClanRelationshipChanged(s,a.efriendrelationship())}if(!e.bincremental()){this.m_FriendGroupStore.OnFullFriendsListUpdateComplete(),this.m_ClanStore.LoadMissingClanPersonas(),this.m_bReceivedFriendsList=!0;var l=m.Init(pe.R);pe.W.RequestFriendPersonaStates(this.m_CMInterface.GetServiceTransport(),l),this.RequestPerFriendPreferences(),0==this.m_setFriendAccountIDs.size?(this.m_bInitialPersonaStatesLoaded=!0,this.StartWaitForInitialAppInfo()):this.SubscribeToMissingPersonaStates()}},e.prototype.OnFriendPersonaStateChanged=function(e,t,n,o){if(ci.NotificationManager.BNotificationsPermitted()&&ci.SettingsStore.BReady()&&!ci.FriendStore.GetUserDoNotDisturb()){if(o&&e.persona.is_ingame&&e.BShowInGameNotification()){var i=e.current_game_name;return e.persona.is_in_nonsteam_game||this.m_FriendInGameNotificationStore.RecordFriendInGameImpression(e.persona.m_unGamePlayedAppID),void(i&&ci.NotificationManager.DisplayNotificationFromFriend(e,{title:e.display_name,body:Object($.b)("#Friend_StateChange_InGame",i),rawbody:i,tag:"state_"+e.accountid,state:"ingame",steamid:e.persona.m_steamid.ConvertTo64BitString()}))}0==t&&0!=n&&e.BShowOnlineNotification()&&ci.NotificationManager.DisplayNotificationFromFriend(e,{title:e.display_name,body:Object($.b)("#Friend_StateChange_Online"),tag:"state_"+e.accountid,state:"online",steamid:e.persona.m_steamid.ConvertTo64BitString()})}},e.prototype.PlayJoinGameSound=function(){ci.FriendStore.GetUserDoNotDisturb()||ci.AudioPlaybackManager.PlayAudioURL(G.a.COMMUNITY_CDN_URL+"public/sounds/webui/ui_steam_smoother_friend_join.m4a")},e.prototype.PlayFriendOnlineSound=function(){ci.FriendStore.GetUserDoNotDisturb()||ci.AudioPlaybackManager.PlayAudioURL(G.a.COMMUNITY_CDN_URL+"public/sounds/webui/ui_steam_smoother_friend_online.m4a")},e.prototype.FillPerFriendNotificationSettingsFromMessage=function(e,t){e.Notifications_ShowInGame=t.notifications_showingame(),e.Notifications_ShowMessage=t.notifications_showmessages(),e.Notifications_ShowOnline=t.notifications_showonline(),e.Notifications_SendMobile=t.notifications_sendmobile(),e.Sounds_PlayInGame=t.sounds_showingame(),e.Sounds_PlayMessage=t.sounds_showmessages(),e.Sounds_PlayOnline=t.sounds_showonline()},e.prototype.RequestPerFriendPreferences=function(){var a=this,e=m.Init(nt.e);nt.k.GetPerFriendPreferences(this.m_CMInterface.GetServiceTransport(),e).then(function(r){Object(d.runInAction)(function(){for(var e=0,t=r.Body().preferences();e<t.length;e++){var n=t[e],o=a.GetPlayer(n.accountid());if(o){o.nickname=n.nickname()||void 0;var i=new _t;a.FillPerFriendNotificationSettingsFromMessage(i,n),o.notification_settings=i}else console.log("Got per-friend preferences back for a user we don't have a Player for:",n)}a.m_bPerFriendPreferencesLoaded=!0,a.UpdateReadyToRenderState()})})},e.prototype.StartWaitForInitialAppInfo=function(){return R.b(this,void 0,void 0,function(){return R.e(this,function(e){switch(e.label){case 0:return[4,Promise.all(this.m_InitialAppInfoPromises)];case 1:return e.sent(),this.m_bInitialAppInfoLoaded=!0,this.UpdateReadyToRenderState(),[2]}})})},e.prototype.FillMessageFromPerFriendNotificationSettings=function(e,t){e.set_notifications_showingame(t.Notifications_ShowInGame),e.set_notifications_showmessages(t.Notifications_ShowMessage),e.set_notifications_showonline(t.Notifications_ShowOnline),e.set_notifications_sendmobile(t.Notifications_SendMobile),e.set_sounds_showingame(t.Sounds_PlayInGame),e.set_sounds_showmessages(t.Sounds_PlayMessage),e.set_sounds_showonline(t.Sounds_PlayOnline)},e.prototype.SetPlayerNickname=function(e,t){return this.SetPlayerPerFriendPreferences(e,t,e.notification_settings)},e.prototype.SetPlayerNotificationSettings=function(e,t){return this.SetPlayerPerFriendPreferences(e,e.nickname,t)},e.prototype.SetPlayerPerFriendPreferences=function(e,t,n){var o=m.Init(nt.i),i=o.Body().preferences();return i.set_accountid(e.accountid),i.set_nickname(t),this.FillMessageFromPerFriendNotificationSettings(i,n),nt.k.SetPerFriendPreferences(ci.CMInterface.GetServiceTransport(),o).then(function(e){return e.GetEResult()})},e.prototype.InviteToGame=function(e,t){var n=m.Init(w.d,7005);n.Hdr().set_routing_appid(t),n.Body().set_steam_id_src(this.m_CMInterface.steamid.ConvertTo64BitString()),n.Body().set_steam_id_dest(D.a.InitFromAccountID(e.accountid).ConvertTo64BitString()),this.m_CMInterface.Send(n)},e.prototype.InviteToLobby=function(e,t,n){var o=m.Init(w.e,6621);o.Hdr().set_routing_appid(t),o.Body().set_steam_id_lobby(n),o.Body().set_steam_id_user_invited(D.a.InitFromAccountID(e.accountid).ConvertTo64BitString()),this.m_CMInterface.Send(o)},e.prototype.InviteToWatch=function(e){ci.ShowFriendChatDialog(ci.GetDefaultBrowserContext(),e.accountid,!0);ci.BroadcastStore.InviteToWatch(e.accountid).then(function(e){})},e.prototype.InviteToTrade=function(e){var t=m.Init(ot.g,7701);t.Body().set_other_steamid(e.persona.m_steamid.ConvertTo64BitString());var n=ci.ShowFriendChatDialog(ci.GetDefaultBrowserContext(),e.accountid,!0);n&&n.AddNewTradeRequestAndNotify(ci.FriendStore.self.accountid,ci.GetServerRTime32(),e.persona.m_steamid.ConvertTo64BitString(),0),this.m_CMInterface.Send(t)},e.prototype.CancelTradeRequest=function(e){var t=m.Init(ot.f,7706);t.Body().set_other_steamid(e),this.m_CMInterface.Send(t)},e.prototype.RespondToTradeRequest=function(e,t){var n=m.Init(ot.h,7703);n.Body().set_trade_request_id(e),n.Body().set_response(t?0:1),this.m_CMInterface.Send(n)},e.prototype.OpenTradeWindow=function(e){var t="Trade"+e,n=G.a.COMMUNITY_BASE_URL+"trade/"+e,o=window.open(n,t,"height=1120,width=1028,resize=yes,scrollbars=yes");return!!o&&(o.focus(),!0)},e.prototype.FillInChatUsabilityMetrics=function(e){for(var t=0,n=0,o=0,i=0,r=this.all_friends;i<r.length;i++){var a=r[i];3==a.efriendrelationship&&(t++,a.persona.is_online&&n++,a.persona.is_ingame&&o++)}e.metrics().set_friends_count(t),e.metrics().set_friends_online_count(n),e.metrics().set_friends_in_game_count(o),this.m_FriendGroupStore.FillInChatUsabilityMetrics(e),this.m_FavoritesStore.FillInChatUsabilityMetrics(e)},R.c([d.observable],e.prototype,"m_bPerFriendPreferencesLoaded",void 0),R.c([d.observable],e.prototype,"m_bReceivedFriendsList",void 0),R.c([d.observable],e.prototype,"m_bInitialPersonaStatesLoaded",void 0),R.c([d.observable],e.prototype,"m_bInitialAppInfoLoaded",void 0),R.c([d.computed],e.prototype,"not_ready_to_render_reason",null),R.c([d.action],e.prototype,"OnParentalLockChanged",null),R.c([d.action],e.prototype,"SetPersonasOffline",null),R.c([d.action],e.prototype,"SetFriendsList",null),R.c([T.a,Object(ht.a)(100)],e.prototype,"PlayJoinGameSound",null),R.c([T.a,Object(ht.a)(100)],e.prototype,"PlayFriendOnlineSound",null),R.c([d.action],e.prototype,"SetPlayerNickname",null),R.c([d.action],e.prototype,"SetPlayerNotificationSettings",null),R.c([d.action],e.prototype,"SetPlayerPerFriendPreferences",null),R.c([d.action],e.prototype,"InviteToGame",null),R.c([d.action],e.prototype,"InviteToLobby",null),R.c([d.action],e.prototype,"InviteToWatch",null),R.c([d.action],e.prototype,"InviteToTrade",null),R.c([d.action],e.prototype,"CancelTradeRequest",null),R.c([d.action],e.prototype,"RespondToTradeRequest",null),R.c([d.action],e.prototype,"OpenTradeWindow",null),e}(),St=-6;(mt=ut||(ut={}))[mt.eOnlineOnly=0]="eOnlineOnly",mt[mt.eOnlineOnlyNotInGame=1]="eOnlineOnlyNotInGame",mt[mt.eOfflineOnly=2]="eOfflineOnly",mt[mt.eIncomingInvites=3]="eIncomingInvites",mt[mt.eAll=4]="eAll";var yt=function(){function e(e){this.m_eDisplayType=ut.eAll,this.m_strName="",this.m_bCollapsed=!1,this.m_OnHeaderClick=void 0,this.m_rgAccountIDMembers=d.observable.array(),this.m_setMembers=new Set,this.m_strName=e}return Object.defineProperty(e.prototype,"name",{get:function(){return this.m_strName},set:function(e){this.m_strName=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"icon_url",{get:function(){return""},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"display_type",{get:function(){return this.m_eDisplayType},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"onheaderclick",{get:function(){return this.m_OnHeaderClick},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"collapsed",{get:function(){return this.m_bCollapsed},set:function(e){this.m_bCollapsed=e},enumerable:!0,configurable:!0}),e.prototype.GetCurrentMemberSet=function(){return this.m_setMembers},Object.defineProperty(e.prototype,"member_count",{get:function(){return this.display_type==ut.eAll?this.unfiltered_count:this.member_list.length},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"unfiltered_count",{get:function(){return this.member_accountid_list.length},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"member_counts",{get:function(){for(var e=0,t=0,n=0,o=this.member_list_unsorted;n<o.length;n++){var i=o[n];i.persona.is_online&&(e++,i.persona.is_ingame&&t++)}return{online:e,ingame:t}},enumerable:!0,configurable:!0}),e.prototype.SetOnHeaderClick=function(e){this.m_OnHeaderClick=e},e.prototype.Clear=function(){this.m_rgAccountIDMembers.clear(),this.m_setMembers.clear()},e.prototype.AddMember=function(e){this.HasMember(e)||(this.m_setMembers.add(e),this.m_rgAccountIDMembers.push(e))},e.prototype.RemoveMember=function(e){this.HasMember(e)&&(this.m_setMembers.delete(e),M.d(this.m_rgAccountIDMembers,e))},e.prototype.HasMember=function(e){return this.m_setMembers.has(e)},Object.defineProperty(e.prototype,"GetRawMemberList",{get:function(){return this.m_rgAccountIDMembers.map(function(e){return ci.FriendStore.GetPlayer(e)})},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"member_list",{get:function(){var e=this.member_list_unsorted.slice();return e.sort(ft.DefaultFriendSortComparator),e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"member_list_unsorted",{get:function(){for(var e=[],t=0,n=this.GetRawMemberList;t<n.length;t++){var o=n[t];if((this.display_type!=ut.eOnlineOnly||o.persona.is_online)&&(this.display_type!=ut.eOfflineOnly||!o.persona.is_online)){if(this.display_type==ut.eOnlineOnlyNotInGame){if(!o.persona.is_online||o.persona.is_ingame)continue;if(o.persona.m_broadcastAppId&&o.persona.m_broadcastAppId==Q.appID)continue}e.push(o)}}return e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"member_accountid_list",{get:function(){return this.m_rgAccountIDMembers},enumerable:!0,configurable:!0}),R.c([d.observable],e.prototype,"m_strName",void 0),R.c([d.observable],e.prototype,"m_bCollapsed",void 0),R.c([d.computed],e.prototype,"member_count",null),R.c([d.computed],e.prototype,"unfiltered_count",null),R.c([d.computed],e.prototype,"member_counts",null),R.c([d.action],e.prototype,"SetOnHeaderClick",null),R.c([d.action],e.prototype,"Clear",null),R.c([d.action],e.prototype,"AddMember",null),R.c([d.action],e.prototype,"RemoveMember",null),R.c([d.computed],e.prototype,"member_list",null),R.c([d.computed],e.prototype,"member_list_unsorted",null),e}(),Ct=function(r){function e(e,t,n,o){void 0===t&&(t=-1),void 0===n&&(n=!1),void 0===o&&(o=!1);var i=r.call(this,e)||this;return i.m_bModifiable=!1,i.m_bAcceptsGroupRemovals=!1,i.m_iGroupID=t,i.m_bModifiable=n,i.m_bAcceptsGroupRemovals=o,i}return R.d(e,r),Object.defineProperty(e.prototype,"id",{get:function(){return this.m_iGroupID},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"unique_id",{get:function(){return""+this.m_iGroupID},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"modifiable",{get:function(){return this.m_bModifiable},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"accepts_group_removals",{get:function(){return this.m_bAcceptsGroupRemovals},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"should_filter_categorized_friends",{get:function(){return!1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"GetRawMemberList",{get:function(){return this.member_accountid_list.map(function(e){return ci.FriendStore.GetPlayer(e)})},enumerable:!0,configurable:!0}),e.prototype.GetMembersMatchingSearch=function(e){for(var t=[],n=0,o=this.GetRawMemberList;n<o.length;n++){var i=o[n];i.BMatchesSearchString(e,!1)&&t.push(i)}return t.sort(ft.DefaultFriendSortComparator),t},R.c([d.computed],e.prototype,"GetRawMemberList",null),e}(yt),It=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return R.d(t,e),Object.defineProperty(t.prototype,"display_type",{get:function(){return ci.SettingsStore.FriendsSettings.bHideOfflineFriendsInTagGroups?ut.eOnlineOnly:ut.eAll},enumerable:!0,configurable:!0}),t}(Ct),Et=function(o){function e(e,t){var n=o.call(this,e,t,!1,!0)||this;return n.m_eDisplayType=ut.eOnlineOnlyNotInGame,n}return R.d(e,o),Object.defineProperty(e.prototype,"unique_id",{get:function(){return"all"},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"display_type",{get:function(){return ci.SettingsStore.FriendsSettings.bCategorizeInGameFriendsByGame?ut.eOnlineOnlyNotInGame:ut.eOnlineOnly},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"should_filter_categorized_friends",{get:function(){return ci.SettingsStore.FriendsSettings.bHideCategorizedFriends},enumerable:!0,configurable:!0}),e}(Ct),Ot=function(n){function e(e,t){return n.call(this,e,t,!1,!0)||this}return R.d(e,n),Object.defineProperty(e.prototype,"unique_id",{get:function(){return"offline"},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"should_filter_categorized_friends",{get:function(){var e=ci.SettingsStore.FriendsSettings;return e.bHideCategorizedFriends&&!e.bHideOfflineFriendsInTagGroups},enumerable:!0,configurable:!0}),e}(Ct),wt=function(n){function e(e,t){return n.call(this,e,t,!1,!0)||this}return R.d(e,n),Object.defineProperty(e.prototype,"unique_id",{get:function(){return"outgoing"},enumerable:!0,configurable:!0}),e}(Ct),Mt=function(n){function e(e,t){return n.call(this,e,t,!1,!0)||this}return R.d(e,n),Object.defineProperty(e.prototype,"unique_id",{get:function(){return"ingame"},enumerable:!0,configurable:!0}),e}(Ct),Dt=function(o){function e(e,t){var n=o.call(this,e,t,!1,!0)||this;return n.m_mapSteamIDToMutualFriends=d.observable.map(),n.m_unMutualFriendsCacheHash=0,n.m_eDisplayType=ut.eIncomingInvites,n}return R.d(e,o),Object.defineProperty(e.prototype,"unique_id",{get:function(){return"incominginvites"},enumerable:!0,configurable:!0}),e.prototype.GetMutualFriendsCacheHash=function(){return this.m_unMutualFriendsCacheHash},e.prototype.SetMutualFriendsCacheHash=function(e){this.m_unMutualFriendsCacheHash=e},e.prototype.SetMutualFriends=function(e){this.m_mapSteamIDToMutualFriends.replace(e)},Object.defineProperty(e.prototype,"map_steamid_to_mutual_friends",{get:function(){return this.m_mapSteamIDToMutualFriends},enumerable:!0,configurable:!0}),e}(Ct),Tt=function(t){function e(e){return t.call(this,"",e,!1,!1)||this}return R.d(e,t),Object.defineProperty(e.prototype,"is_initialized",{get:function(){return 0!=this.id&&ci.AppInfoStore.GetAppInfo(this.id).is_initialized},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"unique_id",{get:function(){return"game_"+this.id},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"name",{get:function(){return!this.is_initialized||this.id<0?"":ci.AppInfoStore.GetAppInfo(this.id).name},set:function(e){},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"icon_url",{get:function(){return!this.is_initialized||this.id<0?"":ci.AppInfoStore.GetAppInfo(this.id).icon_url},enumerable:!0,configurable:!0}),e.prototype.PlayerGroupSortComparator=function(e,t,n,o){var i=e.persona.player_group,r=t.persona.player_group,a=i?Math.max(e.persona.player_group_size,n.get(i)||1):1,s=r?Math.max(t.persona.player_group_size,n.get(r)||1):1;return a!=s?s-a:1<a&&i!=r?i.localeCompare(r):o(e,t)},Object.defineProperty(e.prototype,"member_list",{get:function(){for(var n=this,e=[],o=new Map,t=0,i=this.GetRawMemberList;t<i.length;t++){var r=i[t];if(e.push(r),r.persona.player_group){var a=o.get(r.persona.player_group);o.set(r.persona.player_group,a?a+1:1)}}var s=ft.DefaultFriendSortComparator;return 0==this.id?e.sort(s):e.sort(function(e,t){return n.PlayerGroupSortComparator(e,t,o,s)}),e},enumerable:!0,configurable:!0}),R.c([d.computed],e.prototype,"member_list",null),e}(Ct),Gt={groups:{offline:!0,outgoing:!0}},Rt="FriendGroupCollapse",Nt=function(){function e(){this.m_mapCollapsePrefs=d.observable.map()}return e.prototype.Init=function(){var n=this;ci.SettingsStore.GetObjectFromLocalStorageWhenReady(Rt,Gt).then(function(e){for(var t in n.m_mapCollapsePrefs.clear(),e.groups)n.m_mapCollapsePrefs.set(t,e.groups[t])})},e.prototype.GetUserGroupCollapsed=function(e){return!!this.m_mapCollapsePrefs.get(e)},e.prototype.SetUserGroupCollapsed=function(e,t){!!this.m_mapCollapsePrefs.get(e)!=t&&(t||Gt.groups[e]?this.m_mapCollapsePrefs.set(e,t):this.m_mapCollapsePrefs.delete(e),this.WritePrefs())},e.prototype.ToggleUserGroupCollapsed=function(e){this.SetUserGroupCollapsed(e,!this.GetUserGroupCollapsed(e))},e.prototype.WritePrefs=function(){ci.SettingsStore.StoreObjectInLocalStorage(Rt,{groups:this.m_mapCollapsePrefs.toJSON()})},R.c([d.action],e.prototype,"SetUserGroupCollapsed",null),R.c([d.action],e.prototype,"ToggleUserGroupCollapsed",null),e}(),Lt=function(){function e(e){this.m_FriendGroupDisplayPrefs=new Nt,this.m_mapGroups=d.observable.map(),this.m_mapGameGroups=d.observable.map(),this.m_singletonGameGroup=new Tt(0),this.m_groupAllFriends=new Et(Object($.b)("#FriendGroup_Online"),-1),this.m_groupOfflineFriends=new Ot(Object($.b)("#FriendGroup_Offline"),-3),this.m_groupIngameFriends=new Mt(Object($.b)("#FriendGroup_InGame"),-4),this.m_groupIncomingInvites=new Dt(Object($.b)("#FriendGroup_IncomingInvites"),-5),this.m_groupOutgoingInvites=new wt(Object($.b)("#FriendGroup_Outgoing"),-6),this.m_FriendStore=e,this.m_groupOfflineFriends.m_eDisplayType=ut.eOfflineOnly}return e.prototype.Init=function(e){var t=this;this.m_CMInterface=e,this.m_FriendGroupDisplayPrefs.Init(),this.m_CMInterface.AddOnLogonCallback(function(){return R.b(t,void 0,void 0,function(){var t,n;return R.e(this,function(e){switch(e.label){case 0:return t=m.Init(at.a),[4,at.f.GetCategories(this.m_CMInterface.GetServiceTransport(),t)];case 1:return 1==(n=e.sent()).GetEResult()&&this.RecvCategoriesList(n.Body()),[2]}})})},47)},Object.defineProperty(e.prototype,"all_friends",{get:function(){return this.m_groupAllFriends},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ingame_group",{get:function(){return this.m_groupIngameFriends},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"incoming_invites_group",{get:function(){return this.m_groupIncomingInvites},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"outgoing_invites_group",{get:function(){return this.m_groupOutgoingInvites},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"friend_groups",{get:function(){return this.game_groups.concat(this.user_groups,this.default_groups)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"groupDisplayPrefs",{get:function(){return this.m_FriendGroupDisplayPrefs},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"user_groups",{get:function(){var t=[];return this.m_mapGroups.forEach(function(e){t.push(e)}),t.sort(function(e,t){return e.name.localeCompare(t.name)}),t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"game_groups",{get:function(){var t=[],n=2;return 1==this.m_singletonGameGroup.unfiltered_count&&(n=1),this.m_mapGameGroups.forEach(function(e){e.name&&e.member_count>=n&&t.push(e)}),t.sort(function(e,t){return e.member_count==t.member_count?e.name.localeCompare(t.name):t.member_count-e.member_count}),t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"singleton_game_group",{get:function(){if(1==this.m_singletonGameGroup.unfiltered_count){var e=this.m_singletonGameGroup.member_accountid_list[0];if(!ci.FriendStore.GetPlayer(e).persona.is_in_nonsteam_game)return}return this.m_singletonGameGroup},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"default_groups",{get:function(){return[this.m_groupAllFriends,this.m_groupOfflineFriends]},enumerable:!0,configurable:!0}),e.prototype.OnFullFriendsListUpdateStart=function(){this.m_groupOfflineFriends.Clear(),this.m_groupAllFriends.Clear(),this.m_groupIncomingInvites.Clear(),this.m_groupOutgoingInvites.Clear()},e.prototype.OnFullFriendsListUpdateComplete=function(){this.m_mapGameGroups.clear(),this.m_singletonGameGroup.Clear(),this.m_groupIngameFriends.Clear();for(var e=0,t=this.m_FriendStore.all_friends;e<t.length;e++){var n=t[e];if(n.persona.is_ingame){var o=n.persona.is_in_nonsteam_game?St:n.persona.m_unGamePlayedAppID;this.OnFriendGameChanged(n.accountid,0,o)}}},e.prototype.OnPersonaStateCacheReset=function(){this.m_mapGameGroups.clear(),this.m_singletonGameGroup.Clear(),this.m_groupIngameFriends.Clear()},e.prototype.OnFriendAdded=function(e){this.m_groupAllFriends.AddMember(e),this.m_groupOfflineFriends.AddMember(e)},e.prototype.OnFriendRemoved=function(t){this.m_groupAllFriends.RemoveMember(t),this.m_groupOfflineFriends.RemoveMember(t),this.m_groupIngameFriends.RemoveMember(t),this.m_singletonGameGroup.RemoveMember(t),this.m_mapGroups.forEach(function(e){e.RemoveMember(t)}),this.m_mapGameGroups.forEach(function(e){e.RemoveMember(t)})},e.prototype.OnFriendGameChanged=function(e,t,n){var o=t==St?this.m_singletonGameGroup:0!=t?this.m_mapGameGroups.get(t):null,i=n==St?this.m_singletonGameGroup:0!=n?this.m_mapGameGroups.get(n):null;if(!(o&&i&&t==n||i&&i.HasMember(e))){if(o&&o.HasMember(e)&&(o.RemoveMember(e),o!=this.m_singletonGameGroup&&(0==o.unfiltered_count?this.m_singletonGameGroup.RemoveMember(e):1==o.unfiltered_count&&this.m_singletonGameGroup.AddMember(o.member_accountid_list[0]))),i)i!=this.m_singletonGameGroup&&(1==i.unfiltered_count?this.m_singletonGameGroup.RemoveMember(i.member_accountid_list[0]):0==i.unfiltered_count&&this.m_singletonGameGroup.AddMember(e)),i.AddMember(e);else if(0!=n){var r=new Tt(n);r.AddMember(e),this.m_singletonGameGroup.AddMember(e),this.m_mapGameGroups.set(n,r)}0!=n?this.m_groupIngameFriends.AddMember(e):this.m_groupIngameFriends.RemoveMember(e)}},e.prototype.OnIncomingInviteAdded=function(e){this.m_groupIncomingInvites.AddMember(e)},e.prototype.OnIncomingInviteRemoved=function(e){this.m_groupIncomingInvites.RemoveMember(e)},e.prototype.OnOutgoingInviteAdded=function(e){this.m_groupOutgoingInvites.AddMember(e)},e.prototype.OnOutgoingInviteRemoved=function(e){this.m_groupOutgoingInvites.RemoveMember(e)},e.prototype.EnsureMutualFriendsForIncomingInvites=function(){var l=this;function e(e){for(var t=2166136261,n=0;n<e.length;++n)t^=e.charCodeAt(n),t+=(t<<1)+(t<<4)+(t<<7)+(t<<8)+(t<<24);return t>>>0}for(var p=0,t=0,n=this.m_groupIncomingInvites.member_list;t<n.length;t++){var o=n[t];p^=e(""+o.accountid)}if(this.m_groupIncomingInvites.GetMutualFriendsCacheHash()!=p){this.m_groupIncomingInvites.SetMutualFriendsCacheHash(p);var i=m.Init(nt.d);nt.k.GetMutualFriendsForIncomingInvites(this.m_CMInterface.GetServiceTransport(),i).then(function(e){if(1==e.GetEResult()&&l.m_groupIncomingInvites.GetMutualFriendsCacheHash()==p){for(var t=d.observable.map(),n=0,o=e.Body().incoming_invite_mutual_friends_lists();n<o.length;n++){for(var i=o[n],r=new Set,a=0,s=i.mutual_friend_account_ids();a<s.length;a++){var c=s[a];r.add(c)}t.set(i.steamid(),r)}l.m_groupIncomingInvites.SetMutualFriends(t)}})}},e.prototype.CreateGroup=function(a,s){var c=this,n=m.Init(b.d,5560);return n.Body().set_groupname(a),s&&n.Body().set_steamid_friends(s),new Promise(function(e,t){c.m_CMInterface.SendMsgAndAwaitResponse(n,b.e).then(function(r){1==r.Body().eresult()&&Object(d.runInAction)(function(){var e=r.Body().groupid(),t=new It(a,r.Body().groupid(),!0);if(s)for(var n=0,o=s;n<o.length;n++){var i=o[n];t.AddMember(new D.a(i).GetAccountID())}c.m_mapGroups.set(e,t)}),e(1==r.Body().eresult())}).catch(function(){e(!1)})})},e.prototype.ManageGroup=function(s,c,l,p){var t=this;if(c==s.name&&!l&&!p)return Promise.resolve(!0);var n=m.Init(b.k,5564);return n.Body().set_groupid(s.id),c&&c!=s.name&&n.Body().set_groupname(c),l&&n.Body().set_steamid_friends_added(l),p&&n.Body().set_steamid_friends_removed(p),new Promise(function(a,e){t.m_CMInterface.SendMsgAndAwaitResponse(n,b.l).then(function(e){if(1==e.Body().eresult()){s.name=c;for(var t=0,n=l;t<n.length;t++){var o=n[t];s.AddMember(new D.a(o).GetAccountID())}for(var i=0,r=p;i<r.length;i++){o=r[i];s.RemoveMember(new D.a(o).GetAccountID())}}a(1==e.Body().eresult())}).catch(function(){a(!1)})})},e.prototype.RemoveGroup=function(t){var n=this,e=m.Init(b.f,5562);e.Body().set_groupid(t.id),this.m_CMInterface.SendMsgAndAwaitResponse(e,b.g).then(function(e){1==e.Body().eresult()&&n.HandleGroupRemoval(t)})},e.prototype.HandleGroupRemoval=function(e){this.m_mapGroups.delete(e.id)},Object.defineProperty(e.prototype,"categorized_friend_set",{get:function(){var t=new Set;return this.m_mapGroups.forEach(function(e){e.member_accountid_list.forEach(t.add.bind(t))}),t},enumerable:!0,configurable:!0}),e.prototype.RecvCategoriesList=function(e){this.m_mapGroups.clear();for(var t=0,n=e.categories();t<n.length;t++){var o=n[t],i=o.groupid(),r=new It(o.name()||"",o.groupid(),!0);r.m_eDisplayType=ut.eAll,this.m_mapGroups.set(i,r);for(var a=0,s=o.accountid_members();a<s.length;a++){var c=s[a];r.AddMember(c)}}},e.prototype.TransferFriendFromToGroup=function(t,n,o){var e,i=this,r=o&&o.modifiable,a=n&&n.modifiable,s=[];r&&((e=m.Init(b.a,5566)).Body().set_groupid(o.id),e.Body().set_steamiduser(t.persona.m_steamid.ConvertTo64BitString()),s.push(this.m_CMInterface.SendMsgAndAwaitResponse(e,b.b).then(function(e){return 1==e.Body().eresult()&&(o.AddMember(t.accountid),!0)})));a&&((e=m.Init(b.n,5568)).Body().set_groupid(n.id),e.Body().set_steamiduser(t.persona.m_steamid.ConvertTo64BitString()),s.push(this.m_CMInterface.SendMsgAndAwaitResponse(e,b.o).then(function(e){return 1==e.Body().eresult()&&(n.RemoveMember(t.accountid),0==n.unfiltered_count&&i.HandleGroupRemoval(n),!0)})));return Promise.all(s)},e.prototype.FillInChatUsabilityMetrics=function(e){var t=this;e.metrics().set_friends_category_count(this.m_mapGroups.size),e.metrics().set_friends_categorized_count(this.categorized_friend_set.size),this.singleton_game_group&&e.metrics().set_friends_in_game_singleton_count(this.singleton_game_group.unfiltered_count),e.metrics().set_game_group_count(this.game_groups.length);var n=function(e){return t.m_FriendGroupDisplayPrefs.GetUserGroupCollapsed(e.unique_id)},o=e.ui_state().category_collapse();o.set_in_game_collapsed(n(this.m_singletonGameGroup)),o.set_online_collapsed(n(this.m_groupAllFriends)),o.set_offline_collapsed(n(this.m_groupOfflineFriends)),o.set_categories_collapsed(M.b(Array.from(this.m_mapGroups.values()),n)),o.set_game_groups_collapsed(M.b(Array.from(this.m_mapGameGroups.values()),n))},R.c([d.computed],e.prototype,"friend_groups",null),R.c([d.computed],e.prototype,"user_groups",null),R.c([d.computed],e.prototype,"game_groups",null),R.c([d.computed],e.prototype,"singleton_game_group",null),R.c([d.computed],e.prototype,"default_groups",null),R.c([d.action],e.prototype,"OnFullFriendsListUpdateComplete",null),R.c([d.action],e.prototype,"OnPersonaStateCacheReset",null),R.c([d.action],e.prototype,"HandleGroupRemoval",null),R.c([d.computed],e.prototype,"categorized_friend_set",null),R.c([d.action],e.prototype,"RecvCategoriesList",null),R.c([d.action],e.prototype,"TransferFriendFromToGroup",null),e}(),kt=function(r){function e(e,t,n,o){var i=r.call(this,e.FriendStore,e,e.CMInterface)||this;return i.LOG=Ae.create(function(){return i.unique_id},!1),i.m_unSortOrder=0,i.m_lastChatLink=null,i.m_groupVoiceActiveMembers=new yt(Object($.b)("#Chat_MemberGroup_VoiceChatting")),i.m_eDesktopNotificationLevel=0,i.m_eMobileNotificationLevel=0,i.m_bUnreadIndicatorMuted=!1,i.m_group=t,i.m_ulGroupID=t.GetGroupID(),i.m_ulChatID=n,i.m_bIsDefaultForGroup=o,i.m_groupVoiceActiveMembers.SetOnHeaderClick(i.StartVoiceChat),i}return R.d(e,r),Object.defineProperty(e.prototype,"VoiceChatStore",{get:function(){return this.ChatStore.VoiceChat},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"unread_message_count",{get:function(){switch(this.GetDesktopNotificationLevel()){case 4:return this.m_cUnreadChatMessages;case 3:case 2:return this.has_unread_mention?1:0;case 1:case 0:default:return 0}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"time_last_activity",{get:function(){var e=this.GetDesktopNotificationLevel(),t=0;switch(this.time_last_ack&&(t=Math.max(this.time_last_ack,t)),e){case 4:t=Math.max(this.time_last_message||0,t);break;case 3:case 2:t=Math.max(this.time_last_mention||0,t);break;case 1:case 0:break;default:Object(I.a)(!1,"unhandled EChatRoomNotificationLevel: "+e)}return t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"has_unread_messages",{get:function(){return this.BIsUnreadIndicatorMuted()?0<this.unread_message_count:this.has_any_unread_messages},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"has_any_unread_messages",{get:function(){return 0<this.m_cUnreadChatMessages},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"has_unread_mention",{get:function(){return this.m_rtLastMention>this.m_rtLastAckedChatMsg},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"time_last_mention",{get:function(){return this.m_rtLastMention},enumerable:!0,configurable:!0}),e.prototype.BHasAckedChatMsg=function(){return this.m_rtLastAckedChatMsg&&0!=this.m_rtLastAckedChatMsg},e.prototype.LoadChatLogs=function(){r.prototype.LoadChatLogs.call(this)},e.prototype.GetMessagesFromTimeRange=function(e,t,n,o,i){var r=this,a=m.Init(pe.s);return a.Body().set_chat_group_id(this.m_ulGroupID),a.Body().set_chat_id(this.m_ulChatID),a.Body().set_max_count(i),a.Body().set_start_time(e),a.Body().set_start_ordinal(t),a.Body().set_last_time(n),a.Body().set_last_ordinal(o),this.LOG("trying to load "+i+" messages in range "+e+":"+t+" - "+n+":"+o),pe.V.GetMessageHistory(this.m_ChatStore.CMInterface.GetServiceTransport(),a).then(function(e){var t=e.GetEResult();if(1!=t)throw t;return{messages:r.GetMessagesFromResponse(e),moreAvailable:e.Body().more_available()}})},e.prototype.GetMessagesFromResponse=function(e){for(var t=e.Body().messages(),n=[],o=t.length-1;0<=o;o--){var i=t[o],r=i.server_message().message()||0,a=void 0,s=void 0;if(0!=r){if(r=i.server_message().message(),a=i.server_message().string_param(),s=i.server_message().accountid_param(),!Ze(r)){this.LOG("unrenderable message "+r);continue}}else if(!i.message()||0==i.message().trim().length)continue;var c=new Ye(i.sender(),i.server_timestamp(),i.ordinal()||0,i.message(),r,a,s);i.deleted()&&(c.eDeleteState=xe.Deleted),n.push(c)}return n},e.prototype.GetBBCodeParser=function(){return this.m_ChatStore.ChatRoomBBCodeParser},e.prototype.AckChatMsgOnServer=function(e){var t=m.Init(pe.c);t.Body().set_chat_group_id(this.m_ulGroupID),t.Body().set_chat_id(this.m_ulChatID),t.Body().set_timestamp(e),pe.V.AckChatMessage(this.m_CMInterface.GetServiceTransport(),t)},e.prototype.GetDesktopNotificationLevel=function(){return 0==this.m_eDesktopNotificationLevel?this.m_group.GetDesktopNotificationLevel():this.m_eDesktopNotificationLevel},e.prototype.GetMobileNotificationLevel=function(){return 0===this.m_eMobileNotificationLevel?this.m_group.GetMobileNotificationLevel():this.m_eMobileNotificationLevel},e.prototype.BIsUnreadIndicatorMuted=function(){return this.m_group.BIsUnreadIndicatorMuted()},e.prototype.GetDesktopNotificationLevelSetting=function(){return this.m_eDesktopNotificationLevel},e.prototype.GetMobileNotificationLevelsetting=function(){return this.m_eMobileNotificationLevel},e.prototype.UpdateUserState=function(e){this.m_rtLastAckedChatMsg=e.time_last_ack(),this.m_rtLastMention=e.time_last_mention(),this.m_eDesktopNotificationLevel=e.desktop_notification_level(),this.m_eMobileNotificationLevel=e.mobile_notification_level(),this.m_bUnreadIndicatorMuted=e.unread_indicator_muted(),(this.m_rtLastAckedChatMsg||0)<this.m_rtLastMessageReceived&&(this.m_cUnreadChatMessages=1,this.m_rtLastAckedChatMsg&&(this.m_rtFirstUnreadChatMsg=this.m_rtLastAckedChatMsg+1),ci.FriendStore.UpdateUnreadMessagesGlobal())},e.prototype.UpdateChatState=function(e){var n=this;Object(I.a)(this.m_ulChatID==e.chat_id(),"State for different chat room"),this.m_strName=e.chat_name(),this.m_bVoiceAllowed=e.voice_allowed();for(var t=!1,o=!1,i=this.m_FriendStore.self.accountid,r=new Set(this.m_groupVoiceActiveMembers.GetCurrentMemberSet()),a=0,s=e.members_in_voice();a<s.length;a++){var c=s[a];r.delete(c)||(this.m_groupVoiceActiveMembers.AddMember(c),c!=i&&(t=!0))}r.forEach(function(e){n.m_groupVoiceActiveMembers.RemoveMember(e);var t=n.m_groupVoiceActiveMembers.HasMember(e);n.VoiceChatStore.OnUserLeftChatRoomVoiceChat(n.m_ulGroupID,n.m_ulChatID,e,t),e!=i&&(o=!0)}),this.BVoiceActive()&&(t?ci.AudioPlaybackManager.PlayAudioURL(G.a.COMMUNITY_CDN_URL+"public/sounds/webui/steam_voice_channel_enter.m4a?v=1"):o&&ci.AudioPlaybackManager.PlayAudioURL(G.a.COMMUNITY_CDN_URL+"public/sounds/webui/steam_voice_channel_exit.m4a?v=1")),this.m_rtLastMessageReceived=e.time_last_message(),this.m_unSortOrder=e.sort_order()},Object.defineProperty(e.prototype,"voice_active_member_list",{get:function(){return this.m_groupVoiceActiveMembers},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"voice_active_contains_friends",{get:function(){for(var e=0;e<this.m_groupVoiceActiveMembers.member_list.length;e++)if(this.m_groupVoiceActiveMembers.member_list[e].is_friend||this.m_groupVoiceActiveMembers.member_list[e]==ci.FriendStore.self)return!0;return!1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"voice_active_contains_self",{get:function(){for(var e=0;e<this.m_groupVoiceActiveMembers.member_list.length;e++)if(this.m_groupVoiceActiveMembers.member_list[e]==ci.FriendStore.self)return!0;return!1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"voice_active_contains_only_self",{get:function(){return 1==this.m_groupVoiceActiveMembers.member_list.length&&this.m_groupVoiceActiveMembers.member_list[0]==ci.FriendStore.self},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"name",{get:function(){return this.IsDefaultRoomForGroup()?"Home":this.IsUnsavedVoiceChannel()?Object($.b)("#Chat_CreateChatChannel_DefaultName"):this.m_strName},enumerable:!0,configurable:!0}),e.prototype.IsUnsavedVoiceChannel=function(){return!(0!=this.m_strName.length||!this.m_bVoiceAllowed)},e.prototype.GetParentGroupID=function(){return this.m_ulGroupID},e.prototype.GetGroup=function(){return this.m_group},e.prototype.IsDefaultRoomForGroup=function(){return this.m_bIsDefaultForGroup},e.prototype.GetRoomID=function(){return this.m_ulChatID},e.prototype.BIsDefaultRoom=function(){return this.m_bIsDefaultForGroup},Object.defineProperty(e.prototype,"unique_id",{get:function(){return"cr"+this.m_ulChatID},enumerable:!0,configurable:!0}),e.prototype.GetVoiceAllowed=function(){return this.m_bVoiceAllowed},e.prototype.IsTempVoiceRoom=function(){return!!this.GetVoiceAllowed()&&(!this.m_strName||0==this.m_strName.length)},e.prototype.GetSortOrder=function(){return this.m_unSortOrder},e.prototype.InsertBBCodeMarkup=function(e){(e=ke.EscapeBBCode(e)).replace(/＠/g,"@");for(var t=e.indexOf("@");-1!==t;){for(var n=e.indexOf("@",t+1),o=e.indexOf(" ",t+1),i=Math.min(-1===n?e.length:n,-1===o?e.length:o),r=e.substr(t+1,i-t-1).toLocaleLowerCase(),a=void 0,s=void 0,c=0,l=this.GetChatRoomGroup().memberList.member_list_unsorted;c<l.length;c++){var p=l[c],u=ke.EscapeBBCode(p.player_name_normalized),m=u+"#"+p.accountid.toString(36);if(m.startsWith(r)){var d=void 0,h=m.length===r.length,_=h||u.length===r.length;(_||h)&&(d=r.length),!h&&e.length-t-1>=m.length&&e.substr(t+1,u.length).toLocaleLowerCase()===m&&(_=h=!0,d=m.length),!_&&e.length-t-1>=u.length&&e.substr(t+1,u.length).toLocaleLowerCase()===u&&(d=u.length),d&&(void 0===s||s<=d)&&(a=p,s=d)}}var f=!1;this.GetChatRoomGroup().BCanIMentionAll()&&(f="online"==r||"online#0"==r||"all"==r||"all#0"==r);var g=void 0,b=void 0,v=void 0;if(f&&(void 0===s||s<=r.length)){var S=r;-1!==r.indexOf("#")&&(S=r.substr(0,r.indexOf("#"))),b=g=S,v=r.length,"online"==g&&(g="here")}else a&&void 0!==s&&(g=""+a.accountid,b=a.persona.m_strPlayerName,v=s);if(b&&void 0!==v){var y=e.substr(0,t),C=e.substr(t+1+v),I="[mention="+g+"]@"+ke.EscapeBBCode(b)+"[/mention]";n=(e=y+I+C).indexOf("@",y.length+I.length)}t=n}return e},e.prototype.StartVoiceChat=function(){this.BVoiceActive()||this.ChatStore.VoiceChat.InitiateRoomChat(this.m_ulGroupID,this.m_ulChatID)},e.prototype.ToggleVoiceChat=function(){this.BVoiceActive()?this.ChatStore.VoiceChat.OnUserEndVoiceChat():this.StartVoiceChat()},e.prototype.BVoiceActive=function(){return this.ChatStore.VoiceChat.IsVoiceActiveForRoom(this.m_ulGroupID,this.m_ulChatID)},e.prototype.SendChatMessage=function(e){var n=this;if(!this.GetChatRoomGroup().BCanChat())return this.AppendLocalEchoChatMsg("").eErrorSending=We.NoChatPermissionInGroup,!0;var t=this.InsertBBCodeMarkup(e),o=m.Init(pe.J);o.Body().set_chat_group_id(this.m_ulGroupID),o.Body().set_chat_id(this.m_ulChatID),o.Body().set_message(t);var i=this.AppendLocalEchoChatMsg(t);return pe.V.SendChatMessage(this.m_ChatStore.CMInterface.GetServiceTransport(),o).then(function(t){Object(d.runInAction)(function(){if(1==t.GetEResult()){i.rtTimestamp=t.Body().server_timestamp(),i.unOrdinal=t.Body().ordinal(),n.OnUserChatEcho(i.rtTimestamp,i.unOrdinal);var e=t.Body().modified_message();e&&(n.m_ChatStore.EmoticonStore.TrackEmoticonUsage(e,i.rtTimestamp),i.strMessage=e),i.OnServerAcknowledged()}else switch(t.GetEResult()){case 84:i.eErrorSending=We.RateLimitExceeded;break;default:i.eErrorSending=We.Generic}})}).catch(function(){i.eErrorSending=We.Generic}),!0},e.prototype.DeleteChatMessges=function(l){return R.b(this,void 0,void 0,function(){var t,n,o,i,r,a,s,c;return R.e(this,function(e){switch(e.label){case 0:for(t=l.map(function(e){return{rtTimestamp:e.rtTimestamp,unOrdinal:e.unOrdinal}}),this.UpdateChatMessageDeletedState(t,xe.Deleting),(n=m.Init(pe.i)).Body().set_chat_group_id(this.m_ulGroupID),n.Body().set_chat_id(this.m_ulChatID),o=0,i=l;o<i.length;o++)r=i[o],(a=n.Body().add_messages()).set_server_timestamp(r.rtTimestamp),a.set_ordinal(r.unOrdinal);return[4,pe.V.DeleteChatMessages(this.m_ChatStore.CMInterface.GetServiceTransport(),n)];case 1:return s=e.sent(),1!=(c=s.GetEResult())?(this.UpdateChatMessageDeletedState(t,xe.None),[2,c]):(this.UpdateChatMessageDeletedState(t,xe.Deleted),[2,1])}})})},e.prototype.PopulateCommitFileUploadFormData=function(e,t){e.append("chat_group_id",this.m_ulGroupID),e.append("chat_id",this.m_ulChatID),e.append("spoiler",t.bSpoiler?"1":"0")},e.prototype.BShouldTrackUnreadMessages=function(){return this.m_bIsDefaultForGroup||!this.m_bVoiceAllowed||this.BVoiceActive()},e.prototype.BShouldSilentlyAddMessage=function(e){return ci.FriendStore.GetPlayer(e.unAccountID).is_blocked},e.prototype.PlayChatRoomNotificationSound=function(){ci.FriendStore.GetUserDoNotDisturb()||ci.AudioPlaybackManager.PlayAudioURL(G.a.COMMUNITY_CDN_URL+"public/sounds/webui/steam_chatroom_notification.m4a?v=1")},e.prototype.PlayAtMentionSound=function(){ci.FriendStore.GetUserDoNotDisturb()||ci.AudioPlaybackManager.PlayAudioURL(G.a.COMMUNITY_CDN_URL+"public/sounds/webui/steam_at_mention.m4a?v=1")},e.prototype.OnReceivedNewMessage=function(t,e,n,o){var i=this;if(this.BShouldTrackUnreadMessages()&&!t.BIsLocalEcho()&&t.unAccountID!=this.self.accountid){(t.Mentions.mention_all||t.Mentions.mention_here||t.Mentions.mention_user)&&(this.m_rtLastMention=t.rtTimestamp);var r=void 0;switch(this.GetDesktopNotificationLevel()){case 1:r=!1;break;case 2:r=t.Mentions.mention_user;break;case 3:r=t.Mentions.mention_user||t.Mentions.mention_here||t.Mentions.mention_all;break;case 4:default:r=!0}if(r&&!ci.FriendStore.GetUserDoNotDisturb()){if(ci.SettingsStore.FriendsSettings.bSounds_PlayChatRoomNotification&&(t.Mentions.mention_all||t.Mentions.mention_here||t.Mentions.mention_user)?this.PlayAtMentionSound():ci.SettingsStore.FriendsSettings.bSounds_PlayChatRoomNotification&&e<4&&this.PlayChatRoomNotificationSound(),ci.NotificationManager.BNotificationsPermitted()&&e<4&&ci.SettingsStore.FriendsSettings.bNotifications_ShowChatRoomNotification){var a=ci.FriendStore.GetPlayer(t.unAccountID);a.LoadIfNecessary();Object(d.when)(function(){return a.is_ready},function(){var e={title:i.m_bIsDefaultForGroup?i.GetGroup().name:i.name,body:a.display_name+': "'+n+'"',icon:a.persona.avatar_url_medium,rawbody:n,tag:"groupmsg_"+a.accountid,steamid:a.persona.m_steamid.ConvertTo64BitString()};(e=i.DecorateNotification(t,e,n,o)).body&&(ci.NotificationManager.DisplayNotification(e,function(e){return ci.UIStore.ShowAndOrActivateChat(e,i,!0)}),i.m_bHasUnreadPriorityChatMessages||(i.m_bHasUnreadPriorityChatMessages=!0,ci.FriendStore.UpdateUnreadMessagesGlobal()))},{timeout:1e3})}0==ci.SettingsStore.FriendsSettings.nChatFlashMode&&e<4&&ci.UIStore.FlashChatWindow(this)}}},e.prototype.GetChatRoomGroup=function(){return this.m_ChatStore.GetChatRoomGroup(this.m_ulGroupID)},e.prototype.GetMember=function(e){return this.GetChatRoomGroup().GetMember(e)},e.prototype.SearchMembers=function(e,t,n){void 0===t&&(t=5),void 0===n&&(n=!1);var o=[],i=e.toLocaleLowerCase(),r=this.GetChatRoomGroup().BCanIMentionAll()?"":Object($.b)("#ChatMentionSuggest_NoPermission");"online".startsWith(i)&&o.push({friend:null,iMatchOffset:0,bNicknameMatch:!1,meta_mention:"online",strNotSelectable:r}),"all".startsWith(i)&&o.push({friend:null,iMatchOffset:0,bNicknameMatch:!1,meta_mention:"all",strNotSelectable:r});for(var a=[],s=[],c=0,l=this.GetChatRoomGroup().memberList.member_list;c<l.length;c++){var p=l[c];if(p!=this.self){if(i.length){var u=p.MatchSearchString(i),m=0===u.iOffset;if(0==u.match||n&&!m)continue;var d={friend:p,iMatchOffset:u.iOffset,bNicknameMatch:2==u.match};m?u.bFullMatch?a.unshift(d):a.push(d):s.push(d)}else o.push({friend:p,iMatchOffset:0,bNicknameMatch:!1});if(o.length+a.length>=t)break}}for(var h=0;h<a.length&&o.length<t;h++)o.push(a[h]);for(h=0;h<s.length&&o.length<t;h++)o.push(s[h]);return o},e.prototype.BNameMatchesSearch=function(e){return-1!=this.name.toLocaleLowerCase().indexOf(e)},e.prototype.CreateInviteLink=function(e){var i=this,t=m.Init(pe.g);t.Body().set_chat_group_id(this.m_ulGroupID),t.Body().set_seconds_valid(e),t.Body().set_chat_id(this.m_ulChatID),pe.V.CreateInviteLink(this.m_ChatStore.CMInterface.GetServiceTransport(),t).then(function(e){var t=e.Body().invite_code(),n=Object(he.a)(t),o=e.Body().seconds_valid();0!=o&&(o+=Math.floor(Date.now()/1e3)),i.m_lastChatLink={strInviteURL:n,rtExpires:o}})},e.prototype.OnActivate=function(){r.prototype.OnActivate.call(this),this.m_ChatStore.OnChatRoomActivated(this)},Object.defineProperty(e.prototype,"lastChatLinkInfo",{get:function(){return this.m_lastChatLink},enumerable:!0,configurable:!0}),e.prototype.BCanDeleteMemberMessages=function(e){return this.GetChatRoomGroup().BCanDeleteMemberMessages(e)},e.prototype.ChangeNameWhileWaitingForRenameRequest=function(e){this.m_strName=e},e.prototype.SetNotificationPreferences=function(e,t,n){var o=m.Init(pe.P);o.Body().set_chat_group_id(this.m_ulGroupID);var i=o.Body().add_chat_room_preferences();return i.set_chat_id(this.m_ulChatID),void 0!==e&&(this.m_eDesktopNotificationLevel=e,i.set_desktop_notification_level(e),4==e&&this.m_bUnreadIndicatorMuted&&(n=!1)),void 0!==t&&(this.m_eMobileNotificationLevel=t,i.set_mobile_notification_level(t)),void 0!==n&&(this.m_bUnreadIndicatorMuted=n,i.set_unread_indicator_muted(n)),pe.V.SetUserChatGroupPreferences(ci.CMInterface.GetServiceTransport(),o).then(function(e){return 1==e.GetEResult()})},e.prototype.SetupAppCustomServerMsg=function(d){return R.b(this,void 0,void 0,function(){var t,n,o,i,r,a,s,c,l,p,u,m;return R.e(this,function(e){switch(e.label){case 0:if(t=JSON.parse(d.strMessage)||{},n=new Map,t.params)for(o in t.params)n.set(o.toString(),t.params[o].toString());return d.strServerMsgAppCustomLocalized="...",[4,ci.AppInfoStore.GetRichPresenceLocAsync(this.m_group.GetOwnerAppID())];case 1:for(i=e.sent(),t.tok?d.strServerMsgAppCustomLocalized=i.Localize(t.tok,n):t.msg?d.strServerMsgAppCustomLocalized=i.SubstituteParams(t.msg,n):d.strServerMsgAppCustomLocalized=d.strMessage,r=Te(d.strServerMsgAppCustomLocalized),a=null,s="",c=!1,l=0,p=r;l<p.length;l++)1!=(u=p[l]).type?2==u.type&&("mention"!=u.tag?"spoiler"!=u.tag&&(console.log("bbcode tag '"+u.tag+"' not allowed!"),c=!0):u.args&&(a||(a={}),"all"==(m=u.args[""])?a.mention_all=!0:"here"==m?a.mention_here=!0:m==this.m_FriendStore.self.accountid.toString()&&(a.mention_user=!0))):s+=u.text;return c&&(d.strServerMsgAppCustomLocalized=s),a&&(d.Mentions=a),[2,s]}})})},R.c([d.observable],e.prototype,"m_strName",void 0),R.c([d.observable],e.prototype,"m_unSortOrder",void 0),R.c([d.observable],e.prototype,"m_lastChatLink",void 0),R.c([d.observable],e.prototype,"m_rtLastMention",void 0),R.c([d.observable],e.prototype,"m_eDesktopNotificationLevel",void 0),R.c([d.observable],e.prototype,"m_eMobileNotificationLevel",void 0),R.c([d.observable],e.prototype,"m_bUnreadIndicatorMuted",void 0),R.c([d.action],e.prototype,"UpdateUserState",null),R.c([d.action],e.prototype,"UpdateChatState",null),R.c([d.computed],e.prototype,"name",null),R.c([T.a],e.prototype,"StartVoiceChat",null),R.c([d.action],e.prototype,"SendChatMessage",null),R.c([T.a,Object(ht.a)(100)],e.prototype,"PlayChatRoomNotificationSound",null),R.c([T.a,Object(ht.a)(100)],e.prototype,"PlayAtMentionSound",null),R.c([d.action],e.prototype,"CreateInviteLink",null),R.c([d.action],e.prototype,"OnActivate",null),R.c([d.action],e.prototype,"ChangeNameWhileWaitingForRenameRequest",null),e}(tt),Pt=n("2lpH"),At=n.n(Pt);var Bt=function(){function e(e,t){void 0===e&&(e=20),this.m_rank=e,this.m_role_ids=t}return e.prototype.BHasRole=function(t){return-1!=this.m_role_ids.findIndex(function(e){return e==t})},R.c([d.observable],e.prototype,"m_rank",void 0),R.c([d.observable],e.prototype,"m_role_ids",void 0),e}(),Ft=function(){function e(e){this.m_roleActions=new pe.a,this.m_roleActions=e}return e.prototype.BCanPerformAction=function(e){switch(e){case 1:return this.m_roleActions.can_create_rename_delete_channel();case 2:return this.m_roleActions.can_kick();case 3:return this.m_roleActions.can_ban();case 4:return this.m_roleActions.can_invite();case 5:return this.m_roleActions.can_change_tagline_avatar_name();case 6:return this.m_roleActions.can_chat();case 8:return this.m_roleActions.can_change_group_roles();case 9:return this.m_roleActions.can_change_user_roles();case 10:return this.m_roleActions.can_mention_all();case 11:return this.m_roleActions.can_set_watching_broadcast();default:return!1}},e.prototype.SetCanPerformAction=function(e,t){switch(e){case 1:this.m_roleActions.set_can_create_rename_delete_channel(t);break;case 2:this.m_roleActions.set_can_kick(t);break;case 3:this.m_roleActions.set_can_ban(t);break;case 4:this.m_roleActions.set_can_invite(t);break;case 5:this.m_roleActions.set_can_change_tagline_avatar_name(t);break;case 6:this.m_roleActions.set_can_chat(t);break;case 8:this.m_roleActions.set_can_change_group_roles(t);break;case 9:this.m_roleActions.set_can_change_user_roles(t);break;case 10:this.m_roleActions.set_can_mention_all(t);break;case 11:this.m_roleActions.set_can_set_watching_broadcast(t)}},e.prototype.toString=function(){var e=this.role_id;return this.m_roleActions.can_create_rename_delete_channel()&&(e+=" CreateRenameDeleteChannel"),this.m_roleActions.can_kick()&&(e+=" Kick"),this.m_roleActions.can_ban()&&(e+=" Ban"),this.m_roleActions.can_invite()&&(e+=" Invite"),this.m_roleActions.can_change_tagline_avatar_name()&&(e+=" ChangeTaglineAvatarName"),this.m_roleActions.can_chat()&&(e+=" Chat"),this.m_roleActions.can_change_group_roles()&&(e+=" ChangeGroupRoles"),this.m_roleActions.can_change_user_roles()&&(e+=" ChangeUserRoles"),e},Object.defineProperty(e.prototype,"role_id",{get:function(){return this.m_roleActions.role_id()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"roleActions",{get:function(){return this.m_roleActions},enumerable:!0,configurable:!0}),e}(),Vt=function(){function e(e,t){var n=this;this.LOG=Ae.create(function(){return n.unique_id},!1),this.m_chatStore=null,this.m_ulGroupID="",this.m_ulDefaultChatID="",this.m_rtTimeJoined=0,this.m_rtLastAck=0,this.m_bFullStateLoaded=!1,this.m_strName="",this.m_strTagLine="",this.m_strAvatarSHA="",this.m_mapRooms=d.observable.map(null,{deep:!1}),this.m_rgPartyBeacons=[],this.m_eUserDesktopNotificationLevel=4,this.m_eUserMobileNotificationLevel=4,this.m_bUnreadIndicatorMuted=!1,this.m_roles=[],this.m_roleActions=[],this.m_groupMembers=new zt,this.m_cMemberSummaryCount=0,this.m_chatStore=e,this.m_ulGroupID=t}return e.prototype.BIsValid=function(){return 0<this.m_mapRooms.size},e.prototype.IsNamedGroupChat=function(){return!!this.m_strName},e.prototype.GetOwnerAccountID=function(){return this.m_unOwnerAccountID},e.prototype.BIsAccountIDOwner=function(e){return this.BIsClanChatRoom()?50==this.GetMemberRankIfPresent(e):this.GetOwnerAccountID()==e},e.prototype.SetOwnerAppID=function(e){e||(e=0),this.m_unAppID!=e&&(this.m_unAppID=e,this.m_unAppID&&(ci.AppInfoStore.GetAppInfo(this.m_unAppID),ci.AppInfoStore.GetRichPresenceLoc(this.m_unAppID)))},e.prototype.GetOwnerAppID=function(){return this.m_unAppID},Object.defineProperty(e.prototype,"name",{get:function(){if(this.m_strName)return this.m_strName;var e=this.members_to_highlight_name,t=e.members;if(!t.length)return e.remaining_count?Object($.b)("#ChatRoom_GenericWithOthers",e.remaining_count):Object($.b)("#ChatRoom_GenericEmpty");switch(t.length){case 1:return 0<e.remaining_count?Object($.b)("#ChatRoom_OneFriendPlusMore",t[0].display_name,e.remaining_count):Object($.b)("#ChatRoom_OneFriend",t[0].display_name);case 2:return 0<e.remaining_count?Object($.b)("#ChatRoom_TwoPlusMore",t[0].display_name,t[1].display_name,e.remaining_count):Object($.b)("#ChatRoom_TwoFriends",t[0].display_name,t[1].display_name);case 3:return Object($.b)("#ChatRoom_ThreeFriends",t[0].display_name,t[1].display_name,t[2].display_name);default:return Object(I.a)(!1,"unexpected number of friends: "+t.length),""}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"tagline",{get:function(){return this.m_strTagLine},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"avatarSHA",{get:function(){return this.m_strAvatarSHA},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"watching_broadcast_steamid",{get:function(){return this.m_unWatchingBroadcastAccountID?D.a.InitFromAccountID(this.m_unWatchingBroadcastAccountID):null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hasAvatar",{get:function(){return 0<this.m_strAvatarSHA.length},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hasIcon",{get:function(){return this.hasAvatar||0!=this.m_unAppID},enumerable:!0,configurable:!0}),e.prototype.GetAvatarOrAppIconURL=function(e){if(!this.m_strAvatarSHA&&this.m_unAppID){var t=ci.AppInfoStore.GetAppInfo(this.m_unAppID);if(t.is_valid&&t.icon_url)return t.icon_url}return n=this.m_strAvatarSHA,o=(o=e)<=32?32:o<=64?64:256,G.a.MEDIA_CDN_COMMUNITY_URL+"images/chaticons/"+n.substr(0,2)+"/"+n.substr(2,2)+"/"+n.substr(4,2)+"/"+n+"_"+o+".jpg";var n,o},Object.defineProperty(e.prototype,"avatar_url_small",{get:function(){return this.GetAvatarOrAppIconURL(32)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"avatar_url_medium",{get:function(){return this.GetAvatarOrAppIconURL(64)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"avatar_url_full",{get:function(){return this.GetAvatarOrAppIconURL(256)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"memberCountTotal",{get:function(){return this.m_bFullStateLoaded?this.m_groupMembers.unfiltered_count:this.m_cMemberSummaryCount},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"readyToRender",{get:function(){return this.m_bFullStateLoaded},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"memberCountOnline",{get:function(){return this.m_bFullStateLoaded?this.m_groupMembers.member_counts.online:this.memberCountTotal},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"memberCountInGame",{get:function(){return this.m_groupMembers.member_counts.ingame},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"memberList",{get:function(){return this.m_groupMembers},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"unique_id",{get:function(){return"cg"+this.m_ulGroupID},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"timeJoined",{get:function(){return this.m_rtTimeJoined},enumerable:!0,configurable:!0}),e.prototype.GetGroupID=function(){return this.m_ulGroupID},e.prototype.GetDefaultChatID=function(){return this.m_ulDefaultChatID},e.prototype.BIsClanChatRoom=function(){return!!this.m_unClanID},e.prototype.BIsVoiceChannel=function(e){var t=this.GetChatRoom(e);return null!=t&&(t.GetVoiceAllowed()&&t.GetRoomID()!=this.GetDefaultChatID())},e.prototype.BIsTempVoiceChannel=function(e){var t=this.GetChatRoom(e);return t&&t.IsTempVoiceRoom()},e.prototype.GetClanID=function(){return this.m_unClanID},Object.defineProperty(e.prototype,"chatRoomList",{get:function(){var e=Array.from(this.m_mapRooms.values());return e.sort(function(e,t){if(e.GetSortOrder()<t.GetSortOrder())return-1;if(e.GetSortOrder()>t.GetSortOrder())return 1;var n=At.a.fromString(e.GetRoomID()),o=At.a.fromString(t.GetRoomID());return n.lessThan(o)?-1:n.greaterThan(o)?1:0}),e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"textRoomList",{get:function(){var t=this;return this.chatRoomList.filter(function(e){return!e.GetVoiceAllowed()||e.GetRoomID()==t.GetDefaultChatID()})},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"voiceRoomList",{get:function(){return this.chatRoomList.filter(function(e){return e.GetVoiceAllowed()})},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hasVoiceRoom",{get:function(){for(var e,t=this.m_mapRooms.values();(e=t.next())&&!e.done;)if(e.value.GetVoiceAllowed())return!0;return!1},enumerable:!0,configurable:!0}),e.prototype.GetDesktopNotificationLevel=function(e){return void 0===e&&(e=!1),0==this.m_eUserDesktopNotificationLevel?this.BIsClanChatRoom()?3:4:this.m_eUserDesktopNotificationLevel},e.prototype.GetMobileNotificationLevel=function(){return 0===this.m_eUserMobileNotificationLevel?3:this.m_eUserMobileNotificationLevel},e.prototype.BIsUnreadIndicatorMuted=function(){return this.m_bUnreadIndicatorMuted},Object.defineProperty(e.prototype,"HasUnreadChatMessage",{get:function(){for(var e=0,t=Array.from(this.m_mapRooms.values());e<t.length;e++){var n=t[e];if((this.m_bUnreadIndicatorMuted?n.has_unread_messages:n.has_any_unread_messages)&&(n.BIsDefaultRoom()||n.time_last_ack>=this.m_rtLastAck||n.time_last_mention>this.m_rtLastAck))return!0}return!1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"HasUnreadMention",{get:function(){for(var e=0,t=Array.from(this.m_mapRooms.values());e<t.length;e++){if(t[e].has_unread_mention)return!0}return!1},enumerable:!0,configurable:!0}),e.prototype.GetChatRoomsWithUnreadPriorityMessages=function(t){this.m_mapRooms.forEach(function(e){e.has_unread_priority_messages&&t.push(e)})},e.prototype.GetMostRecentChatAck=function(){var t=0;return this.m_mapRooms.forEach(function(e){e.time_last_ack>t&&(t=e.time_last_ack)}),this.m_rtLastAck>t&&(t=this.m_rtLastAck),t},Object.defineProperty(e.prototype,"time_last_activity",{get:function(){var t=0;return this.m_mapRooms.forEach(function(e){e.BShouldTrackUnreadMessages()&&(t=Math.max(e.time_last_activity,t))}),this.m_rtLastAck>t&&(t=this.m_rtLastAck),this.m_rtTimeJoined>t&&(t=this.m_rtTimeJoined),t},enumerable:!0,configurable:!0}),e.prototype.BHasEverBeenAcked=function(){if(this.m_rtLastAck)return!0;for(var e=0,t=Array.from(this.m_mapRooms.values());e<t.length;e++){if(t[e].time_last_ack)return!0}return!1},e.prototype.UpdateLastAckTimeFromServer=function(e){this.m_rtLastAck<e&&(this.m_rtLastAck=e)},e.prototype.IsInRoom=function(e){return Object(I.a)(this.m_bFullStateLoaded,"Group state not fully loaded"),this.m_groupMembers.HasMember(e)},e.prototype.BRoomContainsJustTheseFriendsAndSelf=function(e){if(!this.BIsCurrentUserAMember())return!1;if(this.memberCountTotal!=e.length+1)return!1;for(var t=!0,n=0,o=e;n<o.length;n++){var i=o[n];if(this.m_rgGroupMembersSummary.indexOf(i)<0){t=!1;break}}return t},e.prototype.GetMyRank=function(){return this.GetMemberRank(this.m_chatStore.CMInterface.steamid.GetAccountID())},e.prototype.ChangeMemberRank=function(e,t){Object(I.a)(this.m_groupMembers.HasMember(e),"ChangeMemberRank: missing member"),this.m_groupMembers.GetExtra(e).m_rank=t},e.prototype.GetMemberRank=function(e){Object(I.a)(this.m_groupMembers.HasMember(e),"GetMemberRank: missing member");var t=this.m_groupMembers.GetExtra(e);return t&&0!=t.m_rank?t.m_rank:this.BIsClanChatRoom()?0:20},e.prototype.GetMemberRankIfPresent=function(e){var t=this.m_groupMembers.GetExtra(e);return t?t.m_rank:0},e.prototype.GetMemberPartyBeacon=function(t){return this.m_rgPartyBeacons.find(function(e){return e.account_id==t})},e.prototype.ChangeMemberRoles=function(e,t){Object(I.a)(this.m_groupMembers.HasMember(e),"GetMemberRank: missing member");var n=this.m_groupMembers.GetExtra(e);n&&(n.m_role_ids=t)},e.prototype.GetMemberRankString=function(e){if(!this.IsInRoom(e))return"";switch(this.GetMemberRank(e)){case 50:return Object($.b)("#Chat_rank_owner");case 40:return Object($.b)("#Chat_rank_officer");case 30:return Object($.b)("#Chat_rank_moderator");case 20:return Object($.b)("#Chat_rank_member");case 15:return Object($.b)("#Chat_rank_guest");case 10:return Object($.b)("#Chat_rank_viewer");case 0:return"";default:return Object($.b)("#Chat_rank_unknown")}},e.prototype.GetMemberRankStringUnlocalized=function(e){if(!this.IsInRoom(e))return"";switch(this.GetMemberRank(e)){case 50:return"Owner";case 40:return"Officer";case 30:return"Moderator";case 20:return"Member";case 15:return"Guest";case 10:return"Viewer";case 0:return"DefaultRank";default:return Object($.b)("UnknownRank")}},e.prototype.GetMember=function(e){if(this.IsInRoom(e))return this.m_chatStore.FriendStore.GetPlayer(e);this.m_bFullStateLoaded},e.prototype.SetInitialGroupState=function(e){Object(I.a)(e.chat_group_id()==this.m_ulGroupID,"Chat group id doesn't match header"),this.UpdateGroupStateFromSummary(e),this.UpdateChatRoomState(e.default_chat_id(),e.chat_rooms())},e.prototype.UpdateGroupStateFromSummary=function(e){this.m_strTagLine=e.chat_group_tagline(),null!=e.chat_group_avatar_sha()&&(this.m_strAvatarSHA=p(e.chat_group_avatar_sha())),this.m_unWatchingBroadcastAccountID=e.watching_broadcast_accountid(),this.m_cMemberSummaryCount=e.active_member_count(),this.m_unClanID=e.clanid(),this.m_unOwnerAccountID=e.accountid_owner(),this.m_rgGroupMembersSummary=e.top_members(),this.m_defaultRoleID=e.default_role_id(),this.m_roleActions=e.role_actions().map(function(e){return new Ft(e)}),this.m_groupMembers.AddMember(ci.CMInterface.steamid.GetAccountID(),new Bt(e.rank(),e.role_ids())),this.SetOwnerAppID(e.appid()),this.SetNameCheckingForAppLocalization(e.chat_group_name()),this.m_rgPartyBeacons=e.party_beacons().map(function(e){return{account_id:new D.a(e.steamid_owner()).GetAccountID(),app_id:e.app_id(),beacon_id:e.beacon_id(),game_metadata:e.game_metadata()}}),ci.GroupMemberStore.OnPartyBeaconsUpdated(this.m_ulGroupID,this.m_rgPartyBeacons)},e.prototype.SetNameCheckingForAppLocalization=function(e){var o=this,i=null;!this.m_unOwnerAccountID&&this.GetOwnerAppID()&&("#"==e[0]?i={tok:e}:"{"==e[0]&&(i=JSON.parse(e))),i&&i.tok?(this.m_strName="...",ci.AppInfoStore.GetRichPresenceLocAsync(this.GetOwnerAppID()).then(function(e){var t=new Map;if(i.params)for(var n in i.params)t.set(n.toString(),i.params[n].toString());o.m_strName=e.Localize(i.tok,t)})):this.m_strName=e},e.prototype.UpdateGroupState=function(e){Object(I.a)(e.header_state().chat_group_id()==this.m_ulGroupID,"Chat group id doesn't match header"),this.UpdateChatRoomHeaderState(e.header_state()),this.m_groupMembers.Clear();for(var t=[],n=0,o=e.members();n<o.length;n++){var i=o[n],r=i.accountid();this.m_groupMembers.AddMember(r,new Bt(i.rank(),i.role_ids())),t.length<10&&t.push(r)}(!this.m_rgGroupMembersSummary||this.m_rgGroupMembersSummary.length<t.length)&&(this.m_rgGroupMembersSummary=t),this.UpdateChatRoomState(e.default_chat_id(),e.chat_rooms()),this.m_bFullStateLoaded=!0},e.prototype.UnloadActiveGroupState=function(){this.UnloadGroupState(),this.m_mapRooms.forEach(function(e){e.UnloadActiveChatState()})},e.prototype.UnloadGroupState=function(){this.m_bFullStateLoaded=!1,this.m_groupMembers.Clear()},e.prototype.UnloadAndResetGroupState=function(){this.UnloadGroupState(),this.UpdateUserState(new pe.T),this.m_mapRooms.forEach(function(e){e.UnloadChatState()})},e.prototype.OnUserStateChange=function(e,t){var n=e.accountid();1==t?(this.LOG("new member "+n+" roles ["+e.role_ids().toString()+"]"),this.m_groupMembers.AddMember(n,new Bt(e.rank(),e.role_ids())),ci.GroupMemberStore.OnMemberAdded(this.m_ulGroupID,n),this.m_rgGroupMembersSummary.length<10&&-1==this.m_rgGroupMembersSummary.indexOf(n)&&(this.m_rgGroupMembersSummary=this.m_rgGroupMembersSummary.concat([n]))):2==t||3==t||10==t?(this.m_groupMembers.RemoveMember(n),ci.GroupMemberStore.OnMemberRemoved(this.m_ulGroupID,n),-1!==this.m_rgGroupMembersSummary.indexOf(n)&&(this.m_rgGroupMembersSummary=M.a(this.m_rgGroupMembersSummary,n))):7==t?this.ChangeMemberRank(n,e.rank()):12==t&&this.ChangeMemberRoles(n,e.role_ids())},e.prototype.UpdateChatRoomState=function(e,t){var n=this;this.m_ulDefaultChatID=e;var o=new Set;this.m_mapRooms.forEach(function(e,t){return o.add(t)});for(var i=0,r=t;i<r.length;i++){var a=r[i],s=a.chat_id();o.delete(s);var c=this.m_mapRooms.get(s);c||(c=new kt(this.m_chatStore,this,s,s==e),this.m_mapRooms.set(s,c)),c.UpdateChatState(a)}o.forEach(function(e){return n.m_mapRooms.delete(e)})},e.prototype.UpdateUserState=function(e){for(var t=0,n=e.user_chat_room_state();t<n.length;t++){var o=n[t],i=o.chat_id(),r=this.m_mapRooms.get(i);r&&r.UpdateUserState(o)}this.m_rtTimeJoined=e.time_joined(),this.m_rtLastAck=e.time_last_group_ack(),this.m_eUserDesktopNotificationLevel=e.desktop_notification_level(),this.m_eUserMobileNotificationLevel=e.mobile_notification_level(),this.m_bUnreadIndicatorMuted=e.unread_indicator_muted()},e.prototype.UpdateChatRoomHeaderState=function(e){Object(I.a)(e.chat_group_id()==this.m_ulGroupID,"Chat group id doesn't match header"),this.m_strTagLine=e.tagline(),null!=e.avatar_sha()&&(this.m_strAvatarSHA=p(e.avatar_sha())),this.m_unWatchingBroadcastAccountID=e.watching_broadcast_accountid(),this.m_unClanID=e.clanid(),this.m_unOwnerAccountID=e.accountid_owner(),this.m_defaultRoleID=e.default_role_id(),this.m_roles=e.roles().map(function(e){return{role_id:e.role_id(),name:e.name(),ordinal:e.ordinal()}});for(var t=0,n=this.m_roles;t<n.length;t++){var o=n[t];this.LOG("role "+o.role_id+" "+o.name)}this.m_roleActions=e.role_actions().map(function(e){return new Ft(e)});for(var i=0,r=this.m_roleActions;i<r.length;i++){var a=r[i];this.LOG("role/action "+a.toString())}this.SetOwnerAppID(e.appid()),this.SetNameCheckingForAppLocalization(e.chat_name()),this.m_rgPartyBeacons=e.party_beacons().map(function(e){return{account_id:new D.a(e.steamid_owner()).GetAccountID(),app_id:e.app_id(),beacon_id:e.beacon_id(),game_metadata:e.game_metadata()}}),ci.GroupMemberStore.OnPartyBeaconsUpdated(this.m_ulGroupID,this.m_rgPartyBeacons)},e.prototype.BIsCurrentUserAMember=function(){return!!this.m_rtTimeJoined},e.prototype.DefaultRoleID=function(){return this.m_defaultRoleID},e.prototype.GetRoleActions=function(e){for(var t=0,n=this.m_roleActions;t<n.length;t++){var o=n[t];if(o.role_id==e)return o}},e.prototype.GetRoles=function(){return this.m_roles},e.prototype.GetRoleOrdinal=function(e){for(var t=0,n=this.m_roles;t<n.length;t++){var o=n[t];if(o.role_id==e)return o.ordinal}},e.prototype.BIsUserGroupMember=function(e){for(var t=0,n=this.m_rgGroupMembersSummary;t<n.length;t++){if(n[t]==e.accountid)return!0}return!1},e.prototype.GetMemberRoleIDs=function(e){return null==this.m_groupMembers.GetExtra(e)?[]:this.m_groupMembers.GetExtra(e).m_role_ids},e.prototype.ToggleMemberRoleState=function(e,t){var n=this.BMemberHasRole(e,t);return this.SetMemberRoleState(e,t,!n)},e.prototype.SetMemberRoleState=function(e,t,n){if(n==this.BMemberHasRole(e,t))return Promise.resolve(!0);if(!this.BCanIAssignRole(t))return Promise.resolve(!1);var o,i=D.a.InitFromAccountID(e);return n?((o=m.Init(pe.d)).Body().set_chat_group_id(this.GetGroupID()),o.Body().set_steamid(i.ConvertTo64BitString()),o.Body().set_role_id(t),pe.V.AddRoleToUser(ci.ChatStore.CMInterface.GetServiceTransport(),o).then(function(e){return e.GetEResult(),1==e.GetEResult()})):((o=m.Init(pe.l)).Body().set_chat_group_id(this.GetGroupID()),o.Body().set_steamid(i.ConvertTo64BitString()),o.Body().set_role_id(t),pe.V.DeleteRoleFromUser(ci.ChatStore.CMInterface.GetServiceTransport(),o).then(function(e){return e.GetEResult(),1==e.GetEResult()}))},e.prototype.BDoesRoleAllowAction=function(e,t){for(var n=0,o=this.m_roleActions;n<o.length;n++){var i=o[n];if(i.role_id==e&&i.BCanPerformAction(t))return!0}return!1},e.prototype.BCanIPerformActionOnUser=function(e,t,n){return void 0===n&&(n=!1),!(!n&&!this.BHasMember(e))&&(!this.BIsAccountIDOwner(e)&&this.BCanIPerformAction(t))},e.prototype.BHasMember=function(e){return void 0!==this.m_groupMembers.GetExtra(e)},e.prototype.BMemberHasRole=function(e,t){var n=this.m_groupMembers.GetExtra(e);return!!n&&n.BHasRole(t)},e.prototype.BCanIPerformAction=function(e){if(this.BIsAccountIDOwner(this.m_chatStore.CMInterface.steamid.GetAccountID()))return!0;var t=this.m_chatStore.CMInterface.steamid.GetAccountID(),n=this.m_groupMembers.GetExtra(t);if(n)for(var o=0,i=n.m_role_ids;o<i.length;o++){var r=i[o];if(this.BDoesRoleAllowAction(r,e))return!0}return!1},e.prototype.BCanKickMember=function(e){return this.BCanIPerformActionOnUser(e,2)},e.prototype.BCanBanMember=function(e){return this.BCanIPerformActionOnUser(e,3)},e.prototype.BCanDeleteMemberMessages=function(e){if(ci.FriendStore.self.accountid==e&&this.BIsAccountIDOwner(e))return!0;return this.BCanIPerformActionOnUser(e,2,!0)||this.BCanIPerformActionOnUser(e,3,!0)},e.prototype.BCanICreateRoles=function(){return this.BCanIPerformAction(8)},e.prototype.BCanIModifyRole=function(e){if(this.BIsAccountIDOwner(this.m_chatStore.CMInterface.steamid.GetAccountID()))return!0;if(!this.BCanIPerformAction(8))return!1;if(!this.GetRoleActions(e))return!1;var t=this.GetRoleOrdinal(e);if(null==t)return!1;var n=this.GetHighestRankRoleIDForPermission(this.m_chatStore.CMInterface.steamid.GetAccountID(),8),o=this.GetRoleOrdinal(n);return null!=o&&o<t},e.prototype.BCanIAssignRoles=function(){return this.BCanIPerformAction(9)},e.prototype.BCanIAssignRole=function(e){if(this.BIsClanChatRoom())return!1;if(e==this.DefaultRoleID())return!1;if(this.BIsAccountIDOwner(this.m_chatStore.CMInterface.steamid.GetAccountID()))return!0;if(!this.BCanIPerformAction(9))return!1;if(!this.GetRoleActions(e))return!1;var t=this.GetRoleOrdinal(e);if(null==t)return!1;var n=this.GetHighestRankRoleIDForPermission(this.m_chatStore.CMInterface.steamid.GetAccountID(),9),o=this.GetRoleOrdinal(n);return null!=o&&o<t},e.prototype.BCanIMentionAll=function(){return this.BCanIPerformAction(10)},e.prototype.BCanIAssociateBroadcast=function(){return this.BCanIPerformAction(11)},e.prototype.GetHighestRankRoleIDForPermission=function(e,t){var n=void 0,o=Number.MAX_VALUE,i=this.m_groupMembers.GetExtra(e);if(i){for(var r=0,a=i.m_role_ids;r<a.length;r++){var s=a[r];if(this.BDoesRoleAllowAction(s,t)){var c=this.GetRoleOrdinal(s);c<o&&(n=s,o=c)}}return n}},e.prototype.GetDefaultChatRoom=function(){return this.m_mapRooms.get(this.m_ulDefaultChatID)},e.prototype.GetChatRoom=function(e){return this.m_mapRooms.get(e)},e.prototype.OnConnectionRestored=function(){this.UnloadGroupState(),this.m_mapRooms.forEach(function(e){return e.OnConnectionRestored()})},e.prototype.OnRoomStateChange=function(e){this.UpdateChatRoomState(e.default_chat_id(),e.chat_rooms())},e.prototype.OnActivate=function(){if(!this.m_rtLastAck||this.HasUnreadChatMessage&&!this.GetDefaultChatRoom().has_unread_messages){var t=0;this.m_mapRooms.forEach(function(e){e.time_last_message&&(t=Math.max(t,e.time_last_message))}),this.m_rtLastAck=t||ci.GetServerRTime32();var e=m.Init(pe.c);e.Body().set_chat_group_id(this.m_ulGroupID),e.Body().set_timestamp(this.m_rtLastAck),pe.V.AckChatMessage(ci.CMInterface.GetServiceTransport(),e)}},e.prototype.InviteFriend=function(e,t){var n=D.a.InitFromAccountID(e),o=m.Init(pe.u);o.Body().set_chat_group_id(this.m_ulGroupID),o.Body().set_steamid(n.ConvertTo64BitString()),t&&o.Body().set_chat_id(t.GetRoomID()),pe.V.InviteFriendToChatRoomGroup(this.m_chatStore.CMInterface.GetServiceTransport(),o).then(function(e){e.GetEResult()})},e.prototype.SaveChatRoomGroup=function(e){var t=m.Init(pe.I);return t.Body().set_chat_group_id(this.m_ulGroupID),t.Body().set_name(e),pe.V.SaveChatRoomGroup(this.m_chatStore.CMInterface.GetServiceTransport(),t).then(function(e){var t=e.GetEResult();if(1!=t)throw t})},e.prototype.RenameChatRoomGroup=function(e){var t=this,n=this.m_strName;this.m_strName=e;var o=m.Init(pe.B);return o.Body().set_chat_group_id(this.m_ulGroupID),o.Body().set_name(e),pe.V.RenameChatRoomGroup(this.m_chatStore.CMInterface.GetServiceTransport(),o).then(function(e){return 1!=e.GetEResult()&&(t.m_strName=n),e.GetEResult()})},e.prototype.SetChatRoomGroupTagline=function(e){var t=this,n=this.m_strTagLine;if(255<e.length&&(e=e.substring(0,255)),e==this.m_strTagLine)return Promise.resolve();this.m_strTagLine=e;var o=m.Init(pe.L);return o.Body().set_chat_group_id(this.m_ulGroupID),o.Body().set_tagline(e),pe.V.SetChatRoomGroupTagline(this.m_chatStore.CMInterface.GetServiceTransport(),o).then(function(e){1!=e.GetEResult()&&(t.m_strTagLine=n)})},e.prototype.SetChatRoomGroupWatchingBroadcast=function(i){return R.b(this,void 0,void 0,function(){var t,n,o;return R.e(this,function(e){switch(e.label){case 0:return i==this.m_unWatchingBroadcastAccountID?[2,Promise.resolve()]:((t=m.Init(pe.M)).Body().set_chat_group_id(this.m_ulGroupID),t.Body().set_watching_broadcast_accountid(i),[4,pe.V.SetChatRoomGroupWatchingBroadcast(this.m_chatStore.CMInterface.GetServiceTransport(),t)]);case 1:if(n=e.sent(),1!==(o=n.GetEResult()))throw o;return this.m_unWatchingBroadcastAccountID=i,[2]}})})},e.prototype.SetChatRoomGroupAvatar=function(n){var o=this;if(n==this.m_strAvatarSHA)return Promise.resolve();var e=m.Init(pe.K);return e.Body().set_chat_group_id(this.m_ulGroupID),e.Body().set_avatar_sha(function(e){for(var t=new Uint8Array(e.length/2),n=0;n<e.length-1;n+=2)t[n/2]=parseInt(e.substr(n,2),16);return t}(n)),pe.V.SetChatRoomGroupAvatar(this.m_chatStore.CMInterface.GetServiceTransport(),e).then(function(e){var t=e.GetEResult();if(1!=t)throw t;o.m_strAvatarSHA=n})},e.prototype.BCanInvite=function(){return this.BCanIPerformAction(4)},e.prototype.BCanBan=function(){return this.BCanIPerformAction(3)},e.prototype.BCanKick=function(){return this.BCanIPerformAction(2)},e.prototype.BCanAdminChannel=function(){return this.BCanIPerformAction(1)},e.prototype.BCanAdminGroup=function(){return this.BCanIPerformAction(5)},e.prototype.BCanChat=function(){return this.BCanIPerformAction(6)},e.prototype.BCanEditRoles=function(){return!this.BIsClanChatRoom()&&this.BCanIPerformAction(9)},Object.defineProperty(e.prototype,"members_to_highlight_name",{get:function(){return this.InternalGetMembersToHighlight(3,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"members_to_highlight",{get:function(){return this.InternalGetMembersToHighlight(4,!1)},enumerable:!0,configurable:!0}),e.prototype.InternalGetMembersToHighlight=function(e,t){var n=!t,o=!!this.m_rtTimeJoined,i=this.m_bFullStateLoaded?this.m_groupMembers.unfiltered_count:this.m_cMemberSummaryCount;var r=e<i?e-1:e,a=ci.FriendStore,s=a.self,c=[],l=a.GetPlayer(this.GetOwnerAccountID());if(l&&l.accountid!=s.accountid&&c.push(l),this.m_rgGroupMembersSummary){for(var p=0,u=this.m_rgGroupMembersSummary;p<u.length;p++){if((_=u[p])!=s.accountid&&!this.BIsAccountIDOwner(_)){var m=a.GetFriendIfCached(_);if(m&&(t||m.persona.BHasAvatarSet())&&(c.push(m),c.length>=r))break}}if(n&&c.length<r)for(var d=0,h=this.m_rgGroupMembersSummary;d<h.length;d++){var _;if((_=h[d])!=s.accountid&&!this.BIsAccountIDOwner(_)){var f=a.GetPlayer(_);if(f&&!f.is_friend&&(t||f.persona.BHasAvatarSet())&&(c.push(f),c.length>=r))break}}}return o&&c.length<r&&c.push(s),{members:c,remaining_count:i-c.length}},e.prototype.SetUserBanState=function(e,t){var n=D.a.InitFromAccountID(e).ConvertTo64BitString(),o=m.Init(pe.O);return o.Body().set_chat_group_id(this.m_ulGroupID),o.Body().set_steamid(n),o.Body().set_ban_state(t),pe.V.SetUserBanState(this.m_chatStore.CMInterface.GetServiceTransport(),o).then(function(e){var t=e.GetEResult();if(1!=t&&29!=t)throw Object(I.a)(!1,"Failed to change ban state "+t),t})},e.prototype.MuteUser=function(e,t){var n=D.a.InitFromAccountID(e).ConvertTo64BitString(),o=m.Init(pe.A);return o.Body().set_chat_group_id(this.m_ulGroupID),o.Body().set_steamid(n),o.Body().set_expiration(t),pe.V.MuteUserInGroup(this.m_chatStore.CMInterface.GetServiceTransport(),o).then(function(e){var t=e.GetEResult();if(1!=t)throw Object(I.a)(!1,"Failed to change muteexpiration "+t),t})},e.prototype.KickUser=function(e,t){var n=this,o=D.a.InitFromAccountID(e).ConvertTo64BitString(),i=m.Init(pe.x);return i.Body().set_chat_group_id(this.m_ulGroupID),i.Body().set_steamid(o),i.Body().set_expiration(t),pe.V.KickUserFromGroup(this.m_chatStore.CMInterface.GetServiceTransport(),i).then(function(e){var t=e.GetEResult();if(1!=t)throw n.LOG("Kick returned "+t),t})},e.prototype.RevokeInvite=function(e){var n=this,t=D.a.InitFromAccountID(e).ConvertTo64BitString(),o=m.Init(pe.H);return o.Body().set_chat_group_id(this.m_ulGroupID),o.Body().set_steamid(t),pe.V.RevokeInviteToGroup(this.m_chatStore.CMInterface.GetServiceTransport(),o).then(function(e){var t=e.GetEResult();if(1!=t)throw n.LOG("RevokeInvite returned "+t),t})},e.prototype.CreateChatRoom=function(e,t){var n=this,o=m.Init(pe.f);return o.Body().set_chat_group_id(this.m_ulGroupID),o.Body().set_name(e),o.Body().set_allow_voice(t),pe.V.CreateChatRoom(this.m_chatStore.CMInterface.GetServiceTransport(),o).then(function(e){var t=e.Body().chat_room().chat_id();if(1!=e.GetEResult()||""==t||"0"==t)throw Object(I.a)(!1,"Failed to create chat room"),new Error("Failed to create chat room");return n.AddCreatedRoom(t,e.Body().chat_room())})},e.prototype.CreateAndJoinTempVoiceRoom=function(){this.CreateChatRoom("",!0).then(function(e){e.StartVoiceChat()}).catch(function(){})},e.prototype.AddCreatedRoom=function(e,t){var n=this.m_mapRooms.get(e);return n||(n=new kt(this.m_chatStore,this,e,!1),this.m_mapRooms.set(e,n)),n.UpdateChatState(t),n},e.prototype.RenameRoom=function(e,t){if(e!=this.m_ulDefaultChatID&&t){var n=this.GetChatRoom(e);if(n){var o=n.name;n.ChangeNameWhileWaitingForRenameRequest(t);var i=m.Init(pe.C);i.Body().set_chat_group_id(this.m_ulGroupID),i.Body().set_chat_id(e),i.Body().set_name(t),pe.V.RenameChatRoom(this.m_chatStore.CMInterface.GetServiceTransport(),i).then(function(e){1==e.GetEResult()||(Object(I.a)(!1,"Failed to change room name"),n.ChangeNameWhileWaitingForRenameRequest(o))})}}},e.prototype.ReorderRoom=function(e,t){var n=m.Init(pe.E);n.Body().set_chat_group_id(this.m_ulGroupID),n.Body().set_chat_id(e),n.Body().set_move_after_chat_id(t),pe.V.ReorderChatRoom(this.m_chatStore.CMInterface.GetServiceTransport(),n).then(function(e){1==e.GetEResult()||Object(I.a)(!1,"Failed to reorder room")})},e.prototype.DeleteChatRoom=function(t){var n=this,e=m.Init(pe.j);e.Body().set_chat_group_id(this.m_ulGroupID),e.Body().set_chat_id(t),pe.V.DeleteChatRoom(this.m_chatStore.CMInterface.GetServiceTransport(),e).then(function(e){1==e.GetEResult()?n.RemoveRoom(t):Object(I.a)(!1,"Failed to delete chat room")})},e.prototype.RemoveRoom=function(e){this.m_mapRooms.delete(e)},e.prototype.LeaveChatRoomGroup=function(e){this.m_chatStore.LeaveChatRoomGroup(e,this.m_ulGroupID).catch(function(){})},e.prototype.GetInviteLinksForGroup=function(){var e=m.Init(pe.q);return e.Body().set_chat_group_id(this.GetGroupID()),pe.V.GetInviteLinksForGroup(ci.ChatStore.CMInterface.GetServiceTransport(),e).then(function(e){return 1!=e.GetEResult()?{loadingState:"failed",rgInviteLinks:null}:{loadingState:"loaded",rgInviteLinks:e.Body().invite_links()}})},e.prototype.GetInvitedUsersForGroup=function(){var e=m.Init(pe.r);return e.Body().set_chat_group_id(this.GetGroupID()),pe.V.GetInviteList(ci.ChatStore.CMInterface.GetServiceTransport(),e).then(function(e){return 1!=e.GetEResult()?{loadingState:"failed",rgInvitedUsers:null}:{loadingState:"loaded",rgInvitedUsers:e.Body().invites()}})},e.prototype.GetBanList=function(){var e=m.Init(pe.n);return e.Body().set_chat_group_id(this.GetGroupID()),pe.V.GetBanList(ci.ChatStore.CMInterface.GetServiceTransport(),e).then(function(e){var t=new Ut;return 15==e.GetEResult()?t.loadingState="denied":1==e.GetEResult()?(t.rgBans=e.Body().bans(),t.loadingState="loaded"):t.loadingState="failed",t})},e.prototype.GetRoleName=function(t){var e=this.m_roles.findIndex(function(e){return e.role_id==t});if(0<=e)return this.m_roles[e].name},e.prototype.CreateRole=function(o){var i=this;if(0==(o=o.trim()).length)return Promise.resolve();var e=m.Init(pe.h);return e.Body().set_chat_group_id(this.GetGroupID()),e.Body().set_name(o),this.m_roles.push({role_id:"-1",name:o,ordinal:Number.MAX_VALUE}),pe.V.CreateRole(ci.ChatStore.CMInterface.GetServiceTransport(),e).then(function(e){var t=e.GetEResult();if(1!=t){var n=i.m_roles.findIndex(function(e){return"-1"==e.role_id});throw 0<=n&&i.m_roles.splice(n,1),new Error("unable to create role, error "+t)}i.LOG("created role "+o)})},e.prototype.DeleteRole=function(n){var o=this,e=m.Init(pe.m);return e.Body().set_chat_group_id(this.GetGroupID()),e.Body().set_role_id(n),pe.V.DeleteRole(ci.ChatStore.CMInterface.GetServiceTransport(),e).then(function(e){if(1!=e.GetEResult())throw new Error("unable to delete role "+n);var t=o.m_roles.findIndex(function(e){return e.role_id==n});0<=t&&o.m_roles.splice(t,1)})},e.prototype.RenameRole=function(o,i){var r=this;if(0==(i=i.trim()).length)return Promise.resolve();var e=m.Init(pe.D);return e.Body().set_chat_group_id(this.GetGroupID()),e.Body().set_role_id(o),e.Body().set_name(i),pe.V.RenameRole(ci.ChatStore.CMInterface.GetServiceTransport(),e).then(function(e){var t=e.GetEResult();if(1!=t)throw new Error("unable to rename role "+o+" "+t);var n=r.m_roles.findIndex(function(e){return e.role_id==o});0<=n&&(r.m_roles[n].name=i)})},e.prototype.ReorderRole=function(e,t){var n=m.Init(pe.F);return n.Body().set_chat_group_id(this.GetGroupID()),n.Body().set_role_id(e),n.Body().set_ordinal(t),pe.V.ReorderRole(ci.ChatStore.CMInterface.GetServiceTransport(),n).then(function(e){return 1==e.GetEResult()})},e.prototype.SetRoleAction=function(e,t,n){var o=this,i=this.GetRoleActions(e);if(i){if(n==i.BCanPerformAction(t))return;var r=i.BCanPerformAction(t);i.SetCanPerformAction(t,n);var a=m.Init(pe.G);return a.Body().set_chat_group_id(this.GetGroupID()),a.Body().set_role_id(e),a.Body().set_actions(i.roleActions),pe.V.ReplaceRoleActions(ci.ChatStore.CMInterface.GetServiceTransport(),a).then(function(e){1!=e.GetEResult()&&(i.SetCanPerformAction(t,r),o.LOG("SetRoleAction error, restoring "+t+" to "+r))})}},e.prototype.DeleteInviteLink=function(t,e){var n=m.Init(pe.k);if(n.Body().set_chat_group_id(this.GetGroupID()),n.Body().set_invite_code(t),e&&"loaded"==e.loadingState){var o=e.rgInviteLinks.findIndex(function(e){return e.invite_code()==t});0<=o&&(e.rgInviteLinks.splice(o,1),this.LOG("removed link "+e.rgInviteLinks))}return pe.V.DeleteInviteLink(ci.ChatStore.CMInterface.GetServiceTransport(),n).then(function(e){return 1==e.GetEResult()})},e.prototype.SetNotificationPreferences=function(e,t,n){var o=m.Init(pe.P);return o.Body().set_chat_group_id(this.m_ulGroupID),void 0!==e&&(this.m_eUserDesktopNotificationLevel=e,o.Body().chat_group_preferences().set_desktop_notification_level(e),4==e&&this.m_bUnreadIndicatorMuted&&(n=!1)),void 0!==t&&(this.m_eUserMobileNotificationLevel=t,o.Body().chat_group_preferences().set_mobile_notification_level(t)),void 0!==n&&(this.m_bUnreadIndicatorMuted=n,o.Body().chat_group_preferences().set_unread_indicator_muted(n)),pe.V.SetUserChatGroupPreferences(ci.CMInterface.GetServiceTransport(),o).then(function(e){return 1==e.GetEResult()})},R.c([d.observable],e.prototype,"m_rtTimeJoined",void 0),R.c([d.observable],e.prototype,"m_rtLastAck",void 0),R.c([d.observable],e.prototype,"m_unOwnerAccountID",void 0),R.c([d.observable],e.prototype,"m_bFullStateLoaded",void 0),R.c([d.observable],e.prototype,"m_strName",void 0),R.c([d.observable],e.prototype,"m_strTagLine",void 0),R.c([d.observable],e.prototype,"m_strAvatarSHA",void 0),R.c([d.observable],e.prototype,"m_unWatchingBroadcastAccountID",void 0),R.c([d.observable],e.prototype,"m_rgPartyBeacons",void 0),R.c([d.observable],e.prototype,"m_eUserDesktopNotificationLevel",void 0),R.c([d.observable],e.prototype,"m_eUserMobileNotificationLevel",void 0),R.c([d.observable],e.prototype,"m_bUnreadIndicatorMuted",void 0),R.c([d.observable],e.prototype,"m_roles",void 0),R.c([d.observable],e.prototype,"m_rgGroupMembersSummary",void 0),R.c([d.observable],e.prototype,"m_cMemberSummaryCount",void 0),R.c([d.computed],e.prototype,"name",null),R.c([d.computed],e.prototype,"hasAvatar",null),R.c([d.computed],e.prototype,"hasIcon",null),R.c([d.computed],e.prototype,"avatar_url_small",null),R.c([d.computed],e.prototype,"avatar_url_medium",null),R.c([d.computed],e.prototype,"avatar_url_full",null),R.c([d.computed],e.prototype,"chatRoomList",null),R.c([d.computed],e.prototype,"textRoomList",null),R.c([d.computed],e.prototype,"voiceRoomList",null),R.c([d.computed],e.prototype,"hasVoiceRoom",null),R.c([d.computed],e.prototype,"HasUnreadChatMessage",null),R.c([d.computed],e.prototype,"HasUnreadMention",null),R.c([d.computed],e.prototype,"time_last_activity",null),R.c([d.action],e.prototype,"ChangeMemberRank",null),R.c([d.action],e.prototype,"ChangeMemberRoles",null),R.c([d.action],e.prototype,"SetInitialGroupState",null),R.c([d.action],e.prototype,"UpdateGroupStateFromSummary",null),R.c([d.action],e.prototype,"SetNameCheckingForAppLocalization",null),R.c([d.action],e.prototype,"UpdateGroupState",null),R.c([d.action],e.prototype,"UnloadActiveGroupState",null),R.c([d.action],e.prototype,"UnloadGroupState",null),R.c([d.action],e.prototype,"UnloadAndResetGroupState",null),R.c([d.action],e.prototype,"UpdateChatRoomState",null),R.c([d.action],e.prototype,"UpdateUserState",null),R.c([d.action],e.prototype,"UpdateChatRoomHeaderState",null),R.c([d.action],e.prototype,"OnActivate",null),R.c([d.computed],e.prototype,"members_to_highlight_name",null),R.c([d.computed],e.prototype,"members_to_highlight",null),R.c([d.action],e.prototype,"AddCreatedRoom",null),R.c([d.action],e.prototype,"RemoveRoom",null),e}(),xt=function(o){function e(e,t){var n=o.call(this)||this;return n.LOG=Ae.create(function(){return n.GetUniqueID()},!1),n.m_mapChatViews=new Map,n.m_bShowSettingsDialog=!1,n.m_bShowBroadcast=!1,n.m_bChatHidden=!1,n.m_bShowGlobalChat=!1,n.m_bMemberSearchActive=!1,n.m_strMemberSearchString="",n.m_tabset=e,n.m_group=t,n.m_group.BIsValid()&&n.SelectChat(n.m_group.GetDefaultChatID()),n.m_disposeChatRooms=Object(d.autorun)(function(){var e=n.m_group.chatRoomList;n.m_selectedChatView&&e.length&&e.indexOf(n.m_selectedChatView.chat)<0&&n.SelectChat(n.m_group.GetDefaultChatID())}),n}return R.d(e,o),e.prototype.GetGroup=function(){return this.m_group},e.prototype.GetSelectedChatView=function(){return this.m_selectedChatView},e.prototype.GetActiveChatView=function(){return this.GetPopoverChatView()||this.GetSelectedChatView()},e.prototype.GetPopoverChatView=function(){return this.m_popoverChatView},Object.defineProperty(e.prototype,"isBroadcastShown",{get:function(){return this.m_bShowBroadcast},enumerable:!0,configurable:!0}),e.prototype.ShowBroadcast=function(){var e=this;this.SetChannelListCollapsed(!0,!1),this.SetMemberListCollapsed(!0,!1),this.m_bShowBroadcast=!0,SetBackgroundTimeout(function(){e.GetActiveChatView()&&e.GetActiveChatView().OnChatFrameChanged()},30)},e.prototype.HideBroadcast=function(){var e=this;this.m_bShowBroadcast=!1,ci.UIStore.SetTheaterMode(!1),SetBackgroundTimeout(function(){e.GetActiveChatView()&&e.GetActiveChatView().OnChatFrameChanged()},30)},e.prototype.SetVerticalBroadcastChat=function(e){this.m_bShowVerticalBroadcastChat=e},e.prototype.ToggleTheaterModeBroadcastChat=function(){ci.UIStore.SetTheaterMode(!ci.UIStore.GetTheaterMode())},e.prototype.SetChatHidden=function(e){this.m_bChatHidden=e},e.prototype.SetGlobalBroadcastChatShown=function(e){this.m_bShowGlobalChat=e,this.GetActiveChatView()&&this.GetActiveChatView().OnChatFrameChanged()},e.prototype.SetLocalBroadcastId=function(e){this.m_strLocalBroadcastId=e},e.prototype.SetMemberListCollapsed=function(e,t){if(void 0===t&&(t=!0),t){this.m_bMemberListCollapsedOverride=void 0;var n=this.GetGroup();ci.ChatStore.ChatRoomGroupDisplayPrefs.SetChatRoomDisplayPref(n.GetGroupID(),"bMemberListCollapsed",e)}else this.m_bMemberListCollapsedOverride=e},e.prototype.SetChannelListCollapsed=function(e,t){if(void 0===t&&(t=!0),t){this.m_bChannelListCollapsedOverride=void 0;var n=this.GetGroup();ci.ChatStore.ChatRoomGroupDisplayPrefs.SetChatRoomDisplayPref(n.GetGroupID(),"bChannelListCollapsed",e)}else this.m_bChannelListCollapsedOverride=e},e.prototype.ClosePopoverChat=function(){this.m_popoverChatView&&(this.m_popoverChatView.OnViewClosed(),this.m_disposeActiveVoice&&this.m_disposeActiveVoice(),this.m_popoverChatView=null)},e.prototype.SelectChat=function(e){var t=this,n=this.m_group.GetChatRoom(e);if(n){if(n.GetVoiceAllowed()&&n!=this.m_group.GetDefaultChatRoom()){if(this.m_popoverChatView&&this.m_popoverChatView.chat==n)return}else if(this.ClosePopoverChat(),this.m_selectedChatView&&this.m_selectedChatView.chat==n)return;n.GetVoiceAllowed()&&this.m_group.GetDefaultChatRoom()!=n?(this.ClosePopoverChat(),this.m_popoverChatView=this.GetChatViewForRoom(n),this.m_disposeActiveVoice&&this.m_disposeActiveVoice(),this.m_disposeActiveVoice=Object(d.when)(function(){return!n.BVoiceActive()},function(){t.m_popoverChatView&&t.m_popoverChatView.chat==n&&t.ClosePopoverChat()})):(this.m_selectedChatView&&this.m_selectedChatView.OnViewClosed(),this.m_selectedChatView=this.GetChatViewForRoom(n)),this.m_tabset.activeTab==this&&this.m_tabset.is_popup_focused&&this.OnTabActivate()}},e.prototype.SelectNextChannel=function(){var e=this.GetSelectedChannelIndex(),t=this.GetGroup().textRoomList,n=e>=t.length-1?0:e+1;this.SelectChat(t[n].GetRoomID())},e.prototype.SelectPreviousChannel=function(){var e=this.GetSelectedChannelIndex(),t=this.GetGroup().textRoomList,n=e<=0?t.length-1:e-1;this.SelectChat(t[n].GetRoomID())},e.prototype.GetSelectedChannelIndex=function(){var t=this.GetSelectedChatView().chat.GetRoomID();return this.GetGroup().textRoomList.findIndex(function(e){return e.GetRoomID()===t})},e.prototype.GetChatViewForRoom=function(e){var t=e.GetRoomID(),n=this.m_mapChatViews.get(t);return n?this.LOG("reusing chat for "+t):n=new nn(this.m_tabset,e),n},e.prototype.StartRoomRename=function(e){this.m_ulRenameChatRoomID=e},e.prototype.EndRoomRename=function(){this.m_ulRenameChatRoomID=""},e.prototype.IsRoomRenameActive=function(e){return""!=this.m_ulRenameChatRoomID&&this.m_ulRenameChatRoomID==e},e.prototype.GetRenameRoomID=function(){return this.m_ulRenameChatRoomID},e.prototype.OnTabClosed=function(){this.m_disposeActiveVoice&&this.m_disposeActiveVoice(),this.m_disposeChatRooms&&this.m_disposeChatRooms(),this.ClosePopoverChat(),this.GetSelectedChatView().OnViewClosed(),ci.ChatStore.DecRefActiveChatRoomGroup(this.GetGroup().GetGroupID())},e.prototype.IsVoiceActive=function(){return ci.ChatStore.VoiceChat.GetActiveChatRoomGroupID()==this.m_group.GetGroupID()},e.prototype.IsTabForChat=function(e){if(!(e instanceof kt))return!1;var t=e;return!!this.m_group.GetChatRoom(t.GetRoomID())},e.prototype.GetUnreadMessageCount=function(){return this.m_group.HasUnreadChatMessage?1:0},e.prototype.SetMemberSearchEnabled=function(e){this.m_bMemberSearchActive&&this.m_strMemberSearchString==e||(this.m_bMemberSearchActive=!0,this.m_strMemberSearchString=e||"")},e.prototype.ClearMemberSearch=function(){this.m_bMemberSearchActive=!1,this.m_strMemberSearchString=""},e.prototype.IsMemberSearchActive=function(){return this.m_bMemberSearchActive},e.prototype.GetMemberSearch=function(){return this.m_strMemberSearchString},Object.defineProperty(e.prototype,"normalizedMemberSearch",{get:function(){return this.m_strMemberSearchString.trim().toLocaleLowerCase()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isMemberListExpanded",{get:function(){if(this.m_bMemberSearchActive)return!0;if(void 0!==this.m_bMemberListCollapsedOverride)return!this.m_bMemberListCollapsedOverride;var e=this.GetGroup();return!ci.ChatStore.ChatRoomGroupDisplayPrefs.GetChatRoomDisplayPref(e.GetGroupID(),"bMemberListCollapsed")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isChannelListCollapsed",{get:function(){if(void 0!==this.m_bChannelListCollapsedOverride)return this.m_bChannelListCollapsedOverride;var e=this.GetGroup();return ci.ChatStore.ChatRoomGroupDisplayPrefs.GetChatRoomDisplayPref(e.GetGroupID(),"bChannelListCollapsed")},enumerable:!0,configurable:!0}),e.prototype.GetTabName=function(){return this.m_group.name},e.prototype.GetUniqueID=function(){return this.m_group.unique_id},e.prototype.OnTabFocus=function(){var e=this.GetActiveChatView();e&&e.OnFocus()},e.prototype.InternalOnTabActivate=function(){var e=this.GetActiveChatView();e&&e.OnActivate()},e.prototype.OnTabDeactivate=function(){var e=this.GetActiveChatView();e&&e.OnDeactivate()},e.prototype.IsChatRoom=function(){return!0},e.prototype.GetChatView=function(){return this.GetActiveChatView()},R.c([d.observable],e.prototype,"m_selectedChatView",void 0),R.c([d.observable],e.prototype,"m_popoverChatView",void 0),R.c([d.observable],e.prototype,"m_bShowSettingsDialog",void 0),R.c([d.observable],e.prototype,"m_ulRenameChatRoomID",void 0),R.c([d.observable],e.prototype,"m_bShowBroadcast",void 0),R.c([d.observable],e.prototype,"m_bShowVerticalBroadcastChat",void 0),R.c([d.observable],e.prototype,"m_strLocalBroadcastId",void 0),R.c([d.observable],e.prototype,"m_bChatHidden",void 0),R.c([d.observable],e.prototype,"m_bShowGlobalChat",void 0),R.c([d.observable],e.prototype,"m_bMemberSearchActive",void 0),R.c([d.observable],e.prototype,"m_strMemberSearchString",void 0),R.c([d.observable],e.prototype,"m_bMemberListCollapsedOverride",void 0),R.c([d.observable],e.prototype,"m_bChannelListCollapsedOverride",void 0),R.c([d.action],e.prototype,"ShowBroadcast",null),R.c([d.action.bound],e.prototype,"HideBroadcast",null),R.c([d.action.bound],e.prototype,"SetVerticalBroadcastChat",null),R.c([d.action],e.prototype,"ToggleTheaterModeBroadcastChat",null),R.c([d.action],e.prototype,"SetChatHidden",null),R.c([d.action],e.prototype,"SetGlobalBroadcastChatShown",null),R.c([d.action],e.prototype,"SetLocalBroadcastId",null),R.c([d.action],e.prototype,"SetMemberListCollapsed",null),R.c([d.action],e.prototype,"SetChannelListCollapsed",null),R.c([d.action],e.prototype,"ClosePopoverChat",null),R.c([d.action],e.prototype,"SelectChat",null),R.c([d.action],e.prototype,"SelectNextChannel",null),R.c([d.action],e.prototype,"SelectPreviousChannel",null),R.c([d.action],e.prototype,"StartRoomRename",null),R.c([d.action],e.prototype,"EndRoomRename",null),R.c([d.action],e.prototype,"OnTabClosed",null),R.c([d.action],e.prototype,"SetMemberSearchEnabled",null),R.c([d.action],e.prototype,"ClearMemberSearch",null),R.c([d.computed],e.prototype,"normalizedMemberSearch",null),R.c([d.computed],e.prototype,"isMemberListExpanded",null),R.c([d.computed],e.prototype,"isChannelListCollapsed",null),e}(ue),Ut=function(){function e(){this.loadingState="pending"}return R.c([d.observable],e.prototype,"loadingState",void 0),R.c([d.observable],e.prototype,"rgBans",void 0),e}(),jt={bMemberListCollapsed:void 0,bChannelListCollapsed:void 0},Ht="ChatRoomGroupDisplayPrefs",Wt=function(){function e(){this.m_mapDisplayPrefs=d.observable.map()}return e.prototype.Init=function(e){var n=this;this.m_SettingsStore=e,this.m_SettingsStore.GetObjectFromLocalStorageWhenReady(Ht).then(function(e){for(var t in n.m_mapDisplayPrefs.clear(),e.chatRoomGroups)n.m_mapDisplayPrefs.set(t,e.chatRoomGroups[t])})},e.prototype.GetChatRoomDisplayPref=function(e,t){return(this.m_mapDisplayPrefs.get(e)||jt)[t]},e.prototype.ToggleChatRoomDisplayPref=function(e,t){var n=this.GetChatRoomDisplayPref(e,t);this.SetChatRoomDisplayPref(e,t,!n)},e.prototype.SetChatRoomDisplayPref=function(e,t,n){var o=this.m_mapDisplayPrefs.get(e);o&&o[t]===n||(o||(this.m_mapDisplayPrefs.set(e,Object.assign({},jt)),o=this.m_mapDisplayPrefs.get(e)),o[t]=n,this.WritePrefs())},e.prototype.WritePrefs=function(){this.m_SettingsStore.StoreObjectInLocalStorage(Ht,{chatRoomGroups:this.m_mapDisplayPrefs.toJSON()})},e.prototype.FillInChatUsabilityMetrics=function(e){var t=Array.from(this.m_mapDisplayPrefs.values());e.ui_state().set_group_chat_left_col_collapsed(M.b(t,function(e){return e.bChannelListCollapsed})),e.ui_state().set_group_chat_right_col_collapsed(M.b(t,function(e){return e.bMemberListCollapsed}))},R.c([d.action],e.prototype,"SetChatRoomDisplayPref",null),e}(),zt=function(){function e(){this.m_mapAccountToExtra=d.observable.map()}return e.prototype.GetCurrentMemberSet=function(){var n=new Set;return this.m_mapAccountToExtra.forEach(function(e,t){n.add(t)}),n},Object.defineProperty(e.prototype,"unfiltered_count",{get:function(){return this.m_mapAccountToExtra.size},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"member_counts",{get:function(){for(var e=0,t=0,n=0,o=this.member_list_unsorted;n<o.length;n++){var i=o[n];i.persona.is_online&&(e++,i.persona.is_ingame&&t++)}return{online:e,ingame:t}},enumerable:!0,configurable:!0}),e.prototype.Clear=function(){this.m_mapAccountToExtra.clear()},e.prototype.AddMember=function(e,t){void 0===t&&(t=void 0),this.HasMember(e)||this.m_mapAccountToExtra.set(e,t)},e.prototype.RemoveMember=function(e){this.HasMember(e)&&this.m_mapAccountToExtra.delete(e)},e.prototype.GetExtra=function(e){return this.m_mapAccountToExtra.get(e)},e.prototype.HasMember=function(e){return this.m_mapAccountToExtra.has(e)},Object.defineProperty(e.prototype,"member_list",{get:function(){var e=this.member_list_unsorted.slice();return e.sort(ft.DefaultFriendSortComparator),e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"member_list_unsorted",{get:function(){var n=[];return this.m_mapAccountToExtra.forEach(function(e,t){n.push(ci.FriendStore.GetPlayer(t))}),n},enumerable:!0,configurable:!0}),R.c([d.computed],e.prototype,"unfiltered_count",null),R.c([d.computed],e.prototype,"member_counts",null),R.c([d.action],e.prototype,"Clear",null),R.c([d.action],e.prototype,"AddMember",null),R.c([d.action],e.prototype,"RemoveMember",null),R.c([d.computed],e.prototype,"member_list",null),R.c([d.computed],e.prototype,"member_list_unsorted",null),e}(),qt=function(){function e(){var c=this;this.m_bEmoticonListRequested=!1,this.m_bInitialized=!1,this.m_rgEmoticons=[],this.m_rgFlairs=[],this.m_rgRecentEmoticons=void 0,this.fnRecvEmoticonList=h(9331,b.h,function(e){c.m_rgEmoticons=[],c.m_rgRecentEmoticons=void 0,c.m_rtMostRecentEmoticon=void 0;for(var t=c.m_CMInterface.GetServerRTime32()-604800,n=0,o=e.Body().emoticons();n<o.length;n++){var i=o[n],r=i.name();if(r.startsWith("^"))c.m_rgFlairs.push({name:r.match(new RegExp(/:(.*):/))[1],flairGroupID:Number(r.match(new RegExp(/\^(.*)\^/))[1])});else{var a={name:r.substr(1,r.length-2)},s=a.name.toLowerCase();s!=a.name&&(a.name_normalized=s),i.time_last_used()&&(a.last_used=i.time_last_used()),i.use_count()&&(a.use_count=i.use_count()),a.last_used||i.time_received()&&i.time_received()>t&&(a.time_received=i.time_received(),(!c.m_rtMostRecentEmoticon||a.time_received>c.m_rtMostRecentEmoticon)&&(c.m_rtMostRecentEmoticon=a.time_received)),c.m_rgEmoticons.push(a)}}c.m_bInitialized=!0,c.m_bEmoticonListRequested=!1})}return e.prototype.Init=function(e){this.m_CMInterface=e},e.GetEmoticonURL=function(e,t){return t?_.b.COMMUNITY_CDN_URL+"economy/emoticonlarge/"+e:_.b.COMMUNITY_CDN_URL+"economy/emoticon/"+e},e.GetEmoticonReplaceRegex=function(){return e.sm_EmoticonRegex},e.prototype.SearchEmoticons=function(e,t,n){var o;void 0===t&&(t=25),void 0===n&&(n=!0),this.UpdateEmoticonList();var i=[];e=e.toLocaleLowerCase();for(var r=0,a=this.recent_emoticons;r<a.length;r++){var s=(p=a[r]).name_normalized||p.name;if((!e||n&&s.startsWith(e)||!n&&-1!==s.indexOf(e))&&(i.push({name:p.name,recent:!0,new:!(p.last_used||!p.time_received)}),o||(o=new Set),o.add(p.name),i.length>=t))break}if(i.length<t)for(var c=0,l=this.m_rgEmoticons;c<l.length;c++){var p;s=(p=l[c]).name_normalized||p.name;if((!e||n&&s.startsWith(e)||!n&&-1!==s.indexOf(e))&&(!o||!o.has(p.name))&&(i.push({name:p.name,recent:!1,new:!1}),i.length>=t))break}return i},Object.defineProperty(e.prototype,"is_initialized",{get:function(){return this.m_bInitialized},enumerable:!0,configurable:!0}),e.prototype.GetTimeReceivedNewestEmoticon=function(){return this.UpdateEmoticonList(),this.m_rtMostRecentEmoticon},e.prototype.UpdateEmoticonList=function(){this.m_bInitialized||this.RequestEmoticonList()},Object.defineProperty(e.prototype,"emoticon_list",{get:function(){return this.UpdateEmoticonList(),this.m_rgEmoticons},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"flair_list",{get:function(){return this.UpdateEmoticonList(),this.m_rgFlairs},enumerable:!0,configurable:!0}),e.prototype.GetFlairListByGroupID=function(t){return this.m_rgFlairs.filter(function(e){return e.flairGroupID===t})},Object.defineProperty(e.prototype,"recent_emoticons",{get:function(){return void 0===this.m_rgRecentEmoticons&&this.BuildRecentEmoticonList(),this.m_rgRecentEmoticons},enumerable:!0,configurable:!0}),e.prototype.TrackEmoticonUsage=function(e,t){if(this.m_bInitialized){for(var n,o=new Map,i=/\[emoticon\]([^[]*)/g;n=i.exec(e);){var r=o.get(n[1])||0;o.set(n[1],r+1)}var a=!1;if(o.size){if(void 0!==this.m_rgRecentEmoticons)for(var s=0,c=this.m_rgRecentEmoticons;s<c.length;s++){var l=c[s];o.has(l.name)&&(l.last_used=t,l.use_count+=o.get(l.name),o.delete(l.name),l.time_received&&(a=!0,delete l.time_received))}if(o.size)for(var p=0,u=this.m_rgEmoticons;p<u.length;p++){l=u[p];o.has(l.name)&&(l.last_used=t,l.use_count+=o.get(l.name),delete l.time_received,void 0!==this.m_rgRecentEmoticons&&this.m_rgRecentEmoticons.push(l))}if(void 0!==this.m_rgRecentEmoticons&&(this.SortRecentEmoticons(),a)){this.m_rtMostRecentEmoticon=void 0;for(var m=0,d=this.m_rgRecentEmoticons;m<d.length;m++){!(l=d[m]).last_used&&l.time_received&&(!this.m_rtMostRecentEmoticon||l.time_received>this.m_rtMostRecentEmoticon)&&(this.m_rtMostRecentEmoticon=l.time_received)}}}}},e.prototype.RequestEmoticonList=function(){var t=this;!this.m_bEmoticonListRequested&&this.m_CMInterface&&(this.m_bEmoticonListRequested=!0,this.m_CMInterface.RunWhenLoggedOn(function(){var e=m.Init(b.j,9330);t.m_CMInterface.Send(e)}))},e.prototype.BuildRecentEmoticonList=function(){this.m_rgRecentEmoticons=[];for(var e=this.m_CMInterface.GetServerRTime32()-604800,t=0,n=this.m_rgEmoticons;t<n.length;t++){var o=n[t];(o.last_used||o.time_received&&o.time_received>e)&&this.m_rgRecentEmoticons.push(o)}this.SortRecentEmoticons()},e.prototype.SortRecentEmoticons=function(){this.m_rgRecentEmoticons.sort(function(e,t){return(t.last_used||t.time_received)-(e.last_used||e.time_received)}),this.m_rgRecentEmoticons=this.m_rgRecentEmoticons.slice(0,50)},e.sm_EmoticonRegex=new RegExp("ː([a-zA-Z0-9_\\-]+)ː","g"),R.c([d.observable],e.prototype,"m_bInitialized",void 0),R.c([d.observable],e.prototype,"m_rtMostRecentEmoticon",void 0),R.c([d.action],e.prototype,"TrackEmoticonUsage",null),e}(),Kt="FriendRecentChats",Yt=function(){function e(e){var c=this;this.m_rgFriendChats=[],this.m_rtLastSessionUpdate=0,this.m_mapLastChatTimeByFriend=d.observable.map(),this.m_mapRecentIgnoreTimeBeforeByFriend=d.observable.map(),this.m_IncomingFriendMessageHandler=f(rt.f.IncomingMessageHandler,function(e){var t=new D.a(e.Body().steamid_friend()),n=ci.FriendStore.GetPlayerIfCached(t.GetAccountID());if(!n){if(e.Body().low_priority())return 41;n=ci.FriendStore.GetPlayer(t.GetAccountID())}if(1==e.Body().chat_entry_type()){var o=e.Body().local_echo(),i=n.is_blocked||e.Body().low_priority()&&!n.is_friend,r=o?c.m_ChatStore.FriendStore.self.persona.m_steamid:t,a=(s=c.GetFriendChat(t.GetAccountID(),!i)).GetVisibilityState();!(i||o||ci.FriendStore.BIsInvisibleMode()||ci.FriendStore.GetUserDoNotDisturb())&&!G.a.IN_MOBILE&&ci.UIStore.ShowAndOrActivateChat(ci.GetDefaultBrowserContext(),s,!1),s&&(n.is_friend||0!=a||s.SetShowNonFriendWarning(!0),s.AddNewChatMsgAndNotify(r.GetAccountID(),e.Body().rtime32_server_timestamp(),e.Body().ordinal(),e.Body().message(),e.Body().message_no_bbcode())),c.m_mapLastChatTimeByFriend.set(t.GetAccountID(),e.Body().rtime32_server_timestamp())}else if(2==e.Body().chat_entry_type()&&!e.Body().local_echo()){var s;(s=c.GetFriendChat(t.GetAccountID(),!1))&&s.OnFriendTypingNotification()}return 1}),this.m_AckMessageEchoHandler=f(rt.f.NotifyAckMessageEchoHandler,function(e){var t=new D.a(e.Body().steamid_partner()),n=c.GetFriendChat(t.GetAccountID());return n&&n.UpdateLastAckTimeFromServer(e.Body().timestamp()),1}),this.m_ChatStore=e}return e.prototype.GetFriendChat=function(e,t){void 0===t&&(t=!0);for(var n=0,o=this.m_rgFriendChats;n<o.length;n++){var i=o[n];if(i.accountid_partner==e)return i}if(!t)return null;var r=new Jt(e,this.m_ChatStore,this.m_ChatStore.CMInterface);return this.m_rgFriendChats.push(r),r},e.prototype.OnLogon=function(){var o=this;this.LoadFriendMessageSessions(),ci.SettingsStore.GetObjectFromLocalStorageWhenReady(Kt).then(function(e){for(var t in o.m_mapRecentIgnoreTimeBeforeByFriend.clear(),e.ignoretimes){var n=parseInt(t,10);o.m_mapRecentIgnoreTimeBeforeByFriend.set(n,e.ignoretimes[t])}})},e.prototype.RestoreStatePostDisconnect=function(){this.LoadFriendMessageSessions();for(var e=0,t=this.m_rgFriendChats;e<t.length;e++){t[e].OnConnectionRestored()}},e.prototype.GetServiceTransport=function(){return this.m_ChatStore.CMInterface.GetServiceTransport()},e.prototype.LoadFriendMessageSessions=function(){var r=this,e=m.Init(rt.e);e.Body().set_lastmessage_since(this.m_rtLastSessionUpdate),rt.g.GetActiveMessageSessions(this.GetServiceTransport(),e).then(function(e){r.m_rtLastSessionUpdate=e.Body().timestamp();for(var t=0,n=e.Body().message_sessions();t<n.length;t++){var o=n[t];if(r.m_mapLastChatTimeByFriend.set(o.accountid_friend(),o.last_view()),0<o.unread_message_count()){var i=r.GetFriendChat(o.accountid_friend(),!0);i&&i.InitUnreadMessageCountFromServer(o.unread_message_count(),o.last_view(),o.last_message())}}})},e.prototype.GetFriendsWithUnreadMessages=function(e){for(var t=[],n=0,o=this.m_rgFriendChats;n<o.length;n++){var i=o[n];0<i.unread_message_count&&(!e||i.GetVisibilityState(e)<2)&&!i.is_blocked_friend&&t.push(i)}return t.sort(function(e,t){return e.time_last_message-t.time_last_message}),t},e.prototype.BIsFriendChatRecent=function(e){var t=ci.GetServerRTime32()-this.RecentChatCutoffDuration,n=this.m_mapLastChatTimeByFriend.get(e);if(!n)return!1;if(t<=n){var o=this.m_mapRecentIgnoreTimeBeforeByFriend.get(e);if(!o||o<n)return!0}return!1},e.prototype.GetFriendChatsWithRecentMessages=function(){var t=this;return this.m_rgFriendChats.filter(function(e){return t.BIsFriendChatRecent(e.accountid_partner)})},e.prototype.GetUnfilteredFriendsWithUnreadMessages=function(){for(var e=[],t=0,n=this.m_rgFriendChats;t<n.length;t++){var o=n[t];0<o.unread_message_count&&!o.is_blocked_friend&&e.push(o)}return e.sort(function(e,t){return e.time_last_message-t.time_last_message}),e},e.prototype.GetAllChats=function(){return this.m_rgFriendChats.slice()},Object.defineProperty(e.prototype,"RecentChatCutoffDuration",{get:function(){return 3600},enumerable:!0,configurable:!0}),e.prototype.ClearRecentChatsForFriend=function(e){this.m_mapRecentIgnoreTimeBeforeByFriend.set(e,ci.GetServerRTime32()),this.WriteRecentChatsPrefs()},e.prototype.WriteRecentChatsPrefs=function(){var n=this,o=ci.GetServerRTime32()-this.RecentChatCutoffDuration;this.m_mapRecentIgnoreTimeBeforeByFriend.forEach(function(e,t){e<o&&n.m_mapRecentIgnoreTimeBeforeByFriend.delete(t)}),ci.SettingsStore.StoreObjectInLocalStorage(Kt,{ignoretimes:this.m_mapRecentIgnoreTimeBeforeByFriend.toJS()})},Object.defineProperty(e.prototype,"GetRecentlyChattingFriends",{get:function(){var o=this,i=[];return this.m_mapLastChatTimeByFriend.forEach(function(e,t){if(o.BIsFriendChatRecent(t)){var n=ci.FriendStore.GetFriend(t);n&&i.push(n)}}),i.sort(ft.DefaultFriendSortComparator),i},enumerable:!0,configurable:!0}),e.prototype.GetUnreadFriendMessageCount=function(e){for(var t=0,n=0,o=this.m_rgFriendChats;n<o.length;n++){var i=o[n];0<i.unread_message_count&&(!e||i.GetVisibilityState(e)<2)&&!i.is_blocked_friend&&(t+=i.unread_message_count)}return t},e.prototype.GetFriendLastChatTime=function(e){return this.m_mapLastChatTimeByFriend.get(e)||0},R.c([d.observable],e.prototype,"m_rgFriendChats",void 0),R.c([d.action],e.prototype,"ClearRecentChatsForFriend",null),R.c([d.computed],e.prototype,"GetRecentlyChattingFriends",null),e}(),Jt=function(i){function e(e,t,n){var o=i.call(this,t.FriendStore,t,n)||this;return o.m_iClearFriendIsTypingInterval=void 0,o.m_bFriendIsTyping=!1,o.m_ChatMsgTradeRequest=null,o.m_bNeedsNonFriendWarning=!1,o.m_unAccountIDFriend=e,o}return R.d(e,i),Object.defineProperty(e.prototype,"unread_message_count",{get:function(){var e=this.m_ChatStore.VoiceChat.BPartnerHasRequestedAndIsInOneOnOneChat(this.m_unAccountIDFriend);return e=e&&!this.BVoiceActive(),this.m_cUnreadChatMessages+(e?1:0)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"VoiceChatStore",{get:function(){return this.m_ChatStore.VoiceChat},enumerable:!0,configurable:!0}),e.prototype.SetShowNonFriendWarning=function(e){this.m_bNeedsNonFriendWarning=e},e.prototype.GetShowNonFriendWarning=function(){var e=this.m_bNeedsNonFriendWarning&&!ci.FriendStore.BApprovedNonFriendMessages(this.accountid_partner);if(e){var t=ci.FriendStore.GetFriend(this.accountid_partner);e=!t||!t.is_friend}return e},e.prototype.GetMessagesFromTimeRange=function(e,t,n,o,i){var r=this,a=m.Init(rt.b);return a.Body().set_steamid1(this.m_CMInterface.steamid.ConvertTo64BitString()),a.Body().set_steamid2(D.a.InitFromAccountID(this.m_unAccountIDFriend).ConvertTo64BitString()),a.Body().set_count(tt.k_LoadMoreMessageCount),a.Body().set_bbcode_format(!0),a.Body().set_rtime32_start_time(e),a.Body().set_start_ordinal(t),a.Body().set_time_last(n),a.Body().set_ordinal_last(o),console.log(this.unique_id+" friend trying to load "+i+" messages in range "+e+":"+t+" - "+n+":"+o),rt.g.GetRecentMessages(this.m_ChatStore.CMInterface.GetServiceTransport(),a).then(function(e){var t=e.GetEResult();if(1!=t)throw t;return{messages:r.GetMessagesFromResponse(e),moreAvailable:e.Body().more_available()}})},e.prototype.GetMessagesFromResponse=function(e){for(var t=e.Body().messages(),n=[],o=t.length-1;0<=o;o--){var i=t[o],r=i.accountid();n.push(new Ye(r,i.timestamp(),i.ordinal(),i.message()||""))}return n},e.prototype.GetBBCodeParser=function(){return this.m_ChatStore.FriendChatBBCodeParser},e.prototype.AckChatMsgOnServer=function(e){var t=m.Init(rt.a);t.Body().set_steamid_partner(D.a.InitFromAccountID(this.accountid_partner).ConvertTo64BitString()),t.Body().set_timestamp(e),rt.g.AckMessage(this.m_CMInterface.GetServiceTransport(),t)},Object.defineProperty(e.prototype,"name",{get:function(){var e=this.chat_partner;return e?e.display_name:void 0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"unique_id",{get:function(){return"f"+this.accountid_partner},enumerable:!0,configurable:!0}),e.prototype.BIsVoiceAllowed=function(){return!!this.chat_partner.is_friend&&(0!=this.chat_partner.persona.m_ePersonaState&&!!this.chat_partner.is_online_in_beta)},e.prototype.GetVoiceNotAllowedReason=function(){return this.chat_partner.is_friend?0==this.chat_partner.persona.m_ePersonaState?Object($.b)("#VoiceChat_Unavailable_NotOnline",this.chat_partner.display_name):this.chat_partner.is_online_in_beta?null:Object($.b)("#VoiceChat_Unavailable_NotInBeta",this.chat_partner.display_name):Object($.b)("#VoiceChat_Unavailable_NotFriend",this.chat_partner.display_name)},e.prototype.ToggleVoiceChat=function(){return this.ChatStore.VoiceChat.IsVoiceActiveForFriend(this.accountid_partner)?this.ChatStore.VoiceChat.OnUserEndVoiceChat():this.ChatStore.VoiceChat.InitiateFriendChat(this.accountid_partner),!0},e.prototype.BVoiceActive=function(){return this.ChatStore.VoiceChat.IsVoiceActiveForFriend(this.accountid_partner)},Object.defineProperty(e.prototype,"is_blocked_friend",{get:function(){return this.chat_partner.is_blocked},enumerable:!0,configurable:!0}),e.prototype.SendChatMessage=function(e){var n=this;if(!this.m_CMInterface.logged_on)return!1;this.chat_partner.is_friend||ci.FriendStore.SetApprovedNonFriendMessages(this.chat_partner.accountid);var t=ke.EscapeBBCode(e),o=this.AppendLocalEchoChatMsg(t),i=m.Init(rt.d);return i.Body().set_chat_entry_type(1),i.Body().set_message(t),i.Body().set_steamid(D.a.InitFromAccountID(this.accountid_partner).ConvertTo64BitString()),i.Body().set_contains_bbcode(!0),rt.g.SendMessage(this.m_CMInterface.GetServiceTransport(),i).then(function(e){if(1==e.GetEResult()){o.rtTimestamp=e.Body().server_timestamp(),o.unOrdinal=e.Body().ordinal(),n.OnUserChatEcho(o.rtTimestamp,o.unOrdinal);var t=e.Body().modified_message();t&&Object(d.runInAction)(function(){n.m_ChatStore.EmoticonStore.TrackEmoticonUsage(t,o.rtTimestamp),o.strMessage=t}),o.OnServerAcknowledged()}else switch(e.GetEResult()){case 15:o.eErrorSending=We.NotFriends;break;case 84:o.eErrorSending=We.RateLimitExceeded;break;default:o.eErrorSending=We.Generic}}).catch(function(){o.eErrorSending=We.Generic}),!(this.m_tsLastSentTypingNotification=void 0)},e.prototype.OnTyping=function(){if(!this.m_tsLastSentTypingNotification||1e4<performance.now()-this.m_tsLastSentTypingNotification){this.m_tsLastSentTypingNotification=performance.now();var e=m.Init(rt.d);e.Body().set_chat_entry_type(2),e.Body().set_steamid(D.a.InitFromAccountID(this.accountid_partner).ConvertTo64BitString()),rt.g.SendMessage(this.m_CMInterface.GetServiceTransport(),e)}},Object.defineProperty(e.prototype,"is_friend_typing",{get:function(){return this.m_bFriendIsTyping},enumerable:!0,configurable:!0}),e.prototype.OnFriendTypingNotification=function(){var e=this;this.m_bFriendIsTyping||(this.m_bFriendIsTyping=!0),void 0!==this.m_iClearFriendIsTypingInterval&&window.clearInterval(this.m_iClearFriendIsTypingInterval),this.m_iClearFriendIsTypingInterval=window.setTimeout(function(){e.m_iClearFriendIsTypingInterval=void 0,e.ClearFriendIsTypingState()},11e3)},e.prototype.PlayFriendMessageSound=function(){ci.FriendStore.GetUserDoNotDisturb()||ci.AudioPlaybackManager.PlayAudioURL(G.a.COMMUNITY_CDN_URL+"public/sounds/webui/ui_steam_message_old_smooth.m4a")},e.prototype.OnReceivedNewMessage=function(e,t,n,o){if(!e.BIsLocalEcho()&&e.unAccountID!=this.self.accountid){if(this.ClearFriendIsTypingState(),t<2&&(this.is_blocked_friend||ci.FriendStore.BIsInvisibleMode()))return;if(ci.NotificationManager.BNotificationsPermitted()&&this.chat_partner.BShowMessageNotification()&&t<4&&!ci.FriendStore.GetUserDoNotDisturb()){var i={title:this.chat_partner.display_name,body:n,tag:"message_"+this.chat_partner.accountid,steamid:this.chat_partner.persona.m_steamid.ConvertTo64BitString()};(i=this.DecorateNotification(e,i,n,o)).body&&(this.GetShowNonFriendWarning()&&ci.SettingsStore.BClientHasFeatureOrOnWeb("NonFriendMessageHandling")&&(i.body=""),ci.NotificationManager.DisplayNotificationFromFriend(this.chat_partner,i),this.m_bHasUnreadPriorityChatMessages||(this.m_bHasUnreadPriorityChatMessages=!0,ci.FriendStore.UpdateUnreadMessagesGlobal()))}this.chat_partner.BPlayMessageSound()&&t<4&&this.PlayFriendMessageSound(),0==ci.SettingsStore.FriendsSettings.nChatFlashMode&&t<4&&!ci.FriendStore.GetUserDoNotDisturb()&&ci.UIStore.FlashChatWindow(this)}},e.prototype.ClearFriendIsTypingState=function(){void 0!==this.m_iClearFriendIsTypingInterval&&(window.clearInterval(this.m_iClearFriendIsTypingInterval),this.m_iClearFriendIsTypingInterval=void 0),this.m_bFriendIsTyping=!1},e.prototype.PopulateCommitFileUploadFormData=function(e,t){e.append("friend_steamid",D.a.InitFromAccountID(this.accountid_partner).ConvertTo64BitString()),e.append("spoiler",t.bSpoiler?"1":"0")},e.prototype.GetMember=function(e){return e==this.m_unAccountIDFriend?this.chat_partner:e==this.self.accountid?this.self:void 0},Object.defineProperty(e.prototype,"accountid_partner",{get:function(){return this.m_unAccountIDFriend},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"chat_partner",{get:function(){return ci.FriendStore.GetPlayer(this.m_unAccountIDFriend)},enumerable:!0,configurable:!0}),e.prototype.AddNewTradeRequestAndNotify=function(e,t,n,o){var i=new Qe(e,t,n,o);this.InternalAppendChatMsg(i),this.m_ChatMsgTradeRequest=i;var r=Object($.b)("#ChatRoom_TradeRequest_Recipient_Pending",this.chat_partner.display_name);this.CheckShouldNotify(i,r,r)},e.prototype.GetTradeRequest=function(){return this.m_ChatMsgTradeRequest},e.prototype.CancelTradeRequest=function(e){this.m_ChatMsgTradeRequest&&this.m_ChatMsgTradeRequest.MarkAsCancelled(e)},e.prototype.MarkTradeRequestDeclined=function(){this.m_ChatMsgTradeRequest&&this.m_ChatMsgTradeRequest.MarkAsDeclined()},e.prototype.MarkTradeRequestAccepted=function(e){this.m_ChatMsgTradeRequest&&this.m_ChatMsgTradeRequest.MarkAsAccepted(e)},e.prototype.ViewerNeedsApproval=function(e){var t='[broadcastviewrequest requestid="'+e+'"][/broadcastviewrequest]';this.InternalAppendChatMsg(new Ye(this.chat_partner.accountid,ci.GetServerRTime32(),0,t)),ci.FriendStore.GetUserDoNotDisturb()||ci.NotificationManager.DisplayNotificationFromFriend(this.chat_partner,{title:"",body:Object($.b)("#Chat_BroadcastViewRequest_Notification"),tag:"message_"+this.chat_partner.accountid,steamid:this.chat_partner.persona.m_steamid.ConvertTo64BitString()})},R.c([d.observable],e.prototype,"m_bFriendIsTyping",void 0),R.c([d.observable],e.prototype,"m_bNeedsNonFriendWarning",void 0),R.c([d.action],e.prototype,"ToggleVoiceChat",null),R.c([d.action],e.prototype,"SendChatMessage",null),R.c([T.a,Object(ht.a)(100)],e.prototype,"PlayFriendMessageSound",null),R.c([d.action],e.prototype,"ClearFriendIsTypingState",null),R.c([d.action],e.prototype,"AddNewTradeRequestAndNotify",null),R.c([d.action],e.prototype,"CancelTradeRequest",null),R.c([d.action],e.prototype,"MarkTradeRequestDeclined",null),R.c([d.action],e.prototype,"MarkTradeRequestAccepted",null),R.c([d.action],e.prototype,"ViewerNeedsApproval",null),e}(tt);function Xt(e,t){if(!e||!t)return[];for(var n=[],o=e.values(),i=o.next();!i.done;)t(i.value)&&n.push(i.value),i=o.next();return n}var Qt,Zt,$t=function(){function e(){this.timestamp=0,this.imageWidth=0,this.imageHeight=0,this.eUploadState=0,this.uploadProgress=0}return R.c([d.observable],e.prototype,"file",void 0),R.c([d.observable],e.prototype,"dataURL",void 0),R.c([d.observable],e.prototype,"imageWidth",void 0),R.c([d.observable],e.prototype,"imageHeight",void 0),R.c([d.observable],e.prototype,"eUploadState",void 0),R.c([d.observable],e.prototype,"uploadProgress",void 0),R.c([d.observable],e.prototype,"strErrorDescription",void 0),e}(),en=function(){function e(e){this.m_fileUploadProps=new $t,this.m_Callbacks=e}return Object.defineProperty(e.prototype,"file_upload_props",{get:function(){return this.m_fileUploadProps},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"file_upload_data_url",{get:function(){return this.m_fileUploadProps.dataURL},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"file",{get:function(){return this.m_fileUploadProps.file},enumerable:!0,configurable:!0}),e.prototype.LogFileUploadMessage=function(e){this.m_Callbacks.LogFileUploadMessage&&this.m_Callbacks.LogFileUploadMessage(e)},e.prototype.SetUploadFileError=function(e,t){this.m_fileUploadProps.eUploadState=e,this.m_fileUploadProps.strErrorDescription=t,this.m_fileUploadProps.displayFileName=null},e.prototype.SetImageFileToUpload=function(a){var s=this;if(a)if(10485760<a.size)this.SetUploadFileError(4,Object($.b)("#Chat_Settings_Error_ChatFileTooLarge",a.name));else{var e=a.name.split(".").pop().toLowerCase();if(-1!=["jpg","jpeg","png","gif","webm","mpg","mp4","mpeg","ogv"].indexOf(e)){var c=new FileReader;c.onload=function(e){var t=a,n=c.result,o=s.StripExifMetadata(n,a.type);if(o){var i=o;i.lastModifiedDate=new Date(a.lastModified),i.name=a.name,t=i}if(s.SetFileToUpload(t),s.m_fileUploadProps.imageWidth=0,(s.m_fileUploadProps.imageHeight=0)==a.type.indexOf("image")){var r=new Image;r.src=s.m_fileUploadProps.dataURL,r.onload=function(e){s.m_fileUploadProps.imageWidth=r.width,s.m_fileUploadProps.imageHeight=r.height}}},c.readAsArrayBuffer(a)}else this.SetUploadFileError(5,Object($.b)("#Chat_Settings_Error_ChatFileTypeNotSupported",a.name))}else this.SetFileToUpload(null)},e.prototype.SetFileToUpload=function(e){if(this.m_fileUploadProps.file=e,this.m_fileUploadProps.dataURL=null,this.m_fileUploadProps.hmac=null,this.m_fileUploadProps.sha1=null,this.m_fileUploadProps.imageWidth=0,this.m_fileUploadProps.imageHeight=0,e){this.m_fileUploadProps.eUploadState=1;for(var t="";t.length<40;)t+=Math.floor(16*Math.random()).toString(16);this.m_fileUploadProps.dataURL=URL.createObjectURL(e),this.m_fileUploadProps.displayFileName=e.name,this.m_fileUploadProps.uploadFileName=window.performance.now()+"_"+e.name,this.m_fileUploadProps.sha1=t,this.m_fileUploadProps.hmac="",this.m_fileUploadProps.timestamp=0}else this.m_fileUploadProps.eUploadState=0},e.prototype.StripExifMetadata=function(t,e){var n=new DataView(t),o=0,i=0,r=[],a=0;if(65496==n.getUint16(o)){o+=2;var s=n.getUint16(o);for(o+=2;o<n.byteLength&&o<131072;){if(65505==s)r[a]={recess:i,offset:o-2},i=o+n.getUint16(o),a++;else if(65498==s)break;o+=n.getUint16(o),s=n.getUint16(o),o+=2}if(0<r.length){var c=new Array;return r.forEach(function(e){c.push(t.slice(e.recess,e.offset))},this),c.push(t.slice(i)),new Blob(c,{type:e})}}return null},e.prototype.RetryFileUpload=function(){this.BeginFileUpload(this.m_fileUploadProps.additionalProps)},e.prototype.BeginFileUpload=function(e){var r=this,t=this.m_fileUploadProps.file;if(t){this.m_fileUploadProps.eUploadState=2,this.m_fileUploadProps.uploadProgress=0,this.m_fileUploadProps.additionalProps=e;var n=new FormData;n.append("sessionid",G.a.SESSIONID),n.append("file_size",t.size.toString()),n.append("file_name",this.m_fileUploadProps.uploadFileName),n.append("file_sha",this.m_fileUploadProps.sha1),n.append("file_image_width",this.m_fileUploadProps.imageWidth.toString()),n.append("file_image_height",this.m_fileUploadProps.imageHeight.toString()),n.append("file_type",t.type),C.a.post(this.m_Callbacks.GetBeginFileUploadURL(),n).then(function(e){r.m_fileUploadProps.timestamp=e.data.timestamp,r.m_fileUploadProps.hmac=e.data.hmac,r.DoFileUpload(e.data.result)}).catch(function(i){Object(d.runInAction)(function(){r.m_fileUploadProps.eUploadState=3,r.LogFileUploadMessage(i.response);var e=null;if(i.response){var t=i.response.data,n=i.response.status,o=t&&t.success;401==n?21==o?e=Object($.b)("#Chat_Settings_Error_NotLoggedOn"):112==o?e=Object($.b)("#Chat_Settings_Error_LimitedUser"):15==o&&(e=Object($.b)("#Chat_Settings_Error_FailedToUpload")):e=400==n?8==o?Object($.b)("#Chat_Settings_Error_InvalidImage"):Object($.b)("#Chat_Settings_Error_ServerError")+" ("+o+")":Object($.b)("#Chat_Settings_Error_ServerError")}else e=Object($.b)("#ConnectionTrouble_FailedToConnect");r.m_fileUploadProps.strErrorDescription=Object($.b)("#Chat_Upload_ErrorStart",e)})})}else Object(I.a)(!1,"Must SetImageFileToUpload before calling BeginFileUpload")},e.prototype.DoFileUpload=function(t){var n=this,e=this.m_fileUploadProps.file,o=t.use_https?"https://":"http://";o+=t.url_host+t.url_path;for(var i={onUploadProgress:function(e){var t=e.loaded/e.total*100;Object(d.runInAction)(function(){n.m_fileUploadProps.uploadProgress=t})},headers:{}},r=0;r<t.request_headers.length;++r){var a=t.request_headers[r];"Content-Length"!=a.name&&"Host"!=a.name&&(i.headers[a.name]=a.value)}C.a.put(o,e,i).then(function(e){n.CommitFileUpload(!0,t.ugcid)}).catch(function(e){n.LogFileUploadMessage(e.response),Object(d.runInAction)(function(){n.m_fileUploadProps.strErrorDescription=Object($.b)("#Chat_Upload_ErrorCloud"),n.m_fileUploadProps.eUploadState=3,n.m_fileUploadProps.uploadProgress=0}),n.CommitFileUpload(!1,t.ugcid)})},e.prototype.CommitFileUpload=function(t,e){var r=this,n=this.m_fileUploadProps.file,o=this.m_fileUploadProps.sha1,i=new FormData;i.append("sessionid",G.a.SESSIONID),i.append("file_name",this.m_fileUploadProps.uploadFileName),i.append("file_sha",o),i.append("success",t?"1":"0"),i.append("ugcid",e),i.append("file_type",n.type),i.append("file_image_width",this.m_fileUploadProps.imageWidth.toString()),i.append("file_image_height",this.m_fileUploadProps.imageHeight.toString()),i.append("timestamp",this.m_fileUploadProps.timestamp.toString()),i.append("hmac",this.m_fileUploadProps.hmac),this.m_Callbacks.PopulateCommitFileUploadFormData(i,this.file_upload_props.additionalProps),C.a.post(this.m_Callbacks.GetCommitFileUploadURL(),i).then(function(e){r.m_fileUploadProps.eUploadState=t?(r.m_fileUploadProps.uploadProgress=0,r.m_fileUploadProps.file=null,0):3}).catch(function(i){t&&Object(d.runInAction)(function(){r.LogFileUploadMessage(i),r.m_fileUploadProps.uploadProgress=0,r.m_fileUploadProps.eUploadState=3;var e=null;if(i.response){var t=i.response.data,n=i.response.status,o=t&&t.success;400==n?e=Object($.b)("#Chat_Settings_Error_AccessDenied"):401==n?21==o?e=Object($.b)("#Chat_Settings_Error_NotLoggedOn"):112==o?e=Object($.b)("#Chat_Settings_Error_LimitedUser"):15==o&&(e=Object($.b)("#Chat_Settings_Error_AccessDenied")):e=500==n?Object($.b)("#Chat_Settings_Error_ServerError")+" ("+o+")":Object($.b)("#Chat_Settings_Error_ServerError")}else e=Object($.b)("#ConnectionTrouble_FailedToConnect");r.m_fileUploadProps.strErrorDescription="Failed to commit upload: "+e})})},e.prototype.ClearFileUploadError=function(){3!=this.m_fileUploadProps.eUploadState&&4!=this.m_fileUploadProps.eUploadState&&5!=this.m_fileUploadProps.eUploadState||this.CancelFileUpload()},e.prototype.CancelFileUpload=function(){this.SetFileToUpload(null)},R.c([d.action],e.prototype,"SetUploadFileError",null),R.c([d.action],e.prototype,"SetImageFileToUpload",null),R.c([d.action],e.prototype,"SetFileToUpload",null),R.c([d.action],e.prototype,"RetryFileUpload",null),R.c([d.action],e.prototype,"BeginFileUpload",null),R.c([d.action],e.prototype,"DoFileUpload",null),R.c([d.action],e.prototype,"CommitFileUpload",null),R.c([d.action],e.prototype,"ClearFileUploadError",null),R.c([d.action],e.prototype,"CancelFileUpload",null),e}(),tn=function(){function e(e){var s=this;this.LOG=Ae.create(function(){return"chatstore"},!1),this.m_EmoticonStore=new qt,this.m_FriendChatStore=new Yt(this),this.m_InviteStore=new fe(this),this.m_GameInviteStore=new Se,this.m_ChatRoomGroupDisplayPrefs=new Wt,this.m_EmbedStore=new Ie,this.m_mapChatGroups=d.observable.map(),this.m_mapActiveChatGroupsToRefCount=d.observable.map(),this.m_mapClanChatsByClanID=new Map,this.m_bReceivedChatGroupList=!1,this.m_bReadyToRender=!1,this.m_bSendingActiveGroups=!1,this.m_bSendActiveGroupsQueued=!1,this.m_IncomingChatRoomMessageHandler=f(pe.U.NotifyIncomingChatMessageHandler,function(e){var t=e.Body(),n=s.FindChatRoom(t.chat_group_id(),t.chat_id());if(!n)return 2;var o=new D.a(t.steamid_sender());if(0!=(t.server_message().message()||0))n.AddNewServerMsg(o.GetAccountID(),t.timestamp(),t.ordinal(),t.server_message().message(),t.message(),t.server_message().string_param(),t.server_message().accountid_param());else{var i=t.mentions(),r=null;i&&(r={},i.mention_all()&&(r.mention_all=!0),i.mention_here()&&(r.mention_here=!0),i.mention_accountids()&&-1!==i.mention_accountids().indexOf(s.m_FriendStore.self.accountid)&&(r.mention_user=!0)),n.AddNewChatMsgAndNotify(o.GetAccountID(),t.timestamp(),t.ordinal(),t.message(),t.message_no_bbcode(),r)}return 1}),this.m_ChatMessageModifiedHandler=f(pe.U.NotifyChatMessageModifiedHandler,function(e){var t=e.Body(),n=s.FindChatRoom(t.chat_group_id(),t.chat_id());if(!n)return 2;for(var o=[],i=0,r=e.Body().messages();i<r.length;i++){var a=r[i];a.deleted&&o.push({rtTimestamp:a.server_timestamp(),unOrdinal:a.ordinal()})}return n.UpdateChatMessageDeletedState(o,xe.Deleting),1}),this.m_IncomingChatRoomHeaderStateChangeHandler=a(pe.U.NotifyChatRoomHeaderStateChangeHandler,function(e){var t=e.Body().header_state().chat_group_id(),n=s.m_mapChatGroups.get(t);return n&&n.UpdateChatRoomHeaderState(e.Body().header_state()),1}),this.m_IncomingStateChangeHandler=a(pe.U.NotifyMemberStateChangeHandler,function(e){var t=e.Body().chat_group_id(),n=s.m_mapChatGroups.get(t);return n&&n.OnUserStateChange(e.Body().member(),e.Body().change()),1}),this.m_IncomingChatRoomGroupRoomsChangeHandler=a(pe.U.NotifyChatRoomGroupRoomsChangeHandler,function(e){var t=e.Body(),n=s.m_mapChatGroups.get(t.chat_group_id());return n&&n.OnRoomStateChange(t),1}),this.m_IncomingChatGroupUserStateChangedHandler=a(pe.U.NotifyChatGroupUserStateChangedHandler,function(e){var t=e.Body(),n=t.chat_group_id(),o=t.user_action();switch(o){case 1:var i=s.AddJoinedChatRoomGroup(t.group_summary(),t.user_chat_group_state());ci.UIStore.ShowAndOrActivateChatRoomGroup(ai,i,!1);break;case 2:case 3:case 10:ci.VoiceStore.GetActiveChatRoomGroupID()==n&&ci.VoiceStore.OnUserEndVoiceChat();var r=(i=s.GetChatRoomGroup(n))?i.name:void 0;s.RemoveChatRoomGroup(n),r&&(3==o?ci.ShowAlert(Object($.b)("#Alert_YouWereKickedTitle"),Object($.b)("#Alert_YouWereKickedDescription",r)):10==o&&ci.ShowAlert(Object($.b)("#Alert_YouWereBannedTitle"),Object($.b)("#Alert_YouWereBannedDescription",r)));break;case 7:case 0:i=s.GetChatRoomGroup(n);Object(I.a)(i,"Got state change for ChatRoomGroup we don't know about"),i&&i.UpdateUserState(t.user_chat_group_state());break;case 4:break;default:Object(I.a)(!1,"Don't know how to handle state change of type "+Object(pe.ab)(o)+" ")}return 1}),this.m_AckChatMessageEchoHandler=f(pe.U.NotifyAckChatMessageEchoHandler,function(e){var t=e.Body().chat_group_id(),n=e.Body().chat_id(),o=e.Body().timestamp(),i=s.GetChatRoomGroup(t);if(!i)return 2;if(n){var r=i.GetChatRoom(n);if(!r)return 11;r.UpdateLastAckTimeFromServer(o)}else i.UpdateLastAckTimeFromServer(o);return 1}),this.m_FriendStore=e}return e.prototype.Init=function(e,t){var n=this;this.m_CMInterface=e,this.m_EmoticonStore.Init(e),this.m_VoiceChat=t,this.m_ChatRoomBBCodeParser=ci.GetChatRoomBBCodeParser(),this.m_FriendChatBBCodeParser=ci.GetFriendChatBBCodeParser(),this.m_NotificationBBCodeParser=ci.GetNotificationBBCodeParser(),this.m_ChatRoomGroupDisplayPrefs.Init(ci.SettingsStore),this.m_EmbedStore.Init();var o=!1;return this.m_CMInterface.AddOnLogonCallback(function(){n.LoadMyChatRooms(),o?n.RestoreStatePostDisconnect():(n.m_FriendChatStore.OnLogon(),o=!0),n.m_GameInviteStore.Init()},102),new Promise(function(e,t){n.m_fnOnReadyToRender=e})},e.prototype.SetReadyToRender=function(){this.m_bReadyToRender||(this.m_bReadyToRender=!0,this.m_fnOnReadyToRender&&(this.m_fnOnReadyToRender(),this.m_fnOnReadyToRender=void 0))},e.prototype.RestoreStatePostDisconnect=function(){this.m_FriendChatStore.RestoreStatePostDisconnect(),this.m_mapChatGroups.forEach(function(e){return e.OnConnectionRestored()}),this.SendActiveChatRoomGroupsToServer()},e.prototype.LoadMyChatRooms=function(){var a=this,e=m.Init(pe.t);pe.V.GetMyChatRoomGroups(this.m_CMInterface.GetServiceTransport(),e).then(function(r){Object(d.runInAction)(function(){1!=r.GetEResult()&&!0;for(var e=0,t=r.Body().chat_room_groups();e<t.length;e++){var n=t[e],o=n.group_summary().chat_group_id();if(o){var i=a.m_mapChatGroups.get(o);i||(i=new Vt(a,o),a.m_mapChatGroups.set(o,i)),i.SetInitialGroupState(n.group_summary()),i.UpdateUserState(n.user_chat_group_state()),a.OnGroupAdded(i),i.BHasEverBeenAcked()||ci.UIStore.ShowUnackedGroup(i)}else!0}a.SetReadyToRender(),a.m_bReceivedChatGroupList=!0})}).catch(function(e){console.error("Failed to load chat rooms from server",e),a.SetReadyToRender()})},e.prototype.OnGroupAdded=function(e){e.GetClanID()&&(this.m_mapClanChatsByClanID.set(e.GetClanID(),e.GetGroupID()),this.m_FriendStore.ClanStore.SetClanChatGroupID(e.GetClanID(),e.GetGroupID()))},e.prototype.OnChatRoomActivated=function(e){e.GetGroup().OnActivate()},e.prototype.JoinAndShowChatRoomGroup=function(e,t,n){var o=this.GetChatRoomGroup(t);o&&o.BIsCurrentUserAMember()?ci.UIStore.ShowAndOrActivateChatRoomGroup(e,o,n):this.m_InviteStore.JoinChatGroup(t,null,e)},e.prototype.AddCreatedChatRoomGroup=function(e,t,n,o){if(!this.m_mapChatGroups.has(t)){var i=new Vt(this,t);this.m_mapChatGroups.set(t,i),i.UpdateGroupState(n),i.UpdateUserState(o),this.OnGroupAdded(i),ci.UIStore.ShowAndOrActivateChatRoomGroup(e,i,!0)}},e.prototype.AddKnownChatRoomGroup=function(e,t){var n=e.chat_group_id();if(this.m_mapChatGroups.has(n)){(o=this.m_mapChatGroups.get(n)).SetInitialGroupState(e)}else{var o=new Vt(this,n);this.m_mapChatGroups.set(n,o),o.SetInitialGroupState(e),t&&o.UpdateUserState(t),this.OnGroupAdded(o)}},e.prototype.AddJoinedChatRoomGroup=function(e,t){var n=t.chat_group_id(),o=this.m_mapChatGroups.get(n);return o||(o=new Vt(this,n),this.m_mapChatGroups.set(n,o)),e instanceof pe.b?o.UpdateGroupState(e):o.SetInitialGroupState(e),this.OnGroupAdded(o),o.UpdateUserState(t),o},e.prototype.RemoveChatRoomGroup=function(e){var t=this.m_mapChatGroups.get(e);if(t){var n=this.m_mapChatGroups.get(e);n&&ci.UIStore.CloseTabByID(n.unique_id),this.GetRefCountActiveChatRoomGroup(e)<=0&&t.UnloadAndResetGroupState()}},e.prototype.FindChatRoom_Deprecated=function(n){var o=null;return this.m_mapChatGroups.forEach(function(e){var t=e.GetChatRoom(n);t&&(o=t)}),o},e.prototype.FindChatRoom=function(e,t){var n=this.m_mapChatGroups.get(e);return n?n.GetChatRoom(t):null},Object.defineProperty(e.prototype,"chat_group_list_ready",{get:function(){return this.m_bReceivedChatGroupList},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"FriendStore",{get:function(){return this.m_FriendStore},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"CMInterface",{get:function(){return this.m_CMInterface},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"VoiceChat",{get:function(){return this.m_VoiceChat},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ChatRoomBBCodeParser",{get:function(){return this.m_ChatRoomBBCodeParser},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"FriendChatBBCodeParser",{get:function(){return this.m_FriendChatBBCodeParser},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"NotificationBBCodeParser",{get:function(){return this.m_NotificationBBCodeParser},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"FriendChatStore",{get:function(){return this.m_FriendChatStore},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"EmoticonStore",{get:function(){return this.m_EmoticonStore},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"InviteStore",{get:function(){return this.m_InviteStore},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"GameInviteStore",{get:function(){return this.m_GameInviteStore},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"EmbedStore",{get:function(){return this.m_EmbedStore},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ChatRoomGroupDisplayPrefs",{get:function(){return this.m_ChatRoomGroupDisplayPrefs},enumerable:!0,configurable:!0}),e.prototype.GetActiveVoiceChat=function(){var e=this.m_VoiceChat.GetActiveVoiceChatID();if(""!=e){if(t=this.FindChatRoom_Deprecated(e))return t}else{var t,n=this.m_VoiceChat.GetActiveOneOnOneVoiceChatAccountID();if(0!=n)if(t=this.GetFriendChat(n,!1))return t}},e.prototype.GetActiveVoiceChannelName=function(){var e=this.GetActiveVoiceChat();return null!=e?e.name:""},e.prototype.GetFriendChat=function(e,t){return void 0===t&&(t=!0),e==this.FriendStore.self.accountid?null:this.m_FriendChatStore.GetFriendChat(e,t)},e.prototype.GetChatRoomGroup=function(e){return this.m_mapChatGroups.get(e)},Object.defineProperty(e.prototype,"currentChatRoomGroups",{get:function(){return Xt(this.m_mapChatGroups,function(e){return e.BIsCurrentUserAMember()})},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ClanChatRooms",{get:function(){return Xt(this.m_mapChatGroups,function(e){return e.BIsClanChatRoom()})},enumerable:!0,configurable:!0}),e.prototype.GetRefCountActiveChatRoomGroup=function(e){var t=this.m_mapActiveChatGroupsToRefCount.get(e);return void 0===t&&(t=0),t},e.prototype.IncRefActiveChatRoomGroup=function(e,t){var n=this.m_mapActiveChatGroupsToRefCount.get(e);return void 0===n&&(n=0),n+=1,this.m_mapActiveChatGroupsToRefCount.set(e,n),1==n&&t&&this.SendActiveChatRoomGroupsToServer(),n},e.prototype.DecRefActiveChatRoomGroup=function(e){var t=this.m_mapActiveChatGroupsToRefCount.get(e),n=void 0!==t&&0<t;if(Object(I.a)(n,"Attempting to DecRef a Chat Group that has no existing references. Doing nothing."),!n)return 0;if((t-=1)<=0){this.m_mapActiveChatGroupsToRefCount.delete(e);var o=this.m_mapChatGroups.get(e);o&&o.UnloadActiveGroupState(),this.SendActiveChatRoomGroupsToServer()}else this.m_mapActiveChatGroupsToRefCount.set(e,t);return t},e.prototype.OnRestorePopupsComplete=function(){0<this.m_mapActiveChatGroupsToRefCount.size&&this.SendActiveChatRoomGroupsToServer()},e.prototype.SendActiveChatRoomGroupsToServer=function(){var a=this;if(this.m_bSendingActiveGroups)this.m_bSendActiveGroupsQueued=!0;else{var s=[],o=m.Init(pe.N);this.m_mapActiveChatGroupsToRefCount.forEach(function(e,t){if(Object(I.a)(0<e,"SendActiveChatRoomGroupsToServer found invalid ref count for chat group."),!(e<=0)){o.Body().add_chat_group_ids(t);var n=a.m_mapChatGroups.get(t);n&&n.readyToRender||o.Body().add_chat_groups_data_requested(t),n&&n.BIsClanChatRoom()&&s.push(n.GetClanID())}});var t=void 0,c=function(e){G.a.IN_CLIENT&&SteamClient.WebChat.SetActiveClanChatIDs(s),e&&void 0!==t&&ClearBackgroundTimeout(t),a.m_bSendingActiveGroups=!1,a.m_bSendActiveGroupsQueued&&a.SendActiveChatRoomGroupsToServer()};this.m_bSendActiveGroupsQueued=!1,this.m_bSendingActiveGroups=!0,pe.V.SetSessionActiveChatRoomGroups(this.m_CMInterface.GetServiceTransport(),o).then(function(e){if(1==e.GetEResult()){for(var t=!1,n=0,o=e.Body().chat_states();n<o.length;n++){var i=o[n],r=a.m_mapChatGroups.get(i.header_state().chat_group_id());if(r)try{r.UpdateGroupState(i),r.BIsClanChatRoom()&&-1===s.indexOf(r.GetClanID())&&s.push(r.GetClanID())}catch(e){t=!0,console.error("exception processing group update for group "+r.GetGroupID(),e)}}c(!t)}}),t=SetBackgroundTimeout(function(){a.m_bSendActiveGroupsQueued=!0,c(!0)},1e4)}},e.prototype.CreateChatRoomGroup=function(n,e,t,o){var i=this;void 0===o&&(o={});var r=o.unBroadcastAccountId,a=m.Init(pe.e);a.Body().set_name(e);for(var s=0,c=t;s<c.length;s++){var l=c[s];a.Body().add_steamid_invitees(l)}return r&&a.Body().set_watching_broadcast_accountid(r),pe.V.CreateChatRoomGroup(this.m_CMInterface.GetServiceTransport(),a).then(function(e){var t=e.GetEResult();if(1!=t)throw t;return i.AddCreatedChatRoomGroup(n,e.Body().chat_group_id(),e.Body().state(),e.Body().user_chat_state()),e.Body().chat_group_id()})},e.prototype.LeaveChatRoomGroup=function(e,n){var o=this,t=m.Init(pe.y);return t.Body().set_chat_group_id(n),pe.V.LeaveChatRoomGroup(this.m_CMInterface.GetServiceTransport(),t).then(function(e){var t=e.GetEResult();if(1!=t)throw t;o.RemoveChatRoomGroup(n)})},e.prototype.FindNamelessChatGroupWithFriends=function(e){if(0==e.length)return null;for(var t=e.map(function(e){return new D.a(e).GetAccountID()}),n=0,o=Array.from(this.m_mapChatGroups.values());n<o.length;n++){var i=o[n];if(!i.IsNamedGroupChat()&&i.BRoomContainsJustTheseFriendsAndSelf(t))return i}return null},e.prototype.FillInChatUsabilityMetrics=function(e){e.metrics().set_group_chat_count(M.b(Array.from(this.m_mapChatGroups.values()),function(e){return e.BIsCurrentUserAMember()})),this.m_ChatRoomGroupDisplayPrefs.FillInChatUsabilityMetrics(e)},e.prototype.GetChatsWithUnreadPriorityMessages=function(){for(var n=[],e=0,t=this.FriendChatStore.GetFriendsWithUnreadMessages(null);e<t.length;e++){var o=t[e];o.has_unread_priority_messages&&n.push(o)}var i=this;return this.m_mapActiveChatGroupsToRefCount.forEach(function(e,t){i.m_mapChatGroups.get(t).GetChatRoomsWithUnreadPriorityMessages(n)}),n},e.prototype.GetChatToActivateForOldestUnread=function(t){var r=this,a=null,s=function(e){return!(!e.has_unread_priority_messages&&0==e.GetVisibilityState(t))&&(!a||!(a.has_unread_priority_messages&&!e.has_unread_priority_messages)&&(!(a.has_unread_priority_messages||!e.has_unread_priority_messages)||(a.m_msTimeActivated<e.m_msTimeActivated||!(a.m_msTimeActivated>e.m_msTimeActivated)&&a.time_last_message<e.time_last_message)))};this.m_mapActiveChatGroupsToRefCount.forEach(function(e,t){for(var n=0,o=r.m_mapChatGroups.get(t).chatRoomList;n<o.length;n++){var i=o[n];s(i)&&(a=i)}});for(var e=0,n=this.m_FriendChatStore.GetAllChats();e<n.length;e++){var o=n[e];s(o)&&(a=o)}return a},R.c([d.observable],e.prototype,"m_bReceivedChatGroupList",void 0),R.c([ti],e.prototype,"JoinAndShowChatRoomGroup",null),R.c([d.action],e.prototype,"AddCreatedChatRoomGroup",null),R.c([d.action],e.prototype,"AddKnownChatRoomGroup",null),R.c([d.action],e.prototype,"AddJoinedChatRoomGroup",null),R.c([d.action],e.prototype,"RemoveChatRoomGroup",null),R.c([d.computed],e.prototype,"currentChatRoomGroups",null),R.c([d.computed],e.prototype,"ClanChatRooms",null),e}(),nn=function(o){function e(e,t){var n=o.call(this)||this;return n.m_rgOnChatFrameChangedCallbacks=[],n.m_bScrolledToBottom=!0,n.m_scrollTop=-1,n.m_scrollHeight=-1,n.m_clientHeight=1,n.m_textEntryFocusCallbacks=new N,n.m_tabset=e,n.m_chat=t,n.m_tabset&&n.m_chat.AddChatView(n),n.m_strTextEntry="",n.m_fileUploadManager=new en(t),n}return R.d(e,o),e.prototype.GetTabName=function(){return this.m_chat.name},e.prototype.GetUniqueID=function(){return this.m_chat.unique_id},e.prototype.OnTabFocus=function(){this.OnFocus()},e.prototype.InternalOnTabActivate=function(){this.OnActivate()},e.prototype.OnTabDeactivate=function(){this.OnDeactivate()},e.prototype.OnTabClosed=function(){this.OnViewClosed()},e.prototype.IsChatRoom=function(){return this.m_chat instanceof kt},e.prototype.IsFriendChat=function(){return this.m_chat instanceof Jt},e.prototype.IsVoiceActive=function(){return this.m_chat.BVoiceActive()},e.prototype.GetUnreadMessageCount=function(){return this.m_chat.unread_message_count},e.prototype.IsTabForChat=function(e){return this.m_chat==e},e.prototype.GetChatView=function(){return this},e.prototype.OnViewClosed=function(){this.m_chat.RemoveChatView(this)},Object.defineProperty(e.prototype,"chat",{get:function(){return this.m_chat},enumerable:!0,configurable:!0}),e.prototype.BIsInBrowserContext=function(e){var t=this.m_tabset.GetBrowserContext();return e.m_nBrowserID==t.m_nBrowserID&&e.m_unPID==t.m_unPID},e.prototype.GetVisibilityState=function(){if(!this.m_tabset||!this.m_tabset.is_popup_active&&!G.a.IN_MOBILE)return 0;var e=void 0;return this.m_tabset.activeTab&&(e=this.m_tabset.activeTab.GetChatView()),e!=this||!this.m_tabset.is_popup_visible&&!G.a.IN_MOBILE?1:this.m_tabset.is_popup_focused||G.a.IN_MOBILE?this.m_bScrolledToBottom&&!ci.IdleTracker.BIsUserIdle(60)?4:3:2},Object.defineProperty(e.prototype,"lastScrollHeight",{get:function(){return this.m_scrollHeight},set:function(e){this.m_scrollHeight=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"lastScrollTop",{get:function(){return this.m_scrollTop},set:function(e){this.m_scrollTop=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"lastClientHeight",{get:function(){return this.m_clientHeight},set:function(e){this.m_clientHeight=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"is_scrolled_to_bottom",{get:function(){return this.m_bScrolledToBottom},set:function(e){!this.m_bScrolledToBottom&&e&&this.m_chat.OnActivate(),this.m_bScrolledToBottom=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"text_entry",{get:function(){return this.m_strTextEntry},set:function(e){this.m_strTextEntry=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"file_upload_manager",{get:function(){return this.m_fileUploadManager},enumerable:!0,configurable:!0}),e.prototype.CheckActivationAndNotifyChat=function(){this.m_bScrolledToBottom&&this.m_chat.OnActivate()},e.prototype.OnActivate=function(){this.CheckActivationAndNotifyChat(),this.FocusTextInput(),this.m_chat.m_msTimeActivated=Date.now()},e.prototype.OnDeactivate=function(){this.m_chat.OnDeactivate()},e.prototype.OnFocus=function(){this.CheckActivationAndNotifyChat()},e.prototype.FocusTextInput=function(){this.m_textEntryFocusCallbacks.Dispatch()},e.prototype.AddOnChatFrameChangedCallback=function(e){this.m_rgOnChatFrameChangedCallbacks.push(e)},e.prototype.RemoveOnChatFrameChangedCallback=function(e){M.d(this.m_rgOnChatFrameChangedCallbacks,e)},e.prototype.OnChatFrameChanged=function(){for(var e=0,t=this.m_rgOnChatFrameChangedCallbacks;e<t.length;e++){(0,t[e])()}},e.prototype.SetFileToUpload=function(e){this.m_fileUploadManager.SetImageFileToUpload(e)},e.prototype.UploadFile=function(e){this.m_fileUploadManager.BeginFileUpload({bSpoiler:e})},e.prototype.RegisterForTextEntryFocus=function(e){return this.m_textEntryFocusCallbacks.Register(e)},e.prototype.BVoiceActive=function(){return this.m_chat.BVoiceActive()},R.c([d.observable],e.prototype,"m_bScrolledToBottom",void 0),e}(ue),on=function(){function e(){this.enabled=!1,this.locked=!1,this.features=0,this.allowallapps=!1,this.baselist=void 0,this.customlist=void 0}return R.c([d.observable],e.prototype,"enabled",void 0),R.c([d.observable],e.prototype,"locked",void 0),R.c([d.observable],e.prototype,"features",void 0),R.c([d.observable],e.prototype,"allowallapps",void 0),R.c([d.observable],e.prototype,"baselist",void 0),R.c([d.observable],e.prototype,"customlist",void 0),e}(),rn=function(){return function(){this.broadcastid="0",this.nViewers=0,this.nRequests=0,this.bIsBroadcasting=!1,this.bIsRecordingDesktop=!1,this.bBroadcastCapable=!1}}(),an=function(){return function(){this.nKeyCode=0,this.bAltKey=!1,this.bShiftKey=!1,this.bCtrlKey=!1,this.bMetaKey=!1}}(),sn=function(){return function(){this.InGameOverlayScreenshotHotKey=new an,this.InGameOverlayShortcutKey=new an}}();Qt=sn||(sn={}),Zt=function(){return function(){}}(),Qt.FriendsSettings=Zt,Qt.DefaultFriendsSettings=function(){return{bNotifications_ShowIngame:!0,bNotifications_ShowOnline:!1,bNotifications_ShowMessage:!0,bNotifications_EventsAndAnnouncements:!0,bSounds_PlayIngame:!1,bSounds_PlayOnline:!1,bSounds_PlayMessage:!0,bSounds_EventsAndAnnouncements:!1,bAlwaysNewChatWindow:!1,bForceAlphabeticFriendSorting:!1,nChatFlashMode:0,bRememberOpenChats:!0,bCompactQuickAccess:!1,bCompactFriendsList:!1,bNotifications_ShowChatRoomNotification:!0,bSounds_PlayChatRoomNotification:!0,bHideOfflineFriendsInTagGroups:!1,bHideCategorizedFriends:!1,bCategorizeInGameFriendsByGame:!0,nChatFontSize:2,b24HourClock:!1,bDoNotDisturbMode:!1,bDisableEmbedInlining:!1,bSignIntoFriends:!0,featuresEnabled:{}}};var cn,ln,pn,un;(ln=cn||(cn={}))[ln.k_EClientUINotificationGroupChatMessage=1]="k_EClientUINotificationGroupChatMessage",ln[ln.k_EClientUINotificationFriendChatMessage=2]="k_EClientUINotificationFriendChatMessage",ln[ln.k_EClientUINotificationFriendPersonaState=3]="k_EClientUINotificationFriendPersonaState",(un=pn||(pn={}))[un.k_EComputerActiveStateInvalid=0]="k_EComputerActiveStateInvalid",un[un.k_EComputerActiveStateActive=1]="k_EComputerActiveStateActive",un[un.k_EComputerActiveStateIdle=2]="k_EComputerActiveStateIdle";var mn,dn,hn=function(){return function(){}}();(dn=mn||(mn={}))[dn.k_EPending=0]="k_EPending",dn[dn.k_EAccepted=1]="k_EAccepted",dn[dn.k_ERejected=2]="k_ERejected";var _n=n("/7KC");function fn(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t]}function gn(e){var t=Math.floor(e/3600),n=Math.floor(e/60)%60,o=Math.floor(e)%60,i=o.toString();o<10&&(i="0"+i);var r=n.toString();return n<10&&0<t&&(r="0"+r),(0<t?t+":":"")+r+":"+i}function bn(e,t){var n=e.getElementsByTagName("MPD");return n&&1==n.length?n[0]:null}function vn(e,t){for(var n=0;n<e.children.length;n++){var o=e.children[n];if(o.tagName==t)return o}return null}function Sn(e,t){var n=e.getAttribute(t);if(!n)return null;var o=new Date(n);return"[object Date]"===Object.prototype.toString.call(o)?o:null}function yn(e,t){var n=e.getAttribute(t);if(!n)return null;var o=0,i=n.match(/(\d*)H/);return i&&(o+=60*parseFloat(i[1])*60),(i=n.match(/(\d*)M/))&&(o+=60*parseFloat(i[1])),(i=n.match(/(\d*\.?\d*)S/))&&(o+=parseFloat(i[1])),o}function Cn(e,t){var n=e.getAttribute(t);return n?parseInt(n):null}function In(e,t){var n=e.getAttribute(t);return n||""}function En(e,t,n){return e=(e=e.replace("$RepresentationID$",t)).replace("$Number$",n.toString())}function On(e){return 0==e.rgRoles.length||0<=e.rgRoles.findIndex(function(e){return"main"==e})}function wn(e){return e?e.segmentTemplate.nDuration/e.segmentTemplate.nTimeScale*1e3:0}function Mn(e,t){var n=wn(e);return Math.floor(t/n)+1}var Dn,Tn,Gn=function(){function e(){this.m_nMinBufferTime=0,this.m_bHasProtectedRepresentations=!1,this.m_dtAvailabilityStartTime=null,this.m_dtPublishTime=null,this.m_nMinimumUpdatePeriod=0,this.m_nTimeShiftBufferDepth=0,this.m_dtMediaPresentationDuration=null,this.m_strBaseURL="",this.m_strStatsLink="",this.m_strStalledLink="",this.m_strEventLogLink="",this.m_rgPeriods=null,this.m_tsLiveContentStart=0}return e.prototype.GetType=function(){return this.m_strType},e.prototype.GetMinimumUpdatePeriod=function(){return this.m_nMinimumUpdatePeriod},e.prototype.GetAvailabilityStartTime=function(){return this.m_dtAvailabilityStartTime},e.prototype.GetPeriods=function(){return this.m_rgPeriods},e.prototype.GetBaseURL=function(){return this.m_strBaseURL},e.prototype.GetLiveContentStart=function(){return this.m_tsLiveContentStart},e.prototype.GetTimeShiftBufferDepth=function(){return this.m_nTimeShiftBufferDepth},e.prototype.GetMinBufferTime=function(){return this.m_nMinBufferTime},e.prototype.GetAdaptationByTrackID=function(e){if(!this.m_rgPeriods||0==this.m_rgPeriods.length)return null;for(var t=0,n=this.m_rgPeriods[0].rgAdaptationSets;t<n.length;t++){var o=n[t];if(e==o.strID)return o}return null},e.prototype.GetVideoAdaption=function(){for(var e=0,t=this.m_rgPeriods[0].rgAdaptationSets;e<t.length;e++){var n=t[e];if(n.bContainsVideo)return n}return null},e.prototype.GetPeriodDuration=function(e){return e<this.m_rgPeriods.length&&this.m_rgPeriods[e].nDuration?this.m_rgPeriods[e].nDuration:0},e.prototype.GetLowestRepresentation=function(e){var t=this.GetAdaptationByTrackID(e);if(!t)return null;for(var n=t.rgRepresentations[0],o=0,i=t.rgRepresentations;o<i.length;o++){var r=i[o];r.nBandwidth<n.nBandwidth&&(n=r)}return n},e.prototype.GetStatsLink=function(){return this.m_strStatsLink},e.prototype.GetStalledLink=function(){return this.m_strStalledLink},e.prototype.GetEventLink=function(){return this.m_strEventLogLink},e.prototype.SetLiveContentStart=function(e){this.m_tsLiveContentStart=e},e.prototype.ParseRepresentation=function(e,t){var n=t,o={strID:In(e,"id"),strMimeType:In(e,"mimeType"),strCodecs:In(e,"codecs"),nBandwidth:Cn(e,"bandwidth")};if(n.bContainsVideo){if(o.nWidth=Cn(e,"width"),o.nHeight=Cn(e,"height"),o.nFrameRate=Cn(e,"frameRate"),!(o.strID&&o.strMimeType&&o.strCodecs&&o.nBandwidth))return fn("MPD - Representation Video Data Missing"),null}else if(n.bContainsAudio){o.nAudioSamplingRate=Cn(e,"audioSamplingRate");var i=vn(e,"AudioChannelConfiguration");if(i&&(o.nAudioChannels=Cn(i,"value")),o.nAudioChannels||(o.nAudioChannels=2),!(o.strID&&o.strMimeType&&o.strCodecs&&o.nBandwidth&&o.nAudioSamplingRate&&o.nAudioChannels))return fn("MPD - Representation Audio Data Missing"),null}return o},e.prototype.BParse=function(e){var t=(new DOMParser).parseFromString(e,"application/xml"),n=bn(t);if(!n)return!1;var o=n.getAttribute("type");if(this.m_nMinBufferTime=yn(n,"minBufferTime"),this.m_bHasProtectedRepresentations=!1,"dynamic"==o){if(this.m_strType="dynamic",this.m_dtAvailabilityStartTime=Sn(n,"availabilityStartTime"),this.m_dtPublishTime=Sn(n,"publishTime"),this.m_nMinimumUpdatePeriod=yn(n,"minimumUpdatePeriod"),this.m_nTimeShiftBufferDepth=yn(n,"timeShiftBufferDepth"),!(this.m_dtAvailabilityStartTime&&this.m_dtPublishTime&&this.m_nMinimumUpdatePeriod&&this.m_nMinBufferTime&&this.m_nTimeShiftBufferDepth))return!1}else{if("static"!=o)return fn("MPD - Unknown type"),!1;if(this.m_strType="static",this.m_dtMediaPresentationDuration=Sn(n,"mediaPresentationDuration"),!this.m_nMinBufferTime||!this.m_dtMediaPresentationDuration)return fn("MPD - Missing Buffer Time or Presentation Duration"),!1}var i=vn(n,"BASEURL");i&&(this.m_strBaseURL=i.textContent);var r=vn(n,"Analytics");r&&(this.m_strStatsLink=In(r,"statslink"),this.m_strStalledLink=In(r,"stalledlink"),this.m_strEventLogLink=In(r,"eventlink"));var a=t.getElementsByTagName("Period");if(0==a.length)return!1;var s=a[0],c={strID:In(s,"id"),nStart:yn(s,"start"),nDuration:yn(s,"duration"),rgAdaptationSets:[]};if(!c.strID||null===c.nStart)return fn("MPD - Missing Period Information."),!1;this.m_rgPeriods=[],this.m_rgPeriods.push(c);for(var l,p,u,m=s.getElementsByTagName("AdaptationSet"),d=0;d<m.length;d++){var h=m[d],_=In(h,"description"),f=In(h,"lang"),g={bSegmentAlignment:(l=h,p="segmentAlignment",u=void 0,u=l.getAttribute(p),u?"true"==(u=u.toLowerCase())||"false"!=u&&null:null),bIsClosedCaption:"text/vtt"==In(h,"mimeType"),strLanguage:In(h,"lang"),bContainsVideo:!1,bContainsAudio:!1,bContainsGame:!1,strDescription:_||f,strForceSub:In(h,"forceSub"),strID:In(h,"id"),rgRoles:[],rgRepresentations:[],thumbnails:null,segmentTemplate:null};if(c.rgAdaptationSets.push(g),g.bIsClosedCaption){g.rgRoles.push("subtitle");for(var b=h.getElementsByTagName("Role"),v=0;v<b.length;v++){(N=In(b[v],"value"))&&g.rgRoles.push(N)}for(var S=h.getElementsByTagName("Representation"),y=0;y<S.length;y++){var C={strID:In(B=S[y],"id"),nBandwidth:Cn(B,"bandwidth"),strClosedCaptionFile:""},I=vn(B,"BaseURL"),E=I?I.textContent:"";if(!E)return fn("Closed Caption File has no BaseURL for (id): "+C.strID),!1;C.strClosedCaptionFile=this.m_strBaseURL+En(E,C.strID,0),g.rgRepresentations.push(C)}}else{if(!g.bSegmentAlignment)return fn("MPD - Segment Alignment Missing"),!1;for(var O=h.getElementsByTagName("ContentComponent"),w=0;w<O.length;w++){var M=In(O[w],"contentType");"video"==M&&(g.bContainsVideo=!0),"audio"==M&&(g.bContainsAudio=!0),"game"==M&&(g.bContainsGame=!0)}if(g.bContainsVideo){var D=vn(h,"Thumbnails");if(D){var T=Cn(D,"sheet"),G=Cn(D,"period");g.thumbnails={nPeriod:G,strTemplate:In(D,"template"),nSheet:T,nSheetSeconds:T*G}}}var R=h.getElementsByTagName("Role");for(w=0;w<R.length;w++){var N;(N=In(R[w],"value"))&&g.rgRoles.push(N)}var L=h.getElementsByTagName("SegmentTemplate");if(0==L.length)return fn("MPD - Segment Template Missing"),!1;var k=L[0];g.segmentTemplate={nTimeScale:Cn(k,"timescale"),nDuration:Cn(k,"duration"),nStartNumber:Cn(k,"startNumber"),strMedia:In(k,"media"),strInitialization:""};var P=g.segmentTemplate;if(g.bContainsGame?P.strInitialization=P.strMedia:P.strInitialization=In(k,"initialization"),!(P.nTimeScale&&P.nDuration&&P.nStartNumber&&P.strMedia&&P.strInitialization))return fn("MPD - Segment Template Data Missing"),!1;var A=h.getElementsByTagName("Representation");for(w=0;w<A.length;w++){var B=A[w];if(!(C=this.ParseRepresentation(B,g)))return!1;g.rgRepresentations.push(C)}}}return!0},e.prototype.BUpdate=function(e){var t=(new DOMParser).parseFromString(e,"application/xml"),n=bn(t);if(!n)return!1;if("dynamic"==this.m_strType){var o=t.getElementsByTagName("Period");if(0==o.length)return!1;for(var i=o[0].getElementsByTagName("AdaptationSet"),r=0;r<i.length;r++){var a=i[r],s=In(a,"id"),c=this.GetAdaptationByTrackID(s);if(c){var l=a.getElementsByTagName("Representation");if(1<l.length)for(var p=0;p<l.length;p++){for(var u=l[p],m=this.ParseRepresentation(u,c),d=!0,h=0,_=c.rgRepresentations;h<_.length;h++){var f=_[h];if(m.strID==f.strID){d=!1;break}}d&&c.rgRepresentations.push(m)}break}}}var g=vn(n,"Analytics");return g&&(this.m_strStatsLink=In(g,"statslink"),this.m_strStalledLink=In(g,"stalledlink"),this.m_strEventLogLink=In(g,"eventlink")),!0},e}();(Tn=Dn||(Dn={}))[Tn.None=0]="None",Tn[Tn.Append=1]="Append",Tn[Tn.Remove=2]="Remove";var Rn=function(){function e(e,t,n,o){this.m_callbacks=null,this.m_mpd=null,this.m_adaptation=null,this.m_mediaSource=null,this.m_sourceBuffer=null,this.m_nTrackBufferMS=0,this.m_representation=null,this.m_eBufferUpdate=Dn.None,this.m_rgBufferedSegments=[],this.m_bNeedInitSegment=!0,this.m_nNextSegment=0,this.m_bRemoveBufferState=!1,this.m_bSeekInProgress=!1,this.m_tsLastBufferRemove=0,this.m_schNextDownload=new L,this.m_xhrDownload=null,this.m_listeners=new k,this.m_rgDownloadLog=[],this.m_nCurDownloadProgress=0,this.m_nCurDownloadBitrate=0,this.m_nNumConsecutiveDownloadGones=0,this.m_statsGameData=null,this.m_callbacks=e,this.m_mpd=t,this.m_adaptation=n,this.m_stats=o}return e.prototype.SetMediaSource=function(e){this.m_mediaSource=e},e.prototype.SetBufferMS=function(e){this.m_nTrackBufferMS=e},e.prototype.GetRepresentationsCount=function(){return this.m_adaptation.rgRepresentations.length},e.prototype.GetRepresentationByID=function(e){for(var t=0,n=this.m_adaptation.rgRepresentations;t<n.length;t++){var o=n[t];if(o.strID==e)return o}return null},e.prototype.GetNumConsecutiveDownloadGones=function(){return this.m_nNumConsecutiveDownloadGones},e.prototype.ContainsVideo=function(){return this.m_adaptation.bContainsVideo},e.prototype.ContainsAudio=function(){return this.m_adaptation.bContainsAudio},e.prototype.ContainsGame=function(){return this.m_adaptation.bContainsGame},e.prototype.GetAdaptation=function(){return this.m_adaptation},e.prototype.GetBandwidthRequired=function(){return this.m_representation.nBandwidth},e.prototype.BIsCurrentRepresentation=function(e){return e&&e.strID==this.m_representation.strID},e.prototype.GetSourceBufferTimeRanges=function(){return this.m_sourceBuffer.buffered},e.prototype.GetEstimatedAudioRate=function(){return this.m_representation&&this.ContainsAudio()?this.m_representation.nBandwidth:0},e.prototype.GetDebugName=function(){var e=[];return this.ContainsVideo()?e.push("Video"):this.ContainsAudio()?e.push("Audio"):this.ContainsGame()&&e.push("Game"),e.join(" & ")},e.prototype.GetMaxSegment=function(){var e=this.m_mpd.GetPeriodDuration(0);return e?Mn(this.m_adaptation,1e3*e):Number.MAX_VALUE},e.prototype.GetAmountBufferedInPlayerMS=function(e){if(!this.m_sourceBuffer)return 0;var t=this.m_sourceBuffer.buffered;if(0==t.length)return 0;e<t.start(0)&&(e=t.start(0)),e>t.end(0)&&(e=t.end(0));var n=t.end(0)-e;return Math.floor(1e3*n)},e.prototype.GetAmountBufferedMS=function(e){for(var t=this.GetAmountBufferedInPlayerMS(e),n=0,o=this.m_rgBufferedSegments;n<o.length;n++){t+=o[n].nDurationMS}return t},e.prototype.ChangeRepresentation=function(e){if(this.m_adaptation.rgRepresentations.indexOf(e)<0)return null;if(this.m_representation==e)return null;if(this.ContainsVideo()&&fn(this.GetDebugName()+" changing representation to "+(e.nHeight||0)+"p at "+Math.ceil(e.nBandwidth/1e3)+"KB for segment "+this.m_nNextSegment),this.m_representation=e,this.m_bNeedInitSegment=!this.ContainsGame(),this.m_stats.SetRepresentation(e),this.ContainsGame())return e;if(!this.m_sourceBuffer){var t=e.strMimeType+";codecs="+e.strCodecs;this.m_sourceBuffer=this.m_mediaSource.addSourceBuffer(t),fn(t),this.m_listeners.AddEventListener(this.m_sourceBuffer,"updateend",this.OnSourceBufferUpdateEnd),this.m_listeners.AddEventListener(this.m_sourceBuffer,"error",this.OnSourceBufferError),this.m_listeners.AddEventListener(this.m_sourceBuffer,"abort",this.OnSourceBufferAbort)}return e},e.prototype.Close=function(){this.m_listeners.Unregister(),this.m_sourceBuffer=null,this.ForceStopDownloads(),this.m_eBufferUpdate=Dn.None,this.m_bRemoveBufferState=!1,this.m_callbacks=null,this.m_mpd=null,this.m_adaptation=null,this.m_mediaSource=null,this.m_nTrackBufferMS=0,this.m_representation=null,this.m_rgBufferedSegments=[],this.m_bNeedInitSegment=!0,this.m_nNextSegment=0,this.m_bSeekInProgress=!1,this.m_tsLastBufferRemove=0,this.m_rgDownloadLog=[],this.m_stats=null,this.m_rgGameDataFrames=[],this.m_statsGameData=null},e.prototype.GetActiveDownloads=function(){return this.m_xhrDownload?1:0},e.prototype.GetActiveDownloadProgress=function(){return this.GetActiveDownloads()?this.m_nCurDownloadProgress:0},e.prototype.OnSourceBufferUpdateEnd=function(e){var t=this.m_callbacks.GetCurrentPlayTime(),n=this.GetAmountBufferedInPlayerMS(t);fn(this.GetDebugName()+" OnSourceBufferUpdateEnd: [playback="+t+"][buffered="+n+"][start="+this.GetBufferedStart()+"][end="+this.GetBufferedEnd()+"]");var o=this.m_eBufferUpdate;this.m_eBufferUpdate=Dn.None,o==Dn.Append&&this.m_callbacks.OnSegmentDownloaded(this),this.m_bSeekInProgress&&o==Dn.Remove&&!this.m_bRemoveBufferState&&this.ContinueSeek(),this.UpdateBuffer()},e.prototype.OnSourceBufferError=function(e){console.log("OnSourceBufferError")},e.prototype.OnSourceBufferAbort=function(e){console.log("OnSourceBufferAbort")},e.prototype.ScheduleNextDownload=function(){if(this.m_bNeedInitSegment)this.DownloadNextSegment();else if(this.m_schNextDownload.Cancel(),this.m_xhrDownload)fn(this.GetDebugName()+" ScheduleNextDownload - download already going");else if(this.m_bSeekInProgress)fn(this.GetDebugName()+" ScheduleNextDownload - seeking");else{var e=this.m_callbacks.GetCurrentPlayTime(),t=this.m_callbacks.GetPlaybackRate(),n=function(e,t,n){if("dynamic"!=e.GetType())return 0;var o=wn(t);return(n-t.segmentTemplate.nStartNumber)*o-(performance.now()-e.GetLiveContentStart())}(this.m_mpd,this.m_adaptation,this.m_nNextSegment);if(0<n)return fn(this.GetDebugName()+" ScheduleNextDownload - segment in future"),void this.m_schNextDownload.Schedule(n,this.ScheduleNextDownload);var o=this.GetAmountBufferedMS(e);if(1<t&&(o/=t),o<4e4)return fn(this.GetDebugName()+" ScheduleNextDownload - download now"),void this.DownloadNextSegment();var i=1.1*wn(this.m_adaptation),r=this.GetAmountBufferedInPlayerMS(this.m_callbacks.GetCurrentPlayTime());fn(this.GetDebugName()+" ScheduleNextDownload - buffered, schedule later [sleep="+i+"ms][buffer="+r+"]"),this.m_schNextDownload.Schedule(i,this.ScheduleNextDownload)}},e.prototype.DownloadNextSegment=function(){this.m_schNextDownload.Cancel();var e,t,n,o,i,r,a,s="",c=0;this.m_bNeedInitSegment?(this.m_bNeedInitSegment=!1,i=this.m_mpd.GetBaseURL(),r=this.m_adaptation,a=this.m_representation,s=En(i+r.segmentTemplate.strInitialization,a.strID,0),c=0):(e=this.m_mpd.GetBaseURL(),t=this.m_adaptation,n=this.m_representation,o=this.m_nNextSegment,s=En(e+t.segmentTemplate.strMedia,n.strID,o),c=wn(this.m_adaptation),this.m_nNextSegment++),this.DownloadSegment(this.m_representation.strID,s,c)},e.prototype.DownloadSegment=function(g,b,v,S){return void 0===S&&(S=performance.now()),R.b(this,void 0,void 0,function(){var t,n,o,i,r,a,s,c,l,p,u,m,d,h,_,f=this;return R.e(this,function(e){switch(e.label){case 0:Object(I.a)(null===this.m_xhrDownload,"Trying to download another segment while a download is already in flight"),this.m_schNextDownload.Cancel(),fn("Downloading: "+b),t=null,n=performance.now(),o=C.a.CancelToken.source(),e.label=1;case 1:return e.trys.push([1,3,,4]),this.m_nCurDownloadProgress=0,this.m_xhrDownload=o,i={cancelToken:this.m_xhrDownload.token,timeout:15e3,responseType:"arraybuffer",onDownloadProgress:function(e){f.m_nCurDownloadProgress=e.loaded/e.total,f.m_nCurDownloadBitrate=8*e.loaded*1e3/Math.max(1,performance.now()-n)}},this.ContainsGame()&&(i.responseType="json"),[4,C.a.get(b,i)];case 2:return t=e.sent(),[3,4];case 3:return fn("Failed to download segment: "+(r=e.sent())),t=r.response,[3,4];case 4:if(!this.m_xhrDownload||this.m_xhrDownload!=o)return[2];if(a=performance.now(),s=Math.floor(performance.now()-n),c=t?t.status:0,this.m_xhrDownload=null,this.m_bSeekInProgress)return this.ContinueSeek(),[2];if(!t||200!=t.status)return this.ContainsGame()?(this.ScheduleNextDownload(),[2]):(this.m_stats.LogSegmentDownloadFailure(s,t?t.status:444),9e3<a-S?(fn(this.GetDebugName()+" HTTP download failed.. stopping loader: "+(a-S)+"ms"),this.DownloadFailed()):410==c?(this.m_nNumConsecutiveDownloadGones+=1,fn(this.GetDebugName()+" HTTP download gone.. informing the player: "+(a-S)+"ms"),this.DownloadGone()):this.m_schNextDownload.Schedule(500,function(){return f.DownloadSegment(g,b,v,S)}),[2]);if(this.m_nNumConsecutiveDownloadGones=0,this.ContainsGame()){for(u=t.data,this.m_rgGameDataFrames||(this.m_rgGameDataFrames=[]),m=Number.MIN_VALUE,this.m_rgGameDataFrames.length&&(m=this.m_rgGameDataFrames[this.m_rgGameDataFrames.length-1].pts),d=0,h=u.frames;d<h.length;d++)(_=h[d]).pts&&_.gamedata?_.pts<=m?fn("Invalide game pts"):(this.m_rgGameDataFrames.push(_),m=_.pts):fn("Invalide game data");this.TrimGameDataIfNecessary(),this.m_statsGameData={nAppID:u.appid,ulBroadcastRelayID:u.broadcastrelayid,nSegmentID:u.segmentid}}else l=new Uint8Array(t.data),this.m_rgBufferedSegments.push({nDurationMS:v,data:l,representationStrID:g}),this.LogDownload(n,l.length),this.UpdateBuffer(),p=l.length/1e3,fn("HTTP "+c+" ("+s+"ms, "+Math.floor(p)+"k): "+b);return this.ScheduleNextDownload(),[2]}})})},e.prototype.DownloadFailed=function(){this.m_callbacks.OnSegmentDownloadFailed(this)},e.prototype.DownloadGone=function(){this.m_callbacks.OnSegmentDownloadGone(this)},e.prototype.TrimGameDataIfNecessary=function(){var e={pts:1e3*(this.m_callbacks.GetCurrentPlayTime()-40),gamedata:null},t=M.h(this.m_rgGameDataFrames,e,function(e,t){return e.pts-t.pts});0<=t&&(this.m_rgGameDataFrames=this.m_rgGameDataFrames.slice(t+1))},e.prototype.UpdateBuffer=function(){if(this.m_eBufferUpdate==Dn.None)if(this.m_bRemoveBufferState)this.RemoveAllBuffers();else if(this.m_sourceBuffer)if(0<this.m_rgBufferedSegments.length)try{this.m_eBufferUpdate=Dn.Append;var e=this.m_rgBufferedSegments[0];this.m_sourceBuffer.appendBuffer(e.data),this.m_rgBufferedSegments.splice(0,1)}catch(e){"QuotaExceededError"===e.name?(this.m_eBufferUpdate=Dn.None,fn(this.GetDebugName()+" Buffer - QuotaExceededError")):fn(this.GetDebugName()+" Buffer - Exception",e)}else{var t=performance.now();if(!this.m_bSeekInProgress&&1e4<t-this.m_tsLastBufferRemove){var n=this.GetBufferedStart(),o=this.m_callbacks.GetCurrentPlayTime()-40;if(n<o){var i=Math.min(this.GetBufferedEnd(),o);return void(i!=n&&(this.m_eBufferUpdate=Dn.Remove,this.m_sourceBuffer.remove(n,i),this.m_tsLastBufferRemove=t))}}}else fn("No source buffer?")},e.prototype.RemoveAllBuffers=function(){this.m_rgBufferedSegments=[];var e=0;if(this.m_sourceBuffer)for(var t=this.m_sourceBuffer.buffered,n=0;n<t.length;n++)e<t.end(n)&&(e=t.end(n));this.m_bRemoveBufferState=!1,this.m_eBufferUpdate=Dn.Remove,0!=e?this.m_sourceBuffer.remove(0,e+1):this.OnSourceBufferUpdateEnd(null)},e.prototype.GetBufferedStart=function(){return this.m_sourceBuffer&&0!=this.m_sourceBuffer.buffered.length?this.m_sourceBuffer.buffered.start(0):0},e.prototype.GetBufferedEnd=function(){return this.m_sourceBuffer&&0!=this.m_sourceBuffer.buffered.length?this.m_sourceBuffer.buffered.end(0):0},e.prototype.ForceStopDownloads=function(){this.m_schNextDownload.Cancel(),this.m_xhrDownload&&(this.m_xhrDownload.cancel(),this.m_xhrDownload=null)},e.prototype.ForceRestartDownload=function(){this.ForceStopDownloads(),this.ScheduleNextDownload()},e.prototype.Seek=function(e){var t=this.GetBufferedStart(),n=this.GetBufferedEnd(),o=e<t||n<e;if(0==t&&0==n&&(o=!0),fn(this.GetDebugName()+" making an "+(o?"unbuffered":"buffered")+" seek to "+e),this.m_bSeekInProgress||o||this.m_bNeedInitSegment){this.m_bSeekInProgress=!0,this.ForceStopDownloads();var i=Mn(this.m_adaptation,1e3*e);if(this.m_nNextSegment=Object(_n.a)(i,this.m_adaptation.segmentTemplate.nStartNumber,this.GetMaxSegment()-1),fn("Seek To Next Segment: "+this.m_nNextSegment+" at approx. "+gn((this.m_nNextSegment-1)*wn(this.m_adaptation)/1e3)+" seconds."),this.ContainsGame())return this.m_bSeekInProgress=!1,this.m_rgGameDataFrames=[],void this.ScheduleNextDownload();this.m_bRemoveBufferState=!0,this.UpdateBuffer()}else this.ScheduleNextDownload()},e.prototype.ContinueSeek=function(){this.m_bSeekInProgress&&(this.m_eBufferUpdate==Dn.Remove||this.m_bRemoveBufferState||(this.m_bSeekInProgress=!1,this.ScheduleNextDownload()))},e.prototype.BHasEnoughBuffered=function(e){return!this.m_bSeekInProgress&&(!!this.ContainsGame()||(this.GetAmountBufferedInPlayerMS(e)>=this.m_nTrackBufferMS||this.m_nNextSegment>this.GetMaxSegment()))},e.prototype.LogDownload=function(e,t){4<=this.m_rgDownloadLog.length&&this.m_rgDownloadLog.shift();var n=performance.now()-e;n<=0||(this.m_rgDownloadLog.push({cubData:t,nDownloadMS:n}),this.m_stats.LogDownload(t,n))},e.prototype.GetDownloadHistory=function(){return this.m_rgDownloadLog},e.prototype.GetAvgDownloadRate=function(){for(var e=0,t=0,n=0,o=this.m_rgDownloadLog;n<o.length;n++){var i=o[n];e+=i.nDownloadMS,t+=i.cubData}return e<=0?this.m_nCurDownloadBitrate&&0<this.GetActiveDownloads()?this.m_nCurDownloadBitrate:0:8*t*1e3/e},e.prototype.GetGameDataFrames=function(){return this.m_rgGameDataFrames},e.prototype.GetLatestGameDataFrameAppID=function(){return this.m_statsGameData&&this.m_statsGameData.nAppID?this.m_statsGameData.nAppID:0},R.c([T.a],e.prototype,"OnSourceBufferUpdateEnd",null),R.c([T.a],e.prototype,"OnSourceBufferError",null),R.c([T.a],e.prototype,"OnSourceBufferAbort",null),R.c([T.a],e.prototype,"ScheduleNextDownload",null),R.c([T.a],e.prototype,"DownloadNextSegment",null),R.c([T.a],e.prototype,"DownloadFailed",null),R.c([T.a],e.prototype,"DownloadGone",null),e}();function Nn(e){for(var t=!1,n=!1,o=!0,i=0;i<e.length;i++){var r=e.charCodeAt(i);if(o&&48<=r&&r<=57||35==r||42==r||10==r?n=!0:(55356<=r&&r<=57343||8205<=r&&r<=11093||12953==r||12349==r||12336==r||65039==r||12951==r||169==r||48<=r&&r<=57||35==r||42==r||10==r||174==r)&&(o=!(n=!0)),n&&0==i)n=!(t=!0);else if(n&&t)n=!(t=!0);else if(!n)return t=!1;if(20<i)return!1}return!o&&t}function Ln(e){var t=e.charCodeAt(0);return 65<=t&&t<=90}var kn,Pn,An=1e6,Bn=function(){return function(){this.playback_speed=1}}(),Fn=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return R.d(t,e),t}(Bn),Vn=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return R.d(t,e),t}(Bn),xn=function(){function e(){this.m_steamIDBroadcast="",this.m_steamIDViewer="",this.m_broadcastID="",this.m_ulViewerToken="",this.m_host="",this.m_strStatsLink="",this.m_strStalledLink="",this.m_strEventLogLink="",this.m_allTimeSnapshot=new Un(0),this.m_rgSnapShots=new Array(new Un(0)),this.m_videoResolution=0,this.m_audioRate=0,this.m_audioChannel=0,this.m_frameRate=0,this.m_strBufferingVideoResolution="0x0@0",this.m_nPlaybackVideoResolution=0,this.m_strPlaybackVideoResolution="0x0",this.m_htmlVideoResolution=0,this.m_strHtmlVideoDisplay="",this.m_nAudioBandwidth=0,this.m_nVideoBandwidth=0,this.m_nBandwidthRequired=0,this.m_nCurBandwidthVideo=0,this.m_nAudioBufferedMS=0,this.m_nVideoBufferedMS=0,this.m_nActiveDownloads=0,this.m_nVideoDownloadProgress=0,this.m_videoBufferedRanges=null,this.m_audioBufferedRanges=null,this.m_nSegmentDurationMS=0,this.m_nPlaybackRate=0,this.m_nTimeToFirstFrameMS=-1,this.m_fpsMonitor=new Hn}return e.prototype.GetBytesReceivedToDisplay=function(){return function(e,t,n,o){void 0===t&&(t=2),void 0===n&&(n=!0),void 0===o&&(o=!1);var i,r,a=n?1024:1e3,s=a*a,c=s*a,l=c*a;return r=l<e?(i=e/l,o?"Tbps":"TB"):c<e?(i=e/c,o?"Gbps":"GB"):s<e?(i=e/s,o?"Mbps":"MB"):a<e?(i=e/a,o?"Kbps":"KB"):(i=e,o?"bps":"bytes"),i.toLocaleString($.a.GetPreferredLocales(),{minimumFractionDigits:0,maximumFractionDigits:t})+" "+r}(this.m_allTimeSnapshot.m_nBytesReceived,1)},e.prototype.GetBufferingResolutionToDisplay=function(){return this.m_strBufferingVideoResolution},e.prototype.GetPlaybackResolutionToDisplay=function(){return this.m_strPlaybackVideoResolution},e.prototype.GetHTMLVideoResolutionToDisplay=function(){return this.m_strHtmlVideoDisplay},e.prototype.GetDroppedFramesToDisplay=function(){return this.m_allTimeSnapshot.m_nFramesDropped+"/"+this.m_allTimeSnapshot.m_nFramesDecoded},e.prototype.GetStalledEventsToDisplay=function(){return String(this.m_allTimeSnapshot.m_nStallEvents)},e.prototype.GetFailedDownloadsToDisplay=function(){return String(this.m_allTimeSnapshot.m_nFailedSegments)},e.prototype.GetNumBufferedVideoRanges=function(){return this.m_videoBufferedRanges?this.m_videoBufferedRanges.length:0},e.prototype.GetNumBufferedAudioRanges=function(){return this.m_audioBufferedRanges?this.m_audioBufferedRanges.length:0},e.prototype.GetBufferedVideoSegmentForDisplay=function(e){return this.m_videoBufferedRanges&&e<this.m_videoBufferedRanges.length?gn(this.m_videoBufferedRanges.start(e))+" - "+gn(this.m_videoBufferedRanges.end(e)):Object($.b)("#DASHPlayerStats_VideoNoRangeInformation")},e.prototype.GetBufferedAudioSegmentForDisplay=function(e){return this.m_audioBufferedRanges&&e<this.m_audioBufferedRanges.length?gn(this.m_audioBufferedRanges.start(e))+" - "+gn(this.m_audioBufferedRanges.end(e)):Object($.b)("#DASHPlayerStats_AudioNoRangeInformation")},e.prototype.GetBandwidthStatsToDisplay=function(){if(this.m_rgSnapShots.length<2)return(this.m_allTimeSnapshot.m_nBandwidthMin/An).toFixed(3)+" / "+(this.m_allTimeSnapshot.m_nBandwidthMax/An).toFixed(3)+" / "+(this.m_allTimeSnapshot.GetAverageBandwidth()/An).toFixed(3);var e=this.m_rgSnapShots[this.m_rgSnapShots.length-2],t=this.m_rgSnapShots[this.m_rgSnapShots.length-1];return((0==t.m_nBandwidthMin?e.m_nBandwidthMin:Math.min(e.m_nBandwidthMin,t.m_nBandwidthMin))/An).toFixed(3)+" / "+(Math.max(e.m_nBandwidthMax,t.m_nBandwidthMax)/An).toFixed(3)+" / "+(e.GetAverageBandwidthFromTwo(t)/An).toFixed(3)},e.prototype.GetDownloadTimeStatsToDisplay=function(){if(this.m_rgSnapShots.length<2)return(this.m_allTimeSnapshot.m_nSegmentDownloadTimeMinMS/1e3).toFixed(3)+" / "+(this.m_allTimeSnapshot.m_nSegmentDownloadTimeMaxMS/1e3).toFixed(3)+" / "+(this.m_allTimeSnapshot.GetAverageDownloadTime()/1e3).toFixed(3);var e=this.m_rgSnapShots[this.m_rgSnapShots.length-2],t=this.m_rgSnapShots[this.m_rgSnapShots.length-1];return((0==t.m_nSegmentDownloadTimeMinMS?e.m_nSegmentDownloadTimeMinMS:Math.min(e.m_nSegmentDownloadTimeMinMS,t.m_nSegmentDownloadTimeMinMS))/1e3).toFixed(3)+" / "+(Math.max(e.m_nSegmentDownloadTimeMaxMS,t.m_nSegmentDownloadTimeMaxMS)/1e3).toFixed(3)+" / "+(e.GetAverageDownloadTimeFromTwo(t)/1e3).toFixed(3)},e.prototype.BHasFrameInformation=function(){return 0<this.m_allTimeSnapshot.m_nFramesDecoded},e.prototype.GetBandwidthRequiredToDisplay=function(){return(this.m_nBandwidthRequired/An).toFixed(3)},e.prototype.GetBandwithVideoToDisplay=function(){return(this.m_nCurBandwidthVideo/An).toFixed(3)},e.prototype.GetContentServerToDisplay=function(){return this.m_host},e.prototype.GetVideoBufferedToDisplay=function(){return(this.m_nVideoBufferedMS/1e3).toFixed(3)},e.prototype.GetAudioBufferedToDisplay=function(){return(this.m_nAudioBufferedMS/1e3).toFixed(3)},e.prototype.GetActiveDownloadsToDisplay=function(){return String(this.m_nActiveDownloads)},e.prototype.GetVideoDownloadProgressToDisplay=function(){return this.m_nVideoDownloadProgress?String(Math.round(100*this.m_nVideoDownloadProgress))+"%":"100%"},e.prototype.GetTimeToFirstFrameToDisplay=function(){return-1==this.m_nTimeToFirstFrameMS?"Unknown":String(this.m_nTimeToFirstFrameMS)},e.prototype.GetPersistentFrameDropsForDisplay=function(){return String(this.m_fpsMonitor.BIsDroppingFrames())},e.prototype.GetCurrentFPSForDisplay=function(){return this.m_fpsMonitor.BHasCurrentFPS()?this.m_fpsMonitor.GetCurrentFPS().toFixed(1):Object($.b)("#DASHPlayerStats_Tracking")},e.prototype.GetPlaybackRateForDisplay=function(){return this.m_nPlaybackRate.toFixed(1)+"x"},e.prototype.GetFPSMonitor=function(){return this.m_fpsMonitor},e.prototype.SetHTMLVideoPlayerDisplay=function(e,t,n,o){this.m_htmlVideoResolution!=o&&(this.m_htmlVideoResolution=o,this.m_strHtmlVideoDisplay=n+"x"+o),this.m_nPlaybackVideoResolution!=t&&(this.m_nPlaybackVideoResolution=t,this.m_strPlaybackVideoResolution=e+"x"+t)},e.prototype.SetVideoPlaybackResolution=function(e,t,n){0==this.m_videoResolution&&(this.m_allTimeSnapshot.m_nInitialVideoResolution=t,this.m_rgSnapShots[this.m_rgSnapShots.length-1].m_nInitialVideoResolution=t),this.m_strBufferingVideoResolution=e+"x"+t+"@"+n,this.m_videoResolution=t,this.m_frameRate=n},e.prototype.SetRepresentation=function(e){e&&(e.nAudioSamplingRate?(this.m_audioRate=Math.round(e.nBandwidth/1e3),this.m_audioChannel=e.nAudioChannels,this.m_nAudioBandwidth=e.nBandwidth):e.nFrameRate&&(this.SetVideoPlaybackResolution(e.nWidth,e.nHeight,e.nFrameRate),this.m_nVideoBandwidth=e.nBandwidth),this.m_nBandwidthRequired=this.m_nAudioBandwidth+this.m_nVideoBandwidth)},e.prototype.SetCurrentVideoBandwidth=function(e){this.m_nCurBandwidthVideo=e},e.prototype.SetSegmentDurationMS=function(e){this.m_nSegmentDurationMS=e},e.prototype.SetBroadcasterAndViewerInfo=function(e,t,n,o){this.m_steamIDBroadcast=e,this.m_steamIDViewer=t,this.m_broadcastID=n,this.m_ulViewerToken=o},e.prototype.SetAnalyticLinks=function(e,t,n){this.m_strStatsLink=e,this.m_strStalledLink=t,this.m_strEventLogLink=n},e.prototype.SetVideoInitializationURL=function(e){var t=new URL(e);this.m_host=t.hostname},e.prototype.SetAudioRate=function(e){this.m_audioRate=e},e.prototype.CaptureFrequentlyUpdatingInformation=function(e,t){var n=this.ExtractFrameInfo(e);this.LogFrameInfo(n),this.LogBufferDuration(t,e)},e.prototype.LogDownload=function(e,t){this.m_allTimeSnapshot.SegmentReceived(e,t),this.m_rgSnapShots[this.m_rgSnapShots.length-1].SegmentReceived(e,t)},e.prototype.LogSegmentDownloadFailure=function(e,t){this.m_allTimeSnapshot.m_nFailedSegments+=1,this.m_rgSnapShots[this.m_rgSnapShots.length-1].m_nFailedSegments+=1,this.m_allTimeSnapshot.m_nLastSegementDownloadStatus=t,this.m_rgSnapShots[this.m_rgSnapShots.length-1].m_nLastSegementDownloadStatus=t,this.LogDownload(0,e)},e.prototype.LogVideoError=function(e){},e.prototype.LogVideoOnCanPlay=function(e){-1===this.m_nTimeToFirstFrameMS&&(this.m_nTimeToFirstFrameMS=Date.now()-this.m_allTimeSnapshot.m_timeMS)},e.prototype.LogErrorEvent=function(e,t){},e.prototype.ReportVideoStalled=function(e,t){if(0!=this.m_strStalledLink.length){var n=this.FindBehindSegmentLoader(e,t);if(n){this.m_allTimeSnapshot.m_nStallEvents+=1,this.m_rgSnapShots[this.m_rgSnapShots.length-1].m_nStallEvents+=1;var o=new Vn;this.GatherCommonStats(o,t,n.GetBandwidthRequired(),n.GetAvgDownloadRate()),o.last_segment_response=this.m_rgSnapShots[this.m_rgSnapShots.length-1].m_nLastSegementDownloadStatus,o.audio_stalled=n.ContainsAudio(),this.CaptureActiveDownloads(e),o.active_downloads=this.m_nActiveDownloads,o.vid_down_progress=this.m_nVideoDownloadProgress;for(var i=n.GetDownloadHistory(),r=0,a=i.length-1;0<=a&&r<3;--a)o["segment"+ ++r+"_bytes"]=i[a].cubData,o["segment"+r+"_time"]=Math.round(i[a].nDownloadMS)/1e3;this.SendReportToServer(o,this.m_strStalledLink)}else fn("DASHStats: Did not find any audio or video loaders")}},e.prototype.FindBehindSegmentLoader=function(e,t){for(var n=!1,o=!1,i=t.currentTime,r=null,a=null,s=0,c=e;s<c.length;s++){var l=c[s];a=l.ContainsAudio()?l:a,r=l.ContainsVideo()?l:a,l.BHasEnoughBuffered(i)&&(o=o||l.ContainsAudio(),n=n||l.ContainsVideo())}return o=o||null==a,!n||n&&o?r:a},e.prototype.ExtractFrameInfo=function(e){var t=0,n=0;if(e.getVideoPlaybackQuality)try{var o=e.getVideoPlaybackQuality();n=o.totalVideoFrames,t=o.droppedVideoFrames}catch(e){fn("Browser does not support HTMLVideoElement.getVideoPlaybackQuality()",e.message)}else e.webkitDecodedFrames?(n=e.webkitDecodedFrames,t=e.webkitDroppedFrames):e.webkitDecodedFrameCount&&(n=e.webkitDecodedFrameCount,t=e.webkitDroppedFrameCount);return{framesDecoded:n,framesDropped:t}},e.prototype.LogFrameInfo=function(e){this.m_allTimeSnapshot.m_nFramesDecoded=e.framesDecoded,this.m_allTimeSnapshot.m_nFramesDropped=e.framesDropped;var t=this.m_rgSnapShots[this.m_rgSnapShots.length-1];if(1==this.m_rgSnapShots.length)t.m_nFramesDecoded=e.framesDecoded,t.m_nFramesDropped=e.framesDropped;else{var n=this.m_rgSnapShots[this.m_rgSnapShots.length-2];t.m_nFramesDecoded=e.framesDecoded-n.m_nFramesDecoded,t.m_nFramesDropped=e.framesDropped-n.m_nFramesDropped}},e.prototype.LogBufferDuration=function(e,t){for(var n=this.m_nActiveDownloads=0,o=e;n<o.length;n++){var i=o[n];i.ContainsAudio()?(this.m_nAudioBufferedMS=i.GetAmountBufferedMS(t.currentTime),this.m_audioBufferedRanges=i.GetSourceBufferTimeRanges()):i.ContainsVideo()&&(this.m_nVideoBufferedMS=i.GetAmountBufferedMS(t.currentTime),this.m_videoBufferedRanges=i.GetSourceBufferTimeRanges()),this.m_nActiveDownloads+=i.GetActiveDownloads(),i.ContainsVideo()&&(this.m_nVideoDownloadProgress=i.GetActiveDownloadProgress())}this.m_nPlaybackRate=t.playbackRate},e.prototype.CaptureActiveDownloads=function(e){for(var t=this.m_nActiveDownloads=0,n=e;t<n.length;t++){var o=n[t];this.m_nActiveDownloads+=o.GetActiveDownloads(),o.ContainsVideo()&&(this.m_nVideoDownloadProgress=o.GetActiveDownloadProgress())}},e.prototype.ReportPlayerStats=function(e,t){if(0!=this.m_strStatsLink.length){var n=this.ExtractFrameInfo(t);if(n.framesDecoded!=this.m_allTimeSnapshot.m_nFramesDecoded||0!=this.m_rgSnapShots[this.m_rgSnapShots.length-1].m_nBytesReceived){this.LogFrameInfo(n),this.LogBufferDuration(e,t);var o=new Fn,i=this.m_rgSnapShots[this.m_rgSnapShots.length-1];o.frames_decoded=i.m_nFramesDecoded,o.frames_dropped=i.m_nFramesDropped,o.bytes_received=i.m_nBytesReceived,o.seconds_delta=Math.round((Date.now()-i.m_timeMS)/1e3),o.failed_segments=i.m_nFailedSegments,o.bw_min=i.m_nBandwidthMin,o.bw_max=i.m_nBandwidthMax,o.audio_buffer=Math.round(this.m_nAudioBufferedMS/1e3),o.video_buffer=Math.round(this.m_nVideoBufferedMS/1e3),o.seg_time_avg=Math.round(i.GetAverageDownloadTime())/1e3,o.seg_time_min=Math.round(i.m_nSegmentDownloadTimeMinMS)/1e3,o.seg_time_max=Math.round(i.m_nSegmentDownloadTimeMaxMS)/1e3,o.initial_vid_res=i.m_nInitialVideoResolution,o.ttff=this.m_nTimeToFirstFrameMS,o.seg_duration=this.m_nSegmentDurationMS,this.GatherCommonStats(o,t,this.m_nBandwidthRequired,i.GetAverageBandwidth()),this.CreateNewEmptySnapshot(t.videoHeight),this.SendReportToServer(o,this.m_strStatsLink)}else this.CreateNewEmptySnapshot(t.videoHeight)}},e.prototype.SendReportToServer=function(a,s){return R.b(this,void 0,void 0,function(){var t,n,o,i,r;return R.e(this,function(e){for(t=new URL(s),n=new FormData,o=0,i=Object.keys(a);o<i.length;o++)r=i[o],n.append(r,a[r]);return n.append("l",t.searchParams.get("l")),n.append("e",t.searchParams.get("e")),n.append("h",t.searchParams.get("h")),fn("CDASHStats Sending Report to Server",a),C.a.post(s,n).catch(function(e){fn("Failed to upload stats: ",e)}),[2]})})},e.prototype.CreateNewEmptySnapshot=function(e){5<=this.m_rgSnapShots.length&&this.m_rgSnapShots.shift(),this.m_rgSnapShots.push(new Un(e))},e.prototype.GatherCommonStats=function(e,t,n,o){e.steamid=this.m_steamIDViewer,e.host=this.m_host,e.playback_position=Math.round(t.currentTime),e.video_res=this.m_videoResolution,e.audio_rate=this.m_audioRate,e.audio_ch=this.m_audioChannel,e.bw_required=n,e.bw_avg=Math.round(o),e.broadcast_accountid=new D.a(this.m_steamIDBroadcast).GetAccountID(),e.useragent=window.navigator.userAgent,e.sessionid=_.b.SESSIONID},R.c([d.observable],e.prototype,"m_allTimeSnapshot",void 0),R.c([d.observable],e.prototype,"m_strBufferingVideoResolution",void 0),R.c([d.observable],e.prototype,"m_strPlaybackVideoResolution",void 0),R.c([d.observable],e.prototype,"m_strHtmlVideoDisplay",void 0),R.c([d.observable],e.prototype,"m_nBandwidthRequired",void 0),R.c([d.observable],e.prototype,"m_nCurBandwidthVideo",void 0),R.c([d.observable],e.prototype,"m_nAudioBufferedMS",void 0),R.c([d.observable],e.prototype,"m_nVideoBufferedMS",void 0),R.c([d.observable],e.prototype,"m_nActiveDownloads",void 0),R.c([d.observable],e.prototype,"m_nVideoDownloadProgress",void 0),R.c([d.observable],e.prototype,"m_videoBufferedRanges",void 0),R.c([d.observable],e.prototype,"m_audioBufferedRanges",void 0),R.c([d.observable],e.prototype,"m_nPlaybackRate",void 0),R.c([d.action],e.prototype,"SetVideoPlaybackResolution",null),R.c([d.action],e.prototype,"SetRepresentation",null),R.c([d.action],e.prototype,"SetCurrentVideoBandwidth",null),R.c([d.action],e.prototype,"CaptureFrequentlyUpdatingInformation",null),R.c([d.action],e.prototype,"LogDownload",null),R.c([d.action],e.prototype,"LogSegmentDownloadFailure",null),R.c([d.action],e.prototype,"LogFrameInfo",null),R.c([d.action],e.prototype,"LogBufferDuration",null),e}(),Un=function(){function e(e){this.m_timeMS=Date.now(),this.m_nBytesReceived=0,this.m_nInitialVideoResolution=0,this.m_nFailedSegments=0,this.m_nStallEvents=0,this.m_nEntries=0,this.m_nSegmentDownloadTimeTotalMS=0,this.m_nSegmentDownloadTimeMaxMS=0,this.m_nSegmentDownloadTimeMinMS=0,this.m_nBandwidthTotal=0,this.m_nBandwidthMin=0,this.m_nBandwidthMax=0,this.m_nLastSegementDownloadStatus=200,this.m_nFramesDecoded=0,this.m_nFramesDropped=0,this.m_nInitialVideoResolution=e}return e.prototype.GetAverageBandwidth=function(){return this.m_nBandwidthTotal/Math.max(1,this.m_nEntries)},e.prototype.GetAverageDownloadTime=function(){return this.m_nSegmentDownloadTimeTotalMS/Math.max(1,this.m_nEntries)},e.prototype.GetAverageBandwidthFromTwo=function(e){return(e.m_nBandwidthTotal+this.m_nBandwidthTotal)/Math.max(1,e.m_nEntries+this.m_nEntries)},e.prototype.GetAverageDownloadTimeFromTwo=function(e){return(e.m_nSegmentDownloadTimeTotalMS+this.m_nSegmentDownloadTimeTotalMS)/Math.max(1,e.m_nEntries+this.m_nEntries)},e.prototype.SegmentReceived=function(e,t){if(this.m_nBytesReceived+=e,!(e<1024)){var n=Math.round(8*e*1e3/Math.max(t,1));0==this.m_nEntries?(this.m_nSegmentDownloadTimeMinMS=t,this.m_nBandwidthMin=n):(this.m_nSegmentDownloadTimeMinMS=Math.min(t,this.m_nSegmentDownloadTimeMinMS),this.m_nBandwidthMin=Math.min(n,this.m_nBandwidthMin)),this.m_nBandwidthMax=Math.max(n,this.m_nBandwidthMax),this.m_nSegmentDownloadTimeMaxMS=Math.max(t,this.m_nSegmentDownloadTimeMaxMS),this.m_nBandwidthTotal+=n,this.m_nSegmentDownloadTimeTotalMS+=t,this.m_nEntries+=1}},R.c([d.observable],e.prototype,"m_nBytesReceived",void 0),R.c([d.observable],e.prototype,"m_nFailedSegments",void 0),R.c([d.observable],e.prototype,"m_nStallEvents",void 0),R.c([d.observable],e.prototype,"m_nSegmentDownloadTimeMaxMS",void 0),R.c([d.observable],e.prototype,"m_nSegmentDownloadTimeMinMS",void 0),R.c([d.observable],e.prototype,"m_nBandwidthMin",void 0),R.c([d.observable],e.prototype,"m_nBandwidthMax",void 0),R.c([d.observable],e.prototype,"m_nFramesDecoded",void 0),R.c([d.observable],e.prototype,"m_nFramesDropped",void 0),R.c([d.action],e.prototype,"SegmentReceived",null),e}(),jn=function(){function e(){}return e.prototype.reset=function(e,t){this.bDropReading=e,this.nTotalDecodedFrames=t},e}(),Hn=function(){function e(){this.k_nTestFrequencyMS=1e3,this.k_nSlidingWindow=6,this.k_nDroppedFramesThreshold=1,this.k_nFailThreshold=3,this.k_nIgnoreReadingAroundResizeMS=2e3,this.m_schTracker=new L,this.m_rgResultsWindow=[],this.m_nLastResizeMS=0,this.m_bDroppingFrameDetected=!1,this.m_nCurrentFPS=0}return e.prototype.StartTracking=function(e){this.m_schTracker.Schedule(this.k_nTestFrequencyMS,this.TakeReading),this.m_fnRequestDecoded=e,this.m_lastFrameInfo=this.m_fnRequestDecoded(),this.m_bDroppingFrameDetected=!1},e.prototype.BHasCurrentFPS=function(){return 0!=this.m_nCurrentFPS},e.prototype.GetCurrentFPS=function(){return this.m_nCurrentFPS},e.prototype.BIsDroppingFrames=function(){return this.m_bDroppingFrameDetected},e.prototype.SetWindowResized=function(){this.m_nLastResizeMS=Date.now()},e.prototype.BIsInResizeTimeWindow=function(){return this.m_nLastResizeMS&&Date.now()-this.m_nLastResizeMS<this.k_nIgnoreReadingAroundResizeMS},e.prototype.Close=function(){this.m_schTracker.Cancel(),this.m_rgResultsWindow=[],this.m_bDroppingFrameDetected=!1},e.prototype.LogResizeAction=function(){this.m_nLastResizeMS=Date.now()},e.prototype.TakeReading=function(){this.m_schTracker.Schedule(this.k_nTestFrequencyMS,this.TakeReading);var e=!1,t=this.m_fnRequestDecoded();this.BIsInResizeTimeWindow()||(e=0<this.m_lastFrameInfo.framesDropped&&t.framesDropped-this.m_lastFrameInfo.framesDropped>this.k_nDroppedFramesThreshold),this.AppendReading(e,t.framesDecoded),this.m_bDroppingFrameDetected=this.ComputeDroppingFrames(),this.m_nCurrentFPS=t.framesDecoded-this.m_lastFrameInfo.framesDecoded-(t.framesDropped-this.m_lastFrameInfo.framesDropped),this.m_lastFrameInfo=t},e.prototype.ComputeDroppingFrames=function(){return this.m_rgResultsWindow.length==this.k_nSlidingWindow&&this.m_rgResultsWindow.filter(function(e){return e.bDropReading}).length>=this.k_nFailThreshold},e.prototype.AppendReading=function(e,t){var n;(n=this.m_rgResultsWindow.length>=this.k_nSlidingWindow?this.m_rgResultsWindow.shift():new jn).reset(e,t),this.m_rgResultsWindow.push(n)},R.c([d.observable],e.prototype,"m_bDroppingFrameDetected",void 0),R.c([d.observable],e.prototype,"m_nCurrentFPS",void 0),R.c([d.action.bound],e.prototype,"TakeReading",null),e}();(Pn=kn||(kn={}))[Pn.HAVE_NOTHING=0]="HAVE_NOTHING",Pn[Pn.HAVE_METADATA=1]="HAVE_METADATA",Pn[Pn.HAVE_CURRENT_DATA=2]="HAVE_CURRENT_DATA",Pn[Pn.HAVE_FUTURE_DATA=3]="HAVE_FUTURE_DATA",Pn[Pn.HAVE_ENOUGH_DATA=4]="HAVE_ENOUGH_DATA";var Wn=function(){function e(e){this.m_elVideo=null,this.m_strMPD="",this.m_schUpdateMPD=new L,this.m_bUseHLSManifest=!1,this.m_strVideoAdaptationID="",this.m_strAudioAdaptationID="",this.m_strGameAdaptationID="",this.m_rgLoaders=[],this.m_mediaSource=null,this.m_nTrackBufferMS=0,this.m_nLimitFPS=0,this.m_bIsBuffering=!0,this.m_nSeekingToTime=-1,this.m_listeners=new k,this.m_bFirstPlay=!0,this.m_schGameDataEventTrigger=new L,this.m_schReportPlayerTrigger=new L,this.m_nGameDataLastFramePTS=-1,this.m_bStatsViewVisible=!1,this.m_schCaptureDisplayStatsTrigger=new L,this.m_videoRepSelected=null,this.m_nAudioRepresentationIndex=0,this.m_stats=new xn,this.m_bClosing=!1,this.m_bUserPlayChoice=!0,this.m_bUserLiveEdgeChoice=!0,this.m_schFirstFrameThrottler=new L,this.m_elVideo=e,this.m_schReportPlayerTrigger.Schedule(3e4,this.ReportPlayerStats)}return e.prototype.CalcVideoStartRelativeToSystemClock=function(e){var t=e?new Date(e).getTime():Date.now(),n=performance.now()-(t-this.m_mpd.GetAvailabilityStartTime().getTime());this.m_mpd.SetLiveContentStart(n),fn("server time: "+e)},e.prototype.PlayMPD=function(n){return R.b(this,void 0,void 0,function(){var t;return R.e(this,function(e){switch(e.label){case 0:return this.m_strMPD=n,[4,this.DownloadMPD()];case 1:return(t=e.sent())?(this.m_mpd=new Gn,this.m_mpd.BParse(t.data)?this.IsLiveContent()?(this.IsLiveContent()&&(0<this.m_mpd.GetMinimumUpdatePeriod()&&this.m_schUpdateMPD.Schedule(1e3*this.m_mpd.GetMinimumUpdatePeriod(),this.UpdateMPD),this.CalcVideoStartRelativeToSystemClock(t.headers.date)),this.m_bUseHLSManifest?this.CloseWithError("playbackerror","HLS manifest not yet supported"):this.BCreateLoaders()?(this.m_stats.SetSegmentDurationMS(wn(this.GetCurrentVideoAdaptation())),this.m_stats.SetAnalyticLinks(this.m_mpd.GetStatsLink(),this.m_mpd.GetStalledLink(),this.m_mpd.GetEventLink()),this.m_stats.SetVideoInitializationURL(this.GetCurrentVideoAdaptation().segmentTemplate.strInitialization),this.InitVideoControl()):this.CloseWithError("playbackerror","Failed to create segment loaders"),[2]):(this.CloseWithError("playbackerror","Only live content is currently supported",this.m_strMPD),[2]):(this.CloseWithError("playbackerror","Failed to parse MPD file",this.m_strMPD),[2])):[2]}})})},e.prototype.PlayWebRTC=function(e,t,n,o,i){},e.prototype.Close=function(){if(this.m_bClosing=!0,this.m_listeners.Unregister(),this.StopDownloads(),this.m_elVideo.pause(),this.m_mediaSource){try{"closed"!=this.m_mediaSource.readyState&&this.m_mediaSource.endOfStream()}catch(e){}this.m_mediaSource=null}this.m_bIsBuffering=!0,this.m_elVideo=null,this.m_strMPD="",this.m_mpd=null,this.m_bUseHLSManifest=!1,this.m_strVideoAdaptationID="",this.m_strAudioAdaptationID="",this.m_strGameAdaptationID="",this.m_nTrackBufferMS=0,this.m_nLimitFPS=0,this.m_nSeekingToTime=-1,this.m_nGameDataLastFramePTS=-1,this.m_bStatsViewVisible=!1,this.m_videoRepSelected=null,this.m_nAudioRepresentationIndex=0,this.m_stats&&this.m_stats.GetFPSMonitor().Close(),this.m_stats=null,this.m_bFirstPlay=!0},e.prototype.StopDownloads=function(){this.m_xhrUpdateMPD&&(this.m_xhrUpdateMPD.cancel(),this.m_xhrUpdateMPD=null),this.m_schUpdateMPD.Cancel(),this.m_schGameDataEventTrigger.Cancel(),this.m_schReportPlayerTrigger.Cancel(),this.m_schCaptureDisplayStatsTrigger.Cancel(),this.m_schFirstFrameThrottler.Cancel(),1!=this.m_elVideo.playbackRate&&(this.m_elVideo.playbackRate=1);for(var e=0,t=this.m_rgLoaders;e<t.length;e++){t[e].Close()}this.m_bIsBuffering=!0},e.prototype.IsBuffering=function(){return this.m_bIsBuffering},e.prototype.IsLiveContent=function(){return!!this.m_mpd&&"dynamic"==this.m_mpd.GetType()},e.prototype.DownloadMPD=function(){return R.b(this,void 0,void 0,function(){var n,o;return R.e(this,function(e){switch(e.label){case 0:if(this.m_xhrUpdateMPD)return Object(I.a)(!1,"Multiple MPD download requests"),[2,null];n=performance.now(),e.label=1;case 1:if(!(performance.now()-n<3e4))return[3,7];o=null,e.label=2;case 2:return e.trys.push([2,4,,5]),this.m_xhrUpdateMPD=C.a.CancelToken.source(),[4,C.a.get(this.m_strMPD,{cancelToken:this.m_xhrUpdateMPD.token})];case 3:return o=e.sent(),[3,5];case 4:return e.sent(),[3,5];case 5:return this.m_xhrUpdateMPD=null,this.m_bClosing?[2,null]:o&&200==o.status?[2,o]:(fn("Failed to download, will retry: "+this.m_strMPD),[4,(t=200,new Promise(function(e){return setTimeout(e,t)}))]);case 6:return e.sent(),[3,1];case 7:return fn("Failed to download: "+this.m_strMPD),[2,null]}var t})})},e.prototype.UpdateMPD=function(){return R.b(this,void 0,void 0,function(){var t;return R.e(this,function(e){switch(e.label){case 0:return[4,this.DownloadMPD()];case 1:return(t=e.sent())&&(this.m_mpd.BUpdate(t.data)?(this.CalcVideoStartRelativeToSystemClock(t.headers.date),this.m_stats.SetAnalyticLinks(this.m_mpd.GetStatsLink(),this.m_mpd.GetStalledLink(),this.m_mpd.GetEventLink()),0<this.m_mpd.GetMinimumUpdatePeriod()&&this.m_schUpdateMPD.Schedule(1e3*this.m_mpd.GetMinimumUpdatePeriod(),this.UpdateMPD)):this.CloseWithError("playbackerror","Failed to parse on Update the MPD file")),[2]}})})},e.prototype.CloseWithError=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];this.Close(),fn.apply(void 0,t)},e.prototype.BCreateLoaders=function(){var e=this.m_mpd.GetPeriods();if(0==e.length)return!1;var t=e[0];this.m_strVideoAdaptationID="",this.m_strAudioAdaptationID="",this.m_strGameAdaptationID="";for(var n=0,o=t.rgAdaptationSets;n<o.length;n++){var i=o[n],r=null;if(!this.m_strVideoAdaptationID&&i.bContainsVideo&&On(i)&&(r=i,this.m_strVideoAdaptationID=i.strID),!this.m_strAudioAdaptationID&&i.bContainsAudio&&On(i)&&(r=i,this.m_strAudioAdaptationID=i.strID),!this.m_strGameAdaptationID&&i.bContainsGame&&(r=i,this.m_strGameAdaptationID=i.strID),r){var a=new Rn(this,this.m_mpd,r,this.m_stats);this.m_rgLoaders.push(a)}}return 0<this.m_strVideoAdaptationID.length},e.prototype.InitVideoControl=function(){var e=new MediaSource,t=URL.createObjectURL(e);this.m_elVideo.pause(),this.m_elVideo.srcObject=null,this.m_elVideo.src=t,this.m_mediaSource=e,this.m_listeners.AddEventListener(e,"sourceopen",this.OnMediaSourceOpen),this.m_listeners.AddEventListener(e,"sourceended",this.OnMediaSourceEnded),this.m_listeners.AddEventListener(e,"sourceclose",this.OnMediaSourceClose),this.m_listeners.AddEventListener(this.m_elVideo,"waiting",this.OnVideoWaiting),this.m_listeners.AddEventListener(this.m_elVideo,"error",this.OnVideoError),this.m_listeners.AddEventListener(this.m_elVideo,"canplay",this.OnVideoCanPlay),this.m_listeners.AddEventListener(this.m_elVideo,"pause",this.OnVideoPause),this.m_listeners.AddEventListener(this.m_elVideo,"resize",this.OnVideoResize),this.m_listeners.AddEventListener(this.m_elVideo,"valve-bufferupdate",this.OnVideoTimeUpdate),this.m_listeners.AddEventListener(this.m_elVideo,"timeupdate",this.OnVideoTimeUpdate)},e.prototype.OnMediaSourceOpen=function(e){fn("OnMediaSourceOpen");for(var t=0,n=this.m_rgLoaders;t<n.length;t++){n[t].SetMediaSource(this.m_mediaSource)}this.BeginPlayback()},e.prototype.OnMediaSourceEnded=function(e){fn("OnMediaSourceEnded")},e.prototype.OnMediaSourceClose=function(e){fn("OnMediaSourceClose")},e.prototype.OnVideoWaiting=function(e){if(!this.BIsPlayerBufferedBetween(this.m_elVideo.currentTime,this.m_elVideo.currentTime+.5)){if(this.m_elVideo&&1<this.m_elVideo.buffered.length)for(var t=this.m_elVideo.currentTime,n=this.m_elVideo.buffered,o=0;o<n.length;++o)if(fn("OnVideoWaiting buffer "+o+" start:"+n.start(o)+" end: "+n.end(o)+" playerTime: "+t),n.start(o)<=t&&t<=n.end(o))return fn("OnVideoWaiting - time splitting, jumping to buffer "+o),void this.Seek(n.start(o));if(this.m_stats.ReportVideoStalled(this.m_rgLoaders,this.m_elVideo),null===this.m_videoRepSelected){var i=!0,r=this.GetVideoLoader();if(r){var a=this.m_mpd.GetLowestRepresentation(this.GetCurrentVideoAdaptation().strID);a&&!r.BIsCurrentRepresentation(a)&&(r.ChangeRepresentation(a),fn("OnVideoWaiting - Stalled, forced restart download at resolution: "+a.nWidth+"x"+a.nHeight+"@"+a.nFrameRate+" instead"),i=!1),this.Seek(this.m_elVideo.currentTime)}i&&fn("OnVideoWaiting - Stalled, already at lowest resolution. No action taken. BHasLoader: "+(null!=r))}else fn("OnVideoWaiting - Stalled, user explicitly chose a resolution: "+this.m_videoRepSelected.nWidth+"x"+this.m_videoRepSelected.nHeight+"@"+this.m_videoRepSelected.nFrameRate)}},e.prototype.OnVideoPause=function(e){this.OnVideoBufferProgress(),this.m_stats.GetFPSMonitor().Close()},e.prototype.OnVideoResize=function(e){this.m_stats.GetFPSMonitor().SetWindowResized()},e.prototype.OnDebugPrintEventInfoAndAvailableBuffer=function(e){var t=-1,n=this.GetVideoLoader();this.m_elVideo&&n&&(t=n.GetAmountBufferedInPlayerMS(this.m_elVideo.currentTime)),fn("DebugMessage - Stats: "+e.type+" BufferedMS: "+t)},e.prototype.OnVideoError=function(e){fn("OnVideoError")},e.prototype.OnVideoCanPlay=function(e){this.m_bIsBuffering||(this.m_bUserPlayChoice&&this.PlayOnElement(),this.m_stats.LogVideoOnCanPlay(e))},e.prototype.GetCurrentPlayTime=function(){return-1!=this.m_nSeekingToTime?this.m_nSeekingToTime:this.m_elVideo.currentTime},e.prototype.OnVideoTimeUpdate=function(){if(this.m_bUserLiveEdgeChoice&&this.IsLiveContent()){var e=this.GetBufferedLiveEdgeTime();if(1==this.m_elVideo.playbackRate&&this.m_elVideo.currentTime<=e-4.5&&this.BIsPlayerBufferedBetween(this.m_elVideo.currentTime,e)){var t=e-this.m_elVideo.currentTime;this.m_elVideo.playbackRate=1.1,fn("User is behind by "+t.toFixed(2)+" seconds, increasing playback speed to catch-up to live edge.")}else 1.1==this.m_elVideo.playbackRate&&this.m_elVideo.currentTime>=e-1&&(this.m_elVideo.playbackRate=1,fn("User is caught up, returning to normal playrate"))}},e.prototype.BIsPlayerBufferedBetween=function(e,t){return 0<this.m_elVideo.buffered.length&&e>=this.m_elVideo.buffered.start(0)&&t<=this.m_elVideo.buffered.end(0)},e.prototype.GetLiveContentStartTime=function(){return this.m_mpd.GetAvailabilityStartTime()},e.prototype.GetAvailableVideoStartTime=function(){if(!this.IsLiveContent())return 0;var e=Math.floor((performance.now()-this.m_mpd.GetLiveContentStart())/1e3),t=this.GetBufferedLiveEdgeTime(),n=this.m_mpd.GetTimeShiftBufferDepth();return _n.a(e-n+10,0,t)},e.prototype.GetBufferedLiveEdgeTime=function(){return this.IsLiveContent()?Math.floor((performance.now()-this.m_mpd.GetLiveContentStart()-this.m_nTrackBufferMS)/1e3):this.m_mpd.GetPeriodDuration(0)-1},e.prototype.IsPaused=function(){return this.m_elVideo.paused},e.prototype.Play=function(){this.m_bUserPlayChoice=!0,this.Seek(this.m_elVideo.currentTime)},e.prototype.Pause=function(){this.m_bUserLiveEdgeChoice=!1,1.1==this.m_elVideo.playbackRate&&(this.m_elVideo.playbackRate=1),this.m_bUserPlayChoice=!1,this.m_elVideo.pause()},e.prototype.GetPlaybackRate=function(){return this.m_elVideo.paused?0:this.m_elVideo.playbackRate},e.prototype.OnSegmentDownloaded=function(e){fn(e.GetDebugName()+" OnSegmentDownloaded"),this.UpdateVideoRepresentation(this.m_videoRepSelected),this.OnVideoBufferProgress(),e==this.GetVideoLoader()&&this.m_stats.SetCurrentVideoBandwidth(e.GetAvgDownloadRate())},e.prototype.PlayOnElement=function(){var t=this,n=this.m_bFirstPlay;this.m_bFirstPlay=!1;var e=this.m_elVideo.play();e||this.m_stats.GetFPSMonitor().StartTracking(function(){return t.m_stats.ExtractFrameInfo(t.m_elVideo)}),e.then(function(){t.m_stats.GetFPSMonitor().StartTracking(function(){return t.m_stats.ExtractFrameInfo(t.m_elVideo)})}).catch(function(e){n&&t.DispatchEvent("valve-userinputneeded")})},e.prototype.OnVideoBufferProgress=function(){if(this.IsBuffering()){for(var e=0<this.m_rgLoaders.length,t=-1!=this.m_nSeekingToTime?this.m_nSeekingToTime:0,n=0,o=this.m_rgLoaders;n<o.length;n++){var i=o[n];if(!i.BHasEnoughBuffered(t)){e=!1;break}t=Math.max(t,i.GetBufferedStart())}e&&(this.m_bIsBuffering=!1,this.m_nSeekingToTime=-1,this.m_elVideo.currentTime!=t?this.m_elVideo.currentTime=t:this.m_elVideo.paused&&this.m_bUserPlayChoice&&this.PlayOnElement(),this.DispatchEvent("valve-bufferupdate"))}},e.prototype.OnSegmentDownloadFailed=function(e){this.StopDownloads(),this.DispatchEvent("valve-downloadfailed")},e.prototype.OnSegmentDownloadGone=function(e){this.m_bIsBuffering&&e.GetNumConsecutiveDownloadGones()<=3?this.Seek(this.GetCurrentPlayTime()+wn(this.GetCurrentVideoAdaptation())/1e3):(fn("OnSegmentDownloadGone: too many consecutive 'gone', erroring the download: "+e.GetNumConsecutiveDownloadGones()),this.OnSegmentDownloadFailed(e))},e.prototype.GetCurrentAudioAdaptationfunction=function(){return this.m_mpd?this.m_mpd.GetAdaptationByTrackID(this.m_strAudioAdaptationID):null},e.prototype.GetCurrentVideoAdaptation=function(){return this.m_mpd?this.m_mpd.GetAdaptationByTrackID(this.m_strVideoAdaptationID):null},e.prototype.GetVideoLoader=function(){for(var e=0,t=this.m_rgLoaders;e<t.length;e++){var n=t[e];if(n.ContainsVideo())return n}return null},e.prototype.GetAudioLoader=function(){for(var e=0,t=this.m_rgLoaders;e<t.length;e++){var n=t[e];if(n.ContainsAudio())return n}return null},e.prototype.GetGameLoader=function(){for(var e=0,t=this.m_rgLoaders;e<t.length;e++){var n=t[e];if(n.ContainsGame())return n}return null},e.prototype.SetTrackBufferMS=function(e){this.m_nTrackBufferMS=e;for(var t=0,n=this.m_rgLoaders;t<n.length;t++){n[t].SetBufferMS(e)}},e.prototype.BeginPlayback=function(){var e=0;if(this.IsLiveContent()){var t=wn(this.GetCurrentVideoAdaptation()),n=1e3*this.m_mpd.GetMinBufferTime(),o=Math.max(t,n);this.SetTrackBufferMS(o),e=this.GetBufferedLiveEdgeTime(),fn("Begin playback [this.buffer="+this.m_nTrackBufferMS+"][nStartTime="+e+"]")}else this.SetTrackBufferMS(8e3),e=0;fn("Starting playback at "+e);for(var i=this.PickStartingVideoRepresentation(),r=0,a=this.m_rgLoaders;r<a.length;r++){var s=a[r];if(s.ContainsVideo()){s.ChangeRepresentation(i);t=wn(s.GetAdaptation());this.m_schFirstFrameThrottler.Schedule(t/2,this.VerifyFirstSegementDownloadProgress)}else if(s.ContainsAudio()||s.ContainsGame()){var c=0<s.GetAdaptation().rgRepresentations.length?s.GetAdaptation().rgRepresentations[0]:null;s.ChangeRepresentation(c)}}this.Seek(e),this.GetGameLoader()&&this.m_schGameDataEventTrigger.Schedule(500,this.GameDataEventTrigger)},e.prototype.VerifyFirstSegementDownloadProgress=function(){var e=this.GetVideoLoader();if(null===this.m_videoRepSelected&&e&&e.GetDownloadHistory().length<=1&&0<e.GetActiveDownloads()&&e.GetActiveDownloadProgress()<.55){var t=this.DetermineBestVideoRepresentation();t&&!e.BIsCurrentRepresentation(t)&&(e.ChangeRepresentation(t),e.ForceRestartDownload(),fn("Video download progressing too slowly, choosing "+t.nWidth+"x"+t.nHeight+"@"+t.nFrameRate+" instead"))}},e.prototype.PickStartingVideoRepresentation=function(){var e=this.GetVideoLoader();if(!e)return null;for(var t=e.GetAdaptation(),n=null,o=e.GetRepresentationsCount()-1;0<=o;o--){var i=t.rgRepresentations[o],r=i.nFrameRate?i.nFrameRate:0;if(!(0<this.m_nLimitFPS&&r>this.m_nLimitFPS)&&(n=i,this.GetVideoPlayerHeight()<=i.nHeight))break}return n},e.prototype.DetermineBestVideoRepresentation=function(){for(var e=this.GetVideoLoader(),t=this.GetAudioLoader(),n=t&&t!=e?t.GetEstimatedAudioRate():0,o=this.GetAvgLoaderDownloadRate(),i=e.GetRepresentationsCount()-1,r=e.GetAdaptation().rgRepresentations[i],a=i-1;0<=a;a--){var s=e.GetAdaptation().rgRepresentations[a],c=(s.nBandwidth+n)*this.m_elVideo.playbackRate*1.15;if(o<c)fn("Video select: Skipping "+a+" due to rate: [avg="+o+"][required="+c+"]");else{var l=s.nFrameRate||0;if(this.IsLiveContent()&&30<l){var p=this.m_stats.GetFPSMonitor();if(p.BIsDroppingFrames()||p.BHasCurrentFPS()&&Math.ceil(p.GetCurrentFPS())<29){fn("Video select: Skipping "+a+" due to dropping frames and high FPS representation: [fps:"+l+"]");continue}}if(0<this.m_nLimitFPS&&l>this.m_nLimitFPS)fn("Video select: Skipping "+a+" due to frame rate limit");else{var u=r.nHeight||0,m=s.nHeight||0,d=this.GetVideoPlayerHeight();if(0<d&&0<u)if(zn(d)<m)break;r=s}}}return r},e.prototype.UpdateVideoRepresentation=function(e){if(e&&this.m_videoRepSelected==e)return null;var t=this.GetVideoLoader();if(!t)return null;if(this.IsBuffering())return null;var n=this.DetermineBestVideoRepresentation();return this.m_videoRepSelected=null,t.ChangeRepresentation(n)},e.prototype.CanSeek=function(){return!0},e.prototype.SeekAndPlay=function(e){return this.m_bUserPlayChoice=!0,this.Seek(e)},e.prototype.Seek=function(e){var t=this.GetAvailableVideoStartTime(),n=this.GetBufferedLiveEdgeTime();e=_n.a(e,t,n),this.m_bUserLiveEdgeChoice=n-5<=e;var o=this.m_elVideo.paused;o||this.m_elVideo.pause(),this.m_bIsBuffering=!0,this.m_nSeekingToTime=e;for(var i=0,r=this.m_rgLoaders;i<r.length;i++){var a=r[i];a.ContainsGame()&&(e=this.GetBufferedLiveEdgeTime()),a.Seek(e)}return this.DispatchEvent("valve-bufferupdate"),o&&this.OnVideoBufferProgress(),e},e.prototype.JumpTime=function(e){return e+=this.GetCurrentPlayTime(),this.Seek(e)},e.prototype.GetVideoPlayerHeight=function(){return this.m_elVideo.clientHeight},e.prototype.GetAvgLoaderDownloadRate=function(){for(var e=0,t=0,n=0,o=[this.GetVideoLoader()];n<o.length;n++){var i=o[n];i&&(e+=i.GetAvgDownloadRate(),t++)}return 0==t?0:e/t},e.prototype.GameDataEventTrigger=function(){var e=this.GetGameLoader();if(e){var t=e.GetGameDataFrames(),n=-1;if(0<=(n=t.length-1)){var o=t[n];o.pts!=this.m_nGameDataLastFramePTS&&(this.m_nGameDataLastFramePTS=o.pts,o.gamedata.appid=e.GetLatestGameDataFrameAppID(),this.DispatchEvent("valve-gamedataupdate",o))}this.m_schGameDataEventTrigger.Schedule(500,this.GameDataEventTrigger)}},e.prototype.DispatchEvent=function(e,t){void 0===t&&(t=null);var n=new CustomEvent(e,{cancelable:!0,bubbles:!0,detail:t});this.m_elVideo.dispatchEvent(n)},e.prototype.IsMuted=function(){return this.m_elVideo.muted},e.prototype.SetMuted=function(e){this.m_elVideo.muted=e},e.prototype.SetVolume=function(e){e=_n.a(e,0,1),this.m_elVideo.volume=e},e.prototype.GetVolume=function(){return this.m_elVideo.volume},e.prototype.GetDASHPlayerStats=function(){return this.m_stats},e.prototype.ReportPlayerStats=function(){this.m_stats.ReportPlayerStats(this.m_rgLoaders,this.m_elVideo),this.m_schReportPlayerTrigger.Schedule(3e5,this.ReportPlayerStats)},e.prototype.SetStatsViewIsVisible=function(e){e&&!this.m_bStatsViewVisible?(this.CaptureStatsForDisplay(),this.m_schCaptureDisplayStatsTrigger.Schedule(250,this.CaptureStatsForDisplay)):!e&&this.m_bStatsViewVisible&&this.m_schCaptureDisplayStatsTrigger.Cancel(),this.m_bStatsViewVisible=e},e.prototype.CaptureStatsForDisplay=function(){this.m_stats.SetHTMLVideoPlayerDisplay(this.m_elVideo.videoWidth,this.m_elVideo.videoHeight,this.m_elVideo.clientWidth,this.m_elVideo.clientHeight),this.m_stats.CaptureFrequentlyUpdatingInformation(this.m_elVideo,this.m_rgLoaders),this.m_schCaptureDisplayStatsTrigger.Schedule(250,this.CaptureStatsForDisplay)},e.prototype.GetVideoRepresentations=function(){var e=[];e.push({id:"auto",displayName:"Auto",selected:null===this.m_videoRepSelected});var t=this.GetCurrentVideoAdaptation();if(t)for(var n=0,o=t.rgRepresentations;n<o.length;n++){var i=o[n],r=this.m_videoRepSelected&&this.m_videoRepSelected.strID==i.strID,a=i.nFrameRate;50<a&&i.nFrameRate<70?a=60:25<a&&a<35&&(a=30);var s=i.nWidth+"x"+i.nHeight+" @ "+a+"fps";e.push({id:i.strID,displayName:s,selected:r})}return e},e.prototype.SetVideoRepresentation=function(e){var t=!0,n=this.GetVideoLoader();if(e&&"auto"!=e.id){var o=n.GetRepresentationByID(e.id);o&&(t=!1,null!==this.m_videoRepSelected&&this.m_videoRepSelected.strID==o.strID||(this.m_videoRepSelected=o,n.ChangeRepresentation(o),this.Seek(this.m_elVideo.currentTime)))}t&&(this.m_videoRepSelected=null)},R.c([T.a],e.prototype,"UpdateMPD",null),R.c([T.a],e.prototype,"OnMediaSourceOpen",null),R.c([T.a],e.prototype,"OnMediaSourceEnded",null),R.c([T.a],e.prototype,"OnMediaSourceClose",null),R.c([T.a],e.prototype,"OnVideoWaiting",null),R.c([T.a],e.prototype,"OnVideoPause",null),R.c([T.a],e.prototype,"OnVideoResize",null),R.c([T.a],e.prototype,"OnDebugPrintEventInfoAndAvailableBuffer",null),R.c([T.a],e.prototype,"OnVideoError",null),R.c([T.a],e.prototype,"OnVideoCanPlay",null),R.c([T.a],e.prototype,"GetCurrentPlayTime",null),R.c([T.a],e.prototype,"OnVideoTimeUpdate",null),R.c([T.a],e.prototype,"GetPlaybackRate",null),R.c([T.a],e.prototype,"OnSegmentDownloaded",null),R.c([T.a],e.prototype,"PlayOnElement",null),R.c([T.a],e.prototype,"OnSegmentDownloadFailed",null),R.c([T.a],e.prototype,"OnSegmentDownloadGone",null),R.c([T.a],e.prototype,"VerifyFirstSegementDownloadProgress",null),R.c([T.a],e.prototype,"GameDataEventTrigger",null),R.c([T.a],e.prototype,"ReportPlayerStats",null),R.c([d.action.bound],e.prototype,"CaptureStatsForDisplay",null),e}();function zn(e){return e<360?480:e<480?720:4320}var qn=function(){function e(e){this.m_elVideo=null,this.m_peerConnection=null,this.m_schCandidateTimer=new L,this.m_elVideo=e}return e.prototype.PlayMPD=function(e){},e.prototype.PlayWebRTC=function(o,i,r,a,s){return R.b(this,void 0,void 0,function(){var t,n=this;return R.e(this,function(e){return this.m_strBroadcastSteamID=o,this.m_ulWebRTCSessionID=r,this.m_nHostCandidateGeneration=0,t={iceServers:[{urls:["stun:"+a]},{urls:["turn:"+a],username:i,credential:r}],iceTransportPolicy:"relay"},this.m_peerConnection=new RTCPeerConnection(t),this.m_peerConnection.oniceconnectionstatechange=function(e){n.m_peerConnection&&(console.log("BroadcastWebRTC: ICE connection state changed to "+n.m_peerConnection.iceConnectionState),"failed"===n.m_peerConnection.iceConnectionState?n.OnWebRTCConnectionFailed():"disconnected"===n.m_peerConnection.iceConnectionState&&n.OnWebRTCConnectionRetry())}.bind(this),this.m_peerConnection.onicecandidate=function(e){if(e.candidate){var t=new FormData;t.append("broadcaststeamid",n.m_strBroadcastSteamID),t.append("webrtc_session_id",n.m_ulWebRTCSessionID),t.append("sdp_mid",e.candidate.sdpMid),t.append("sdp_mline_index",String(e.candidate.sdpMLineIndex)),t.append("candidate",e.candidate.candidate),C.a.post(_.b.CHAT_BASE_URL+"broadcast/addbroadcastwebrtccandidate",t).then(function(e){var t=e.data;t.success&&1==t.success||console.log("Failed to add a WebRTC session ICE candidate: "+String(t.success))}).catch(function(e){return console.log("Failed to add a WebRTC session ICE candidate"+e)})}}.bind(this),this.m_peerConnection.ontrack=function(e){"video"===e.track.kind&&(n.m_elVideo.src=null,n.m_elVideo.srcObject=e.streams[0],n.m_elVideo.play())}.bind(this),this.m_peerConnection.setRemoteDescription({type:"offer",sdp:s}).then(function(){return R.b(n,void 0,void 0,function(){var t,n,o,i,r=this;return R.e(this,function(e){switch(e.label){case 0:return n=(t=this.m_peerConnection).setLocalDescription,[4,this.m_peerConnection.createAnswer()];case 1:return[4,n.apply(t,[e.sent()])];case 2:e.sent(),(o=new FormData).append("broadcaststeamid",this.m_strBroadcastSteamID),o.append("webrtc_session_id",this.m_ulWebRTCSessionID),o.append("answer",this.m_peerConnection.localDescription.sdp),e.label=3;case 3:return e.trys.push([3,5,,6]),[4,C.a.post(_.b.CHAT_BASE_URL+"broadcast/setbroadcastwebrtcanswer",o).then(function(e){var t=e.data;if(!t.success||1!=t.success)throw new Error(String(t.success))})];case 4:return e.sent(),[3,6];case 5:return i=e.sent(),console.log("Failed to set the WebRTC session answer: "+i),this.OnWebRTCConnectionRetry(),[2];case 6:return this.m_nCandidateUpdateIntervalMS=250,this.m_schCandidateTimer.Schedule(this.m_nCandidateUpdateIntervalMS,function(){return r.GetHostCandidates()}),[2]}})})}),[2]})})},e.prototype.GetHostCandidates=function(){return R.b(this,void 0,void 0,function(){var t,n,o=this;return R.e(this,function(e){switch(e.label){case 0:(t=new FormData).append("broadcaststeamid",this.m_strBroadcastSteamID),t.append("webrtc_session_id",this.m_ulWebRTCSessionID),t.append("candidate_generation",String(this.m_nHostCandidateGeneration)),e.label=1;case 1:return e.trys.push([1,3,,4]),[4,C.a.post(_.b.CHAT_BASE_URL+"broadcast/getbroadcastwebrtccandidates",t).then(function(e){var t=e.data,n=t.data;if(!t.success||1!=t.success)throw new Error(String(t.success));n.candidate_generation>o.m_nHostCandidateGeneration?(n.candidates.forEach(function(e){var t=new RTCIceCandidate({sdpMid:e.sdp_mid,sdpMLineIndex:e.sdp_mline_index,candidate:e.candidate});o.m_peerConnection.addIceCandidate(t).catch(function(e){return console.error(e)})}),o.m_nHostCandidateGeneration=n.candidate_generation):0<o.m_nHostCandidateGeneration&&(o.m_nCandidateUpdateIntervalMS*=2)})];case 2:return e.sent(),[3,4];case 3:return n=e.sent(),console.log("Failed to get WebRTC session ICE candidates"+n),this.OnWebRTCConnectionRetry(),[2];case 4:return this.m_schCandidateTimer.Schedule(this.m_nCandidateUpdateIntervalMS,function(){return o.GetHostCandidates()}),[2]}})})},e.prototype.OnWebRTCConnectionRetry=function(){var e=new CustomEvent("valve-webrtcretry",{cancelable:!0,bubbles:!0,detail:null});this.m_elVideo.dispatchEvent(e)},e.prototype.OnWebRTCConnectionFailed=function(){var e=new CustomEvent("valve-webrtcfailed",{cancelable:!0,bubbles:!0,detail:null});this.m_elVideo.dispatchEvent(e)},e.prototype.Close=function(){this.m_schCandidateTimer.Cancel(),this.m_peerConnection&&(this.m_peerConnection.close(),this.m_peerConnection=null),this.m_elVideo.pause(),this.m_elVideo.srcObject=null},e.prototype.IsBuffering=function(){return!1},e.prototype.GetCurrentPlayTime=function(){return 0},e.prototype.GetLiveContentStartTime=function(){return null},e.prototype.GetAvailableVideoStartTime=function(){return 0},e.prototype.GetBufferedLiveEdgeTime=function(){return 0},e.prototype.IsPaused=function(){return this.m_elVideo.paused},e.prototype.Play=function(){this.m_elVideo.play()},e.prototype.Pause=function(){this.m_elVideo.pause()},e.prototype.CanSeek=function(){return!1},e.prototype.SeekAndPlay=function(e){return this.m_elVideo.play(),0},e.prototype.Seek=function(e){return 0},e.prototype.JumpTime=function(e){return 0},e.prototype.IsMuted=function(){return this.m_elVideo.muted},e.prototype.SetMuted=function(e){this.m_elVideo.muted=e},e.prototype.SetVolume=function(e){e=_n.a(e,0,1),this.m_elVideo.volume=e},e.prototype.GetVolume=function(){return this.m_elVideo.volume},e.prototype.GetDASHPlayerStats=function(){return null},e.prototype.SetStatsViewIsVisible=function(e){},e.prototype.GetVideoRepresentations=function(){var e=[];return e.push({id:"auto",displayName:"Auto",selected:!0}),e},e.prototype.SetVideoRepresentation=function(e){},R.c([T.a],e.prototype,"PlayWebRTC",null),e}(),Kn=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return R.d(t,e),t}(Error),Yn=function(n){function e(e){var t=n.call(this)||this;return t.m_appid=e||0,t}return R.d(e,n),e.prototype.parseColor=function(e){if("string"!=typeof e||!e.match(/^#[0-9a-fA-F]{6}$/))throw new Kn("expected color string");return[parseInt(e.substring(1,3),16),parseInt(e.substring(3,5),16),parseInt(e.substring(5,7),16)]},e.prototype.parseString=function(e){if("string"==typeof e)return e;throw new Kn("expected string")},e.prototype.parseNumber=function(e){if("number"==typeof e)return e;throw new Kn("expected number")},e.prototype.parseDate=function(e){if("number"==typeof e)return new Date(e);throw new Kn("expected timestamp")},e.prototype.parseArray=function(e,t){var n=[];if("object"!=typeof e||!Array.isArray(e))throw new Kn("expected array");for(var o=e.length,i=0;i<o;++i)try{n.push(t(e[i]))}catch(e){throw e.message+="\n...while parsing array element "+i,e}return n},e.prototype.parseDict=function(e,t){var n=new Map;if("object"!=typeof e||Array.isArray(e))throw new Kn("expected object");for(var o in e)try{n.set(o,t(e[o]))}catch(e){throw e.message+="\n...while parsing dictionary element "+o,e}return n},e.prototype.parseBracket=function(e){var t={name:this.parseString(e.name),start:this.parseDate(e.start),color:[255,0,255]};return"params"in e&&(t.params=this.parseDict(e.params,this.parseString.bind(this))),"end"in e&&(t.end=this.parseDate(e.end)),"color"in e&&(t.color=this.parseColor(e.color)),t},e.prototype.parseMarker=function(e){var t={time:this.parseDate(e.time),color:[0,255,255]};return"name"in e&&(t.name=this.parseString(e.name)),"params"in e&&(t.params=this.parseDict(e.params,this.parseString.bind(this))),"color"in e&&(t.color=this.parseColor(e.color)),t},e.prototype.parseBroadcastGameData=function(e){var t={appid:0,brackets:[],markers:[]};return"appid"in e&&(t.appid=this.parseNumber(e.appid)),"brackets"in e&&(t.brackets=this.parseArray(e.brackets,this.parseBracket.bind(this))),"markers"in e&&(t.markers=this.parseArray(e.markers,this.parseMarker.bind(this))),t},e.prototype.convertTime=function(e,t){return e.getTime()/1e3-t},e.prototype.LocalizeTokenIfPossible=function(e,t){return le.Localize(this.m_appid,e,t)},e.prototype.UpdateMarkers=function(t,e){var n;try{n=this.parseBroadcastGameData(t)}catch(e){return console.log("failed to parse game data: "+e),console.log(t),null}n.markers.sort(function(e,t){return e.time.getTime()-t.time.getTime()}),n.brackets.sort(function(e,t){return e.start.getTime()-t.start.getTime()});for(var o=0;o<n.brackets.length;++o){void 0===(c=n.brackets[o]).end?o<n.brackets.length-1?c.end=n.brackets[o+1].start:c.end=new Date(Date.now()+36e5):c.start.getTime()>c.end.getTime()&&(c.end=c.start)}var i=[],r=[],a=e/1e3;for(o=0;o<n.markers.length;++o){var s=n.markers[o];i.push({nTime:this.convertTime(s.time,a),strLabel:this.LocalizeTokenIfPossible(s.name,s.params),color:Object(T.b)(s.color[0],s.color[1],s.color[2])})}for(o=0;o<n.brackets.length;++o){var c=n.brackets[o];r.push({nTimeStart:this.convertTime(c.start,a),nTimeEnd:this.convertTime(c.end,a),strLabel:this.LocalizeTokenIfPossible(c.name,c.params),color:Object(T.b)(c.color[0],c.color[1],c.color[2])})}return{rgMarkers:i,rgSegments:r}},e}(X),Jn=n("nDwt"),Xn=n("Dss5"),Qn=(n("q6PM"),function(){var e=window;return e&&e.g_SteamTV&&e.g_SteamTV.WebAPI()&&e.g_SteamTV.WebAPI().GetServiceTransport()}),Zn=function(e,t){for(var n in t)e.Body()["set_"+n]&&e.Body()["set_"+n](t[n])};function $n(n){return R.b(this,void 0,void 0,function(){var t;return R.e(this,function(e){switch(e.label){case 0:return t=m.Init(Jn.e),Zn(t,n),[4,Jn.a.MuteBroadcastChatUser(Qn(),t)];case 1:return[2,e.sent().Body()]}})})}var eo,to;(to=eo||(eo={}))[to.None=0]="None",to[to.Loading=1]="Loading",to[to.Ready=2]="Ready",to[to.Error=3]="Error";var no,oo,io=function(){function e(){this.m_steamIDBroadcast="",this.m_ulBroadcastID="",this.m_ulViewerToken="",this.m_bWebRTC=!1,this.m_eWatchState=eo.None,this.m_strStateDescription="",this.m_rgVideos=[],this.m_rgChats=[],this.m_schManifestTimeout=new L,this.m_schHeartbeatTimeout=new L}return e.prototype.SetState=function(e,t){void 0===t&&(t=""),this.m_eWatchState=e,this.m_strStateDescription=t,e==eo.Error&&console.log(this.m_strStateDescription)},e.prototype.GetVideoData=function(t){return this.m_rgVideos.find(function(e){return e.video==t})},R.c([d.observable],e.prototype,"m_eWatchState",void 0),R.c([d.observable],e.prototype,"m_strStateDescription",void 0),R.c([d.action],e.prototype,"SetState",null),e}(),ro=function(){function e(e){this.m_steamIDBroadcast="",this.m_strTitle="",this.m_strAppId="",this.m_strAppTitle="",this.m_strThumbnailUrl="",this.m_nViewerCount=0,this.m_bIsOnline=!1,this.m_schUpdateTimeout=new L,this.m_nRefCount=0,this.m_steamIDBroadcast=e}return R.c([d.observable],e.prototype,"m_strTitle",void 0),R.c([d.observable],e.prototype,"m_strAppId",void 0),R.c([d.observable],e.prototype,"m_strAppTitle",void 0),R.c([d.observable],e.prototype,"m_strThumbnailUrl",void 0),R.c([d.observable],e.prototype,"m_nViewerCount",void 0),R.c([d.observable],e.prototype,"m_bIsOnline",void 0),e}(),ao=function(){function e(){this.m_mapBroadcasts=new Map,this.m_activeVideo=null,this.m_activeChat=null,this.m_broadcastSettings={nVolume:1,bMuted:!1,ulViewerToken:"0"},this.m_schSaveSettings=new L,this.m_broadcastInfos={},this.LoadBroadcastSettings()}return e.prototype.GetBroadcastState=function(e){var t=this.m_mapBroadcasts.get(e);return t?t.m_eWatchState:eo.None},e.prototype.GetBroadcastStateDescription=function(e){var t=this.m_mapBroadcasts.get(e);return t?t.m_strStateDescription:""},e.prototype.StartVideo=function(e,t,n,o){console.log("Starting video for "+t),this.PauseAllVideo();var i=this.GetOrCreateBroadcast(t);var r,a=this.m_broadcastSettings,s=a.nVolume,c=a.bMuted,l=new so(this,t,e,s,c);return i.m_rgVideos.push({video:l,eWatchLocation:n}),this.m_activeVideo=l,function(){var e=!1;try{e=MediaSource.isTypeSupported('video/mp4;codecs="avc1.4d4032,mp4a.40.2"')}catch(e){}return e}()||"probably"===(r=document.createElement("video").canPlayType('application/vnd.apple.mpegurl;codecs="avc1.64001f,mp4a.40.02"'))||"maybe"===r?(i.m_eWatchState==eo.None?this.GetBroadcastManifest(i,n):i.m_eWatchState==eo.Ready&&l.Start(i),l.InitSubtitles(),l):(i.SetState(eo.Error,Object($.b)("#BroadcastWatch_MinBrowser")),null)},e.prototype.PauseAllVideo=function(){this.m_mapBroadcasts.forEach(function(e){for(var t=0,n=e.m_rgVideos;t<n.length;t++){n[t].video.StopPlaybackTillUserInput()}})},e.prototype.StopVideo=function(i){return R.b(this,void 0,void 0,function(){var t,n,o;return R.e(this,function(e){switch(e.label){case 0:if(t=i.GetBroadcastSteamID(),n=this.m_mapBroadcasts.get(t),i.Stop(),!n)return[2];(o=new FormData).append("steamid",t),o.append("broadcastid",n.m_ulBroadcastID),o.append("viewertoken",this.m_broadcastSettings.ulViewerToken),e.label=1;case 1:return e.trys.push([1,3,,4]),[4,C.a.post(_.b.CHAT_BASE_URL+"broadcast/stopwatching",o)];case 2:return e.sent(),[3,4];case 3:return e.sent(),console.error("Attempted to stop video that was not started"),[3,4];case 4:return M.e(n.m_rgVideos,function(e){return e.video==i}),this.RemoveBroadcastIfUnused(n),[2]}})})},e.prototype.StartChat=function(e,t,n){var o=this.GetOrCreateBroadcast(t),i=new co(t,e);return o.m_rgChats.push(i),this.m_activeChat=i,o.m_eWatchState==eo.None&&t?this.GetBroadcastManifest(o,n):o.m_eWatchState==eo.Ready&&i.StartForBroadcastID(o.m_ulBroadcastID),i},e.prototype.StopChat=function(e){var t=e.GetBroadcastSteamID(),n=this.m_mapBroadcasts.get(t);n&&(M.d(n.m_rgChats,e),this.RemoveBroadcastIfUnused(n),e.Stop())},e.prototype.StartInfo=function(e){var t=this.GetOrCreateBroadcastInfo(e);return t.m_nRefCount++,1===t.m_nRefCount&&this.LoadBroadcastInfo(t),t},e.prototype.StopInfo=function(e){e.m_nRefCount--,0===e.m_nRefCount&&(e.m_schUpdateTimeout.Cancel(),delete this.m_broadcastInfos[e.m_steamIDBroadcast])},e.prototype.GetOrCreateBroadcastInfo=function(e){if(!this.m_broadcastInfos[e]){var t=new ro(e);this.m_broadcastInfos[e]=t}return this.m_broadcastInfos[e]},e.prototype.GetOrCreateBroadcast=function(e){var t=this.m_mapBroadcasts.get(e);return t||((t=new io).m_steamIDBroadcast=e,t.m_eWatchState=eo.None,this.m_mapBroadcasts.set(e,t),t)},e.prototype.RemoveBroadcastIfUnused=function(e){e.m_rgVideos.length||e.m_rgChats.length||(e.m_schHeartbeatTimeout.Cancel(),e.m_schManifestTimeout.Cancel(),this.m_mapBroadcasts.delete(e.m_steamIDBroadcast))},e.prototype.LoadBroadcastInfo=function(c){return R.b(this,void 0,void 0,function(){var t,n,o,i,r,a,s=this;return R.e(this,function(e){switch(e.label){case 0:t="0",(n=this.m_mapBroadcasts.get(c.m_steamIDBroadcast))&&(t=n.m_ulBroadcastID),o={steamid:c.m_steamIDBroadcast,broadcastid:t},e.label=1;case 1:return e.trys.push([1,3,,4]),[4,C.a.get(_.b.CHAT_BASE_URL+"broadcast/getbroadcastinfo/",{params:o})];case 2:return(i=e.sent())&&i.data?(r=i.data,c.m_strTitle=r.title,c.m_strAppId=r.appid,c.m_strAppTitle=r.app_title,c.m_strThumbnailUrl=r.thumbnail_url,c.m_nViewerCount=r.viewer_count,c.m_bIsOnline=r.is_online,(a=r.update_interval)&&"number"==typeof a&&c.m_schUpdateTimeout.Schedule(1e3*a,function(){return s.LoadBroadcastInfo(c)}),[3,4]):[2];case 3:return e.sent(),[3,4];case 4:return[2]}})})},e.prototype.GetBroadcastManifest=function(c,l,p){return void 0===p&&(p=Date.now()),R.b(this,void 0,void 0,function(){var t,n,o,i,r,a,s=this;return R.e(this,function(e){switch(e.label){case 0:c.SetState(eo.Loading,""),t={steamid:c.m_steamIDBroadcast,broadcastid:0,viewertoken:this.m_broadcastSettings.ulViewerToken,watchlocation:l,sessionid:_.b.SESSIONID,is_webrtc:c.m_bWebRTC},n=null,e.label=1;case 1:return e.trys.push([1,3,,4]),[4,C.a.get(_.b.CHAT_BASE_URL+"broadcast/getbroadcastmpd/",{params:t,withCredentials:!0})];case 2:return n=e.sent(),[3,4];case 3:return o=e.sent(),console.error(o),console.log("Failed to get broadcast manifest!"),[3,4];case 4:if(!n||200!=n.status)return c.SetState(eo.Error,Object($.b)("#BroadcastWatch_RequestFailed")),[2];if(i=n.data,this.SetBroadcastStateFromManifestResponse(c,i),i.viewertoken&&this.SetViewerToken(i.viewertoken),"waiting"==i.success){if(6e4<(r=Date.now()-p))return c.SetState(eo.Error,Object($.b)("#BroadcastWatch_NotAvailable")),[2];a=3e4<r?i.retry:5e3,c.m_schManifestTimeout.Schedule(a,function(){return s.GetBroadcastManifest(c,l,p)})}else"waiting_for_start"==i.success?c.m_schManifestTimeout.Schedule(i.retry,function(){return s.GetBroadcastManifest(c,l,p)}):"waiting_for_reconnect"==i.success?c.m_schManifestTimeout.Schedule(i.retry,function(){return s.GetBroadcastManifest(c,l,p)}):"ready"==i.success&&(c.m_ulBroadcastID=i.broadcastid,c.m_ulViewerToken=this.m_broadcastSettings.ulViewerToken,c.m_bWebRTC=i.is_webrtc,c.m_data=i,this.LoadBroadcast(c),c.m_schHeartbeatTimeout.Schedule(1e3*c.m_data.heartbeat_interval,function(){return s.HeartbeatBroadcast(c)}));return[2]}})})},e.prototype.HeartbeatBroadcast=function(o){return R.b(this,void 0,void 0,function(){var t,n=this;return R.e(this,function(e){return(t=new FormData).append("steamid",o.m_steamIDBroadcast),t.append("broadcastid",o.m_ulBroadcastID),t.append("viewertoken",this.m_broadcastSettings.ulViewerToken),C.a.post(_.b.CHAT_BASE_URL+"broadcast/heartbeat/",t),o.m_schHeartbeatTimeout.Schedule(1e3*o.m_data.heartbeat_interval,function(){return n.HeartbeatBroadcast(o)}),[2]})})},e.prototype.SetBroadcastStateFromManifestResponse=function(e,t){var n=t.success;"waiting"==n?e.SetState(eo.Loading,Object($.b)("#BroadcastWatch_WaitingForResponse")):"waiting_for_start"==n?e.SetState(eo.Loading,Object($.b)("#BroadcastWatch_WaitingForStart")):"waiting_for_reconnect"==n?e.SetState(eo.Loading,Object($.b)("#BroadcastWatch_WaitingForReconnect")):"ready"==n?e.SetState(eo.Ready):"end"==n?e.SetState(eo.Error,Object($.b)("#BroadcastWatch_NotAvailable")):"noservers"==n?e.SetState(eo.Error,Object($.b)("#BroadcastWatch_ServerLoad")):"system_not_supported"==n?e.SetState(eo.Error,Object($.b)("#BroadcastWatch_SystemNotSupported")):"user_restricted"==n?e.SetState(eo.Error,Object($.b)("#BroadcastWatch_UserRestricted")):"poor_upload_quality"==n?e.SetState(eo.Error,Object($.b)("#BroadcastWatch_PoorUploadQuality")):"request_failed"==n?e.SetState(eo.Error,Object($.b)("#BroadcastWatch_RequestFailed")):e.SetState(eo.Error,Object($.b)("#BroadcastWatch_NotAvailable"))},e.prototype.LoadBroadcast=function(e){var t=this;0<=e.m_rgVideos.findIndex(function(e){return e.video==t.m_activeVideo})&&this.m_activeVideo.Start(e),0<=e.m_rgChats.findIndex(function(e){return e==t.m_activeChat})&&this.m_activeChat.StartForBroadcastID(e.m_ulBroadcastID)},e.prototype.BroadcastDownloadFailed=function(e,t){void 0===t&&(t=!0),e.Stop();var n=this.m_mapBroadcasts.get(e.GetBroadcastSteamID());if(n&&n.m_eWatchState!=eo.Loading){n.m_bWebRTC&&t&&(n.m_bWebRTC=!1);var o=n.GetVideoData(e);this.GetBroadcastManifest(n,o.eWatchLocation)}},e.prototype.UserInputClickVideo=function(e){if(this.m_activeVideo!=e){this.PauseAllVideo();var t=this.m_mapBroadcasts.get(e.GetBroadcastSteamID()),n=t.GetVideoData(e);return this.m_activeVideo=e,void this.GetBroadcastManifest(t,n.eWatchLocation)}e.UserInputClick()},e.prototype.LoadBroadcastSettings=function(){if(window.localStorage){var e=window.localStorage.getItem("broadcastSettings");if(e){var t=JSON.parse(e);if(t){Object.assign(this.m_broadcastSettings,t);var n=this.m_broadcastSettings;n.bMuted=!!n.bMuted,n.nVolume=_n.a(n.nVolume,0,1),"string"!=typeof n.ulViewerToken&&(n.ulViewerToken="0")}}}},e.prototype.SaveBroadcastSettings=function(){var e=this;window.localStorage&&this.m_schSaveSettings.Schedule(1e3,function(){try{window.localStorage.setItem("broadcastSettings",JSON.stringify(e.m_broadcastSettings))}catch(e){}})},e.prototype.SetViewerToken=function(e){this.m_broadcastSettings.ulViewerToken!=e&&(this.m_broadcastSettings.ulViewerToken=e,this.SaveBroadcastSettings())},e.prototype.SaveVolumeChange=function(e,t){this.m_broadcastSettings.nVolume==e&&this.m_broadcastSettings.bMuted==t||(this.m_broadcastSettings.nVolume=e,this.m_broadcastSettings.bMuted=t,this.SaveBroadcastSettings())},e}();(oo=no||(no={}))[oo.Timeline=1]="Timeline",oo[oo.Minimap=2]="Minimap";var so=function(){function e(e,t,n,o,i){this.m_store=null,this.m_steamID=null,this.m_elVideo=null,this.m_player=null,this.m_listeners=new k,this.m_gameDataParser=null,this.m_info=null,this.m_rgSubtitles=[],this.m_bPaused=!1,this.m_nPlaybackTime=0,this.m_bBuffering=!1,this.m_bOnLiveEdge=!1,this.m_nVolume=0,this.m_bMuted=!1,this.m_bUserInputNeeded=!1,this.m_nTimelineDuration=1800,this.m_nVideoStartPos=0,this.m_nVideoEndPos=0,this.m_rgMarkers=d.observable.array(),this.m_rgSegments=d.observable.array(),this.m_store=e,this.m_steamID=t,this.m_elVideo=n,this.m_nVolume=o,this.m_bMuted=i}return e.prototype.GetBroadcastSteamID=function(){return this.m_steamID},e.prototype.IsPaused=function(){return this.m_bPaused},e.prototype.GetPlaybackTime=function(){return this.m_nPlaybackTime},e.prototype.SetStatsViewIsVisible=function(e){this.m_player&&this.m_player.SetStatsViewIsVisible(e)},e.prototype.GetDASHPlayerStats=function(){return this.m_player.GetDASHPlayerStats()},e.prototype.BHasDASHStats=function(){return null!=this.m_player},e.prototype.IsTimelineMapActive=function(){return!1},e.prototype.CanSeek=function(){return this.m_player&&this.m_player.CanSeek()},e.prototype.IsBuffering=function(){return this.m_bBuffering},e.prototype.IsOnLiveEdge=function(){return this.m_bOnLiveEdge},e.prototype.GetVideoAvailableStartTime=function(){return this.m_nVideoStartPos},e.prototype.GetVolume=function(){return this.m_nVolume},e.prototype.GetUserInputNeeded=function(){return this.m_bUserInputNeeded},e.prototype.GetVideoRepresentations=function(){return this.m_player?this.m_player.GetVideoRepresentations():[]},e.prototype.SetVideoRepresentation=function(e){this.m_player.SetVideoRepresentation(e)},e.prototype.GetBroadcastInfo=function(){return this.m_info},e.prototype.ListSubtitles=function(){return this.m_elVideo.textTracks},e.prototype.GetSubtitles=function(){for(var e=0;e<this.m_elVideo.textTracks.length;e++){var t=this.m_elVideo.textTracks[e];if("showing"===t.mode)return t}return null},e.prototype.SetSubtitles=function(e){for(var t=0;t<this.m_elVideo.textTracks.length;t++){var n=this.m_elVideo.textTracks[t];n.language===e?n.mode="showing":n.mode="disabled"}},e.prototype.Start=function(e){Object(I.a)(!this.m_player,"Initialized twice?"),this.m_listeners.AddEventListener(this.m_elVideo,"playing",this.OnVideoPlaying),this.m_listeners.AddEventListener(this.m_elVideo,"pause",this.OnVideoPause),this.m_listeners.AddEventListener(this.m_elVideo,"timeupdate",this.OnVideoTimeUpdate),this.m_listeners.AddEventListener(this.m_elVideo,"valve-bufferupdate",this.OnVideoTimeUpdate),this.m_listeners.AddEventListener(this.m_elVideo,"valve-gamedataupdate",this.OnGameDataUpdate),this.m_listeners.AddEventListener(this.m_elVideo,"valve-downloadfailed",this.OnDownloadFailed),this.m_listeners.AddEventListener(this.m_elVideo,"valve-webrtcretry",this.OnWebRTCRetry),this.m_listeners.AddEventListener(this.m_elVideo,"valve-webrtcfailed",this.OnWebRTCFailed),this.m_listeners.AddEventListener(this.m_elVideo,"valve-userinputneeded",this.OnUserInputNeeded),this.m_bPaused=!1,this.m_nPlaybackTime=0,this.m_bBuffering=!1,this.m_nTimelineDuration=1800,this.m_nVideoStartPos=0,this.m_nVideoEndPos=0,this.m_rgMarkers.clear(),this.m_rgSegments.clear(),this.m_bUserInputNeeded=!1,e.m_data.url?(this.m_player=new Wn(this.m_elVideo),this.m_player.PlayMPD(e.m_data.url)):(this.m_player=new qn(this.m_elVideo),this.m_player.PlayWebRTC(this.m_steamID,e.m_ulViewerToken,e.m_data.webrtc_session_id,e.m_data.webrtc_turn_server,e.m_data.webrtc_offer_sdp));var t=this.m_player.GetDASHPlayerStats();t&&(t.SetBroadcasterAndViewerInfo(this.m_steamID,_.e.steamid,e.m_ulBroadcastID,e.m_ulViewerToken),fn("DASH Stat Object",t)),this.SetVolume(this.m_nVolume),this.m_player.SetMuted(this.m_bMuted),this.m_info=this.m_store.StartInfo(this.m_steamID)},e.prototype.InitSubtitles=function(){var n=this;"76561198894692971"===this.m_steamID&&(this.m_rgSubtitles=["english","spanish"],setInterval(function(){return R.b(n,void 0,void 0,function(){var n,o;return R.e(this,function(e){switch(e.label){case 0:return[4,C.a.get("/public/steamawards_offset.json")];case 1:return n=e.sent().data.offsetSeconds,(o=this.GetSubtitles())&&o.currentOffset!==n&&(Array.from(o.cues||[]).forEach(function(e){var t=n-(o.currentOffset||0);e.startTime+=t,e.endTime+=t}),o.currentOffset=n),[2]}})})},5e3)),this.m_rgSubtitles.forEach(function(e){var t=document.createElement("track");t.kind="subtitles",t.srclang=e,t.src="/public/steamawards_"+e+".vtt",n.m_elVideo.appendChild(t)}),"english"!==_.b.LANGUAGE&&this.SetSubtitles(_.b.LANGUAGE)},e.prototype.Stop=function(){this.m_listeners.Unregister(),this.m_info&&(this.m_store.StopInfo(this.m_info),this.m_info=null),this.m_gameDataParser=null,this.m_player&&(this.m_player.Close(),this.m_player=null)},e.prototype.TogglePlayPause=function(){this.m_player.IsPaused()?this.m_player.Play():this.m_player.Pause()},e.prototype.JumpTime=function(e){this.m_player.JumpTime(e)},e.prototype.Seek=function(e){this.m_player.Seek(e)},e.prototype.SeekAndPlay=function(e){this.m_player.SeekAndPlay(e)},e.prototype.JumpToLiveEdge=function(){this.SeekAndPlay(this.m_player.GetBufferedLiveEdgeTime())},e.prototype.SetVolume=function(e){this.m_player.SetVolume(e),this.m_nVolume=this.m_player.GetVolume(),this.m_store.SaveVolumeChange(e,this.m_bMuted)},e.prototype.SetMute=function(e){this.m_player.SetMuted(e),this.m_bMuted=e,this.m_store.SaveVolumeChange(this.m_nVolume,e)},e.prototype.IsMuted=function(){return this.m_bMuted},e.prototype.OnVideoPlaying=function(){this.m_bPaused=!1},e.prototype.OnVideoPause=function(){this.m_bPaused=!0},e.prototype.OnVideoTimeUpdate=function(){this.m_nPlaybackTime=this.m_player.GetCurrentPlayTime(),this.m_nVideoStartPos=this.m_player.GetAvailableVideoStartTime(),this.m_nVideoEndPos=Math.max(this.m_player.GetBufferedLiveEdgeTime(),this.m_nPlaybackTime),this.m_bBuffering=this.m_player.IsBuffering(),this.m_bOnLiveEdge=this.m_nVideoEndPos-this.m_nPlaybackTime<5,this.m_player.IsPaused()&&(this.m_bOnLiveEdge=!1)},e.prototype.OnGameDataUpdate=function(e){var t=e.detail;if(t&&"object"==typeof t.gamedata){this.m_gameDataParser||(this.m_gameDataParser=new Yn(t.gamedata.appid));var n=this.m_player.GetLiveContentStartTime().getTime(),o=this.m_gameDataParser.UpdateMarkers(t.gamedata,n);if(o)this.m_rgMarkers.replace(o.rgMarkers||[]),this.m_rgSegments.replace(o.rgSegments||[]);else;}},e.prototype.OnDownloadFailed=function(){this.m_store.BroadcastDownloadFailed(this)},e.prototype.OnWebRTCRetry=function(){this.m_store.BroadcastDownloadFailed(this,!1)},e.prototype.OnWebRTCFailed=function(){this.m_store.BroadcastDownloadFailed(this,!0)},e.prototype.OnUserInputNeeded=function(){this.m_bUserInputNeeded=!0},e.prototype.UserInputClick=function(){this.m_bUserInputNeeded=!1,this.JumpToLiveEdge()},e.prototype.StopPlaybackTillUserInput=function(){this.Stop(),this.OnUserInputNeeded()},e.prototype.GetTimelineStartPos=function(){return this.m_nVideoEndPos-this.m_nTimelineDuration},e.prototype.GetTimelineDuration=function(){return this.m_nTimelineDuration},e.prototype.GetTimeAtMousePosition=function(e,t,n,o){var i=_n.c(e,t.left,t.right,n,o);return Math.floor(i+.5)},e.prototype.GetPercentOffsetFromTime=function(e,t){var n=0,o=0;return t==no.Timeline?n=(o=this.m_nVideoEndPos)-this.m_nTimelineDuration:o=n=0,_n.c(e,n,o,0,100)},e.prototype.GetTimelineMarkers=function(){return this.m_rgMarkers},e.prototype.GetTimelineSegments=function(){return this.m_rgSegments},e.prototype.BHasMarkersOrSegments=function(){return this.has_segments||this.has_markers},Object.defineProperty(e.prototype,"has_markers",{get:function(){return 0<this.m_rgMarkers.length},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"has_segments",{get:function(){return 0<this.m_rgSegments.length},enumerable:!0,configurable:!0}),R.c([d.observable],e.prototype,"m_bPaused",void 0),R.c([d.observable],e.prototype,"m_nPlaybackTime",void 0),R.c([d.observable],e.prototype,"m_bBuffering",void 0),R.c([d.observable],e.prototype,"m_bOnLiveEdge",void 0),R.c([d.observable],e.prototype,"m_nVolume",void 0),R.c([d.observable],e.prototype,"m_bMuted",void 0),R.c([d.observable],e.prototype,"m_bUserInputNeeded",void 0),R.c([d.observable],e.prototype,"m_nTimelineDuration",void 0),R.c([d.observable],e.prototype,"m_nVideoStartPos",void 0),R.c([d.observable],e.prototype,"m_nVideoEndPos",void 0),R.c([d.action.bound],e.prototype,"Start",null),R.c([T.a],e.prototype,"OnVideoPlaying",null),R.c([T.a],e.prototype,"OnVideoPause",null),R.c([d.action.bound],e.prototype,"OnVideoTimeUpdate",null),R.c([d.action.bound],e.prototype,"OnGameDataUpdate",null),R.c([T.a],e.prototype,"OnDownloadFailed",null),R.c([T.a],e.prototype,"OnWebRTCRetry",null),R.c([T.a],e.prototype,"OnWebRTCFailed",null),R.c([T.a],e.prototype,"OnUserInputNeeded",null),R.c([d.computed],e.prototype,"has_markers",null),R.c([d.computed],e.prototype,"has_segments",null),e}(),co=function(){function e(e,t){if(this.m_ulBroadcastChannelID="",this.m_ulChatID="",this.m_nFlairGroupID=0,this.m_iframe=null,this.m_bIframeLoaded=!1,this.m_ulBroadcastID="",this.m_broadcastSteamID="",this.m_tsFirstRequest=null,this.m_nFromFirstRequestMS=0,this.m_nNextChatTS=0,this.m_cConsecutiveErrors=0,this.m_nNudgeFactorMS=0,this.m_nLastSleepMS=0,this.m_bReconnecting=!1,this.m_unInstanceID=Math.floor(4294967296*Math.random()),this.m_strUserSteamID="",this.m_regexUserEmoticons=null,this.m_chatScheduledFunc=null,this.m_mapMutedUsers={},this.m_mapChannelModeratorUsers=new Map,this.m_nRateLimitSeconds=0,this.m_bRateLimited=!1,this.m_rgChatMessages=[],this.m_broadcastSteamID=e,t){this.m_iframe=t;var n="/community/",o=_.b.CHAT_BASE_URL;o.endsWith(n)&&(o=o.slice(0,-n.length));var i=_.b.CHAT_BASE_URL+"broadcast/watch/"+e;i+="?iframe=1&origin="+o+"&muted=1&steamtv=1&enablechat=1&enablevideo=0",t.src=i,t.onload=this.OnIframeLoaded}}return e.prototype.GetBroadcastSteamID=function(){return this.m_broadcastSteamID},e.prototype.GetUserSteamID=function(){return this.m_strUserSteamID},e.prototype.StartForBroadcastID=function(e){this.m_ulBroadcastID=e,this.m_iframe?this.m_bIframeLoaded&&this.PostMessageToIframe():this.RequestChatInfo()},e.prototype.StartForChannel=function(e){this.m_ulBroadcastChannelID=e,this.m_strUserSteamID=_.e.steamid,this.JoinChannelChat()},e.prototype.Stop=function(){this.m_chatScheduledFunc&&this.m_chatScheduledFunc.Cancel()},e.prototype.OnIframeLoaded=function(){this.m_bIframeLoaded=!0,this.m_ulBroadcastID&&this.PostMessageToIframe()},e.prototype.PostMessageToIframe=function(){var e={msg:"OnVideoIFrameBroadcastIDChanged",broadcastid:this.m_ulBroadcastID};this.m_iframe.contentWindow.postMessage(e,_.b.CHAT_BASE_URL)},e.prototype.SendMessage=function(c){return R.b(this,void 0,void 0,function(){var t,n,o,i,r,a,s=this;return R.e(this,function(e){switch(e.label){case 0:if(0==(t=c.trim()).length)return[2];e.label=1;case 1:return e.trys.push([1,6,,7]),i=o=n=void 0,this.m_webApiToken?((r=new FormData).append("chat_id",this.m_ulChatID),r.append("message",t),r.append("instance_id",this.m_unInstanceID.toString()),[4,C.a.post(_.b.WEBAPI_BASE_URL+"IBroadcastService/PostChatMessage/v0001?access_token="+this.m_webApiToken,r)]):[3,3];case 2:return o=e.sent(),i=o.data&&o.data.response,[3,5];case 3:return[4,function(n){return R.b(this,void 0,void 0,function(){var t;return R.e(this,function(e){switch(e.label){case 0:return t=m.Init(Jn.f),Zn(t,n),[4,Jn.a.PostChatMessage(Qn(),t)];case 1:return[2,e.sent()]}})})}({chat_id:this.m_ulChatID,message:t,instance_id:this.m_unInstanceID.toString()})];case 4:n=e.sent(),i={result:n.GetEResult(),cooldown_time_seconds:n.Body().cooldown_time_seconds(),in_game:n.Body().in_game(),persona_name:n.Body().persona_name()},e.label=5;case 5:return i&&i.result&&1!=i.result?(a="",a=17==i.result?Object($.b)("#BroadcastChat_YouMuted"):84==i.result?Object($.b)("#BroadcastChat_Cooldown",i.cooldown_time_seconds):40==i.result?Object($.b)("#BroadcastChat_Blocked"):Object($.b)("#BroadcastChat_FailedToSendMsg",t),this.m_rgChatMessages.push({type:F.Error,msg:a,client_ts:Number(new Date),instance_id:this.m_unInstanceID,in_game:i.in_game,persona_name:i.persona_name,steamid:""}),[2]):(this.m_nRateLimitSeconds||(this.m_nRateLimitSeconds=i.cooldown_time_seconds),this.m_nRateLimitSeconds&&(this.m_bRateLimited=!0,setTimeout(function(){return s.m_bRateLimited=!1},1e3*this.m_nRateLimitSeconds)),[3,7]);case 6:return e.sent(),this.m_rgChatMessages.push({type:F.Error,msg:Object($.b)("#BroadcastChat_FailedToSendMsg",t),client_ts:Number(new Date),instance_id:this.m_unInstanceID,in_game:!1,persona_name:"",steamid:""}),[3,7];case 7:return[2]}})})},e.prototype.RequestChatInfo=function(){return R.b(this,void 0,void 0,function(){var t,n,o;return R.e(this,function(e){switch(e.label){case 0:this.m_cConsecutiveErrors=0,this.m_bReconnecting=!1,e.label=1;case 1:return e.trys.push([1,3,,4]),[4,C.a.get(_.b.CHAT_BASE_URL+"broadcast/getchatinfo",{params:{steamid:this.m_broadcastSteamID,broadcastid:this.m_ulBroadcastID,sessionid:_.b.SESSIONID},withCredentials:!0})];case 2:return t=e.sent(),n=t.data,this.m_strChatURL=n.view_url_template,this.m_ulChatID=n.chat_id,this.m_nFlairGroupID=n.flair_group_ids&&n.flair_group_ids[0],n.blocked&&console.log("User is blocked from chat"),n.steamid&&(this.m_strUserSteamID=n.steamid),n.token&&(this.m_webApiToken=n.token),n.emoticons&&this.SetOwnedEmoticons(n.emoticons),this.m_rgChatMessages.push({type:F.Notification,msg:Object($.b)("#BroadcastChat_DefaultMessage"),client_ts:Number(new Date),instance_id:this.m_unInstanceID,in_game:!1,persona_name:"",steamid:""}),this.m_chatScheduledFunc=new L,this.m_chatScheduledFunc.Schedule(0,this.RequestLoop),[3,4];case 3:return o=e.sent(),console.error(o),console.log("Failed to get chat info!"),[3,4];case 4:return[2]}})})},e.prototype.JoinChannelChat=function(){return R.b(this,void 0,void 0,function(){var t,n;return R.e(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,function(n){return R.b(this,void 0,void 0,function(){var t;return R.e(this,function(e){switch(e.label){case 0:return t=m.Init(Xn.p),Zn(t,n),[4,Xn.u.JoinChat(Qn(),t)];case 1:return[2,e.sent().Body()]}})})}({broadcast_channel_id:this.m_ulBroadcastChannelID})];case 1:return(t=e.sent()).chat_id&&t.view_url_template?(this.m_strChatURL=t.view_url_template(),this.m_ulChatID=t.chat_id(),this.FetchChatModerators(),this.m_rgChatMessages.push({type:F.Notification,msg:Object($.b)("#BroadcastChat_DefaultMessage"),client_ts:Number(new Date),instance_id:this.m_unInstanceID,in_game:!1,persona_name:"",steamid:""}),this.m_chatScheduledFunc=new L,this.m_chatScheduledFunc.Schedule(0,this.RequestLoop),[3,3]):(console.log("Failed to join channel chat"),[2]);case 2:return n=e.sent(),console.error(n),console.log("Failed to join chat!"),[3,3];case 3:return[2]}})})},e.prototype.FetchChatModerators=function(){return R.b(this,void 0,void 0,function(){var t,n;return R.e(this,function(e){switch(e.label){case 0:return[4,function(n){return R.b(this,void 0,void 0,function(){var t;return R.e(this,function(e){switch(e.label){case 0:return t=m.Init(Xn.l),Zn(t,n),[4,Xn.u.GetChatModerators(Qn(),t)];case 1:return[2,e.sent().Body()]}})})}({broadcast_channel_id:this.m_ulBroadcastChannelID})];case 1:return t=e.sent(),n=new Map,t.results().forEach(function(e){n.set(e.steamid(),!0)}),this.m_mapChannelModeratorUsers=n,[2]}})})},e.prototype.RequestLoop=function(){return R.b(this,void 0,void 0,function(){var t,n,o,i,r,a,s,c,l,p=this;return R.e(this,function(e){switch(e.label){case 0:n={},(o=this.m_strChatURL.replace("{0}",this.m_nNextChatTS.toString()))==this.m_strChatURL&&0<this.m_nNextChatTS&&(n.t=this.m_nNextChatTS),e.label=1;case 1:return e.trys.push([1,3,,4]),[4,C.a.get(o,{params:n})];case 2:if(i=e.sent(),r=i.data,this.m_cConsecutiveErrors=0,a=r.messages.map(function(e){return R.a({},e,{type:F.Chat,client_ts:Number(new Date)})}).filter(function(e){return!p.IsUserMutedLocally(e.steamid)}),(t=this.m_rgChatMessages).push.apply(t,a),150<this.m_rgChatMessages.length&&this.m_rgChatMessages.splice(0,this.m_rgChatMessages.length-150),r.joined)for(c=0;c<r.joined.length;c++)r.joined[c].steamid!=this.m_strUserSteamID&&this.m_rgChatMessages.push({type:F.Notification,msg:Object($.b)("#BroadcastChat_UserJoined",r.joined[c].persona_name),client_ts:Number(new Date),instance_id:this.m_unInstanceID,in_game:!1,persona_name:"",steamid:""});if(r.left)for(c=0;c<r.left.length;c++)r.left[c].steamid!=this.m_strUserSteamID&&this.m_rgChatMessages.push({type:F.Notification,msg:Object($.b)("#BroadcastChat_UserLeft",r.left[c].persona_name),client_ts:Number(new Date),instance_id:this.m_unInstanceID,in_game:!1,persona_name:"",steamid:""});if(r.muted)for(c=0;c<r.muted.length;c++)s=r.muted[c].muted==this.m_strUserSteamID?Object($.b)("#BroadcastChat_YouMuted",r.muted[c].persona_name):Object($.b)("#BroadcastChat_UserMuted",r.muted[c].persona_name),this.m_rgChatMessages.push({type:F.Notification,msg:s,client_ts:Number(new Date),instance_id:this.m_unInstanceID,in_game:!1,persona_name:"",steamid:""});if(r.remove_msgs)for(c=0;c<r.remove_msgs.length;c++)this.RemoveUserMessagesLocal(r.remove_msgs[c].steamid);if(l=0,null==this.m_tsFirstRequest||0==this.m_nNextChatTS||r.initial_delay){if("undefined"===r.initial_delay)return console.log("Need initial_delay to know when to request first chat message"),[2];this.m_tsFirstRequest=performance.now()+r.initial_delay,this.m_nFromFirstRequestMS=0,this.m_nNextChatTS=r.next_request,l=r.initial_delay}else{if(r.next_request<this.m_nNextChatTS)return console.log("Next request in past"),[2];this.m_nFromFirstRequestMS+=r.next_request-this.m_nNextChatTS,this.m_nNextChatTS=r.next_request,l=this.m_tsFirstRequest+this.m_nFromFirstRequestMS-performance.now()+this.m_nNudgeFactorMS}return this.m_bReconnecting&&(this.m_rgChatMessages.push({type:F.Notification,msg:Object($.b)("#BroadcastChat_Reconnected"),client_ts:Number(new Date),instance_id:this.m_unInstanceID,in_game:!1,persona_name:"",steamid:""}),this.m_bReconnecting=!1),(this.m_nLastSleepMS=l)<0&&(l=0),this.m_chatScheduledFunc.Schedule(l,this.RequestLoop),[3,4];case 3:if(e.sent(),console.log("Failed to get chat messages. Previous sleep set to: "+this.m_nLastSleepMS+" firstReq: "+this.m_tsFirstRequest+" firstFromRequest: "+this.m_nFromFirstRequestMS+" nudge: "+this.m_nNudgeFactorMS),this.m_cConsecutiveErrors++,this.m_nNudgeFactorMS+=10,4<=this.m_cConsecutiveErrors){if(null==this.m_tsFirstRequest)return this.m_rgChatMessages.push({type:F.Error,msg:Object($.b)("#BroadcastChat_UnableToJoinChat"),client_ts:Number(new Date),instance_id:this.m_unInstanceID,in_game:!1,persona_name:"",steamid:""}),[2];this.m_cConsecutiveErrors=0,this.m_bReconnecting=!0,this.SyncChat()}return this.m_chatScheduledFunc.Schedule(500,this.RequestLoop),[3,4];case 4:return[2]}})})},e.prototype.GetUserEmoticons=function(){return this.m_regexUserEmoticons},e.prototype.SetOwnedEmoticons=function(e){for(var t=[],n=0;n<e.length;n++){var o=e[n];2<=o.length&&":"==o[0]?t.push(o.substr(1,o.length-2)):t.push(o)}var i=":("+t.join("|")+"):";this.m_regexUserEmoticons=new RegExp(i,"g")},e.prototype.UpdateBroadcastChatModerator=function(n,o,i){return R.b(this,void 0,void 0,function(){var t;return R.e(this,function(e){switch(e.label){case 0:if(!this.m_ulBroadcastChannelID)return[3,6];e.label=1;case 1:return e.trys.push([1,4,,5]),[4,function(n){return R.b(this,void 0,void 0,function(){var t;return R.e(this,function(e){switch(e.label){case 0:return t=m.Init(Xn.b),Zn(t,n),[4,Xn.u.AddChatModerator(Qn(),t)];case 1:return[2,e.sent().Body()]}})})}({broadcast_channel_id:this.m_ulBroadcastChannelID,moderator_steamid:n,undo:!o})];case 2:return e.sent(),this.m_rgChatMessages.push({type:F.Notification,msg:"Moderator '"+i+"' "+(o?"added.":"removed.")}),[4,this.FetchChatModerators()];case 3:return e.sent(),[3,5];case 4:return e.sent(),this.m_rgChatMessages.push({type:F.Error,msg:"Failed to "+(o?"assign":"remove")+" '"+i+"' as moderator!"}),[3,5];case 5:return[3,10];case 6:(t=new FormData).append("broadcaststeamid",this.m_broadcastSteamID),t.append("moderatorsteamid",n),t.append("bAdd",o?"1":"0"),t.append("sessionid",_.b.SESSIONID),e.label=7;case 7:return e.trys.push([7,9,,10]),[4,C.a.post(_.b.CHAT_BASE_URL+"broadcast/ajaxupdatechannelmod",t)];case 8:return e.sent(),this.m_mapChannelModeratorUsers.set(n,o),this.m_rgChatMessages.push({type:F.Notification,msg:"Moderator '"+i+"' "+(o?"added.":"removed.")}),[3,10];case 9:return e.sent(),this.m_rgChatMessages.push({type:F.Error,msg:"Failed to "+(o?"assign":"remove")+" '"+i+"' as moderator!"}),[3,10];case 10:return[2]}})})},e.prototype.UpdateUserChatBan=function(i,r,a,s,c,l){return R.b(this,void 0,void 0,function(){var t,n,o;return R.e(this,function(e){switch(e.label){case 0:return t=this.m_broadcastSteamID,n=this.m_strUserSteamID,this.m_ulBroadcastChannelID?[4,function(n){return R.b(this,void 0,void 0,function(){var t;return R.e(this,function(e){switch(e.label){case 0:return t=m.Init(Xn.a),Zn(t,n),[4,Xn.u.AddChatBan(Qn(),t)];case 1:return[2,e.sent().Body()]}})})}({broadcast_channel_id:this.m_ulBroadcastChannelID,chatter_steamid:i,duration:3600*a,permanent:s,undo:l})]:[3,2];case 1:return e.sent(),[3,6];case 2:(o=new FormData).append("broadcaststeamid",t),o.append("issuersteamid",n),o.append("chattersteamid",i),o.append("bantype",r),o.append("duration",a.toString()),o.append("perm",s?"1":"0"),o.append("sessionid",_.b.SESSIONID),e.label=3;case 3:return e.trys.push([3,5,,6]),[4,C.a.post(_.b.CHAT_BASE_URL+"broadcast/ajaxupdateusermute",o)];case 4:return e.sent(),0==r?delete this.m_mapMutedUsers[i]:this.m_mapMutedUsers[i]=c,[3,6];case 5:return e.sent(),console.log("Failed to update mute for "+c),[3,6];case 6:return[2]}})})},e.prototype.MuteUserForSession=function(o,i){return R.b(this,void 0,void 0,function(){var t,n;return R.e(this,function(e){switch(e.label){case 0:if(o==this.m_strUserSteamID)return[2];if(this.m_broadcastSteamID==o)return[2];if(t=this.m_broadcastSteamID==this.m_strUserSteamID,this.m_mapMutedUsers[o])return[3,7];this.m_mapMutedUsers[o]=i,e.label=1;case 1:return e.trys.push([1,6,,7]),this.m_webApiToken?((n=new FormData).append("chat_id",this.m_ulChatID),n.append("user_steamid",o),n.append("muted","1"),[4,C.a.post(_.b.WEBAPI_BASE_URL+"IBroadcastService/MuteBroadcastChatUser/v0001/?access_token="+this.m_webApiToken,n)]):[3,3];case 2:return e.sent(),[3,5];case 3:return[4,$n({chat_id:this.m_ulChatID,user_steamid:o,muted:!0})];case 4:e.sent(),e.label=5;case 5:return[3,7];case 6:return e.sent(),t&&(this.m_rgChatMessages.push({type:F.Error,msg:Object($.b)("#BroadcastChat_UserMuteFailed",i),client_ts:Number(new Date),instance_id:this.m_unInstanceID,in_game:!1,persona_name:"",steamid:""}),delete this.m_mapMutedUsers[o]),[3,7];case 7:return t||this.m_rgChatMessages.push({type:F.Notification,msg:Object($.b)("#BroadcastChat_UserMutedLocal",i),client_ts:Number(new Date),instance_id:this.m_unInstanceID,in_game:!1,persona_name:"",steamid:""}),[2]}})})},e.prototype.UnmuteUserForSession=function(n,o){return R.b(this,void 0,void 0,function(){var t;return R.e(this,function(e){switch(e.label){case 0:if(n==this.m_strUserSteamID)return[2];if(this.m_mapMutedUsers[n]&&delete this.m_mapMutedUsers[n],!(this.m_broadcastSteamID==this.m_strUserSteamID))return[3,8];e.label=1;case 1:return e.trys.push([1,6,,7]),this.m_webApiToken?((t=new FormData).append("chat_id",this.m_ulChatID),t.append("user_steamid",n),t.append("muted","0"),[4,C.a.post(_.b.WEBAPI_BASE_URL+"IBroadcastService/MuteBroadcastChatUser/v0001/?access_token="+this.m_webApiToken,t)]):[3,3];case 2:return e.sent(),[3,5];case 3:return[4,$n({chat_id:this.m_ulChatID,user_steamid:n,muted:!1})];case 4:e.sent(),e.label=5;case 5:return this.m_rgChatMessages.push({type:F.Notification,msg:Object($.b)("#BroadcastChat_UserUnmutedLocal",o),client_ts:Number(new Date),instance_id:this.m_unInstanceID,in_game:!1,persona_name:"",steamid:""}),[3,7];case 6:return e.sent(),this.m_rgChatMessages.push({type:F.Error,msg:Object($.b)("#BroadcastChat_UserUnmuteFailed",o),client_ts:Number(new Date),instance_id:this.m_unInstanceID,in_game:!1,persona_name:"",steamid:""}),[3,7];case 7:return[3,9];case 8:this.m_rgChatMessages.push({type:F.Notification,msg:Object($.b)("#BroadcastChat_UserUnmutedLocal",o),client_ts:Number(new Date),instance_id:this.m_unInstanceID,in_game:!1,persona_name:"",steamid:""}),e.label=9;case 9:return[2]}})})},e.prototype.RemoveUserMessagesLocal=function(o){M.c(this.m_rgChatMessages,function(e,t,n){return e.steamid!==o})},e.prototype.RemoveUserMessagesServer=function(n,o){return R.b(this,void 0,void 0,function(){var t;return R.e(this,function(e){switch(e.label){case 0:if(n==this.m_strUserSteamID)return[2];e.label=1;case 1:return e.trys.push([1,6,,7]),this.m_webApiToken?((t=new FormData).append("chat_id",this.m_ulChatID),t.append("user_steamid",n),[4,C.a.post(_.b.WEBAPI_BASE_URL+"IBroadcastService/RemoveUserChatText/v0001/?access_token="+this.m_webApiToken,t)]):[3,3];case 2:return e.sent(),[3,5];case 3:return[4,function(n){return R.b(this,void 0,void 0,function(){var t;return R.e(this,function(e){switch(e.label){case 0:return t=m.Init(Jn.g),Zn(t,n),[4,Jn.a.RemoveUserChatText(Qn(),t)];case 1:return[2,e.sent().Body()]}})})}({chat_id:this.m_ulChatID,user_steamid:n})];case 4:e.sent(),e.label=5;case 5:return[3,7];case 6:return e.sent(),this.m_rgChatMessages.push({type:F.Error,msg:Object($.b)("#BroadcastChat_RemoveMessagesFailed",o),client_ts:Number(new Date),instance_id:this.m_unInstanceID,in_game:!1,persona_name:"",steamid:""}),[3,7];case 7:return[2]}})})},e.prototype.UpdateChatMessageFlair=function(n){return R.b(this,void 0,void 0,function(){var t;return R.e(this,function(e){switch(e.label){case 0:return this.m_webApiToken?((t=new FormData).append("chat_id",this.m_ulChatID),t.append("flair","^"+this.m_nFlairGroupID+"^:"+n+":"),[4,C.a.post(_.b.WEBAPI_BASE_URL+"IBroadcastService/UpdateChatMessageFlair/v0001/?access_token="+this.m_webApiToken,t)]):[3,2];case 1:return e.sent(),[3,3];case 2:!function(n){R.b(this,void 0,void 0,function(){var t;return R.e(this,function(e){switch(e.label){case 0:return t=m.Init(Jn.i),Zn(t,n),[4,Jn.a.UpdateChatMessageFlair(Qn(),t)];case 1:return[2,e.sent().Body()]}})})}({chat_id:this.m_ulChatID,flair:"^"+this.m_nFlairGroupID+"^:"+n+":"}),e.label=3;case 3:return[2]}})})},e.prototype.IsUserMutedLocally=function(e){return Boolean(this.m_mapMutedUsers[e])},e.prototype.IsUserChannelModerator=function(e){return this.m_mapChannelModeratorUsers.get(e)},e.prototype.IsUserBroadcaster=function(e){return e===this.m_broadcastSteamID},e.prototype.SyncChat=function(){this.m_tsFirstRequest=null,this.m_nFromFirstRequestMS=0,this.m_nNextChatTS=0},R.c([d.observable],e.prototype,"m_mapChannelModeratorUsers",void 0),R.c([d.observable],e.prototype,"m_nRateLimitSeconds",void 0),R.c([d.observable],e.prototype,"m_bRateLimited",void 0),R.c([d.observable],e.prototype,"m_rgChatMessages",void 0),R.c([T.a],e.prototype,"OnIframeLoaded",null),R.c([T.a],e.prototype,"PostMessageToIframe",null),R.c([T.a],e.prototype,"FetchChatModerators",null),R.c([T.a],e.prototype,"RequestLoop",null),R.c([T.a],e.prototype,"MuteUserForSession",null),e}(),lo=new ao;window.uiBroadcastWatchStore=lo;var po,uo,mo=function(){function e(){this.m_status=new rn,this.m_mapPendingRequests=new d.ObservableMap,this.m_nRequestID=1,this.m_BroadcastDetails={}}return e.prototype.Init=function(e){var t=this;this.m_CMInterface=e,this.m_CMInterface.RunWhenLoggedOn(function(){G.a.IN_CLIENT&&(SteamClient&&SteamClient.Broadcast&&SteamClient.Broadcast.RegisterForBroadcastStatus&&SteamClient.Broadcast.RegisterForBroadcastStatus(t.OnBroadcastStatus),SteamClient&&SteamClient.Broadcast&&SteamClient.Broadcast.RegisterForViewerRequests&&SteamClient.Broadcast.RegisterForViewerRequests(t.OnViewerRequest))})},e.prototype.MakeKey=function(e,t){return e+"_"+t},Object.defineProperty(e.prototype,"status",{get:function(){return this.m_status},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"is_broadcasting",{get:function(){return this.m_status.bIsBroadcasting},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"broadcastid",{get:function(){return this.m_status.broadcastid},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"is_broadcast_capable",{get:function(){return this.m_status.bBroadcastCapable},enumerable:!0,configurable:!0}),e.prototype.OnBroadcastStatus=function(e){(this.m_status.bIsBroadcasting&&!e.bIsBroadcasting||"0"!=this.m_status.broadcastid&&"0"==e.broadcastid)&&this.m_mapPendingRequests.forEach(function(e,t,n){e==mn.k_EPending&&n.delete(t)}),this.m_status=e},e.prototype.OnViewerRequest=function(e,t,n){if(n==mn.k_EPending){var o=this.m_nRequestID++;this.m_mapPendingRequests.set(this.MakeKey(e,o),n);var i=ci.GetDefaultBrowserContext(),r=ci.ShowFriendChatDialog(i,e);r&&r.ViewerNeedsApproval(o)}else this.m_mapPendingRequests.set(this.MakeKey(e,t),n)},e.prototype.ApproveViewerRequest=function(e,t){var n=D.a.InitFromAccountID(e);SteamClient.Broadcast.ApproveViewerRequest(n.ConvertTo64BitString(),Number(t))},e.prototype.RejectViewerRequest=function(e,t){var n=D.a.InitFromAccountID(e);SteamClient.Broadcast.RejectViewerRequest(n.ConvertTo64BitString(),Number(t))},e.prototype.GetRequestState=function(e,t){return this.m_mapPendingRequests.get(this.MakeKey(e,t))},e.prototype.InviteToWatch=function(e){var t=D.a.InitFromAccountID(e);return SteamClient.Broadcast.InviteToWatch(t.ConvertTo64BitString())},e.prototype.SubscribeToBroadcastDetails=function(e,t){if(this.m_BroadcastDetails[e])0===this.m_BroadcastDetails[e].refCount&&this.m_BroadcastDetails[e].details.Subscribe(),this.m_BroadcastDetails[e].refCount++;else{var n=new ho(e,t,this.m_CMInterface.GetServiceTransport());n.Subscribe(),this.m_BroadcastDetails[e]={details:n,refCount:1}}},e.prototype.UnsubscribeFromBroadcastDetails=function(e,t){var n=this.m_BroadcastDetails[e];n&&(1<n.refCount?n.refCount--:(n.details.Unsubscribe(),delete this.m_BroadcastDetails[e]))},e.prototype.GetBroadcastDetails=function(e,t){var n=this.m_BroadcastDetails[e];return n||(n={details:new ho(e,t,this.m_CMInterface.GetServiceTransport()),refCount:0},this.m_BroadcastDetails[e]=n),n.details},R.c([d.observable],e.prototype,"m_status",void 0),R.c([d.observable],e.prototype,"m_mapPendingRequests",void 0),R.c([d.computed],e.prototype,"status",null),R.c([d.computed],e.prototype,"is_broadcasting",null),R.c([d.computed],e.prototype,"broadcastid",null),R.c([d.computed],e.prototype,"is_broadcast_capable",null),R.c([T.a,d.action],e.prototype,"OnBroadcastStatus",null),R.c([T.a,d.action],e.prototype,"OnViewerRequest",null),R.c([d.action],e.prototype,"ApproveViewerRequest",null),R.c([d.action],e.prototype,"RejectViewerRequest",null),R.c([d.action],e.prototype,"InviteToWatch",null),e}(),ho=function(){function e(e,t,n){this.m_bExpired=!1,this.m_strThumbnail="",this.m_nThumbnailCount=0,this.m_nTimeout=10,this.m_bSubscribed=!1,this.m_strBroadcastID=e,this.m_strBroadcasterID=t,this.m_ServiceTransport=n}return Object.defineProperty(e.prototype,"strThumbnail",{get:function(){return this.m_strThumbnail?this.m_strThumbnail+"?n="+this.m_nThumbnailCount:null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bExpired",{get:function(){return this.m_bExpired},enumerable:!0,configurable:!0}),e.prototype.Subscribe=function(){this.m_bSubscribed||(this.m_bSubscribed=!0,this.PollForDetails())},e.prototype.SchedulePollForDetails=function(){var e=this,t=this.m_strThumbnail?this.m_nTimeout:10;this.m_nTimer=window.setTimeout(function(){e.m_nTimer=void 0,e.m_bSubscribed&&e.PollForDetails()},1e3*t)},e.prototype.PollForDetails=function(){return R.b(this,void 0,void 0,function(){var t;return R.e(this,function(e){switch(e.label){case 0:return this.m_nTimer||this.m_bExpired?[3,6]:[4,this.FetchBroadcastStatus()];case 1:return 1==e.sent().GetEResult()?[3,2]:(this.m_bExpired=!0,[3,6]);case 2:return this.m_strThumbnail?[3,4]:[4,this.FetchBroadcastThumbnail()];case 3:return 1===(t=e.sent()).GetEResult()&&(this.m_strThumbnail=t.Body().thumbnail_url(),this.m_nTimeout=t.Body().update_interval()),[3,5];case 4:this.m_nThumbnailCount++,e.label=5;case 5:this.SchedulePollForDetails(),e.label=6;case 6:return[2]}})})},e.prototype.FetchBroadcastStatus=function(){var e=m.Init(Jn.b);return e.Body().set_steamid(this.m_strBroadcasterID),e.Body().set_broadcast_id(this.m_strBroadcastID),Jn.a.GetBroadcastStatus(this.m_ServiceTransport,e)},e.prototype.FetchBroadcastThumbnail=function(){var e=m.Init(Jn.c);return e.Body().set_steamid(this.m_strBroadcasterID),e.Body().set_broadcast_id(this.m_strBroadcastID),Jn.a.GetBroadcastThumbnail(this.m_ServiceTransport,e)},e.prototype.Unsubscribe=function(){this.m_bSubscribed=!1,this.m_nTimer&&(clearTimeout(this.m_nTimer),this.m_nTimer=void 0)},R.c([d.observable],e.prototype,"m_bExpired",void 0),R.c([d.observable],e.prototype,"m_strThumbnail",void 0),R.c([d.observable],e.prototype,"m_nThumbnailCount",void 0),e}(),_o=function(o){function e(e,t){var n=o.call(this)||this;return n.m_bShowWatchPromptDialog=!1,n.m_steamID=D.a.InitFromAccountID(t),n.m_tabset=e,n.m_info=lo.StartInfo(n.m_steamID.ConvertTo64BitString()),n}return R.d(e,o),e.prototype.GetSteamID=function(){return this.m_steamID},e.prototype.GetTabName=function(){var e=this.m_info&&this.m_info.m_strTitle;return!e&&Q.bValid?Q.name:e},e.prototype.GetUniqueID=function(){return"br"+this.m_steamID.GetAccountID()},e.prototype.OnTabFocus=function(){},e.prototype.InternalOnTabActivate=function(){},e.prototype.OnTabDeactivate=function(){},e.prototype.OnTabClosed=function(){lo.StopInfo(this.m_info)},e.prototype.IsVoiceActive=function(){return!1},e.prototype.GetUnreadMessageCount=function(){return 0},e.prototype.IsTabForChat=function(e){return!1},e.prototype.GetChatView=function(){return null},e.prototype.ShowWatchPromptDialog=function(e){this.m_bShowWatchPromptDialog=!0,this.m_watchPromptInitialFriend=e},e.prototype.HideWatchPromptDialog=function(){this.m_bShowWatchPromptDialog=!1,this.m_watchPromptInitialFriend=void 0},R.c([d.observable],e.prototype,"m_bShowWatchPromptDialog",void 0),R.c([d.observable],e.prototype,"m_watchPromptInitialFriend",void 0),R.c([d.action],e.prototype,"ShowWatchPromptDialog",null),R.c([d.action],e.prototype,"HideWatchPromptDialog",null),e}(ue),fo="ChatStorePopupState",go=function(){function e(e){this.m_bRestoredPopupState=!1,this.m_vecShowGroupsAfterRestorePopup=[],this.m_iLastChatPopupID=0,this.m_mapChatBrowserContexts=new Map,this.m_bSuppressBrowserContextBroadcasting=!1,this.m_bParentalLocked=void 0,this.m_stateToRestoreFrom=void 0,this.m_bRestoringPopups=!1,this.m_bShuttingDown=!1,this.m_bTheaterMode=!1,this.m_mapFriendChatBroadcastVisible=new Map,this.m_chatStore=e}return e.prototype.GetRootChatPerContextData=function(){return this.GetPerContextChatData(ai)},e.prototype.Init=function(){var t=this;ci.AddPopupManagerShutdownCallback(function(){t.SerializePopupState(),t.m_bShuttingDown=!0}),Object(d.autorun)(function(){var e=ci.ParentalStore.BIsFriendsBlocked();t.OnFriendsParentalLockChanged(e)})},e.prototype.OnFriendsParentalLockChanged=function(e){!1===this.m_bParentalLocked&&e?(this.SerializePopupState(!0),this.m_mapChatBrowserContexts.forEach(function(e){e.CloseAllPopups()}),this.m_bRestoredPopupState=!1):!0!==this.m_bParentalLocked||e||this.RestorePopupState(),this.m_bParentalLocked=e},e.prototype.ShowFriendChatDialog=function(e,t,n,o){void 0===n&&(n=!0),void 0===o&&(o=!0);var i=this.m_chatStore.GetFriendChat(t);return n&&i&&this.ShowAndOrActivateChat(e,i,o),i},e.prototype.ShowFriendChatDialogWhenReady=function(e,t,n,o){void 0===n&&(n=!0),void 0===o&&(o=!0),this.ShowFriendChatDialog(e,t,n,o)},e.prototype.ShowFriendChatDialogAndStartVoice=function(e,t){var n=this.ShowFriendChatDialog(e,t,!0,!0);return n.BVoiceActive()||n.ToggleVoiceChat(),n},e.prototype.ShowAndOrActivateChat=function(e,t,n){if(t instanceof kt){var o=this.m_chatStore.GetChatRoomGroup(t.GetParentGroupID());if(!o)return void Object(I.a)(!1,"Can't find group for chat room ");var i=this.ShowAndOrActivateChatRoomGroup(e,o,n);i&&i.SelectChat(t.GetRoomID())}else this.ShowAndOrActivateTabByID(e,t.unique_id,n)},e.prototype.ShowAndOrActivateChatForTabset=function(e,t,n){var o=e.GetTabForChat(t);o||this.CreateNewTabFromUniqueID(e,t.unique_id,!1),n&&e.ActivateTab(o)},e.prototype.IsChatRoomGroupActive=function(e,t){var n=this.GetPerContextChatData(e),o=this.GetTabSetByUniqueID(n,t.unique_id);return!!o&&o.tabSet.activeTab==o.tab},e.prototype.SetTheaterMode=function(e){this.m_bTheaterMode=e},e.prototype.GetTheaterMode=function(){return this.m_bTheaterMode},e.prototype.SetFriendBroadcastVisible=function(e,t){this.m_mapFriendChatBroadcastVisible.set(e,t)},e.prototype.IsFriendBroadcastVisible=function(e){return this.m_mapFriendChatBroadcastVisible.get(e)},e.prototype.ShowAndOrActivateChatRoomGroup=function(e,t,n){return t.BIsCurrentUserAMember()?this.ShowAndOrActivateTabByID(e,t.unique_id,n):(console.log("Failed to activate",t,"- user is not a member."),null)},e.prototype.ShowAndOrActivateChatRoomGroupWhenReady=function(e,t,n){this.ShowAndOrActivateChatRoomGroup(e,t,n)},e.prototype.ShowUnackedGroup=function(e){this.m_bRestoredPopupState?this.ShowAndOrActivateChatRoomGroup(ai,e,!1):this.m_vecShowGroupsAfterRestorePopup.push(e)},e.prototype.ShowOrActivateBroadcast=function(e,t,n){var o="br"+t;return this.ShowAndOrActivateTabByID(e,o,n)},e.prototype.CloseTabByID=function(t,e){var n=this;e?this.CloseTabByIDInContext(e,t):this.m_mapChatBrowserContexts.forEach(function(e){n.CloseTabByIDInContext(e.browser_context,t)})},e.prototype.ReplaceFriendChatWithGroup=function(e,t,n){var o=this.GetPerContextChatData(e),i=this.GetTabSetByUniqueID(o,n.unique_id);i||(this.ShowAndOrActivateChatRoomGroup(e,n,!0),i=this.GetTabSetByUniqueID(o,n.unique_id)),Object(I.a)(i,"Failed to find group tab");var r=this.GetTabSetByUniqueID(o,t.chat.unique_id);if(r){var a=i.tab,s=r.tabSet;i.tabSet!=s&&(i.tabSet.RemoveTab(a),s.AddTab(a)),s.MoveTabAfter(a,t),this.CloseTab(e,t),this.ShowAndOrActivateChatRoomGroup(e,n,!0)}},e.prototype.ForEachTabSet=function(e,t){e.IsFriendsListSingleWindow()&&0<e.default_tabset.tabCount&&t(e.default_tabset);for(var n=0,o=Array.from(e.popup_list);n<o.length;n++){t(o[n].tab_set)}},e.prototype.CloseTab=function(t,n,o){void 0===o&&(o=!1);var i=this.GetPerContextChatData(t);this.ForEachTabSet(i,function(e){e.BHasTab(n)&&(o||e.RemoveTab(n),n.IsVoiceActive()&&ci.ShowCloseActiveVoiceConfirmation(t,i.GetPopupForTabSet(e)))}),this.BroadcastCloseTabToAllBrowserContexts(t,n.GetUniqueID()),n.OnTabClosed(),i.IsFriendsListSingleWindow()&&0==i.default_tabset.tabCount&&(i.responsive_window_state.SetActiveView(po.FriendsList),this.SetTheaterMode(!1),i.SetFriendsListCollapsed(!1)),ci.UIStore.SerializePopupState()},e.prototype.GetResponsiveWindowState=function(e){return this.GetPerContextChatData(e).responsive_window_state},e.prototype.CloseTabByIDInContext=function(e,t){var n=this.GetPerContextChatData(e),o=this.GetTabSetByUniqueID(n,t);o&&(o.tabSet.RemoveTab(o.tab),o.tab.OnTabClosed(),this.BroadcastCloseTabToAllBrowserContexts(e,t))},e.prototype.ShowAndOrActivateTabByID=function(e,t,n){void 0===n&&(n=!0);var o,i=this.GetPerContextChatData(e),r=this.GetTabSetByUniqueID(i,t);if(r)n&&r.tabSet.ActivateTab(r.tab),o=r.tab;else{var a=ci.SettingsStore.BAlwaysShowChatsInNewWindow();if(!i.BUsePopups()||!a&&i.default_tabset.is_popup_active)o=this.CreateNewTabFromUniqueID(i.default_tabset,t,n);else{var s=void 0;if(s=a&&0!=i.default_tabset.tabCount?new de(e):i.default_tabset,!(o=this.CreateNewTabFromUniqueID(s,t,n)))return null;var c=s==i.default_tabset;if(c&&i.IsFriendsListSingleWindow())ci.ShowPopupFriendsList(e,!n,n);else if(!c||!i.IsFriendsListSingleWindow()&&!s.is_popup_active){var l=ci.CreateChatPopup(e,this.GetNextChatPopupID(),s,void 0,void 0,!n);l.Show(n),i.AddPopup(s,l),this.SerializePopupState()}}}return o&&n&&i.responsive_window_state.SetActiveView(po.Chat),ci.UIStore.SerializePopupState(),o},e.prototype.GetTabSetByUniqueID=function(e,t){if(!e)return null;var n=e.GetTabSetForId(t);return n?{tabSet:n,tab:n.GetTabByUniqueID(t)}:null},e.prototype.BIsTabSetActive=function(e){var t=this.GetPerContextChatData(e.GetBrowserContext());if(t)return t.BIsTabSetActive(e)},e.prototype.BIsTabSetVisible=function(e){var t=this.GetPerContextChatData(e.GetBrowserContext());if(t)return t.BIsTabSetVisible(e)},e.prototype.BIsTabSetFocused=function(e){var t=this.GetPerContextChatData(e.GetBrowserContext());if(t)return t.BIsTabSetFocused(e)},e.prototype.GetAppContainerForChat=function(e){var t=this.GetRootChatPerContextData(),n=null;if(e instanceof kt){var o=this.m_chatStore.GetChatRoomGroup(e.GetParentGroupID());o&&(n=this.GetTabSetByUniqueID(t,o.unique_id))}else n=this.GetTabSetByUniqueID(t,e.unique_id);if(!n||!n.tabSet)return null;var i=t.GetPopupForTabSet(n.tabSet);return i?i.popup?i.popup.container:null:t.IsTabSetInFriendListWindow(n.tabSet)?t.friends_list_window:null},e.prototype.FlashChatWindow=function(e){var t=this.GetAppContainerForChat(e);t&&!t.BIsClosed()&&t.FlashWindow()},e.prototype.GetPerContextChatData=function(e){Object(I.a)(ci.ready_to_render||this.m_bRestoringPopups,"GetPerContextChatData called before ready",e);var t=this.m_mapChatBrowserContexts.get(e.m_unPID);if(!t){var n=ci.BIsValidBrowserContext(e);t=new So(e),n?this.m_mapChatBrowserContexts.set(e.m_unPID,t):Object(I.a)(!1,"Had to prevent instance being added back"+e.m_unPID)}return t},e.prototype.GetDefaultTabSetForContext=function(e){return this.GetPerContextChatData(e).default_tabset},e.prototype.OnOverlayBrowserCreated=function(e,t,n){var i=this,r=this.GetPerContextChatData(e);if(r){r.SetScreenInfo(t,n);var o=this.GetRootChatPerContextData();o&&this.ForEachTabSet(o,function(n){var o=new de(r.browser_context);n.tabs.forEach(function(e){var t=n.activeTab==e;i.CreateNewTabFromUniqueID(o,e.GetUniqueID(),t)});var e=ci.CreateChatPopup(r.browser_context,i.GetNextChatPopupID(),o,void 0,void 0,!1);e.Show(!1),r.AddPopup(o,e)})}},e.prototype.OnOverlayBrowserChanged=function(e,t,n){var o=this.GetPerContextChatData(e);o&&o.SetScreenInfo(t,n)},e.prototype.OnOverlayBrowserClosed=function(e){var t=this.m_mapChatBrowserContexts.get(e.m_unPID);t&&(Object(I.a)(e.m_nBrowserID==t.browser_context.m_nBrowserID,"Mismatch found in OnOverlayBrowserClosed"),this.m_mapChatBrowserContexts.delete(e.m_unPID))},e.prototype.SetSuppressBrowserContextBroadcasting=function(e){this.m_bSuppressBrowserContextBroadcasting=e},e.prototype.BroadcastNewTabToAllBrowserContexts=function(n,o){var i=this;this.m_bSuppressBrowserContextBroadcasting||(this.m_bSuppressBrowserContextBroadcasting=!0,this.m_mapChatBrowserContexts.forEach(function(e){if(!ri(e.browser_context,n)){var t=e.browser_context!=ai;i.ShowAndOrActivateTabByID(e.browser_context,o,t)}}),this.m_bSuppressBrowserContextBroadcasting=!1)},e.prototype.BroadcastCloseTabToAllBrowserContexts=function(e,t){if(!this.m_bSuppressBrowserContextBroadcasting)if(ri(e,ai))this.BroadcastCloseTabToAllBrowserContexts_Internal(e,t);else{var n=this.m_mapChatBrowserContexts.get(e.m_unPID);n&&ri(e,n.browser_context)&&this.BroadcastCloseTabToAllBrowserContexts_Internal(e,t)}},e.prototype.BroadcastCloseTabToAllBrowserContexts_Internal=function(t,n){var o=this;this.m_bSuppressBrowserContextBroadcasting||(this.m_bSuppressBrowserContextBroadcasting=!0,this.m_mapChatBrowserContexts.forEach(function(e){ri(e.browser_context,t)||o.CloseTabByIDInContext(e.browser_context,n)}),this.m_bSuppressBrowserContextBroadcasting=!1)},e.prototype.CreateNewTabFromUniqueID=function(e,t,n,o){void 0===o&&(o=!1);var i=null,r=t.match(/^f(\d+)$/);if(r&&r[1]){var a=parseInt(r[1]),s=ci.FriendStore.GetPlayer(a);if(s&&!s.is_blocked){var c=this.m_chatStore.GetFriendChat(a);c&&(i=new nn(e,c),!o||s.is_friend||ci.FriendStore.BApprovedNonFriendMessages(a)||c.SetShowNonFriendWarning(!0))}}if(!i){var l=t.match(/^cg(\d+)$/);if(l&&l[1]){var p=this.m_chatStore.GetChatRoomGroup(l[1]);p&&(this.m_chatStore.IncRefActiveChatRoomGroup(p.GetGroupID(),!this.m_bRestoringPopups),i=new xt(e,p))}}if(!i){var u=t.match(/^br(\d+)$/);if(u&&u[1]){var m=parseInt(u[1]);i=new _o(e,m)}}return i?(e.AddTab(i),this.BroadcastNewTabToAllBrowserContexts(e.GetBrowserContext(),t),n&&e.ActivateTab(i),i):null},e.prototype.GetNextChatPopupID=function(){return"ChatWindow_"+this.m_iLastChatPopupID++},e.prototype.BIsFriendsListSingleWindow=function(e){var t=this.GetPerContextChatData(e);return!t.BUsePopups()||t.IsFriendsListSingleWindow()},e.prototype.SetFriendsListSingleWindowMode=function(e,t){var n=this.GetPerContextChatData(e);n.BUsePopups()&&n.IsFriendsListSingleWindow()!=t&&(t?ci.UIStore.ConvertDefaultTabSetToEmbedded(n.browser_context):ci.UIStore.ConvertDefaultTabSetToPopup(n.browser_context),n.SetFriendsListSingleWindowMode(t))},e.prototype.BIsFriendsListCollapsed=function(e){var t=this.GetPerContextChatData(e);return t.IsFriendsListSingleWindow()&&t.IsFriendsListCollapsed()},e.prototype.SetFriendsListCollapsed=function(e,t){this.GetPerContextChatData(e).SetFriendsListCollapsed(t)},e.prototype.ConvertDefaultTabSetToPopup=function(e){var t=this.GetPerContextChatData(e);if(t.default_tabset.tabCount){var n=t.GetPopupForTabSet(t.default_tabset);return n||((n=ci.CreateChatPopup(e,this.GetNextChatPopupID(),t.default_tabset,t.cached_popup_window_restore_details,void 0,!1)).Show(!0),t.AddPopup(t.default_tabset,n),this.SerializePopupState(),t.friends_list_window&&(t.friends_list_window.BringToFront(),t.friends_list_window.title=Object($.b)("#WindowTitle_FriendsList")),n)}return null},e.prototype.ConvertDefaultTabSetToEmbedded=function(e){var t=this.GetPerContextChatData(e),n=t.GetPopupForTabSet(t.default_tabset);n&&(n.popup.GetWindowRestoreDetails().then(function(e){t.SetCachedDefaultPopupDimensions(e)}),t.RemovePopupForTabSet(t.default_tabset),this.SerializePopupState(),n.ClearTabSet(),n.popup.Close())},e.prototype.OnTabSetResized=function(e){var t=this.GetPerContextChatData(e.GetBrowserContext());if(e==t.default_tabset&&!t.IsFriendsListSingleWindow()){var n=t.GetPopupForTabSet(e);n&&n.popup.GetWindowRestoreDetails().then(function(e){t.SetCachedDefaultPopupDimensions(e)})}},e.prototype.CloseTabSet=function(e){var t=this.GetPerContextChatData(e.GetBrowserContext()),n=t.GetPopupForTabSet(e);n&&n.popup.Close(),t.RemovePopupForTabSet(e),this.SerializePopupState()},e.prototype.OnTabSetClosed=function(e){this.GetPerContextChatData(e.GetBrowserContext()).RemovePopupForTabSet(e),this.SerializePopupState()},e.prototype.FocusTabSet=function(e){var t=this.GetPerContextChatData(e.GetBrowserContext()),n=t.GetPopupForTabSet(e);n&&n.popup&&!n.popup.container.BIsClosed()?n.popup.container.BringToFront():t.IsTabSetInFriendListWindow(e)&&t.IsFriendsListSingleWindow()&&(t.BUsePopups()?ci.ShowPopupFriendsList(t.browser_context,!1,!0):t.friends_list_window&&t.friends_list_window.BringToFront())},e.prototype.MoveTabToNewPopup=function(e,t,n,o){Object(I.a)(e,"browserContext");var i=this.GetPerContextChatData(e);this.ForEachTabSet(i,function(e){return e.RemoveTab(t)});var r=new de(e);r.AddTab(t);var a=ci.CreateChatPopup(e,this.GetNextChatPopupID(),r,o,n,!1);if(a.Show(!0),o){var s=a.popup.GetWindow();try{s.SteamClient.Window.PositionWindowRelative(o,n.left,n.top,n.width,n.height)}catch(e){console.error(e)}}i.AddPopup(r,a),this.SerializePopupState()},e.prototype.SerializePopupState=function(e){if(void 0===e&&(e=!1),this.m_bRestoredPopupState&&ci.SettingsStore.BReady()&&!this.m_bShuttingDown){var t=this.SerializePopupStateToObject(e);ci.SettingsStore.StoreObjectInLocalStorage(fo,t)}},e.prototype.SerializePopupStateToObject=function(e){var t=this.GetPerContextChatData(ai),n={window_restore_details:t.cached_popup_window_restore_details,defaultTabs:void 0,popupTabs:void 0,bFriendsListVisible:!1,always_restore:e,bFriendsListSingleWindow:t.IsFriendsListSingleWindow(),bFriendsListCollapsed:t.IsFriendsListCollapsed()};t.default_tabset&&0<t.default_tabset.tabCount&&(n.defaultTabs=t.default_tabset.Serialize());for(var o=[],i=0,r=Array.from(t.popup_list);i<r.length;i++){var a=r[i];a.tab_set!=t.default_tabset&&o.push(a.tab_set.Serialize())}return 0<o.length&&(n.popupTabs=o),n.bFriendsListVisible=!!t.friends_list_window,n},e.prototype.BRestorePopups=function(){return ci.SettingsStore.BAlwaysShowChatsInNewWindow()},e.prototype.BRestoreOpenChats=function(){return ci.SettingsStore.FriendsSettings.bRememberOpenChats},e.prototype.DeserializeIntoTabSet=function(e,t){if(t.tabs&&Array.isArray(t.tabs))for(var n=0,o=t.tabs;n<o.length;n++){var i=o[n];i.startsWith("br")||this.CreateNewTabFromUniqueID(e,i,i==t.active_tab,!0)}},e.prototype.SetStateToRestoreFrom=function(e){this.m_stateToRestoreFrom=e},e.prototype.RestorePopupState=function(){return R.b(this,void 0,void 0,function(){var t,n;return R.e(this,function(e){switch(e.label){case 0:return Object(I.a)(!this.m_bRestoredPopupState,"Second restore popup state"),Object(I.a)(!this.m_bRestoringPopups,"RestorePopupState called while already restoring"),ci.ParentalStore.BIsFriendsBlocked()?[2]:(this.m_bRestoringPopups=!0,this.m_stateToRestoreFrom?(this.RestoreFromStateObject(this.m_stateToRestoreFrom,!1),this.m_stateToRestoreFrom=void 0,this.m_bRestoringPopups=!1,[2]):[4,ci.SettingsStore.GetObjectFromLocalStorageWhenReady(fo)]);case 1:return t=e.sent(),n=!1,"undefined"!=typeof SteamClient&&SteamClient.WebChat&&SteamClient.WebChat.BSuppressPopupsInRestore?[4,SteamClient.WebChat.BSuppressPopupsInRestore()]:[3,3];case 2:n=e.sent(),e.label=3;case 3:return this.RestoreFromStateObject(t,n),this.m_bRestoringPopups=!1,[2]}})})},e.prototype.RestoreFromStateObject=function(e,t){var n=this.GetPerContextChatData(ai);if(Object(I.a)(n.BIsEmpty(),"Restoring to non-empty context",n),n.BIsEmpty()){if(e.window_restore_details&&n.SetCachedDefaultPopupDimensions(e.window_restore_details),n.SetFriendsListSingleWindowMode(!!e.bFriendsListSingleWindow),n.SetFriendsListCollapsed(!!e.bFriendsListCollapsed),!t&&(e.always_restore||this.BRestoreOpenChats())){if(e.defaultTabs){var o=n.default_tabset;if(this.DeserializeIntoTabSet(o,e.defaultTabs),0<o.tabCount&&!n.IsFriendsListSingleWindow()){var i=ci.CreateChatPopup(ci.GetDefaultBrowserContext(),this.GetNextChatPopupID(),o,void 0,void 0,!1);n.AddPopup(o,i),i.Show(!1)}}if(e.popupTabs)for(var r=0,a=e.popupTabs;r<a.length;r++){var s=a[r];o=new de(ai);if(this.DeserializeIntoTabSet(o,s),0<o.tabCount){i=ci.CreateChatPopup(ci.GetDefaultBrowserContext(),this.GetNextChatPopupID(),o,void 0,void 0,!1);n.AddPopup(o,i),i.Show(!1)}}}if(!t){var c=!e||void 0===e.bFriendsListVisible||e.bFriendsListVisible;n.BUsePopups()&&ci.ShowPopupFriendsListAtStartup(c);for(var l=0,p=this.m_vecShowGroupsAfterRestorePopup;l<p.length;l++){var u=p[l];this.ShowAndOrActivateChatRoomGroup(ai,u,!1)}}this.m_vecShowGroupsAfterRestorePopup=[],this.m_bRestoredPopupState=!0,this.m_chatStore.OnRestorePopupsComplete()}},e.prototype.FillInChatUsabilityMetrics=function(e){var t=this.GetPerContextChatData(ai);e.ui_state().set_friends_list_docked(t.IsFriendsListSingleWindow()),e.ui_state().set_friends_list_visible(t.friends_list_window&&!t.friends_list_window.BIsClosed()),e.ui_state().set_chat_popups_opened(Array.from(t.popup_list).length),e.ui_state().set_friends_list_collapsed(t.IsFriendsListCollapsed());var n=0,o=0;n+=M.b(t.default_tabset.tabs,function(e){return e.IsChatRoom()}),o+=M.b(t.default_tabset.tabs,function(e){return e.IsFriendChat()});for(var i=0,r=Array.from(t.popup_list);i<r.length;i++){var a=r[i];a.tab_set!=t.default_tabset&&(n+=M.b(a.tab_set.tabs,function(e){return e.IsChatRoom()}),o+=M.b(a.tab_set.tabs,function(e){return e.IsFriendChat()}))}e.ui_state().set_group_chat_tabs_opened(n),e.ui_state().set_friend_chat_tabs_opened(o)},R.c([d.observable],e.prototype,"m_bTheaterMode",void 0),R.c([d.observable],e.prototype,"m_mapFriendChatBroadcastVisible",void 0),R.c([d.action],e.prototype,"OnFriendsParentalLockChanged",null),R.c([ti],e.prototype,"ShowFriendChatDialogWhenReady",null),R.c([ti],e.prototype,"ShowAndOrActivateChatRoomGroupWhenReady",null),R.c([T.a],e.prototype,"SerializePopupState",null),e}(),bo=function(){function e(e,t){this.m_bShown=!1,this.m_popup=e,this.m_chatPopup=t}return e.prototype.Show=function(e){this.m_popup.Show(e),this.m_bShown||(this.m_bShown=!0)},Object.defineProperty(e.prototype,"popup",{get:function(){return this.m_popup},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"tab_set",{get:function(){return this.m_chatPopup.tab_set},enumerable:!0,configurable:!0}),e.prototype.ClearTabSet=function(){this.m_chatPopup.ClearTabSet()},e.prototype.IsSameBrowserContext=function(e){var t=this.m_popup.GetBrowserContext()||ai;return e.m_nBrowserID==t.m_nBrowserID&&e.m_unPID==t.m_unPID},e}();(uo=po||(po={}))[uo.FriendsList=0]="FriendsList",uo[uo.Chat=1]="Chat";var vo=function(){function e(){this.m_eActiveView=po.FriendsList}return e.prototype.GetActiveView=function(){return this.m_eActiveView},e.prototype.SetActiveView=function(e){this.m_eActiveView=e},R.c([d.observable],e.prototype,"m_eActiveView",void 0),e}(),So=function(){function e(e){this.m_browserContext=e,this.m_DefaultTabSet=new de(e),this.m_FriendsListWindow=void 0,this.m_PopupWindowRestoreDetails=void 0,this.m_mapTabSetToPopup=new Map,this.m_ResponsiveWindowState=new vo,this.SetFriendsListSingleWindowMode(!1),this.m_bFriendsListCollapsed=G.a.STEAM_TV}return e.prototype.BIsEmpty=function(){return 0==this.m_DefaultTabSet.tabCount&&(!G.a.IN_CLIENT||null==this.m_FriendsListWindow)&&0==this.m_mapTabSetToPopup.size},e.prototype.BUsePopups=function(){return G.a.USE_POPUPS},e.prototype.IsFriendsListSingleWindow=function(){return this.m_bFriendsListSingleWindow},e.prototype.SetFriendsListSingleWindowMode=function(e){this.BUsePopups()?this.m_bFriendsListSingleWindow=e:this.m_bFriendsListSingleWindow=!0},e.prototype.IsFriendsListCollapsed=function(){return this.m_bFriendsListCollapsed},e.prototype.SetFriendsListCollapsed=function(e){this.m_bFriendsListCollapsed=e},Object.defineProperty(e.prototype,"browser_context",{get:function(){return this.m_browserContext},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"default_tabset",{get:function(){return Object(I.a)(this.m_DefaultTabSet,"Context has no default chat target"),this.m_DefaultTabSet},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"friends_list_window",{get:function(){return this.m_FriendsListWindow},enumerable:!0,configurable:!0}),e.prototype.SetFriendsListWindow=function(e){this.m_FriendsListWindow=e||void 0,!e&&this.IsFriendsListSingleWindow()&&this.m_DefaultTabSet.CloseAllTabs()},Object.defineProperty(e.prototype,"popup_list",{get:function(){return this.m_mapTabSetToPopup.values()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"responsive_window_state",{get:function(){return this.m_ResponsiveWindowState},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"cached_popup_window_restore_details",{get:function(){return this.m_PopupWindowRestoreDetails},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"screen_info",{get:function(){return this.m_ScreenInfo},enumerable:!0,configurable:!0}),e.prototype.SetScreenInfo=function(e,t){this.m_ScreenInfo={width:e,height:t}},e.prototype.SetCachedDefaultPopupDimensions=function(e){this.m_PopupWindowRestoreDetails=e},e.prototype.GetTabSetForId=function(e){if(this.m_DefaultTabSet.GetTabByUniqueID(e))return this.m_DefaultTabSet;for(var t=0,n=Array.from(this.m_mapTabSetToPopup.keys());t<n.length;t++){var o=n[t];if(o.GetTabByUniqueID(e))return o}return null},e.prototype.RemovePopupForTabSet=function(e){this.m_mapTabSetToPopup.delete(e)},e.prototype.AddPopup=function(e,t){Object(I.a)(!this.m_mapTabSetToPopup.has(e),"Added popup for tabset twice"),this.m_mapTabSetToPopup.set(e,t)},e.prototype.GetPopupForTabSet=function(e){return this.m_mapTabSetToPopup.get(e)},e.prototype.IsTabSetInFriendListWindow=function(e){return e==this.default_tabset&&this.IsFriendsListSingleWindow()},e.prototype.BIsTabSetActive=function(e){var t=this.GetPopupForTabSet(e);return t?!t.popup.container.BIsClosed():this.IsTabSetInFriendListWindow(e)&&this.friends_list_window&&!this.friends_list_window.BIsClosed()},e.prototype.BIsTabSetVisible=function(e){var t=this.GetPopupForTabSet(e);return t?t.popup.container.BIsVisible():this.IsTabSetInFriendListWindow(e)&&this.friends_list_window&&this.friends_list_window.BIsVisible()},e.prototype.BIsTabSetFocused=function(e){var t=this.GetPopupForTabSet(e);return t?t.popup.container.BIsFocused():this.IsTabSetInFriendListWindow(e)&&this.friends_list_window&&this.friends_list_window.BIsFocused()},e.prototype.CloseAllPopups=function(){for(var e=0,t=Array.from(this.popup_list);e<t.length;e++){t[e].popup.Close()}this.m_mapTabSetToPopup.clear(),this.friends_list_window&&this.m_FriendsListWindow.Close(),this.m_DefaultTabSet=new de(this.m_browserContext)},R.c([d.observable],e.prototype,"m_bFriendsListSingleWindow",void 0),R.c([d.observable],e.prototype,"m_bFriendsListCollapsed",void 0),e}(),yo=n("jELD");function Co(e){var t,n=e.split(".");return 2==n.length&&(t=n[0],!!SteamClient&&"object"==typeof SteamClient&&t in SteamClient)&&n[1]in SteamClient[n[0]]}var Io,Eo,Oo=function(){function e(e){var t=this;this.m_bReady=!1,this.m_unTimerUploadCommunityPreferences=void 0,this.m_rgOnReadyCallbacks=[],this.m_bFriendSettingsReady=!1,this.m_CommunityPreferencesChangedHandler=f(nt.j.NotifyCommunityPreferencesChangedHandler,function(e){return t.UpdateCommunityPreferences(e.Body().preferences()),1}),this.m_Storage=e,G.a.IN_CLIENT?this.m_iFriendSettingsStore=new Mo(this,this.OnFriendSettingsChanged.bind(this)):this.m_iFriendSettingsStore=new Do(this,this.OnFriendSettingsChanged.bind(this)),this.m_CommunityPreferences=new hn;var n=new nt.b;this.m_CommunityPreferences.bHideAdultContentViolence=n.hide_adult_content_violence(),this.m_CommunityPreferences.bHideAdultContentSex=n.hide_adult_content_sex(),this.m_CommunityPreferences.bParenthesizeNicknames=n.parenthesize_nicknames(),this.m_ServerCommunityPreferences=void 0}return e.prototype.Init=function(e){var n=this;this.m_CM=e,this.m_CM.AddOnLogonCallback(function(){n.m_bReady||(n.m_iFriendSettingsStore.InternalInit(),n.SetReady());var e=m.Init(yo.a);yo.b.GetStorePreferences(n.m_CM.GetServiceTransport(),e).then(function(e){n.m_StorePreferences=e.Body()});var t=m.Init(nt.c);return nt.k.GetCommunityPreferences(n.m_CM.GetServiceTransport(),t).then(function(e){return n.UpdateCommunityPreferences(e.Body().preferences())})})},e.prototype.BReady=function(){return this.m_bReady},Object.defineProperty(e.prototype,"FriendsSettings",{get:function(){return this.m_FriendsSettings},enumerable:!0,configurable:!0}),e.prototype.BUpdateFriendsSettings=function(e){return!!this.m_iFriendSettingsStore.BUpdateSettings(e)&&(this.m_FriendsSettings=e,!0)},e.prototype.BClientHasFeatureOrOnWeb=function(e){return!G.a.IN_CLIENT||!!this.BReady()&&("object"==typeof this.m_FriendsSettings.featuresEnabled&&(!!this.m_FriendsSettings.featuresEnabled.hasOwnProperty(e)&&this.m_FriendsSettings.featuresEnabled[e]))},e.prototype.BAlwaysShowChatsInNewWindow=function(){return this.m_FriendsSettings.bAlwaysNewChatWindow},e.prototype.BForceAlphabeticFriendSorting=function(){return this.m_FriendsSettings.bForceAlphabeticFriendSorting},e.prototype.RunOnReady=function(e){this.m_bReady?e():this.m_rgOnReadyCallbacks.push(e)},e.prototype.GetAccountSpecificLocalStorageKey=function(e){return Object(I.a)(this.m_CM.steamid.BIsValid(),"CM has never been logged on, can't construct local storage key"),this.m_CM.steamid.BIsValid()?e+"_"+this.m_CM.steamid.GetAccountID():null},e.prototype.GetObjectFromLocalStorageWhenReady=function(n,o){var i=this;return this.m_bReady?Promise.resolve(this.GetObjectFromLocalStorage(n,o)):new Promise(function(e,t){i.RunOnReady(function(){e(i.GetObjectFromLocalStorage(n,o))})})},e.prototype.GetObjectFromLocalStorage=function(e,o){var t=this.GetAccountSpecificLocalStorageKey(e);return t?this.m_Storage.GetObject(t).then(function(e){var t=Object.assign({},o,e);if(o&&"object"==typeof o)for(var n in o)"object"==typeof o[n]&&e&&(t[n]=Object.assign({},o[n],e[n]));return t}):Promise.reject("Storage not ready")},e.prototype.StoreObjectInLocalStorage=function(e,t){var n=this.GetAccountSpecificLocalStorageKey(e);return!!n&&(this.m_Storage.StoreObject(n,t),!0)},e.prototype.GetFlagFromLocalStorageWhenReady=function(n){var o=this;return this.m_bReady?Promise.resolve(this.GetFlagFromLocalStorage(n)):new Promise(function(e,t){o.RunOnReady(function(){e(o.GetFlagFromLocalStorage(n))})})},e.prototype.GetFlagFromLocalStorage=function(e){var t=this.GetAccountSpecificLocalStorageKey(e);return t?this.m_Storage.GetString(t).then(function(e){return"true"===e}):Promise.reject("Storage not ready")},e.prototype.SetFlagInLocalStorage=function(e,t){var n=this.GetAccountSpecificLocalStorageKey(e);return!!n&&(t?this.m_Storage.StoreString(n,"true"):this.m_Storage.RemoveObject(n),!0)},e.prototype.SetReady=function(){if(this.m_bFriendSettingsReady&&this.m_CM.steamid.BIsValid()){this.m_bReady=!0;for(var e=0,t=this.m_rgOnReadyCallbacks;e<t.length;e++){(0,t[e])()}this.m_rgOnReadyCallbacks=[]}},e.prototype.OnFriendSettingsChanged=function(e){this.m_FriendsSettings=e,this.m_bFriendSettingsReady=!0,this.SetReady()},Object.defineProperty(e.prototype,"CommunityPreferences",{get:function(){return this.m_CommunityPreferences},enumerable:!0,configurable:!0}),e.prototype.UpdateCommunityPreferences=function(e){var t=R.a({},this.m_CommunityPreferences);void 0!==e.hide_adult_content_violence()&&(t.bHideAdultContentViolence=e.hide_adult_content_violence()),void 0!==e.hide_adult_content_sex()&&(t.bHideAdultContentSex=e.hide_adult_content_sex()),void 0!==e.parenthesize_nicknames()&&(t.bParenthesizeNicknames=e.parenthesize_nicknames()),this.m_ServerCommunityPreferences=R.a({},t),this.m_CommunityPreferences=t},e.prototype.CommunityPreferencesToMessage=function(e){var t=new nt.b;return t.set_hide_adult_content_violence(e.bHideAdultContentViolence),t.set_hide_adult_content_sex(e.bHideAdultContentSex),t.set_parenthesize_nicknames(e.bParenthesizeNicknames),t},e.prototype.SetCommunityPreferences=function(e){var t=this;this.m_CommunityPreferences=e,Co("Messaging.PostMessage")&&SteamClient.Messaging.PostMessage("Settings","CommunityPreferences",JSON.stringify(e)),this.m_unTimerUploadCommunityPreferences&&clearTimeout(this.m_unTimerUploadCommunityPreferences),this.m_unTimerUploadCommunityPreferences=SetBackgroundTimeout(function(){t.m_unTimerUploadCommunityPreferences=void 0,t.UploadCommunityPreferences()},5e3)},e.prototype.UploadCommunityPreferences=function(){var e=!1;if(void 0===this.m_ServerCommunityPreferences)e=!0;else for(var t=0,n=Object.keys(this.m_ServerCommunityPreferences);t<n.length;t++){var o=n[t];if(this.m_ServerCommunityPreferences[o]!==this.CommunityPreferences[o]){e=!0;break}}if(e){var i=m.Init(nt.h);i.Body().set_preferences(this.CommunityPreferencesToMessage(this.CommunityPreferences)),nt.k.SetCommunityPreferences(this.m_CM.GetServiceTransport(),i).then(function(e){})}},Object.defineProperty(e.prototype,"StorePreferences",{get:function(){return this.m_StorePreferences},enumerable:!0,configurable:!0}),e.prototype.FillInChatUsabilityMetrics=function(e){var t=e.settings(),n=this.FriendsSettings;t.set_notifications_show_ingame(n.bNotifications_ShowIngame),t.set_notifications_show_online(n.bNotifications_ShowOnline),t.set_notifications_show_message(n.bNotifications_ShowMessage),t.set_notifications_events_and_announcements(n.bNotifications_EventsAndAnnouncements),t.set_sounds_play_ingame(n.bSounds_PlayIngame),t.set_sounds_play_online(n.bSounds_PlayOnline),t.set_sounds_play_message(n.bSounds_PlayMessage),t.set_sounds_events_and_announcements(n.bSounds_EventsAndAnnouncements),t.set_always_new_chat_window(n.bAlwaysNewChatWindow),t.set_force_alphabetic_friend_sorting(n.bForceAlphabeticFriendSorting),t.set_chat_flash_mode(n.nChatFlashMode),t.set_remember_open_chats(n.bRememberOpenChats),t.set_compact_quick_access(n.bCompactQuickAccess),t.set_compact_friends_list(n.bCompactFriendsList),t.set_notifications_show_chat_room_notification(n.bNotifications_ShowChatRoomNotification),t.set_sounds_play_chat_room_notification(n.bSounds_PlayChatRoomNotification),t.set_hide_offline_friends_in_tag_groups(n.bHideOfflineFriendsInTagGroups),t.set_hide_categorized_friends(n.bHideCategorizedFriends),t.set_categorize_in_game_friends_by_game(n.bCategorizeInGameFriendsByGame),t.set_chat_font_size(n.nChatFontSize),t.set_use24hour_clock(n.b24HourClock),t.set_do_not_disturb_mode(n.bDoNotDisturbMode),t.set_disable_embed_inlining(n.bDisableEmbedInlining),t.set_sign_into_friends(n.bSignIntoFriends)},R.c([d.observable],e.prototype,"m_bReady",void 0),R.c([d.observable],e.prototype,"m_FriendsSettings",void 0),R.c([d.observable],e.prototype,"m_CommunityPreferences",void 0),R.c([d.observable],e.prototype,"m_StorePreferences",void 0),R.c([d.action],e.prototype,"BUpdateFriendsSettings",null),R.c([d.action],e.prototype,"UpdateCommunityPreferences",null),R.c([d.action],e.prototype,"SetCommunityPreferences",null),e}(),wo=function(){return function(e,t){this.m_SettingsStore=e,this.m_fnFriendSettingsChanged=t}}(),Mo=function(o){function e(e,t){var n=o.call(this,e,t)||this;return n.m_bClientInitComplete=!1,n.InternalInit(),n}return R.d(e,o),e.prototype.InternalInit=function(){this.m_bClientInitComplete||(SteamClient&&SteamClient.FriendSettings&&SteamClient.FriendSettings.RegisterForSettingsChanges?(SteamClient.FriendSettings.RegisterForSettingsChanges(this.OnClientSettingsChange.bind(this)),this.m_bClientInitComplete=!0):Object(I.a)(!1,"Can't initialize settings from client"))},e.prototype.OnClientSettingsChange=function(e){var t,n=sn.DefaultFriendsSettings();if("string"!=typeof e){if(t=e.FriendsSettings,SteamClient.FriendSettings&&SteamClient.FriendSettings.SetFriendSettings)return void this.BUpdateSettings(t)}else t=JSON.parse(e,function(e,t){return"b"==e.substring(0,1)&&"number"==typeof t?0!=t:t});Object.assign(n,t),this.m_fnFriendSettingsChanged(n)},e.prototype.BUpdateSettings=function(e){var t=JSON.stringify(e);return SteamClient.FriendSettings.SetFriendSettings(t),!0},e}(wo),Do=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return R.d(n,e),n.prototype.InternalInit=function(){var t=this;this.m_SettingsStore.GetObjectFromLocalStorage(n.k_strLocalStorageKeyPrefix,this.GetDefaultSettings()).then(function(e){t.m_fnFriendSettingsChanged(e.friendsSettings)})},n.prototype.GetDefaultSettings=function(){return{friendsSettings:sn.DefaultFriendsSettings()}},n.prototype.BUpdateSettings=function(e){var t={friendsSettings:e};return this.m_SettingsStore.StoreObjectInLocalStorage(n.k_strLocalStorageKeyPrefix,t)},n.k_strLocalStorageKeyPrefix="LocalStorageFriendsSettings",n}(wo),To=n("fGPn"),Go=n("7t13"),Ro=n("48Gm"),No=function(){function r(e,t){if(!(e instanceof BaseAudioContext))throw"Not a valid audio context.";t||(t={});var n=t.numberOfChannels||1;if(2<n)throw"The maximum supported number of channels is two.";this.context_=e;var o=t.bufferSize||0;this.attack=t.attack||0,this.release=t.release||0;var i=void 0===t.timeConstant?.0025:t.timeConstant;this.threshold=void 0===t.threshold?-100:t.threshold,this.alpha_=this.getAlphaFromTimeConstant_(i,this.context_.sampleRate),this.noiseGateKernel_=this.context_.createScriptProcessor(o,n,n),this.noiseGateKernel_.onaudioprocess=this.onaudioprocess_.bind(this),this.input=new GainNode(this.context_),this.output=new GainNode(this.context_),this.input.connect(this.noiseGateKernel_).connect(this.output),this.previousLevel_=0,this.previousWeight_=1,this.channel_=new Float32Array(this.noiseGateKernel_.bufferSize),this.envelope_=new Float32Array(this.noiseGateKernel_.bufferSize),this.weights_=new Float32Array(this.noiseGateKernel_.bufferSize)}return r.prototype.onaudioprocess_=function(e){var t=e.inputBuffer,n=t.getChannelData(0);if(2===t.numberOfChannels)for(var o=t.getChannelData(1),i=0;i<o.length;i++)this.channel_[i]=(n[i]+o[i])/2;else this.channel_=n;var r=this.detectLevel_(this.channel_),a=this.computeWeights_(r);for(i=0;i<t.numberOfChannels;i++)for(var s=t.getChannelData(i),c=e.outputBuffer.getChannelData(i),l=0;l<s.length;l++)c[l]=a[l]*s[l]},r.prototype.detectLevel_=function(e){this.envelope_[0]=this.alpha_*this.previousLevel_+(1-this.alpha_)*Math.pow(e[0],2);for(var t=1;t<e.length;t++)this.envelope_[t]=this.alpha_*this.envelope_[t-1]+(1-this.alpha_)*Math.pow(e[t],2);return this.previousLevel_=this.envelope_[this.envelope_.length-1],this.envelope_},r.prototype.computeWeights_=function(e){var t=1,n=1;0<this.attack&&(t=1/Math.ceil(this.context_.sampleRate*this.attack)),0<this.release&&(n=1/Math.ceil(this.context_.sampleRate*this.release));for(var o=0;o<e.length;o++){if(r.toDecibel(2*e[o])<this.threshold){var i=this.previousWeight_-t;this.weights_[o]=Math.max(i,0)}else{i=this.previousWeight_+n;this.weights_[o]=Math.min(i,1)}this.previousWeight_=this.weights_[o]}return this.weights_},r.prototype.getAlphaFromTimeConstant_=function(e,t){return Math.exp(-1/(t*e))},r.toDecibel=function(e){return 10*Math.log10(e)},r}(),Lo=function(){function e(e,t){this.m_Analyser=void 0,this.m_rgInputNode=[],this.m_hUpdateInterval=0,this.m_buffer=void 0,this.m_lastTimeNonZero=0,this.m_flVolume=0,this.m_flRoundedVolume=0,this.m_flAveraging=.6,this.m_Analyser=t.createAnalyser(),this.m_Analyser.fftSize=128,this.m_buffer=new Float32Array(this.m_Analyser.fftSize),this.m_rgInputNode.push(e),e.connect(this.m_Analyser),this.StartUpdating()}return e.prototype.GetLastTimeNonZero=function(){return this.m_lastTimeNonZero},e.prototype.StartUpdating=function(){this.StopUpdating(),this.m_hUpdateInterval=SetBackgroundInterval(this.UpdateVolume,60)},e.prototype.StopUpdating=function(){0!=this.m_hUpdateInterval&&ClearBackgroundInterval(this.m_hUpdateInterval),this.m_hUpdateInterval=0},e.prototype.UpdateVolume=function(){this.m_Analyser.getFloatTimeDomainData(this.m_buffer);for(var e=0,t=0;t<this.m_buffer.length;++t){var n=this.m_buffer[t];e+=n*n}var o=Math.sqrt(e/this.m_buffer.length);this.m_flVolume=1.2*Math.max(o,this.m_flVolume*this.m_flAveraging);var i=Math.round(100*this.m_flVolume)/100;i!=this.m_flRoundedVolume&&(this.m_flRoundedVolume=i),0<this.m_flRoundedVolume&&(this.m_lastTimeNonZero=performance.now())},e.prototype.stop=function(){this.StopUpdating(),this.DisconnectAll()},e.prototype.Connect=function(e){this.m_rgInputNode.push(e),null!=this.m_Analyser&&e.connect(this.m_Analyser)},e.prototype.DisconnectAll=function(){for(var e=0;e<this.m_rgInputNode.length;++e){if(this.m_Analyser)try{this.m_rgInputNode[e].disconnect(this.m_Analyser)}catch(e){}this.m_rgInputNode[e]=void 0}this.m_rgInputNode=[]},Object.defineProperty(e.prototype,"rounded_volume",{get:function(){return this.m_flRoundedVolume},enumerable:!0,configurable:!0}),R.c([d.observable],e.prototype,"m_lastTimeNonZero",void 0),R.c([d.observable],e.prototype,"m_flVolume",void 0),R.c([d.observable],e.prototype,"m_flRoundedVolume",void 0),R.c([d.action.bound],e.prototype,"UpdateVolume",null),R.c([d.action.bound],e.prototype,"stop",null),e}(),ko=n("K4CH");(Eo=Io||(Io={}))[Eo.k_EAudioStreamType_Microphone=1]="k_EAudioStreamType_Microphone",Eo[Eo.k_EAudioStreamType_IncomingStream=2]="k_EAudioStreamType_IncomingStream";var Po,Ao,Bo,Fo,Vo=function(){function e(){this.destination_node=void 0,this.source_node=void 0,this.elem=void 0,this.output_gain_node=void 0,this.muted=!1,this.volume_meter=void 0}return R.c([d.observable],e.prototype,"muted",void 0),R.c([d.observable],e.prototype,"volume_meter",void 0),e}();function xo(e){switch(e){case Bo.k_EVoiceCallState_None:return"None";case Bo.k_EVoiceCallState_ScheduledInitiate:return"ScheduledInitiate";case Bo.k_EVoiceCallState_RequestedMicAccess:return"RequestedMicAccess";case Bo.k_EVoiceCallState_LocalMicOnly:return"LocalMicOnly";case Bo.k_EVoiceCallState_CreatePeerConnection:return"CreatePeerConnection";case Bo.k_EVoiceCallState_InitatedWebRTCSession:return"InitiatedWebRTCSession";case Bo.k_EVoiceCallState_WebRTCConnectedWaitingOnIceConnected:return"WaitingOnICEConnected";case Bo.k_EVoiceCallState_RequestedPermission:return"RequestedPermission";case Bo.k_EVoiceCallState_NotifyingVoiceChatOfWebRTCSession:return"NotifyingVoiceChatOfWebRTCSession";case Bo.k_EVoiceCallState_Connected:return"Connected"}}(Ao=Po||(Po={}))[Ao.k_ENoiseGateLevel_Off=0]="k_ENoiseGateLevel_Off",Ao[Ao.k_ENoiseGateLevel_Low=1]="k_ENoiseGateLevel_Low",Ao[Ao.k_ENoiseGateLevel_Medium=2]="k_ENoiseGateLevel_Medium",Ao[Ao.k_ENoiseGateLevel_High=3]="k_ENoiseGateLevel_High",(Fo=Bo||(Bo={}))[Fo.k_EVoiceCallState_None=0]="k_EVoiceCallState_None",Fo[Fo.k_EVoiceCallState_ScheduledInitiate=1]="k_EVoiceCallState_ScheduledInitiate",Fo[Fo.k_EVoiceCallState_RequestedMicAccess=2]="k_EVoiceCallState_RequestedMicAccess",Fo[Fo.k_EVoiceCallState_LocalMicOnly=3]="k_EVoiceCallState_LocalMicOnly",Fo[Fo.k_EVoiceCallState_CreatePeerConnection=4]="k_EVoiceCallState_CreatePeerConnection",Fo[Fo.k_EVoiceCallState_InitatedWebRTCSession=5]="k_EVoiceCallState_InitatedWebRTCSession",Fo[Fo.k_EVoiceCallState_WebRTCConnectedWaitingOnIceConnected=6]="k_EVoiceCallState_WebRTCConnectedWaitingOnIceConnected",Fo[Fo.k_EVoiceCallState_RequestedPermission=7]="k_EVoiceCallState_RequestedPermission",Fo[Fo.k_EVoiceCallState_NotifyingVoiceChatOfWebRTCSession=8]="k_EVoiceCallState_NotifyingVoiceChatOfWebRTCSession",Fo[Fo.k_EVoiceCallState_Connected=9]="k_EVoiceCallState_Connected";var Uo=function(){function e(){this.m_eState=Bo.k_EVoiceCallState_None,this.m_targetAccountID=0,this.m_bInitiatedOneOnOneCall=!1,this.m_bWaitingOnOneOnOneRejoin=!1,this.m_bPostedOneOnOneEndedMsg=!1,this.m_voiceChatID="",this.m_webRTCConnectedNotification=void 0,this.m_webRTCServerIP=0,this.m_webRTCServerPort=0,this.m_webRTCClientIP=0,this.m_webRTCClientPort=0,this.m_nFailuresThisInitiate=0,this.m_bOfferUpdateInProgress=!1,this.m_msgPendingRemoteDescriptionUpdate=void 0,this.m_bIsConnectionAttemptOverTwoSeconds=!1,this.m_nMostRecentRemoteDescriptionVersion="0"}return e.prototype.BMatchingCall=function(e,t){return 0!=e&&this.m_targetAccountID==e||!(!this.m_chatRoom||!t||this.m_chatRoom.chatID!=t.chatID||this.m_chatRoom.groupID!=t.groupID)},e.prototype.BCallActiveForGroup=function(e){return this.m_chatRoom&&this.m_chatRoom.groupID==e},R.c([d.observable],e.prototype,"m_eState",void 0),R.c([d.observable],e.prototype,"m_targetAccountID",void 0),R.c([d.observable],e.prototype,"m_bInitiatedOneOnOneCall",void 0),R.c([d.observable],e.prototype,"m_bWaitingOnOneOnOneRejoin",void 0),R.c([d.observable],e.prototype,"m_bPostedOneOnOneEndedMsg",void 0),R.c([d.observable],e.prototype,"m_chatRoom",void 0),R.c([d.observable],e.prototype,"m_voiceChatID",void 0),R.c([d.observable],e.prototype,"m_nFailuresThisInitiate",void 0),R.c([d.observable],e.prototype,"m_bIsConnectionAttemptOverTwoSeconds",void 0),e}(),jo=function(){return function(){this.m_SSRC=0,this.m_MostRecentDelayEstimateMs=0,this.m_MostRecentJitterReceivedMs=0,this.m_CurrentJitterBufferMs=0,this.m_PacketsReceived=0,this.m_PacketsLost=0,this.m_PacketsSent=0,this.m_BytesSent=0,this.m_googRTT=0,this.m_BytesReceived=0,this.m_DecodingThroughNetEQ=0,this.m_DecodingPacketLossCorrection=0,this.m_DecodingPacketLossFadeNoiseGeneration=0,this.m_DecodingComfortNoiseGeneration=0,this.m_DecodingNormal=0,this.m_DecodingSilenceGenerator=0,this.m_DecodingMuted=0}}(),Ho="SteamVoiceSettings",Wo=function(){function e(e){this.m_VoiceInputGain=1,this.m_VoiceOutputGain=1,this.m_NoiseGateLevel=Po.k_ENoiseGateLevel_Medium,this.m_VoiceUseEchoCancellation=!0,this.m_VoiceUseNoiseCancellation=!0,this.m_VoiceUseAutoGainControl=!0,this.m_SelectedMicID="default",this.m_SelectedOutputID="default",this.m_bPlayPTTSounds=!0,this.m_bSettingsLoaded=!1,this.m_bHasResetOpenMicHotkey=!1,this.m_SettingsStore=e}return e.prototype.SaveToLocalStorage=function(){this.m_SettingsStore.StoreObjectInLocalStorage(Ho,{inputGain:this.m_VoiceInputGain,outputGain:this.m_VoiceOutputGain,noiseGateLevel:this.m_NoiseGateLevel,noiseCancellation:this.m_VoiceUseNoiseCancellation,echoCancellation:this.m_VoiceUseEchoCancellation,autoGainControl:this.m_VoiceUseAutoGainControl,selectedMic:this.m_SelectedMicID,selectedOutput:this.m_SelectedOutputID,pttSoundsEnabled:this.m_bPlayPTTSounds,hasResetOpenMicHotKey:this.m_bHasResetOpenMicHotkey})},e.prototype.LoadFromLocalStorage=function(t){var n=this;this.m_SettingsStore.GetObjectFromLocalStorageWhenReady(Ho,void 0).then(function(e){null!=e&&(null!=e.inputGain&&(n.m_VoiceInputGain=e.inputGain),null!=e.outputGain&&(n.m_VoiceOutputGain=e.outputGain),null!=e.noiseGateLevel&&(n.m_NoiseGateLevel=e.noiseGateLevel),null!=e.noiseCancellation&&(n.m_VoiceUseNoiseCancellation=e.noiseCancellation),null!=e.autoGainControl&&(n.m_VoiceUseAutoGainControl=e.autoGainControl),null!=e.echoCancellation&&(n.m_VoiceUseEchoCancellation=e.echoCancellation),null!=e.selectedMic&&(n.m_SelectedMicID=e.selectedMic),null!=e.selectedOutput&&(n.m_SelectedOutputID=e.selectedOutput),null!=e.pttSoundsEnabled&&(n.m_bPlayPTTSounds=e.pttSoundsEnabled),null!=e.hasResetOpenMicHotKey&&(n.m_bHasResetOpenMicHotkey=e.hasResetOpenMicHotKey)),n.m_bSettingsLoaded=!0,t.LogMsg("(VoiceChat) Settings loaded from local storage"),t.RefreshPushToTalkKeySettings()})},R.c([d.observable],e.prototype,"m_VoiceInputGain",void 0),R.c([d.observable],e.prototype,"m_VoiceOutputGain",void 0),R.c([d.observable],e.prototype,"m_NoiseGateLevel",void 0),R.c([d.observable],e.prototype,"m_VoiceUseEchoCancellation",void 0),R.c([d.observable],e.prototype,"m_VoiceUseNoiseCancellation",void 0),R.c([d.observable],e.prototype,"m_VoiceUseAutoGainControl",void 0),R.c([d.observable],e.prototype,"m_SelectedMicID",void 0),R.c([d.observable],e.prototype,"m_SelectedOutputID",void 0),R.c([d.observable],e.prototype,"m_bPlayPTTSounds",void 0),R.c([d.observable],e.prototype,"m_bSettingsLoaded",void 0),R.c([d.observable],e.prototype,"m_bHasResetOpenMicHotkey",void 0),e}(),zo=function(){function e(){this.muted=!1,this.gain=1}return R.c([d.observable],e.prototype,"muted",void 0),R.c([d.observable],e.prototype,"gain",void 0),e}(),qo=function(){function e(){this.mic_muted_locally=!1,this.output_muted_locally=!1,this.has_no_mic_for_session=!1}return R.c([d.observable],e.prototype,"mic_muted_locally",void 0),R.c([d.observable],e.prototype,"output_muted_locally",void 0),R.c([d.observable],e.prototype,"has_no_mic_for_session",void 0),e}(),Ko=function(){function e(){this.partner_accountid=0,this.voice_chatid="",this.previously_joined=!1,this.audio_repeat=0,this.audio_buffer=void 0}return e.prototype.ClearAudioRepeats=function(){0!=this.audio_repeat&&(ClearBackgroundTimeout(this.audio_repeat),this.audio_repeat=0),null!=this.audio_buffer&&(this.audio_buffer.StopPlayback(),this.audio_buffer=void 0)},R.c([d.observable],e.prototype,"partner_accountid",void 0),R.c([d.observable],e.prototype,"voice_chatid",void 0),R.c([d.observable],e.prototype,"previously_joined",void 0),e}(),Yo=function(){function o(e){var l=this;if(this.m_VoiceCallState=new Uo,this.m_mapOneOnOneCallsWaitingJoinOrAccept=d.observable.map(),this.m_hRegisterForPushToTalkStateChange=null,this.m_bPushToTalkEnabled=!1,this.m_bPushToMuteEnabled=!1,this.m_bVoicePTTStateEnabled=!1,this.m_VKPushToTalkHotKey=0,this.m_strPushToTalkDisplayString="",this.m_hPushToTalkReleaseTimeout=0,this.m_ConnectionCheck=0,this.m_ScheduledInitiate=0,this.m_ScheduledVoiceLogsUpload=0,this.m_bClientSideLogsUploadInProgress=!1,this.m_nLastLogLineUploaded=0,this.m_StatsTimeout=0,this.m_bUserHasDeniedMicPermissions=!1,this.m_bOutputMuted=!1,this.m_AudioContext=void 0,this.m_rgAudioStreams=Object(d.observable)([]),this.m_MicVolumeMeter=void 0,this.m_MicNoiseGate=void 0,this.m_MicInputGainNode=void 0,this.m_rgLogLines=[],this.m_mapSSRCToAccountID=new Map,this.m_mapAccountIDToStats=new Map,this.m_mapPerUserOutputGain=d.observable.map(),this.m_mapUserVoiceStatus=d.observable.map(),this.m_LogVoiceChatDetails=!1,this.m_VoiceEchoLocalMic=!1,this.m_bLocalMicEchoStateBeforeMicTest=!1,this.m_bLocalMicTestActive=!1,this.m_bForceConnectingStatus=!1,this.m_bForceReconnectingStatus=!1,this.m_OnWebRTCUpdateRemoteDescriptionHandler=a(Ro.c.NotifyWebRTCUpdateRemoteDescriptionHandler,function(e){return l.m_VoiceCallState.m_eState<Bo.k_EVoiceCallState_InitatedWebRTCSession?(l.LogMsg("(WebRTC) Hit NotifyWebRTCUpdateRemoteDescriptionHandler in wrong state "+l.m_VoiceCallState.m_eState),2):(l.m_VoiceCallState.m_bOfferUpdateInProgress?(l.LogMsg("(WebRTC) Hit NotifyWebRTCUpdateRemoteDescriptionHandler while already updating, queing work"),l.m_VoiceCallState.m_msgPendingRemoteDescriptionUpdate=e.Body()):l.ProcessUpdatedRemoteDescription(e.Body()),1)}),this.m_OnWebRTCConnectionHandler=a(Ro.c.NotifyWebRTCSessionConnectedHandler,function(e){return l.m_VoiceCallState.m_eState<Bo.k_EVoiceCallState_InitatedWebRTCSession?(l.LogMsg("(WebRTC) Hit NotifyWebRTCSessionConnectedHandler in wrong state "+l.m_VoiceCallState.m_eState),2):(l.m_VoiceCallState.m_webRTCConnectedNotification=e.Body(),l.m_VoiceCallState.m_webRTCServerIP=l.m_VoiceCallState.m_webRTCConnectedNotification.server_ip(),l.m_VoiceCallState.m_webRTCServerPort=l.m_VoiceCallState.m_webRTCConnectedNotification.server_port(),l.m_VoiceCallState.m_webRTCClientIP=l.m_VoiceCallState.m_webRTCConnectedNotification.client_ip(),l.m_VoiceCallState.m_webRTCClientPort=l.m_VoiceCallState.m_webRTCConnectedNotification.client_port(),"completed"==l.m_PeerConnection.iceConnectionState||"connected"==l.m_PeerConnection.iceConnectionState?(l.LogMsg("(VoiceChat) ICE state is already connected after successful SetRemoteDescription, joining voice chat immediately"),l.JoinVoiceChatOrAskForOneOnOneChatNow()):(l.LogMsg("(VoiceChat) ICE state is not connected after successful SetRemoteDescription, waiting for UDP connetivity"),l.m_VoiceCallState.m_eState=Bo.k_EVoiceCallState_WebRTCConnectedWaitingOnIceConnected),1)}),this.m_OnVoiceAllUsersStatusUpdate=a(Go.h.NotifyAllUsersVoiceStatusHandler,function(e){if(l.m_VoiceCallState.m_voiceChatID!=e.Body().voice_chatid())return 1;for(var t=0;t<e.Body().users().length;++t){var n=e.Body().users()[t];l.UpdateUserVoiceStatus(n)}return 1}),this.m_OnVoiceStatusUpdate=a(Go.h.NotifyUserVoiceStatusHandler,function(e){return l.UpdateUserVoiceStatus(e.Body()),1}),this.m_VoiceChatResponseHandler=a(Go.h.NotifyOneOnOneChatResponseHandler,function(e){if(l.m_VoiceCallState.m_eState>=Bo.k_EVoiceCallState_RequestedPermission){var t=new D.a(e.Body().steamid_partner());if(e.Body().voicechat_id()!=l.m_VoiceCallState.m_voiceChatID)l.LogMsg("(VoiceChat) Got response from "+t.GetAccountID()+" but for different voice chat than we are in, ignoring. ");else if(t.GetAccountID()==l.m_VoiceCallState.m_targetAccountID&&1==e.Body().accepted_request())l.LogMsg("(VoiceChat) Got acceptance from "+t.GetAccountID()+" "+e.Hdr().steamid()),ci.AudioPlaybackManager.PlayAudioURL(G.a.COMMUNITY_CDN_URL+"public/sounds/webui/steam_voice_channel_enter.m4a?v=1"),l.OnVoiceChatAccepted(!0);else{l.LogMsg("(VoiceChat) Rejected by "+t.GetAccountID());var n=ci.ChatStore.GetFriendChat(t.GetAccountID(),!1),o=ci.FriendStore.GetFriend(t.GetAccountID());null!=n&&null!=o&&(l.m_VoiceCallState.m_bPostedOneOnOneEndedMsg=!0,n.AddVoiceChannelInviteMsg(t.GetAccountID(),ci.GetServerRTime32(),Object($.b)("#FriendMsg_VoiceChannelEndedExplicit",o.display_name))),l.DeleteOneOnOneCallWaitingJoinOrAccept(t.GetAccountID()),ci.AudioPlaybackManager.PlayAudioURL(G.a.COMMUNITY_CDN_URL+"public/sounds/webui/steam_voice_channel_exit.m4a?v=1"),l.OnVoiceChatAccepted(!1)}}return 1}),this.m_IncomingVoiceChatRequestHandler=a(Go.h.NotifyOneOnOneChatRequestedHandler,function(e){var t=new D.a(e.Body().steamid_partner()),n=e.Body().voice_chatid(),o=ci.FriendStore.GetFriend(t.GetAccountID());if(null==o||o.is_blocked||ci.FriendStore.BIsInvisibleMode()||ci.FriendStore.GetUserDoNotDisturb())return l.LogMsg("(VoiceChat) Rejecting one-on-one voice chat request because partner is not a friend, is blocked, we are invisible, or we are DND"),l.OnRejectOneOnOneVoiceChat(t,e.Body().voice_chatid()),1;var i=new Ko;i.partner_accountid=l.m_CMInterface.steamid.GetAccountID(),i.voice_chatid=n,i.previously_joined=!1;var r=l;if(i.audio_repeat=SetBackgroundTimeout(function(){i.audio_repeat=0,r.PlayRingSound(t.GetAccountID())},2e4),l.m_mapOneOnOneCallsWaitingJoinOrAccept.set(t.GetAccountID(),i),l.LogMsg("(VoiceChat) voice chat request from "+t.GetAccountID()),l.LogMsg("(VoiceChat) current state "+l.m_VoiceCallState.m_eState),l.m_VoiceCallState.m_targetAccountID==t.GetAccountID())return l.LogMsg("(VoiceChat) We are already trying to one on one chat this user, just auto-acceptting to re-sync."),l.OnAcceptOneOnOneVoiceChat(t,n),1;ci.NotificationManager.DisplayNotificationFromFriend(o,{title:o.display_name,body:Object($.b)("#Friend_RequestingOneOnOneChat",o.display_name),tag:"state_"+o.accountid,steamid:o.persona.m_steamid.ConvertTo64BitString()});var a=ci.ChatStore.GetFriendChat(t.GetAccountID(),!0);return null!=a&&(a.AddVoiceChannelInviteMsg(t.GetAccountID(),ci.GetServerRTime32(),Object($.b)("#FriendMsg_VoiceChannelInvite",o.display_name,a.self.display_name)),ci.UIStore.ShowAndOrActivateChat(ci.GetDefaultBrowserContext(),a,!1)),l.PlayRingSound(o.accountid),1}),this.m_VoiceChatEndedHandler=a(Go.h.NotifyVoiceChatEndedHandler,function(e){for(var t=e.Body().voice_chatid(),n=0,o=Array.from(l.m_mapOneOnOneCallsWaitingJoinOrAccept.keys());n<o.length;n++){var i=o[n],r=l.m_mapOneOnOneCallsWaitingJoinOrAccept.get(i);if(null!=r&&r.voice_chatid==t){l.LogMsg("(VoiceChat) OneOnOne VoiceChat we were invited too with "+i+" has ended and is no longer joinable."),ci.AudioPlaybackManager.PlayAudioURL(G.a.COMMUNITY_CDN_URL+"public/sounds/webui/steam_voice_channel_exit.m4a?v=1");var a=Number(i);l.DeleteOneOnOneCallWaitingJoinOrAccept(a);var s=ci.ChatStore.GetFriendChat(a,!1),c=ci.FriendStore.GetFriend(a);null!=s&&(c?s.AddVoiceChannelInviteMsg(c.accountid,ci.GetServerRTime32(),Object($.b)("#FriendMsg_VoiceChannelEndedExplicit",c.display_name)):s.AddVoiceChannelInviteMsg(l.m_CMInterface.steamid.GetAccountID(),ci.GetServerRTime32(),Object($.b)("#FriendMsg_VoiceChannelEnded")),l.m_VoiceCallState.m_targetAccountID==Number(i)&&(l.m_VoiceCallState.m_bPostedOneOnOneEndedMsg=!0))}}if(t==l.m_VoiceCallState.m_voiceChatID){if(0!=l.m_VoiceCallState.m_targetAccountID)null==(s=ci.ChatStore.GetFriendChat(l.m_VoiceCallState.m_targetAccountID,!1))||l.m_VoiceCallState.m_bPostedOneOnOneEndedMsg||(l.m_VoiceCallState.m_bPostedOneOnOneEndedMsg=!0,s.AddVoiceChannelInviteMsg(l.m_CMInterface.steamid.GetAccountID(),ci.GetServerRTime32(),Object($.b)("#FriendMsg_VoiceChannelEnded")));0!=l.m_VoiceCallState.m_targetAccountID&&l.m_VoiceCallState.m_eState>Bo.k_EVoiceCallState_RequestedPermission&&ci.AudioPlaybackManager.PlayAudioURL(G.a.COMMUNITY_CDN_URL+"public/sounds/webui/steam_voice_channel_exit.m4a?v=1"),l.LogMsg("(VoiceChat) Got voice chat end notification from server for active chatid"),l.EndVoiceChatInternal(!1)}return 1}),this.m_VoiceChatEnteredNotification=a(Go.h.NotifyUserJoinedVoiceChatHandler,function(e){if(e.Body().voice_chatid()==l.m_VoiceCallState.m_voiceChatID){var t=new D.a(e.Body().user_steamid());l.LogMsg("(VoiceChat) User "+t.Render()+" has just JOINED our active voice chat"),0!=l.m_VoiceCallState.m_targetAccountID&&l.m_VoiceCallState.m_targetAccountID==t.GetAccountID()&&(l.m_VoiceCallState.m_bWaitingOnOneOnOneRejoin=!1)}return 1}),this.m_VoiceChatLeftNotification=a(Go.h.NotifyUserLeftVoiceChatHandler,function(e){if(e.Body().voice_chatid()==l.m_VoiceCallState.m_voiceChatID){var t=new D.a(e.Body().user_steamid());l.LogMsg("(VoiceChat) User "+t.Render()+" has just LEFT our active voice chat"),0!=l.m_VoiceCallState.m_targetAccountID&&l.m_VoiceCallState.m_targetAccountID==t.GetAccountID()&&(l.m_VoiceCallState.m_bWaitingOnOneOnOneRejoin=!0)}return 1}),this.m_ShouldRejoinChatRoomVoiceChatHandler=a(pe.U.NotifyShouldRejoinChatRoomVoiceChatHandler,function(e){var t={groupID:e.Body().chat_group_id(),chatID:e.Body().chat_id()};return l.m_VoiceCallState.m_eState>Bo.k_EVoiceCallState_ScheduledInitiate&&l.m_VoiceCallState.BMatchingCall(0,t)&&(l.LogMsg("(ChatRoom) Notified that we need to rejoin new voicechat session for chat room... doing so now..."),l.EndVoiceChatInternal(!0),l.InitiateVoiceChat(0,t)),1}),this.m_Settings=new Wo(e),this.m_Settings.LoadFromLocalStorage(this),"undefined"!=typeof SteamClient&&null!=SteamClient&&null!=SteamClient.WebChat&&(null!=SteamClient.WebChat.RegisterForPushToTalkStateChange&&(this.m_hRegisterForPushToTalkStateChange=SteamClient.WebChat.RegisterForPushToTalkStateChange(this.OnPushToTalkStateChange)),null!=SteamClient.WebChat.SetVoiceChatActive))try{SteamClient.WebChat.SetVoiceChatActive(!1)}catch(e){}}return o.prototype.Init=function(e){this.m_CMInterface=e,window.SetVoiceEchoLocalMic=this.SetVoiceEchoLocalMic,window.SetVoiceLogDetails=this.SetVoiceLogDetails,window.SetVoiceForceReconnectingStatus=this.ForceReconnectingStatus,window.SetVoiceForceConnectingStatus=this.ForceConnectingStatus},o.prototype.RefreshPushToTalkKeySettings=function(){var t=this;"undefined"!=typeof SteamClient&&null!=SteamClient.WebChat&&null!=SteamClient.WebChat.GetPushToTalkEnabled&&SteamClient.WebChat.GetPushToTalkEnabled().then(function(e){t.m_bPushToTalkEnabled=e.bEnabled,t.m_VKPushToTalkHotKey=e.vkHotKey,e.bPushToMute&&(t.m_bPushToMuteEnabled=e.bEnabled,t.m_bPushToTalkEnabled=!1),t.m_strPushToTalkDisplayString=e.strKeyName,t.m_bPushToTalkEnabled||t.m_bPushToMuteEnabled||null!=SteamClient.WebChat&&null!=SteamClient.WebChat.SetPushToTalkHotKey&&(Object(I.a)(t.m_Settings.m_bSettingsLoaded,"Settings not loaded but RefreshPushToTalkKeySettings hit"),t.m_Settings.m_bHasResetOpenMicHotkey||(t.m_Settings.m_bHasResetOpenMicHotkey=!0,t.m_Settings.SaveToLocalStorage(),console.log("Reset Open Mic hotkey to None on first run of new client in open mic mode"),SteamClient.WebChat.SetPushToTalkHotKey(0),t.RefreshPushToTalkKeySettings()))})},o.prototype.InitiateFriendChat=function(e){this.BPartnerHasRequestedAndIsInOneOnOneChat(e)?this.AcceptPartnersOneOnOneChatRequest(e):(this.InitiateVoiceChat(e,null),ci.AudioPlaybackManager.PlayAudioURL(G.a.COMMUNITY_CDN_URL+"public/sounds/webui/steam_phonecall.m4a?v=1"))},o.prototype.InitiateRoomChat=function(e,t){this.InitiateVoiceChat(0,{groupID:e,chatID:t})},o.prototype.EndLocalMicTest=function(){this.m_bLocalMicTestActive=!1,this.m_VoiceCallState.m_eState==Bo.k_EVoiceCallState_LocalMicOnly&&this.EndVoiceChatInternal(!1),this.SetVoiceEchoLocalMic(this.m_bLocalMicEchoStateBeforeMicTest)},o.prototype.IsLocalMicTestActive=function(){return this.m_bLocalMicTestActive},o.prototype.InitiateLocalMicTest=function(){this.m_bLocalMicTestActive=!0,this.m_bLocalMicEchoStateBeforeMicTest=this.m_VoiceEchoLocalMic,this.SetVoiceEchoLocalMic(!0),this.m_VoiceCallState.m_eState==Bo.k_EVoiceCallState_None&&this.InitiateVoiceChat(0,null)},o.prototype.AcceptPartnersOneOnOneChatRequest=function(e){var t=this.m_mapOneOnOneCallsWaitingJoinOrAccept.get(e);if(null==t)return!1;t.ClearAudioRepeats();var n=D.a.InitFromAccountID(e);return this.OnAcceptOneOnOneVoiceChat(n,t.voice_chatid),!0},o.prototype.OnRejectOneOnOneVoiceChatForPartner=function(e){var t=this.m_mapOneOnOneCallsWaitingJoinOrAccept.get(e);if(null==t)return!1;t.ClearAudioRepeats();var n=D.a.InitFromAccountID(e);this.OnRejectOneOnOneVoiceChat(n,t.voice_chatid),this.m_mapOneOnOneCallsWaitingJoinOrAccept.delete(e);var o=ci.ChatStore.GetFriendChat(e,!1),i=ci.FriendStore.self;return null!=o&&null!=i&&(this.m_VoiceCallState.m_targetAccountID==e&&this.m_VoiceCallState.m_bPostedOneOnOneEndedMsg||o.AddVoiceChannelInviteMsg(i.accountid,ci.GetServerRTime32(),Object($.b)("#FriendMsg_VoiceChannelEndedExplicit",i.display_name)),this.m_VoiceCallState.m_targetAccountID==e&&(this.m_VoiceCallState.m_bPostedOneOnOneEndedMsg=!0)),!0},o.prototype.OnUserLeaveOneOnOneVoiceChat=function(){0!=this.m_VoiceCallState.m_targetAccountID||this.m_VoiceCallState.m_eState==Bo.k_EVoiceCallState_None?(this.LogMsg("(VoiceChat) User asking to leave but not end one-on-one chat with: "+this.m_VoiceCallState.m_targetAccountID),this.EndVoiceChatInternal(!1)):this.LogMsg("(VoiceChat) OnUserLeaveOneOnOneVoiceChat called when in a group not one-on-one chat!")},o.prototype.OnUserEndVoiceChat=function(){var t=this;if(this.m_VoiceCallState.m_eState!=Bo.k_EVoiceCallState_None&&0!=this.m_VoiceCallState.m_targetAccountID){if(!this.m_VoiceCallState.m_bPostedOneOnOneEndedMsg){var e=ci.ChatStore.GetFriendChat(this.m_VoiceCallState.m_targetAccountID,!1),n=ci.FriendStore.self;null!=e&&null!=n&&(this.m_VoiceCallState.m_bPostedOneOnOneEndedMsg=!0,e.AddVoiceChannelInviteMsg(ci.CMInterface.steamid.GetAccountID(),ci.GetServerRTime32(),Object($.b)("#FriendMsg_VoiceChannelEndedExplicit",n.display_name)))}var o=this.m_VoiceCallState.m_targetAccountID;this.m_VoiceCallState.m_targetAccountID=0;var i=m.Init(Go.b);i.Body().set_steamid_partner(D.a.InitFromAccountID(o).ConvertTo64BitString()),this.DeleteOneOnOneCallWaitingJoinOrAccept(o),Go.i.EndOneOnOneChat(this.m_CMInterface.GetServiceTransport(),i).then(function(e){1==e.GetEResult()?t.LogMsg("(VoiceChat) Ended voice chat with "+o):t.LogMsg("(VoiceChat) Failed ending voice chat with "+o)})}0!=this.m_VoiceCallState.m_targetAccountID&&this.DeleteOneOnOneCallWaitingJoinOrAccept(this.m_VoiceCallState.m_targetAccountID),this.EndVoiceChatInternal(!1)},o.prototype.SetSelectedMic=function(e){e!=this.m_Settings.m_SelectedMicID&&(this.LogMsg("(VoiceChat) Set selected mic "+e),this.m_Settings.m_SelectedMicID=e,this.m_Settings.SaveToLocalStorage(),this.RestartVoiceChatIfConnected())},o.prototype.SetSelectedOutput=function(e){e!=this.m_Settings.m_SelectedOutputID&&(this.LogMsg("(VoiceChat) Set selected output "+e),this.m_Settings.m_SelectedOutputID=e,this.m_Settings.SaveToLocalStorage(),this.RestartVoiceChatIfConnected())},o.prototype.GetAudioWorkletSupport=function(){return ci.AudioPlaybackManager.supports_audio_worklets},o.prototype.GetUserDeniedMicAccess=function(){return this.m_bUserHasDeniedMicPermissions},o.prototype.GetSelectedMic=function(){return this.m_Settings.m_SelectedMicID},o.prototype.GetSelectedOutputDevice=function(){return this.m_Settings.m_SelectedOutputID},o.prototype.SetUseEchoCancellation=function(e){e!=this.m_Settings.m_VoiceUseEchoCancellation&&(this.m_Settings.m_VoiceUseEchoCancellation=e,this.m_Settings.SaveToLocalStorage(),this.RestartVoiceChatIfConnected())},o.prototype.GetUseEchoCancellation=function(){return this.m_Settings.m_VoiceUseEchoCancellation},o.prototype.SetUseNoiseCancellation=function(e){e!=this.m_Settings.m_VoiceUseNoiseCancellation&&(this.m_Settings.m_VoiceUseNoiseCancellation=e,this.m_Settings.SaveToLocalStorage(),this.RestartVoiceChatIfConnected())},o.prototype.GetUseNoiseCancellation=function(){return this.m_Settings.m_VoiceUseNoiseCancellation},o.prototype.SetUseAutoGainControl=function(e){e!=this.m_Settings.m_VoiceUseAutoGainControl&&(this.m_Settings.m_VoiceUseAutoGainControl=e,this.m_Settings.SaveToLocalStorage(),this.RestartVoiceChatIfConnected())},o.prototype.GetUseAutoGainControl=function(){return this.m_Settings.m_VoiceUseAutoGainControl},o.prototype.SetVoiceEchoLocalMic=function(e){this.m_VoiceEchoLocalMic=e,this.UpdateNoiseGateOnActiveMic()},o.prototype.GetVoiceEchoLocalMic=function(){return this.m_VoiceEchoLocalMic},o.prototype.GetPushToTalkOrMuteSoundsEnabled=function(){return this.m_Settings.m_bPlayPTTSounds},o.prototype.SetPushToTalkOrMuteSoundsEnabled=function(e){this.m_Settings.m_bPlayPTTSounds!=e&&(this.m_Settings.m_bPlayPTTSounds=e,this.m_Settings.SaveToLocalStorage())},o.prototype.SetPushToTalkEnabled=function(e){this.m_bPushToTalkEnabled=e,this.m_bPushToMuteEnabled=!1},o.prototype.GetPushToTalkEnabled=function(){return this.m_bPushToTalkEnabled},o.prototype.SetPushToMuteEnabled=function(e){this.m_bPushToMuteEnabled=e,this.m_bPushToTalkEnabled=!1},o.prototype.GetPushToMuteEnabled=function(){return this.m_bPushToMuteEnabled},o.prototype.GetPushToTalkVoiceStateEnabled=function(){return this.m_bVoicePTTStateEnabled},o.prototype.GetPushToTalkHotKeyVK=function(){return this.m_VKPushToTalkHotKey},o.prototype.GetPushToTalkHotKeyDisplayString=function(){return this.m_strPushToTalkDisplayString},o.prototype.SetVoiceLogDetails=function(e){this.m_LogVoiceChatDetails=e},o.prototype.GetVoiceLogDetails=function(){return this.m_LogVoiceChatDetails},o.prototype.SetUseNoiseGateLevel=function(e){e!=this.m_Settings.m_NoiseGateLevel&&(this.LogMsg("(VoiceChat) Nose Gate Level: "+e),this.m_Settings.m_NoiseGateLevel=e,this.m_Settings.SaveToLocalStorage(),this.UpdateNoiseGateOnActiveMic())},o.prototype.GetUseNoiseGateLevel=function(){return this.m_Settings.m_NoiseGateLevel},o.prototype.SetVoiceInputGain=function(e){this.m_Settings.m_VoiceInputGain!=e&&(this.m_Settings.m_VoiceInputGain=Math.max(0,Math.min(e,o.k_MaxInputOutputGainValue)),this.LogMsg("(VoiceChat) New mic Input Gain value is "+this.m_Settings.m_VoiceInputGain),null!=this.m_MicInputGainNode&&this.m_MicInputGainNode.gain.setValueAtTime(this.GetCurrentVoiceInputGainTarget(),this.m_AudioContext.currentTime),this.m_Settings.SaveToLocalStorage())},o.prototype.GetVoiceInputGain=function(){return this.m_Settings.m_VoiceInputGain},o.prototype.SetVoiceOutputGain=function(e){if(this.m_Settings.m_VoiceOutputGain!=e){this.m_Settings.m_VoiceOutputGain=Math.max(0,Math.min(e,o.k_MaxInputOutputGainValue)),this.LogMsg("(VoiceChat) New global OutputGain value is "+this.m_Settings.m_VoiceOutputGain),this.m_Settings.SaveToLocalStorage();for(var t=0;t<this.m_rgAudioStreams.length;++t){var n=this.m_rgAudioStreams[t];n.output_gain_node&&(n.type==Io.k_EAudioStreamType_Microphone?n.output_gain_node.gain.setValueAtTime(this.m_Settings.m_VoiceOutputGain,this.m_AudioContext.currentTime):n.output_gain_node.gain.setValueAtTime(this.m_Settings.m_VoiceOutputGain*this.GetPerUserGainLevel(n.accountid),this.m_AudioContext.currentTime))}}},o.prototype.GetVoiceOutputGain=function(){return this.m_Settings.m_VoiceOutputGain},o.prototype.GetUserMutedRemotely=function(e){var t=this.m_mapUserVoiceStatus.get(e);return null==t&&(t=new qo,this.m_mapUserVoiceStatus.set(e,t)),t.mic_muted_locally},o.prototype.GetOutputMutedRemotely=function(e){var t=this.m_mapUserVoiceStatus.get(e);return null==t&&(t=new qo,this.m_mapUserVoiceStatus.set(e,t)),t.output_muted_locally},o.prototype.GetUserHasNoMicForSession=function(e){var t=this.m_mapUserVoiceStatus.get(e);return null==t&&(t=new qo,this.m_mapUserVoiceStatus.set(e,t)),t.has_no_mic_for_session},o.prototype.ConvertSliderToGainValue=function(e,t){return e=e<=50?e/50*1:1+t*((e-50)/50)},o.prototype.ConvertGainValueToSliderValue=function(e,t){return e<=1?50*e:50+(e-1)/t*50},o.prototype.ForceReconnectingStatus=function(e){this.m_bForceReconnectingStatus=!0},o.prototype.ForceConnectingStatus=function(e){this.m_bForceConnectingStatus=!0},o.prototype.GetActiveChatRoomGroupID=function(){return this.m_VoiceCallState.m_eState==Bo.k_EVoiceCallState_None?"":this.m_VoiceCallState.m_chatRoom?this.m_VoiceCallState.m_chatRoom.groupID:""},o.prototype.GetActiveVoiceChatID=function(){return this.m_VoiceCallState.m_eState==Bo.k_EVoiceCallState_None?"":this.m_VoiceCallState.m_chatRoom?this.m_VoiceCallState.m_chatRoom.chatID:""},o.prototype.BInitiatedOneOnOneChat=function(e){return this.m_VoiceCallState.m_eState!=Bo.k_EVoiceCallState_None&&(this.m_VoiceCallState.m_targetAccountID==e&&this.m_VoiceCallState.m_bInitiatedOneOnOneCall)},o.prototype.ToggleMicMuting=function(){for(var e=0;e<this.m_rgAudioStreams.length;++e){var t=this.m_rgAudioStreams[e];if(t.type==Io.k_EAudioStreamType_Microphone){t.muted=!t.muted;for(var n=t.stream.getTracks(),o=0;o<n.length;o++)n[o].enabled=!t.muted;t.muted?this.m_MicInputGainNode.gain.setValueAtTime(0,this.m_AudioContext.currentTime+.2):this.m_MicInputGainNode.gain.setValueAtTime(this.GetCurrentVoiceInputGainTarget(),this.m_AudioContext.currentTime)}}this.SendVoiceStatusUpdate()},o.prototype.BHasSampleRateTooHighInBrowser=function(){return!G.a.IN_CLIENT&&48e3<ci.AudioPlaybackManager.GetLastObservedSampleRate()},o.prototype.BNoMicAvailableForSession=function(){if(this.m_VoiceCallState.m_eState<=Bo.k_EVoiceCallState_RequestedMicAccess)return!1;if(this.BHasSampleRateTooHighInBrowser())return!0;for(var e=0;e<this.m_rgAudioStreams.length;++e)if(this.m_rgAudioStreams[e].type==Io.k_EAudioStreamType_Microphone)return!1;return!0},o.prototype.IsMicMuted=function(){for(var e=0;e<this.m_rgAudioStreams.length;++e)if(this.m_rgAudioStreams[e].type==Io.k_EAudioStreamType_Microphone)return this.m_rgAudioStreams[e].muted;return!1},o.prototype.ToggleOutputMuting=function(){this.m_bOutputMuted=!this.m_bOutputMuted;for(var e=0;e<this.m_rgAudioStreams.length;++e){var t=this.m_rgAudioStreams[e];if(t.type==Io.k_EAudioStreamType_IncomingStream){t.muted=this.m_bOutputMuted||this.GetPerUserMuting(t.accountid);for(var n=t.stream.getTracks(),o=0;o<n.length;o++)n[o].enabled=!this.m_bOutputMuted}}this.SendVoiceStatusUpdate()},o.prototype.IsOutputMuted=function(){return this.m_bOutputMuted},o.prototype.GetActiveOneOnOneVoiceChatAccountID=function(){return this.m_VoiceCallState.m_eState==Bo.k_EVoiceCallState_None?0:this.m_VoiceCallState.m_targetAccountID},Object.defineProperty(o.prototype,"audio_streams",{get:function(){return this.m_rgAudioStreams},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"mic_volume",{get:function(){return this.m_MicVolumeMeter},enumerable:!0,configurable:!0}),o.prototype.get_volume=function(e){if(e==this.m_CMInterface.steamid.GetAccountID()){if(this.IsMicMuted()||this.m_VoiceCallState.m_eState!=Bo.k_EVoiceCallState_Connected&&this.m_VoiceCallState.m_eState!=Bo.k_EVoiceCallState_LocalMicOnly)return 0}else if(this.m_VoiceCallState.m_eState!=Bo.k_EVoiceCallState_Connected)return 0;for(var t=0,n=0;n<this.m_rgAudioStreams.length;++n){var o=this.m_rgAudioStreams[n];o.accountid==e&&null!=o.volume_meter&&(t=Math.max(t,o.volume_meter.rounded_volume))}return t},o.prototype.GetPerUserGainLevel=function(e){var t=this.m_mapPerUserOutputGain.get(e);return null==t?1:t.gain},o.prototype.GetPerUserMuting=function(e){var t=this.m_mapPerUserOutputGain.get(e);return null!=t&&t.muted},o.prototype.SetPerUserMuting=function(e,t){var n=this.m_mapPerUserOutputGain.get(e);null==n&&(n=new zo),n.muted=t||this.m_bOutputMuted,this.m_mapPerUserOutputGain.set(e,n),this.UpdateStreamsForPerUseGainChange(e)},o.prototype.SetPerUserGainLevel=function(e,t){var n=Math.max(0,Math.min(4,t)),o=this.m_mapPerUserOutputGain.get(e);null==o&&(o=new zo),o.gain=n,o.gain<.001?o.muted=!0:o.muted=!1,this.m_mapPerUserOutputGain.set(e,o),this.UpdateStreamsForPerUseGainChange(e)},o.prototype.UpdateStreamsForPerUseGainChange=function(e){var t=this.m_mapPerUserOutputGain.get(e);null==t&&(t=new zo);for(var n=0;n<this.m_rgAudioStreams.length;++n){var o=this.m_rgAudioStreams[n];if(o.accountid==e&&null!=o.output_gain_node){o.muted=t.muted,o.output_gain_node.gain.setValueAtTime(this.m_Settings.m_VoiceOutputGain*t.gain,this.m_AudioContext.currentTime);for(var i=o.stream.getTracks(),r=0;r<i.length;r++)i[r].enabled=!o.muted}}},o.prototype.OnUserLeftChatRoomVoiceChat=function(e,t,n,o){var i={groupID:e,chatID:t};this.m_VoiceCallState.m_eState>Bo.k_EVoiceCallState_RequestedPermission&&this.m_VoiceCallState.BMatchingCall(0,i)&&(n!=this.m_CMInterface.steamid.GetAccountID()||o||(this.LogMsg("(ChatRoom) We were told that we left chat "+t+" but we hadn't initiated that, trying to reconnect..."),this.RestartVoiceChatIfConnected()))},o.prototype.IsMicTestActive=function(){return this.m_VoiceCallState.m_eState==Bo.k_EVoiceCallState_LocalMicOnly},o.prototype.IsAnyVoiceActive=function(){return!(this.m_VoiceCallState.m_eState<=Bo.k_EVoiceCallState_LocalMicOnly&&0==this.m_VoiceCallState.m_targetAccountID&&null==this.m_VoiceCallState.m_chatRoom)&&(this.m_VoiceCallState.m_eState!=Bo.k_EVoiceCallState_None||0!=this.m_ScheduledInitiate)},o.prototype.BSelfHasAcceptedOrInitiatedOneOnOneChat=function(e){return this.m_VoiceCallState.m_eState!=Bo.k_EVoiceCallState_None&&this.m_VoiceCallState.m_targetAccountID==e&&(!!this.m_VoiceCallState.m_bInitiatedOneOnOneCall||this.m_VoiceCallState.m_eState>=Bo.k_EVoiceCallState_NotifyingVoiceChatOfWebRTCSession)},o.prototype.BSelfHadPreviouslyJoinedOneOnOneChat=function(e){var t=this.m_mapOneOnOneCallsWaitingJoinOrAccept.get(e);if(null==t){var n=new Ko;return this.m_mapOneOnOneCallsWaitingJoinOrAccept.set(e,n),!1}if(t.partner_accountid!=this.m_CMInterface.steamid.GetAccountID())return!1;var o=t.voice_chatid;return t.previously_joined&&""!=o},o.prototype.BPartnerHasAcceptedOrInitiatedOneOnOneChat=function(e){return!(this.m_VoiceCallState.m_eState!=Bo.k_EVoiceCallState_None||this.m_VoiceCallState.m_bInitiatedOneOnOneCall||!this.BPartnerHasRequestedAndIsInOneOnOneChat(e))||this.m_VoiceCallState.m_eState>Bo.k_EVoiceCallState_RequestedPermission&&!this.m_VoiceCallState.m_bWaitingOnOneOnOneRejoin},o.prototype.BPartnerHasRequestedAndIsInOneOnOneChat=function(e){var t=this.m_mapOneOnOneCallsWaitingJoinOrAccept.get(e);if(null!=t)return t.partner_accountid==this.m_CMInterface.steamid.GetAccountID()&&""!=t.voice_chatid;var n=new Ko;return this.m_mapOneOnOneCallsWaitingJoinOrAccept.set(e,n),!1},o.prototype.IsAttemptingInitialConnection=function(){return(0==this.m_VoiceCallState.m_targetAccountID||this.m_VoiceCallState.m_eState!=Bo.k_EVoiceCallState_RequestedPermission)&&(this.m_VoiceCallState.m_eState!=Bo.k_EVoiceCallState_LocalMicOnly&&(this.IsAnyVoiceActive()&&0==this.m_VoiceCallState.m_nFailuresThisInitiate&&this.m_VoiceCallState.m_eState!=Bo.k_EVoiceCallState_Connected))},o.prototype.HasBeenAttemptingOverTwoSeconds=function(){var e=this.m_VoiceCallState.m_bIsConnectionAttemptOverTwoSeconds,t=this.IsAttemptingInitialConnection();return!!this.m_bForceConnectingStatus||e&&t},o.prototype.IsAttemptingReconnect=function(){var e=this.IsAnyVoiceActive(),t=this.m_VoiceCallState.m_nFailuresThisInitiate,n=this.m_VoiceCallState.m_eState;return!!this.m_bForceReconnectingStatus||e&&0<t&&n!=Bo.k_EVoiceCallState_Connected},o.prototype.IsVoiceActiveForFriend=function(e){return this.IsVoiceActive(e,null)},o.prototype.IsVoiceActiveForRoom=function(e,t){return this.IsVoiceActive(0,{groupID:e,chatID:t})},o.prototype.IsVoiceActiveForGroup=function(e){return!!this.m_VoiceCallState.BCallActiveForGroup(e)&&this.m_VoiceCallState.m_eState!=Bo.k_EVoiceCallState_None},o.prototype.LogMsg=function(e){this.m_rgLogLines.push(e),this.m_LogVoiceChatDetails&&console.log(e)},o.prototype.GetVoiceLogs=function(){return this.m_rgLogLines.join("\r\n")},o.prototype.OnPushToTalkReleased=function(){this.m_bPushToTalkEnabled&&null!=this.m_MicInputGainNode&&!this.m_bVoicePTTStateEnabled?this.m_MicInputGainNode.gain.setValueAtTime(this.GetCurrentVoiceInputGainTarget(),this.m_AudioContext.currentTime+.2):this.m_bPushToMuteEnabled&&null!=this.m_MicInputGainNode&&this.m_bVoicePTTStateEnabled&&this.m_MicInputGainNode.gain.setValueAtTime(this.GetCurrentVoiceInputGainTarget(),this.m_AudioContext.currentTime+.2)},o.prototype.DebouncedToggleMicMuting=function(){this.ToggleMicMuting(),this.GetPushToTalkOrMuteSoundsEnabled()&&(this.IsMicMuted()?ci.AudioPlaybackManager.PlayAudioURL(G.a.COMMUNITY_CDN_URL+"public/sounds/webui/steam_ui_ptt_short_02_quiet.m4a"):ci.AudioPlaybackManager.PlayAudioURL(G.a.COMMUNITY_CDN_URL+"public/sounds/webui/steam_ui_ptt_short_01_quiet.m4a"))},o.prototype.OnPushToTalkStateChange=function(e){var t=e,n=!1;ci.SettingsStore.BClientHasFeatureOrOnWeb("NewVoiceHotKeyState")&&(n=!0,this.m_bPushToMuteEnabled&&(t=!e)),!n||this.m_bPushToTalkEnabled||this.m_bPushToMuteEnabled?t!=this.m_bVoicePTTStateEnabled&&(this.m_bVoicePTTStateEnabled=t,(this.m_bPushToTalkEnabled||this.m_bPushToMuteEnabled)&&null!=this.m_MicInputGainNode&&(this.m_bVoicePTTStateEnabled?(this.GetPushToTalkOrMuteSoundsEnabled()&&ci.AudioPlaybackManager.PlayAudioURL(G.a.COMMUNITY_CDN_URL+"public/sounds/webui/steam_ui_ptt_short_01_quiet.m4a"),this.m_bPushToMuteEnabled?this.m_hPushToTalkReleaseTimeout=SetBackgroundTimeout(this.OnPushToTalkReleased,100):(this.m_MicInputGainNode.gain.setValueAtTime(this.GetCurrentVoiceInputGainTarget(),this.m_AudioContext.currentTime),0!=this.m_hPushToTalkReleaseTimeout&&ClearBackgroundTimeout(this.m_hPushToTalkReleaseTimeout))):(this.GetPushToTalkOrMuteSoundsEnabled()&&ci.AudioPlaybackManager.PlayAudioURL(G.a.COMMUNITY_CDN_URL+"public/sounds/webui/steam_ui_ptt_short_02_quiet.m4a"),this.m_bPushToMuteEnabled?(this.m_MicInputGainNode.gain.setValueAtTime(this.GetCurrentVoiceInputGainTarget(),this.m_AudioContext.currentTime),0!=this.m_hPushToTalkReleaseTimeout&&ClearBackgroundTimeout(this.m_hPushToTalkReleaseTimeout)):this.m_hPushToTalkReleaseTimeout=SetBackgroundTimeout(this.OnPushToTalkReleased,100)))):e&&null!=this.m_MicInputGainNode&&this.DebouncedToggleMicMuting()},o.prototype.GetCurrentVoiceInputGainTarget=function(){return this.m_bPushToTalkEnabled&&!this.m_bVoicePTTStateEnabled?0:this.m_bPushToMuteEnabled&&!this.m_bVoicePTTStateEnabled?0:this.m_Settings.m_VoiceInputGain},o.prototype.RestartVoiceChatIfConnected=function(){if(this.m_VoiceCallState.m_eState>Bo.k_EVoiceCallState_ScheduledInitiate){var e=this.m_VoiceCallState.m_targetAccountID,t=this.m_VoiceCallState.m_chatRoom;this.LogMsg("(WebRTC) Ending then auto-re-initiating voice chat - without leave of chatroom if joined as attempt is quick rejoin"),this.EndVoiceChatInternal(!0),this.InitiateVoiceChat(e,t)}},o.prototype.GetNoiseGateOptions=function(){var e={attack:2,release:.01,threshold:-80,bufferSize:1024};switch(this.m_Settings.m_NoiseGateLevel){case Po.k_ENoiseGateLevel_Off:break;case Po.k_ENoiseGateLevel_Low:e={attack:.8,release:.06,threshold:-48,bufferSize:1024};break;case Po.k_ENoiseGateLevel_Medium:e={attack:.8,release:.06,threshold:-36,bufferSize:1024};break;case Po.k_ENoiseGateLevel_High:e={attack:.8,release:.09,threshold:-22,bufferSize:1024}}return e},o.prototype.DeleteOneOnOneCallWaitingJoinOrAccept=function(e){var t=this.m_mapOneOnOneCallsWaitingJoinOrAccept.get(e);null!=t&&(t.ClearAudioRepeats(),this.m_mapOneOnOneCallsWaitingJoinOrAccept.delete(e))},o.prototype.UpdateNoiseGateOnActiveMic=function(){if(null!=this.m_MicInputGainNode){for(var e=void 0,t=0;t<this.m_rgAudioStreams.length;++t){var n=this.m_rgAudioStreams[t];if(n.type==Io.k_EAudioStreamType_Microphone){e=n;break}}if(null!=e){if(null!=this.m_MicNoiseGate)this.m_MicInputGainNode.disconnect(this.m_MicNoiseGate.input),this.m_MicNoiseGate.input?(this.m_MicNoiseGate.input.disconnect(),this.m_MicNoiseGate.output.disconnect(),this.m_MicNoiseGate.noiseGateKernel_.disconnect()):this.m_MicNoiseGate.disconnect(),this.m_MicNoiseGate=void 0;else{this.m_MicInputGainNode.disconnect(e.destination_node);try{this.m_MicInputGainNode.disconnect(e.output_gain_node)}catch(e){}}this.m_MicVolumeMeter.stop(),this.m_MicVolumeMeter=void 0,null!=e.volume_meter&&(e.volume_meter.stop(),e.volume_meter=void 0),this.m_Settings.m_NoiseGateLevel!=Po.k_ENoiseGateLevel_Off?this.SetupNoiseGateOnMic(e.destination_node):this.m_MicInputGainNode.connect(e.destination_node);var o=e.source_node;this.m_MicNoiseGate&&(o=this.m_MicNoiseGate.output?this.m_MicNoiseGate.output:this.m_MicNoiseGate),this.m_MicVolumeMeter=new Lo(o,this.m_AudioContext),e.volume_meter=this.m_MicVolumeMeter,this.m_VoiceEchoLocalMic&&null==this.m_MicNoiseGate?this.m_MicInputGainNode.connect(e.output_gain_node):this.m_VoiceEchoLocalMic&&(this.m_MicNoiseGate.output?this.m_MicNoiseGate.output.connect(e.output_gain_node):this.m_MicNoiseGate.connect(e.output_gain_node))}}},o.prototype.OnAudioContextStateChange=function(){null!=this.m_AudioContext&&this.LogMsg("(WebAudio) Audio context state changed: "+this.m_AudioContext.state)},o.prototype.OnIceCandidate=function(e){this.LogMsg("(ICE) Local candidate: "+JSON.stringify(e.candidate))},o.prototype.AddRemoteIceCandidate=function(e,t){var n=this.LogMsg;n("(ICE) Candidate from remote peer: "+JSON.stringify(t)),e.addIceCandidate(t).then(function(){}).catch(function(e){n("addIceCandidate error: "+e+" "+e.name)})},o.prototype.OnSignalingStateChange=function(e,t){this.LogMsg("(WebRTC) OnSignalingStateChange: "+e.signalingState)},o.prototype.OnIceConnectionStateChange=function(e,t){this.LogMsg("(ICE) OnIceConnectionStateChange: "+e.iceConnectionState),"failed"==e.iceConnectionState&&this.m_VoiceCallState.m_eState>Bo.k_EVoiceCallState_CreatePeerConnection?this.BackOffAndRetryInitiateVoiceChat():"completed"!=e.iceConnectionState&&"connected"!=e.iceConnectionState||this.m_VoiceCallState.m_eState!=Bo.k_EVoiceCallState_WebRTCConnectedWaitingOnIceConnected||(this.LogMsg("(VoiceChat) ICE connection state now 'completed' or 'connected', proceeding to join voice chat"),this.JoinVoiceChatOrAskForOneOnOneChatNow())},o.prototype.OnIceGatheringStateChange=function(e,t){this.LogMsg("(ICE) OnIceGatheringStateChange: "+e.iceGatheringState)},o.prototype.RemoveStreamToOutput=function(e){this.LogMsg("(WebRTC) RemoveStreamToOutput - "+e.id+" - "+e.getTracks().length);for(var t=0;t<this.m_rgAudioStreams.length;++t){var n=this.m_rgAudioStreams[t];if(n.unique_id==e.id){if(n.elem.pause(),n.elem.srcObject=void 0,n.elem.src=void 0,n.elem=void 0,null!=n.volume_meter&&(n.volume_meter.stop(),n.volume_meter=void 0),null!=n.output_gain_node&&(n.output_gain_node.disconnect(),n.output_gain_node=void 0),null!=n.source_node){try{n.source_node.disconnect()}catch(e){}n.source_node=void 0}return void this.m_rgAudioStreams.splice(t,1)}}},o.prototype.OnRemoveRemoteStream=function(e){this.RemoveStreamToOutput(e.stream)},o.prototype.SetupAudioStreamElementAndCreateSourceNode=function(e,t){var n=-1!=this.m_PeerConnection.localDescription.sdp.indexOf("mozilla...");null!=e.source_node&&(e.source_node.disconnect(),e.source_node=void 0),null==e.elem?e.elem=document.createElement("audio"):e.elem.srcObject=void 0,e.elem.srcObject=t,e.source_node=n?(e.elem.play(),this.m_AudioContext.createMediaElementSource(e.elem)):this.m_AudioContext.createMediaStreamSource(t)},o.prototype.AddStreamToOutput=function(e){var t=new Vo;this.SetupAudioStreamElementAndCreateSourceNode(t,e),t.unique_id=e.id,t.stream=e,t.type=Io.k_EAudioStreamType_IncomingStream;var n=e.id.match(/Peer-(\d+)-(\d+)-/);if(n&&3==n.length?t.accountid=Number(n[2]):t.accountid=0,this.LogMsg("(VoiceChat) AddStreamToOutput "+t.accountid+" "+t.unique_id),t.muted=this.m_bOutputMuted||this.GetPerUserMuting(t.accountid),t.muted)for(var o=t.stream.getTracks(),i=0;i<o.length;i++)o[i].enabled=!t.muted;this.m_rgAudioStreams.push(t),t.output_gain_node=this.m_AudioContext.createGain(),t.output_gain_node.gain.setValueAtTime(this.m_Settings.m_VoiceOutputGain*this.GetPerUserGainLevel(t.accountid),this.m_AudioContext.currentTime),t.output_gain_node.connect(ci.AudioPlaybackManager.GetActiveDestination()),t.source_node.connect(t.output_gain_node),t.volume_meter=new Lo(t.source_node,this.m_AudioContext),t.volume_meter.Connect(t.source_node)},o.prototype.OnAddTrack=function(e,t){for(var n=0;n<this.m_rgAudioStreams.length;++n){var o=this.m_rgAudioStreams[n];if(o.unique_id==e.id&&(this.LogMsg("(VoiceChat) OnAddTrack to existing stream "+o.accountid+" "+o.unique_id),o.volume_meter.DisconnectAll(),this.SetupAudioStreamElementAndCreateSourceNode(o,e),o.volume_meter.Connect(o.source_node),o.source_node.connect(o.output_gain_node),o.muted))for(var i=o.stream.getTracks(),r=0;r<i.length;r++)i[r].enabled=!o.muted}},o.prototype.OnAddRemoteStream=function(e){if(this.LogMsg("(WebRTC) OnAddRemoteStream - "+e.stream.id+" - "+e.stream.getTracks().length),null!=this.m_AudioContext){if(null!=e.stream&&null!=this.m_AudioContext){this.AddStreamToOutput(e.stream);var t=this;e.stream.onaddtrack=function(e){t.OnAddTrack(this,e)}}}else this.LogMsg("(WebRTC)Got OnAddRemoteStream when we don't have audio context... stopped chat?")},o.prototype.ModifyLocalSDPBeforeSetting=function(e){for(var t=/a=rtpmap:(\d+)\sopus(.*)/,n=/a=fmtp:(\d+)\s(.*)/,o=e.sdp.split("\r\n"),i=-1!=e.sdp.indexOf("mozilla..."),r=!1,a=0;a<o.length;++a){var s=o[a];if("m="==s.substr(0,2)&&a+1<o.length){for(var c="0",l=a+1;l<o.length;++l){if("m="==(s=o[l]).substr(0,2)){a=l-1;break}if(p=s.match(t)){c=p[1];break}}if("0"!=c)for(l=a+1;l<o.length;++l){if("m="==(s=o[l]).substr(0,2)){a=l-1;break}var p;if((p=s.match(n))&&p[1]==c){i||(o[l]="a=fmtp:"+p[1]+" minptime=10;useinbandfec=1;usedtx=1"),r=!0;break}}}}return r&&(e.sdp=o.join("\r\n")),e},o.prototype.OnCreateOfferSuccess=function(e,t){if(this.m_VoiceCallState.m_eState==Bo.k_EVoiceCallState_CreatePeerConnection){this.LogMsg("(WebRTC) OnCreateOfferSuccess");var n=this;t=this.ModifyLocalSDPBeforeSetting(t),e.setLocalDescription(t).then(function(){var e=m.Init(Ro.b);e.Body().set_sdp(JSON.stringify(t)),n.LogMsg("(WebRTC) Offer (Local Description): "+e.Body().sdp()),n.m_VoiceCallState.m_eState=Bo.k_EVoiceCallState_InitatedWebRTCSession,Ro.d.InitiateWebRTCConnection(n.m_CMInterface.GetServiceTransport(),e).then(function(e){if(null==n.m_PeerConnection)n.LogMsg("(WebRTC) Got response to InitiateWebRTCConnection with no local peer connection"),n.EndVoiceChatInternal(!1);else if(1==e.GetEResult()){var t=JSON.parse(e.Body().remote_description());n.m_PeerConnection.setRemoteDescription(new RTCSessionDescription(t)).then(function(){n.LogMsg("(WebRTC) Remote Description: "+t.sdp),"offer"==t.type?(n.LogMsg("(WebRTC) !! received 'offer' rather than 'answer' from InitiateWebRTCConnection, unexpected."),n.EndVoiceChatInternal(!1)):"answer"==t.type&&n.LogMsg("(WebRTC) setRemoteDescription success")}).catch(function(e){n.LogMsg("(WebRTC) setRemoteDescription error: "+e),n.LogMsg("(VoiceChat) Fatal error, ending chat"),n.EndVoiceChatInternal(!1)})}else n.LogMsg("(WebRTC) Got failure ("+e.GetEResult()+") response from InitiateWebRTCConnection"),n.BackOffAndRetryInitiateVoiceChat()}).catch(function(e){n.LogMsg("(WebRTC) Failure in WebRTCClientService.InitiateWebRTCConnection"),n.BackOffAndRetryInitiateVoiceChat()})}).catch(function(e){n.LogMsg("(WebRTC) setLocalDescription error: "+e),n.LogMsg("(VoiceChat) Fatal error, ending voice chat"),n.EndVoiceChatInternal(!1)})}else this.LogMsg("(WebRTC) Hit OnCreateOfferSuccess in wrong state "+this.m_VoiceCallState.m_eState)},o.prototype.OnCreateOfferError=function(e){this.LogMsg("(WebRTC) OnCreateOfferError: "+e),this.LogMsg("(VoiceChat) Fatal Error, ending chat attempt"),this.EndVoiceChatInternal(!1)},o.prototype.CreatePeerConnection=function(e){var t=this,n=new RTCPeerConnection({sdpSemantics:"plan-b"});return n.onicecandidate=function(e){t.OnIceCandidate(e)},n.onaddstream=this.OnAddRemoteStream,n.onremovestream=this.OnRemoveRemoteStream,n.oniceconnectionstatechange=function(e){t.OnIceConnectionStateChange(n,e)},n.onicegatheringstatechange=function(e){t.OnIceGatheringStateChange(n,e)},n.onsignalingstatechange=function(e){t.OnSignalingStateChange(n,e)},null!=e&&n.addStream(e),this.m_PeerConnection=n,this.m_PeerConnection},o.prototype.OnMicStreamInactive=function(e,t){this.LogMsg("(WebRTC) Mic Stream went inactive: "+t.type),this.m_VoiceCallState.m_eState>Bo.k_EVoiceCallState_RequestedMicAccess&&(this.LogMsg("(WebRTC) Ending then auto-re-initiating voice chat without mic"),this.RestartVoiceChatIfConnected())},o.prototype.OnNoiseGateMessage=function(e){this.LogMsg("(VoiceChat) "+e.data)},o.prototype.SetupNoiseGateOnMic=function(e){var t=this.GetNoiseGateOptions();if(ci.AudioPlaybackManager.supports_audio_worklets){this.LogMsg("(VoiceChat) Audio Worklets supported - high performance mic noisegate in use!");var n=window;this.m_MicNoiseGate=new n.AudioWorkletNode(this.m_AudioContext,"noisegate-processor"),this.m_MicNoiseGate.port.onmessage=this.OnNoiseGateMessage,this.m_MicInputGainNode.connect(this.m_MicNoiseGate).connect(e),this.m_MicNoiseGate.parameters.get("threshold").setValueAtTime(t.threshold,this.m_AudioContext.currentTime),this.m_MicNoiseGate.parameters.get("attack").setValueAtTime(t.attack,this.m_AudioContext.currentTime),this.m_MicNoiseGate.parameters.get("release").setValueAtTime(t.release,this.m_AudioContext.currentTime),this.m_MicNoiseGate.parameters.get("sampleRate").setValueAtTime(this.m_AudioContext.sampleRate,this.m_AudioContext.currentTime)}else this.LogMsg("(VoiceChat) Browser doesn't support audio worklets, mic perf will suffer and may stutter/echo during repaint/high CPU usage"),this.m_MicNoiseGate=new No(this.m_AudioContext,t),this.m_MicInputGainNode.connect(this.m_MicNoiseGate.input),this.m_MicNoiseGate.output.connect(e)},o.prototype.OnGetUserMediaSuccess=function(e){if(this.m_VoiceCallState.m_eState==Bo.k_EVoiceCallState_RequestedMicAccess){if(this.m_VoiceCallState.m_eState=Bo.k_EVoiceCallState_CreatePeerConnection,null!=e){e.id;var t=this.m_AudioContext.createMediaStreamSource(e),n=this;e.oninactive=function(e){n.OnMicStreamInactive(this,e)},this.m_MicInputGainNode=this.m_AudioContext.createGain(),this.m_MicInputGainNode.gain.setValueAtTime(this.GetCurrentVoiceInputGainTarget(),this.m_AudioContext.currentTime),t.connect(this.m_MicInputGainNode);var o=void 0;if(this.m_Settings.m_NoiseGateLevel!=Po.k_ENoiseGateLevel_Off)o=this.m_AudioContext.createMediaStreamDestination(),this.SetupNoiseGateOnMic(o),e=o.stream;else o=this.m_AudioContext.createMediaStreamDestination(),this.m_MicInputGainNode.connect(o),e=o.stream;var i=new Vo;i.unique_id=e.id,i.destination_node=o,i.stream=e,i.source_node=t,i.type=Io.k_EAudioStreamType_Microphone,i.accountid=this.m_CMInterface.steamid.GetAccountID(),i.muted=!1,i.elem=void 0,i.output_gain_node=this.m_AudioContext.createGain(),i.output_gain_node.gain.setValueAtTime(this.m_Settings.m_VoiceOutputGain,this.m_AudioContext.currentTime),i.output_gain_node.connect(ci.AudioPlaybackManager.GetActiveDestination()),this.m_rgAudioStreams.push(i);var r=t;this.m_MicNoiseGate&&(r=null!=this.m_MicNoiseGate.output?this.m_MicNoiseGate.output:this.m_MicNoiseGate),this.m_MicVolumeMeter=void 0,this.m_MicVolumeMeter=new Lo(r,this.m_AudioContext),i.volume_meter=this.m_MicVolumeMeter,this.m_VoiceEchoLocalMic&&null==this.m_MicNoiseGate?this.m_MicInputGainNode.connect(i.output_gain_node):this.m_VoiceEchoLocalMic&&(this.m_MicNoiseGate.output?this.m_MicNoiseGate.output.connect(i.output_gain_node):this.m_MicNoiseGate.connect(i.output_gain_node))}if(0!=this.m_VoiceCallState.m_targetAccountID||null!=this.m_VoiceCallState.m_chatRoom){var a=this.CreatePeerConnection(e),s=this;a.createOffer({offerToReceiveAudio:1,offerToReceiveVideo:0,voiceActivityDetection:!0}).then(function(e){s.OnCreateOfferSuccess(a,e)}).catch(function(e){s.OnCreateOfferError(e)})}else this.m_VoiceCallState.m_eState=Bo.k_EVoiceCallState_LocalMicOnly,this.m_VoiceCallState.m_timeFinishedConnecting=performance.now()}else{for(var c=0,l=e.getTracks();c<l.length;c++){l[c].stop()}this.LogMsg("(VoiceChat) Hit OnGetUserMediaSuccess in wrong state "+this.m_VoiceCallState.m_eState)}},o.prototype.OnGetUserMediaFailure=function(e){if(!(this.m_VoiceCallState.m_eState<=Bo.k_EVoiceCallState_ScheduledInitiate)){var t=this,n=navigator;n.permissions&&n.permissions.query({name:"microphone"}).then(function(e){"granted"==e.stat||("denied"==e.state?t.m_bUserHasDeniedMicPermissions=!0:e.state)}),this.LogMsg("(WebAudio) The following error occured getting audio stream: "+e.name),this.OnGetUserMediaSuccess(void 0)}},o.prototype.InitiateChatRoomVoice=function(){this.m_VoiceCallState.m_eState>Bo.k_EVoiceCallState_ScheduledInitiate?this.LogMsg("(VoiceChat) Hit InitiateChatRoomVoice in wrong state "+this.m_VoiceCallState.m_eState):ci.AudioPlaybackManager.SetVoiceActive(this.OnRequestMicrophoneAccess)},o.prototype.JoinVoiceChatOrAskForOneOnOneChatNow=function(){var e,o=this;0==this.m_VoiceCallState.m_targetAccountID?(this.m_VoiceCallState.m_eState=Bo.k_EVoiceCallState_RequestedPermission,(e=m.Init(pe.w)).Body().set_chat_group_id(this.m_VoiceCallState.m_chatRoom.groupID),e.Body().set_chat_id(this.m_VoiceCallState.m_chatRoom.chatID),this.LogMsg("(VoiceChat) InitiateChatRoomVoice request to group: "+this.m_VoiceCallState.m_chatRoom.groupID+", room: "+this.m_VoiceCallState.m_chatRoom.chatID),pe.V.JoinVoiceChat(this.m_CMInterface.GetServiceTransport(),e).then(function(e){1==e.GetEResult()?(o.m_VoiceCallState.m_voiceChatID=e.Body().voice_chatid(),o.OnVoiceChatAccepted(!0)):2==e.GetEResult()?o.BackOffAndRetryInitiateVoiceChat():o.OnVoiceChatAccepted(!1)}).catch(function(e){o.BackOffAndRetryInitiateVoiceChat()})):(this.m_VoiceCallState.m_eState=Bo.k_EVoiceCallState_RequestedPermission,""==this.m_VoiceCallState.m_voiceChatID?((e=m.Init(Go.d)).Body().set_steamid_partner(D.a.InitFromAccountID(this.m_VoiceCallState.m_targetAccountID).ConvertTo64BitString()),this.LogMsg("(VoiceChat) InitiateOneOnOneVoiceChat request to "+this.m_VoiceCallState.m_targetAccountID),Go.i.RequestOneOnOneChat(this.m_CMInterface.GetServiceTransport(),e).then(function(e){if(1==e.GetEResult()){o.LogMsg("(VoiceChat) Waiting on acceptance from "+o.m_VoiceCallState.m_targetAccountID),o.m_VoiceCallState.m_voiceChatID=e.Body().voice_chatid();var t=ci.FriendStore.self,n=ci.ChatStore.GetFriendChat(o.m_VoiceCallState.m_targetAccountID,!1);null!=t&&null!=n&&n.AddVoiceChannelInviteMsg(o.m_CMInterface.steamid.GetAccountID(),ci.GetServerRTime32(),Object($.b)("#FriendMsg_VoiceChannelInvite",t.display_name,n.chat_partner.display_name))}else o.LogMsg("(VoiceChat) Initiating voice chat to "+o.m_VoiceCallState.m_targetAccountID+" has failed."),o.EndVoiceChatInternal(!1)})):this.OnVoiceChatAccepted(!0))},o.prototype.OnVoiceChatAccepted=function(e){this.m_VoiceCallState.m_eState<Bo.k_EVoiceCallState_RequestedPermission?this.LogMsg("(VoiceChat) Hit OnVoiceChatAccepted in wrong state "+this.m_VoiceCallState.m_eState):null!=this.m_VoiceCallState.m_webRTCConnectedNotification?e?(this.m_VoiceCallState.m_targetAccountID?(this.m_VoiceCallState.m_bIsConnectionAttemptOverTwoSeconds=!1,this.m_VoiceCallState.m_timeStartedConnecting=performance.now(),this.LogMsg("(VoiceChat) Call accepted to individual "+this.m_VoiceCallState.m_targetAccountID)):this.m_VoiceCallState.m_chatRoom&&this.LogMsg("(VoiceChat) Call accepted to room "+this.m_VoiceCallState.m_chatRoom.chatID),this.OnWebRTCConnectedAndVoiceChatConnected()):this.m_VoiceCallState.m_targetAccountID?(this.LogMsg("(VoiceChat) Call rejected to individual "+this.m_VoiceCallState.m_targetAccountID),this.OnUserEndVoiceChat()):this.m_VoiceCallState.m_chatRoom&&(this.LogMsg("(VoiceChat) Call rejected to room "+this.m_VoiceCallState.m_chatRoom.chatID),this.EndVoiceChatInternal(!1)):this.LogMsg("(VoiceChat) Hit OnVoiceChatAccepted without WebRTC connected")},o.prototype.InitiateOneOnOneVoiceChat=function(e){this.m_VoiceCallState.m_eState>Bo.k_EVoiceCallState_ScheduledInitiate?this.LogMsg("(VoiceChat) Hit InitiateOneOnOneVoiceChat in wrong state "+this.m_VoiceCallState.m_eState):ci.AudioPlaybackManager.SetVoiceActive(this.OnRequestMicrophoneAccess)},o.prototype.IPIntToString=function(e){return(e>>>24)+"."+(e>>16&255)+"."+(e>>8&255)+"."+(255&e)},o.prototype.OnSetUpdatedLocalDescriptionSuccess=function(){this.LogMsg("(WebRTC) OnSetUpdatedLocalDescriptionSuccess");var e=m.Init(Ro.a);e.Body().set_ip_webrtc_server(this.m_VoiceCallState.m_webRTCServerIP),e.Body().set_port_webrtc_server(this.m_VoiceCallState.m_webRTCServerPort),e.Body().set_ip_webrtc_session_client(this.m_VoiceCallState.m_webRTCClientIP),e.Body().set_port_webrtc_session_client(this.m_VoiceCallState.m_webRTCClientPort),e.Body().set_remote_description_version(this.m_VoiceCallState.m_nMostRecentRemoteDescriptionVersion),Ro.d.AcknowledgeUpdatedRemoteDescription(this.m_CMInterface.GetServiceTransport(),e).then(function(e){})},o.prototype.OnSetUpdatedLocalDescriptionFailure=function(e){this.LogMsg("(WebRTC) OnSetUpdatedLocalDescriptionFailure: "+e),this.EndVoiceChatInternal(!1)},o.prototype.OnCreateAnswerSuccess=function(e){this.LogMsg("(WebRTC) OnCreateAnswerSuccess: "+JSON.stringify(e));var t=this;if(this.m_PeerConnection.setLocalDescription(e).then(function(){t.OnSetUpdatedLocalDescriptionSuccess()}).catch(function(e){t.OnSetUpdatedLocalDescriptionFailure(e)}),this.m_VoiceCallState.m_bOfferUpdateInProgress=!1,null!=this.m_VoiceCallState.m_msgPendingRemoteDescriptionUpdate){var n=this.m_VoiceCallState.m_msgPendingRemoteDescriptionUpdate;this.m_VoiceCallState.m_msgPendingRemoteDescriptionUpdate=void 0,this.ProcessUpdatedRemoteDescription(n)}},o.prototype.OnCreateAnswerError=function(e){this.LogMsg("(WebRTC) OnCreateAnswerError: "+e),this.EndVoiceChatInternal(!1)},o.prototype.ProcessUpdatedRemoteDescription=function(e){this.m_VoiceCallState.m_bOfferUpdateInProgress=!0,this.m_mapSSRCToAccountID.clear();for(var t=e.ssrcs_to_accountids(),n=0;n<t.length;++n){var o=t[n];this.m_mapSSRCToAccountID.set(o.ssrc(),o.accountid())}var i=this,r=JSON.parse(e.remote_description());return this.m_PeerConnection.setRemoteDescription(new RTCSessionDescription(r)).then(function(){i.LogMsg("(WebRTC) Updated Remote Description: "+r.sdp),"offer"==r.type?(i.LogMsg("(WebRTC) setRemoteDescription success with new offer"),i.m_PeerConnection.createAnswer().then(function(e){i.OnCreateAnswerSuccess(e)}).catch(function(e){i.OnCreateAnswerError(e)}),i.m_VoiceCallState.m_nMostRecentRemoteDescriptionVersion=e.remote_description_version()):"answer"==r.type&&(i.LogMsg("(WebRTC) setRemoteDescription success"),i.m_VoiceCallState.m_bOfferUpdateInProgress=!1)}).catch(function(e){i.LogMsg("(WebRTC) setRemoteDescription error: "+e),i.LogMsg("(VoiceChat) Fatal error, ending chat"),i.EndVoiceChatInternal(!1)}),1},o.prototype.SendVoiceStatusUpdate=function(){var e=m.Init(Go.g);e.Body().set_user_steamid(this.m_CMInterface.steamid.ConvertTo64BitString()),e.Body().set_voice_chatid(this.m_VoiceCallState.m_voiceChatID),e.Body().set_user_muted_mic_locally(this.IsMicMuted()),e.Body().set_user_muted_output_locally(this.IsOutputMuted()),e.Body().set_user_has_no_mic_for_session(this.BNoMicAvailableForSession()),e.Body().set_user_webaudio_sample_rate(ci.AudioPlaybackManager.GetLastObservedSampleRate()),Go.i.NotifyUserVoiceStatus(this.m_CMInterface.GetServiceTransport(),e)},o.prototype.UpdateUserVoiceStatus=function(e){if(this.m_VoiceCallState.m_voiceChatID==e.voice_chatid()){var t=new D.a(e.user_steamid()),n=this.m_mapUserVoiceStatus.get(t.GetAccountID());null==n&&(n=new qo),n.mic_muted_locally=e.user_muted_mic_locally(),n.output_muted_locally=e.user_muted_output_locally(),n.has_no_mic_for_session=e.user_has_no_mic_for_session();var o=ci.FriendStore.GetPlayerIfCached(t.GetAccountID()),i="[U:1:"+t.GetAccountID()+"]",r="";null!=o&&(r=o.display_name+" ");var a="";a=n.has_no_mic_for_session?"nomic":n.mic_muted_locally?"muted":"on",this.LogMsg("(VoiceChat) User "+r+i+" status now: mic("+a+") output("+(n.output_muted_locally?"muted":"on")+")"),this.m_mapUserVoiceStatus.set(t.GetAccountID(),n)}},o.prototype.OnWebRTCConnectedAndVoiceChatConnected=function(){var t=this,e=this.m_VoiceCallState.m_webRTCConnectedNotification;this.m_VoiceCallState.m_eState=Bo.k_EVoiceCallState_NotifyingVoiceChatOfWebRTCSession,this.LogMsg("(WebRTC) WebRTC session connected "+this.IPIntToString(e.client_ip())+":"+e.client_port()+" => "+this.IPIntToString(e.server_ip())+":"+e.server_port()),""==this.m_VoiceCallState.m_voiceChatID&&(this.LogMsg("(VoiceChat) Reached OnWebRTCConnectedAndVoiceChatConnected without voice chat id? Failing."),this.EndVoiceChatInternal(!1));var n=m.Init(Go.e);n.Body().set_voice_chatid(this.m_VoiceCallState.m_voiceChatID),n.Body().set_ssrc_my_sending_stream(e.ssrc()),n.Body().set_ip_webrtc_client(e.client_ip()),n.Body().set_port_webrtc_client(e.client_port()),n.Body().set_ip_webrtc_server(e.server_ip()),n.Body().set_port_webrtc_server(e.server_port()),n.Body().set_has_audio_worklets_support(ci.AudioPlaybackManager.supports_audio_worklets),n.Body().set_user_agent(navigator.userAgent),Go.i.UpdateVoiceChatWebRTCData(this.m_CMInterface.GetServiceTransport(),n).then(function(e){1==e.GetEResult()?(t.m_VoiceCallState.m_eState=Bo.k_EVoiceCallState_Connected,t.m_VoiceCallState.m_timeFinishedConnecting=performance.now(),t.SendVoiceStatusUpdate(),t.LogMsg("(WebRTC) Updated voice session with WebRTC session data "+t.m_VoiceCallState.m_voiceChatID),e.Body().send_client_voice_logs()&&t.ScheduleClientVoiceLogsUpload(2),t.CheckConnection()):(t.LogMsg("(WebRTC) Error updating voice session with WebRTC session data "+t.m_VoiceCallState.m_voiceChatID),t.BackOffAndRetryInitiateVoiceChat())}).catch(function(e){t.LogMsg("(WebRTC) Error updating voice session with WebRTC session data "+t.m_VoiceCallState.m_voiceChatID),t.BackOffAndRetryInitiateVoiceChat()})},o.prototype.OnAcceptOneOnOneVoiceChat=function(t,e){var n=this;this.m_VoiceCallState.m_targetAccountID!=t.GetAccountID()&&this.EndVoiceChatInternal(!1),this.m_VoiceCallState.m_eState=Bo.k_EVoiceCallState_None,this.m_VoiceCallState.m_targetAccountID=t.GetAccountID(),this.m_VoiceCallState.m_bInitiatedOneOnOneCall=!1,this.m_VoiceCallState.m_bWaitingOnOneOnOneRejoin=!1,this.m_VoiceCallState.m_bPostedOneOnOneEndedMsg=!1,this.m_VoiceCallState.m_chatRoom=null,this.m_VoiceCallState.m_voiceChatID=e;var o=m.Init(Go.a);o.Body().set_steamid_partner(t.ConvertTo64BitString()),o.Body().set_accepted_request(!0),o.Body().set_voice_chatid(e),Go.i.AnswerOneOnOneChat(this.m_CMInterface.GetServiceTransport(),o).then(function(e){1==e.GetEResult()?n.InitiateOneOnOneVoiceChat(t.GetAccountID()):(n.LogMsg("(VoiceChat) Failed responding to voice chat from "+t.GetAccountID()),n.EndVoiceChatInternal(!1))})},o.prototype.OnRejectOneOnOneVoiceChat=function(t,e){var n=this,o=m.Init(Go.a);o.Body().set_steamid_partner(t.ConvertTo64BitString()),o.Body().set_accepted_request(!1),o.Body().set_voice_chatid(e),Go.i.AnswerOneOnOneChat(this.m_CMInterface.GetServiceTransport(),o).then(function(e){1==e.GetEResult()||n.LogMsg("(VoiceChat) Failed responding to voice chat from "+t.GetAccountID())})},o.prototype.PlayRingSound=function(e){this.m_mapOneOnOneCallsWaitingJoinOrAccept.get(e).audio_buffer=ci.AudioPlaybackManager.PlayAudioURLWithRepeats(G.a.COMMUNITY_CDN_URL+"public/sounds/webui/steam_phonecall.m4a?v=1",1)},o.prototype.IsVoiceActive=function(e,t){return!!this.m_VoiceCallState.BMatchingCall(e,t)&&this.m_VoiceCallState.m_eState!=Bo.k_EVoiceCallState_None},o.prototype.CheckVoiceSnoozeTiemout=function(){if(3600<ci.IdleTracker.GetUserIdleTime()){var e=this.m_MicVolumeMeter.GetLastTimeNonZero();36e5<performance.now()-e&&(this.OnUserEndVoiceChat(),ci.ShowAlert(Object($.b)("#Voice_LeftIdleVoiceChat_Title"),Object($.b)("#Voice_LeftIdleVoiceChat_Body"),Object($.b)("#Voice_LeftIdleVoiceChat_OK")).then(function(){}).catch(function(){return!0}))}},o.prototype.ProcessStatsReport=function(){if((this.CheckVoiceSnoozeTiemout(),null!=this.m_PeerConnection)&&(this.m_StatsTimeout=SetBackgroundTimeout(this.ProcessStatsReport,1e4),G.a.IN_CLIENT&&To.b.BClientConnected().then(function(){}),!(-1!=this.m_PeerConnection.localDescription.sdp.indexOf("mozilla...")))){var e=new Date,d=this,t=this.m_PeerConnection;d.LogMsg("-----------------------------------------------------------"),d.LogMsg(" Voice Report: "+e.toUTCString()),d.LogMsg("-----------------------------------------------------------");var n=t.getSenders();if(0<n.length){this.LogMsg("(WebRTC) "+this.PadOutput("(Sender SSRC)",40)+" "+this.PadOutput("Audio Packets Sent",20)+" "+this.PadOutput("Connection State",20)+" "+this.PadOutput("Writable",20)+" "+this.PadOutput("Track State",20)+" "+this.PadOutput("Round Trip MS",20)+" "+this.PadOutput("Transport Bytes Sent",24)+" "+this.PadOutput("Transport Bytes Received",24)+" ");try{for(var o=0;o<n.length;++o)n[o].getStats().then(function(m){m.forEach(function(e){if("outbound-rtp"==e.type&&"audio"==e.mediaType){var t=e.ssrc,n=e.packetsSent,o="",i="",r=0,a=0,s=0,c="",l=m.get(e.trackId);null!=l&&"track"==l.type&&"audio"==l.kind&&(c=l.ended&&l.detached?"ended+detached":l.ended?"ended":l.detached?"detached":"active");var p=m.get(e.transportId);if(null!=p&&"transport"==p.type){var u=m.get(p.selectedCandidatePairId);null!=u&&"candidate-pair"==u.type&&(o=u.state,i=u.writable?"writable":"not-writable",r=1e3*u.currentRoundTripTime),a=p.bytesSent,s=p.bytesReceived}d.LogMsg("(WebRTC) "+d.PadOutput(String(t),40)+" "+d.PadOutput(String(n),20)+" "+d.PadOutput(o,20)+" "+d.PadOutput(i,20)+" "+d.PadOutput(c,20)+" "+d.PadOutput(String(r),20)+" "+d.PadOutput(String(a),24)+" "+d.PadOutput(String(s),24))}})})}catch(e){d.LogMsg("(WebRTC) Can't log sender stats on this browser")}}SetBackgroundTimeout(this.ProcessReceiverStatsReport,100)}},o.prototype.ProcessReceiverStatsReport=function(){if(!(-1!=this.m_PeerConnection.localDescription.sdp.indexOf("mozilla..."))){var r=this,e=this.m_PeerConnection;try{e.getStats(function(e){e.result().forEach(function(t){if("ssrc"==t.type){var n=new jo,e=t.names(),o=e.indexOf("mediaType");if(-1!=o&&"audio"==t.stat(e[o])){t.names().forEach(function(e){"ssrc"==e?n.m_SSRC=Number(t.stat(e)):"googCurrentDelayMs"==e?n.m_MostRecentDelayEstimateMs=Number(t.stat(e)):"packetsLost"==e?n.m_PacketsLost=Number(t.stat(e)):"packetsReceived"==e?n.m_PacketsReceived=Number(t.stat(e)):"googJitterReceived"==e?n.m_MostRecentJitterReceivedMs=Number(t.stat(e)):"googJitterBufferMs"==e?n.m_CurrentJitterBufferMs=Number(t.stat(e)):"bytesReceived"==e?n.m_BytesReceived=Number(t.stat(e)):"googDecodingCTN"==e?n.m_DecodingThroughNetEQ=Number(t.stat(e)):"googDecodingPLC"==e?n.m_DecodingPacketLossCorrection=Number(t.stat(e)):"googDecodingCNG"==e?n.m_DecodingComfortNoiseGeneration=Number(t.stat(e)):"googDecodingPLCCNG"==e?n.m_DecodingPacketLossFadeNoiseGeneration=Number(t.stat(e)):"googDecodingNormal"==e?n.m_DecodingNormal=Number(t.stat(e)):"googDecodingCTSG"==e?n.m_DecodingSilenceGenerator=Number(t.stat(e)):"googDecodingMuted"==e&&(n.m_DecodingMuted=Number(t.stat(e)))});var i=r.m_mapSSRCToAccountID.get(n.m_SSRC);null!=i&&r.m_mapAccountIDToStats.set(i,n)}}})}),r.LogMsg("-----------------------------------------------------------"),r.LogMsg("(WebRTC) "+r.PadOutput("(Receiving)",40)+" "+r.PadOutput("Packets Received",20)+" "+r.PadOutput("Est. Delay MS",20)+" "+r.PadOutput("Packets Lost",20)+" "+r.PadOutput("Last Jitter MS",20)+" "+r.PadOutput("Jitter Buffer MS",20)+" "+r.PadOutput("Decoding Successes",20)+" "+r.PadOutput("Decoding Errors",20)),r.m_mapAccountIDToStats.forEach(function(e,t){var n=ci.FriendStore.GetPlayerIfCached(t),o="[unknown]";null!=n&&(o=n.display_name),r.LogMsg("(WebRTC) "+r.PadOutput(o.substr(0,40),40)+" "+r.PadOutput(String(e.m_PacketsReceived),20)+" "+r.PadOutput(String(e.m_MostRecentDelayEstimateMs),20)+" "+r.PadOutput(String(e.m_PacketsLost),20)+" "+r.PadOutput(String(e.m_MostRecentJitterReceivedMs),20)+" "+r.PadOutput(String(e.m_CurrentJitterBufferMs),20)+" "+r.PadOutput(String(e.m_DecodingNormal+e.m_DecodingComfortNoiseGeneration),20)+" "+r.PadOutput(String(e.m_DecodingPacketLossCorrection+e.m_DecodingPacketLossFadeNoiseGeneration+e.m_DecodingSilenceGenerator),20))}),r.LogMsg("-----------------------------------------------------------")}catch(e){}}},o.prototype.PadOutput=function(e,t,n){if(void 0===n&&(n=void 0),Math.abs(t)<=e.length)return e;var o=Math.max(Math.abs(t)-e.length||0,0),i=Array(o+1).join(String(n||" ").charAt(0));return t<0?i+e:e+i},o.prototype.CheckConnection=function(){if(this.m_VoiceCallState.m_eState==Bo.k_EVoiceCallState_Connected||this.m_VoiceCallState.m_eState==Bo.k_EVoiceCallState_LocalMicOnly)this.LogMsg("(VoiceChat) Succcess! Voice is fully connected took "+(this.m_VoiceCallState.m_timeFinishedConnecting-this.m_VoiceCallState.m_timeStartedConnecting).toFixed(0)+"ms to complete, "+(this.m_VoiceCallState.m_nFailuresThisInitiate+1)+" attempts made before success."),ClearBackgroundInterval(this.m_ConnectionCheck),this.m_ConnectionCheck=0,this.m_VoiceCallState.m_nFailuresThisInitiate=0,this.m_VoiceCallState.m_bIsConnectionAttemptOverTwoSeconds=!1,this.m_StatsTimeout=SetBackgroundTimeout(this.ProcessStatsReport,1e4);else{var e=performance.now()-this.m_VoiceCallState.m_timeStartedConnecting;this.m_VoiceCallState.m_bIsConnectionAttemptOverTwoSeconds=2e3<e;var t=6e4;0!=this.m_VoiceCallState.m_targetAccountID&&this.m_VoiceCallState.m_eState==Bo.k_EVoiceCallState_RequestedPermission&&(t=3e5),t<e&&(this.LogMsg("(VoiceChat) Failure! Gave up after more than one minute trying to connect, last state was "+xo(this.m_VoiceCallState.m_eState)+"("+this.m_VoiceCallState.m_eState+")"),this.EndVoiceChatInternal(!1)),this.LogMsg("(VoiceChat) Still trying to connect to voice chat/webrtc "+xo(this.m_VoiceCallState.m_eState)+"("+this.m_VoiceCallState.m_eState+") "+(performance.now()-this.m_VoiceCallState.m_timeStartedConnecting).toFixed(0)+"ms elapsed...")}},o.prototype.BackOffAndRetryInitiateVoiceChat=function(){var e=this;if(this.m_VoiceCallState.m_eState!=Bo.k_EVoiceCallState_None){var t=this.m_VoiceCallState.m_nFailuresThisInitiate,n=this.m_VoiceCallState.m_targetAccountID,o=this.m_VoiceCallState.m_chatRoom;this.EndVoiceChatInternal(!0),this.m_VoiceCallState.m_eState=Bo.k_EVoiceCallState_ScheduledInitiate,this.m_VoiceCallState.m_targetAccountID=n,this.m_VoiceCallState.m_chatRoom=o,this.m_VoiceCallState.m_nFailuresThisInitiate=t+1;var i=250;i=t<1?250:t<3?1e3:t<5?5e3:t<10?1e4:t<15?3e4:6e4,this.LogMsg("(VoiceChat) Retrying InitiateVoiceChat in "+i.toFixed(0)+" milliseconds..."),this.m_ScheduledInitiate=SetBackgroundTimeout(function(){e.ScheduledInitiate(n,o)},i)}},o.prototype.ScheduledInitiate=function(e,t){this.m_ScheduledInitiate=0,this.InitiateVoiceChat(e,t)},o.prototype.InitiateVoiceChat=function(e,t){var n=this;To.b.BClientConnected().then(function(){});var o=new ko.UAParser(navigator.userAgent).getResult();if("Chrome"!=o.browser.name)return this.LogMsg("(VoiceChat) Voice chat not supported in browser: "+o.browser.name),void ci.ShowAlert(Object($.b)("#Voice_VoiceUnavailableInBrowser_Title"),Object($.b)("#Voice_VoiceUnavailableInBrowser_Body",o.browser.name),Object($.b)("#Voice_VoiceUnavailableInBrowser_OK")).then(function(){}).catch(function(){return!0});if(0!=e&&t)this.LogMsg("Cant initiate voice chat for both friend & group");else{var i=this.m_VoiceCallState.BMatchingCall(e,t);!this.m_VoiceCallState.BMatchingCall(e,t)&&this.m_VoiceCallState.m_eState>Bo.k_EVoiceCallState_ScheduledInitiate&&(this.LogMsg("(VoiceChat) InitiateVoiceChat called for new target account/room while already connected, ending prior session first"),this.EndVoiceChatInternal(!1)),this.m_ScheduledInitiate&&(ClearBackgroundTimeout(this.m_ScheduledInitiate),this.m_ScheduledInitiate=0);var r=performance.now();if(this.m_VoiceCallState.m_eState<=Bo.k_EVoiceCallState_ScheduledInitiate&&0!=this.m_VoiceCallState.m_timeEndedVoiceChat&&r-this.m_VoiceCallState.m_timeEndedVoiceChat<100){this.m_VoiceCallState.m_eState=Bo.k_EVoiceCallState_ScheduledInitiate,this.m_VoiceCallState.m_targetAccountID=e,this.m_VoiceCallState.m_bInitiatedOneOnOneCall=!0,this.m_VoiceCallState.m_chatRoom=t;var a=100-(r-this.m_VoiceCallState.m_timeEndedVoiceChat);return this.LogMsg("(VoiceChat) Delaying requested InitiateChat for "+a.toFixed(0)+" milliseconds to let prior EndVoiceChat finish..."),void(this.m_ScheduledInitiate=SetBackgroundTimeout(function(){n.ScheduledInitiate(e,t)},a))}if((!i||this.m_VoiceCallState.m_eState<=Bo.k_EVoiceCallState_ScheduledInitiate)&&(e?this.LogMsg("Resetting voice chat state and initiating to individual "+e):t?this.LogMsg("Resetting voice chat state and initiating to room "+t.chatID):(Object(I.a)(this.m_VoiceEchoLocalMic,"Shouldn't hit local mic access only without echo local mic on"),this.LogMsg("Resetting voice chat state and initiating local mic access only")),this.m_VoiceCallState.m_eState<=Bo.k_EVoiceCallState_ScheduledInitiate)){if(0!=e||null!=t&&"undefined"!=typeof SteamClient&&null!=SteamClient.WebChat&&null!=SteamClient.WebChat.SetVoiceChatActive)try{SteamClient.WebChat.SetVoiceChatActive(!0)}catch(e){}this.m_VoiceCallState.m_targetAccountID=e,this.m_VoiceCallState.m_bInitiatedOneOnOneCall=!0,this.m_VoiceCallState.m_chatRoom=t,this.m_VoiceCallState.m_timeStartedConnecting=performance.now(),this.m_VoiceCallState.m_nMostRecentRemoteDescriptionVersion="0",this.m_VoiceCallState.m_bIsConnectionAttemptOverTwoSeconds=!1,this.m_ConnectionCheck=SetBackgroundInterval(this.CheckConnection,2e3),0!=e?this.InitiateOneOnOneVoiceChat(e):this.InitiateChatRoomVoice()}}},o.prototype.OnRequestMicrophoneAccess=function(){var t=this;if(this.m_VoiceCallState.m_eState>Bo.k_EVoiceCallState_ScheduledInitiate)return this.LogMsg("(VoiceChat) Hit OnRequestMicrophoneAccess in wrong state "+this.m_VoiceCallState.m_eState),void this.EndVoiceChatInternal(!1);null==this.m_AudioContext&&(this.m_AudioContext=ci.AudioPlaybackManager.context);var e={optional:[{echoCancellation:this.m_Settings.m_VoiceUseEchoCancellation},{googEchoCancellation:this.m_Settings.m_VoiceUseEchoCancellation},{googEchoCancellation2:this.m_Settings.m_VoiceUseEchoCancellation},{googNoiseSupression:this.m_Settings.m_VoiceUseNoiseCancellation},{googNoiseSupression2:this.m_Settings.m_VoiceUseNoiseCancellation},{mozNoiseSuppression:this.m_Settings.m_VoiceUseNoiseCancellation},{googTypingNoiseDetection:this.m_Settings.m_VoiceUseNoiseCancellation},{googAutoGainControl:this.m_Settings.m_VoiceUseAutoGainControl},{googAutoGainControl2:this.m_Settings.m_VoiceUseAutoGainControl},{mozAutoGainControl:this.m_Settings.m_VoiceUseAutoGainControl},{googHighpassFilter:!0},{googAudioMirroring:!1}]};"default"!=this.m_Settings.m_SelectedMicID&&e.optional.push({sourceId:this.m_Settings.m_SelectedMicID}),this.m_VoiceCallState.m_targetAccountID?this.LogMsg("(VoiceChat) Call to individual "+this.m_VoiceCallState.m_targetAccountID+" now initating getUserMedia/WebRTC"):this.m_VoiceCallState.m_chatRoom&&this.LogMsg("(VoiceChat) Call to room "+this.m_VoiceCallState.m_chatRoom.chatID+" now initating getUserMedia/WebRTC"),this.m_VoiceCallState.m_eState=Bo.k_EVoiceCallState_RequestedMicAccess;var n=navigator;this.m_bUserHasDeniedMicPermissions=!1,n.getUserMedia=n.getUserMedia||n.webkitGetUserMedia||n.mozGetUserMedia||n.msGetUserMedia,n.getUserMedia({audio:e,video:!1},function(e){t.OnGetUserMediaSuccess(e)},this.OnGetUserMediaFailure)},o.prototype.ScheduleClientVoiceLogsUpload=function(e){if(""!=this.m_VoiceCallState.m_voiceChatID){this.m_ScheduledVoiceLogsUpload&&(ClearBackgroundTimeout(this.m_ScheduledVoiceLogsUpload),this.m_ScheduledVoiceLogsUpload=0);this.m_ScheduledVoiceLogsUpload=SetBackgroundTimeout(this.UploadClientSideVoiceLogs,1e3*e)}},o.prototype.UploadClientSideVoiceLogs=function(){var t=this;if(""!=this.m_VoiceCallState.m_voiceChatID)if(this.m_bClientSideLogsUploadInProgress)this.ScheduleClientVoiceLogsUpload(2);else{this.m_bClientSideLogsUploadInProgress=!0;var e=m.Init(Go.f);e.Body().set_voice_chatid(this.m_VoiceCallState.m_voiceChatID);var n=this.m_rgLogLines.slice(this.m_nLastLogLineUploaded);e.Body().set_client_voice_logs_new_lines(n.join("\r\n"));var o=n.length;Go.i.UploadClientVoiceChatLogs(this.m_CMInterface.GetServiceTransport(),e).then(function(e){1==e.GetEResult()?(t.m_nLastLogLineUploaded+=o,t.LogMsg("(VoiceChat) Uploaded "+o+" new lines of voice chat log info to server"),t.ScheduleClientVoiceLogsUpload(20)):(t.LogMsg("(VoiceChat) Error uploading client side logs to voice chat session, will retry soon"),t.ScheduleClientVoiceLogsUpload(10+10*Math.random())),t.m_bClientSideLogsUploadInProgress=!1}).catch(function(e){t.LogMsg("(VoiceChat) Error uploading client side logs to voice chat session, will retry soon"),t.ScheduleClientVoiceLogsUpload(10+10*Math.random()),t.m_bClientSideLogsUploadInProgress=!1})}},o.prototype.EndVoiceChatInternal=function(e){var i=this;if(this.m_ScheduledVoiceLogsUpload&&this.UploadClientSideVoiceLogs(),this.m_ScheduledInitiate&&(ClearBackgroundTimeout(this.m_ScheduledInitiate),this.m_ScheduledInitiate=0),this.m_StatsTimeout&&(ClearBackgroundTimeout(this.m_StatsTimeout),this.m_StatsTimeout=0),"undefined"!=typeof SteamClient&&null!=SteamClient.WebChat&&null!=SteamClient.WebChat.SetVoiceChatActive)try{SteamClient.WebChat.SetVoiceChatActive(!1)}catch(e){}if(this.m_VoiceCallState.m_eState!=Bo.k_EVoiceCallState_None){if(!e){if(this.m_VoiceCallState.m_targetAccountID){var r=this.m_VoiceCallState.m_targetAccountID;this.m_VoiceCallState.m_targetAccountID=0;var a=this.m_VoiceCallState.m_voiceChatID;(t=m.Init(Go.c)).Body().set_steamid_partner(D.a.InitFromAccountID(r).ConvertTo64BitString()),t.Body().set_voice_chatid(this.m_VoiceCallState.m_voiceChatID);var s=this.m_VoiceCallState.m_eState;Go.i.LeaveOneOnOneChat(this.m_CMInterface.GetServiceTransport(),t).then(function(e){if(1==e.GetEResult())if(i.LogMsg("(VoiceChat) Left voice chat with "+r),s==Bo.k_EVoiceCallState_Connected){var t=new Ko;t.partner_accountid=i.m_CMInterface.steamid.GetAccountID(),t.voice_chatid=a,t.previously_joined=!0,i.m_mapOneOnOneCallsWaitingJoinOrAccept.set(r,t)}else{var n=ci.FriendStore.self,o=ci.ChatStore.GetFriendChat(r,!1);o&&n&&o.AddVoiceChannelInviteMsg(ci.CMInterface.steamid.GetAccountID(),ci.GetServerRTime32(),Object($.b)("#FriendMsg_VoiceChannelEndedExplicit",n.display_name))}else i.LogMsg("(VoiceChat) Failed leaving voice chat with "+r)})}else if(this.m_VoiceCallState.m_chatRoom){var t;(t=m.Init(pe.z)).Body().set_chat_group_id(this.m_VoiceCallState.m_chatRoom.groupID),t.Body().set_chat_id(this.m_VoiceCallState.m_chatRoom.chatID);var n=this.m_VoiceCallState.m_chatRoom.chatID;pe.V.LeaveVoiceChat(this.m_CMInterface.GetServiceTransport(),t).then(function(e){1==e.GetEResult()?i.LogMsg("(VoiceChat) Left chat room ("+n+") voice chat"):i.LogMsg("(VoiceChat) Failed leaving chat room ("+n+") voice chat")})}this.m_mapUserVoiceStatus.clear()}this.m_mapSSRCToAccountID.clear(),this.m_mapAccountIDToStats.clear();var o=this.m_VoiceCallState.m_eState>Bo.k_EVoiceCallState_RequestedPermission;this.m_VoiceCallState.m_eState=Bo.k_EVoiceCallState_None,this.m_VoiceCallState.m_targetAccountID=0,this.m_VoiceCallState.m_bInitiatedOneOnOneCall=!1,this.m_VoiceCallState.m_bPostedOneOnOneEndedMsg=!1,this.m_VoiceCallState.m_bWaitingOnOneOnOneRejoin=!1,this.m_VoiceCallState.m_chatRoom=null,e&&o||(this.m_VoiceCallState.m_voiceChatID=""),this.m_VoiceCallState.m_nMostRecentRemoteDescriptionVersion="0",this.m_VoiceCallState.m_nFailuresThisInitiate=0,this.m_VoiceCallState.m_timeEndedVoiceChat=performance.now(),this.m_VoiceCallState.m_webRTCConnectedNotification=void 0,this.m_VoiceCallState.m_bOfferUpdateInProgress=!1,this.m_VoiceCallState.m_msgPendingRemoteDescriptionUpdate=void 0,this.m_ConnectionCheck&&(ClearBackgroundInterval(this.m_ConnectionCheck),this.m_ConnectionCheck=0);for(var c=this.m_rgAudioStreams.pop();null!=c;){null!=c.elem&&(c.elem.pause(),c.elem.src=void 0,c.elem.srcObject=void 0,c.elem=void 0),null!=c.volume_meter&&(c.volume_meter.stop(),c.volume_meter=void 0),c.stream.oninactive=void 0;for(var l=0,p=c.stream.getTracks();l<p.length;l++){p[l].stop()}if(null!=this.m_AudioContext&&c.source_node)try{c.source_node.disconnect()}catch(e){}c.output_gain_node&&(c.output_gain_node.disconnect(),c.output_gain_node=void 0),c=this.m_rgAudioStreams.pop()}null!=this.m_MicVolumeMeter&&(this.m_MicVolumeMeter.stop(),this.m_MicVolumeMeter=void 0),null!=this.m_MicNoiseGate&&(this.m_MicNoiseGate.input?(this.m_MicNoiseGate.input.disconnect(),this.m_MicNoiseGate.output.disconnect(),this.m_MicNoiseGate.noiseGateKernel_.disconnect()):this.m_MicNoiseGate.disconnect(),this.m_MicNoiseGate=void 0),null!=this.m_MicInputGainNode&&(this.m_MicInputGainNode.disconnect(),this.m_MicInputGainNode=void 0),null!=this.m_AudioContext&&(ci.AudioPlaybackManager.SetVoiceNotActive(),this.m_AudioContext=void 0),this.m_PeerConnection&&(this.m_PeerConnection.oniceconnectionstatechange=void 0,this.m_PeerConnection.onicegatheringstatechange=void 0,this.m_PeerConnection.onsignalingstatechange=void 0,this.m_PeerConnection.close(),this.m_PeerConnection=void 0)}},o.prototype.FillInChatUsabilityMetrics=function(e){var t=e.voice_settings();t.set_voice_input_gain(this.m_Settings.m_VoiceInputGain),t.set_voice_output_gain(this.m_Settings.m_VoiceOutputGain),t.set_noise_gate_level(Math.round(this.m_Settings.m_NoiseGateLevel)),t.set_voice_use_echo_cancellation(this.m_Settings.m_VoiceUseEchoCancellation),t.set_voice_use_noise_cancellation(this.m_Settings.m_VoiceUseNoiseCancellation),t.set_voice_use_auto_gain_control(this.m_Settings.m_VoiceUseAutoGainControl),t.set_selected_non_default_mic("default"!==this.m_Settings.m_SelectedMicID),t.set_selected_non_default_output("default"!==this.m_Settings.m_SelectedOutputID),t.set_push_to_talk_enabled(this.GetPushToTalkEnabled()),t.set_push_to_mute_enabled(this.GetPushToMuteEnabled()),t.set_play_ptt_sounds(this.m_Settings.m_bPlayPTTSounds),this.IsAnyVoiceActive()&&(this.m_VoiceCallState.m_targetAccountID?e.ui_state().set_in_one_on_one_voice_chat(!0):this.m_VoiceCallState.m_chatRoom&&e.ui_state().set_in_group_voice_chat(!0))},o.k_MaxPerUserGainMultiplier=2,o.k_MaxInputOutputGainValue=4,R.c([d.observable],o.prototype,"m_VoiceCallState",void 0),R.c([d.observable],o.prototype,"m_bPushToTalkEnabled",void 0),R.c([d.observable],o.prototype,"m_bPushToMuteEnabled",void 0),R.c([d.observable],o.prototype,"m_bVoicePTTStateEnabled",void 0),R.c([d.observable],o.prototype,"m_VKPushToTalkHotKey",void 0),R.c([d.observable],o.prototype,"m_strPushToTalkDisplayString",void 0),R.c([d.observable],o.prototype,"m_bUserHasDeniedMicPermissions",void 0),R.c([d.observable],o.prototype,"m_bOutputMuted",void 0),R.c([d.observable],o.prototype,"m_AudioContext",void 0),R.c([d.observable],o.prototype,"m_rgAudioStreams",void 0),R.c([d.observable],o.prototype,"m_MicVolumeMeter",void 0),R.c([d.observable],o.prototype,"m_MicNoiseGate",void 0),R.c([d.observable],o.prototype,"m_MicInputGainNode",void 0),R.c([d.observable],o.prototype,"m_PeerConnection",void 0),R.c([d.observable],o.prototype,"m_Settings",void 0),R.c([d.observable],o.prototype,"m_bLocalMicTestActive",void 0),R.c([d.observable],o.prototype,"m_bForceConnectingStatus",void 0),R.c([d.observable],o.prototype,"m_bForceReconnectingStatus",void 0),R.c([d.action.bound],o.prototype,"SetSelectedMic",null),R.c([d.action.bound],o.prototype,"SetSelectedOutput",null),R.c([d.action.bound],o.prototype,"SetUseEchoCancellation",null),R.c([d.action.bound],o.prototype,"SetUseNoiseCancellation",null),R.c([d.action.bound],o.prototype,"SetUseAutoGainControl",null),R.c([d.action.bound],o.prototype,"SetVoiceEchoLocalMic",null),R.c([d.action.bound],o.prototype,"SetVoiceLogDetails",null),R.c([d.action.bound],o.prototype,"GetVoiceLogDetails",null),R.c([d.action.bound],o.prototype,"SetUseNoiseGateLevel",null),R.c([d.action.bound],o.prototype,"SetVoiceInputGain",null),R.c([d.action.bound],o.prototype,"SetVoiceOutputGain",null),R.c([d.action.bound],o.prototype,"ForceReconnectingStatus",null),R.c([d.action.bound],o.prototype,"ForceConnectingStatus",null),R.c([d.action.bound],o.prototype,"LogMsg",null),R.c([d.action.bound],o.prototype,"GetVoiceLogs",null),R.c([d.action.bound],o.prototype,"OnPushToTalkReleased",null),R.c([d.action.bound,Object(ht.a)(150)],o.prototype,"DebouncedToggleMicMuting",null),R.c([d.action.bound],o.prototype,"OnPushToTalkStateChange",null),R.c([d.action.bound],o.prototype,"UpdateNoiseGateOnActiveMic",null),R.c([d.action.bound],o.prototype,"OnAudioContextStateChange",null),R.c([d.action.bound],o.prototype,"OnIceCandidate",null),R.c([d.action.bound],o.prototype,"AddRemoteIceCandidate",null),R.c([d.action.bound],o.prototype,"OnSignalingStateChange",null),R.c([d.action.bound],o.prototype,"OnIceConnectionStateChange",null),R.c([d.action.bound],o.prototype,"OnIceGatheringStateChange",null),R.c([d.action.bound],o.prototype,"OnRemoveRemoteStream",null),R.c([d.action.bound],o.prototype,"OnAddRemoteStream",null),R.c([d.action.bound],o.prototype,"ModifyLocalSDPBeforeSetting",null),R.c([d.action.bound],o.prototype,"OnCreateOfferSuccess",null),R.c([d.action.bound],o.prototype,"OnCreateOfferError",null),R.c([d.action.bound],o.prototype,"OnNoiseGateMessage",null),R.c([d.action.bound],o.prototype,"SetupNoiseGateOnMic",null),R.c([d.action.bound],o.prototype,"OnGetUserMediaSuccess",null),R.c([d.action.bound],o.prototype,"OnGetUserMediaFailure",null),R.c([d.action.bound],o.prototype,"OnSetUpdatedLocalDescriptionSuccess",null),R.c([d.action.bound],o.prototype,"OnSetUpdatedLocalDescriptionFailure",null),R.c([d.action.bound],o.prototype,"OnCreateAnswerSuccess",null),R.c([d.action.bound],o.prototype,"OnCreateAnswerError",null),R.c([d.action.bound],o.prototype,"OnAcceptOneOnOneVoiceChat",null),R.c([d.action.bound],o.prototype,"OnRejectOneOnOneVoiceChat",null),R.c([d.action.bound],o.prototype,"PlayRingSound",null),R.c([d.action.bound],o.prototype,"ProcessStatsReport",null),R.c([d.action.bound],o.prototype,"ProcessReceiverStatsReport",null),R.c([d.action.bound],o.prototype,"CheckConnection",null),R.c([d.action.bound],o.prototype,"ScheduledInitiate",null),R.c([d.action.bound],o.prototype,"OnRequestMicrophoneAccess",null),R.c([d.action.bound],o.prototype,"UploadClientSideVoiceLogs",null),o}(),Jo=n("a6nX"),Xo=function(){function e(){var t=this;this.m_ParentalState=new on,this.m_ParentalLockHandler=f(Jo.d.NotifyLockHandler,function(e){return G.a.SESSIONID==e.Body().sessionid()&&t.SetLockState(!0),1}),this.m_ParentalUnlockHandler=f(Jo.d.NotifyUnlockHandler,function(e){return G.a.SESSIONID==e.Body().sessionid()&&t.SetLockState(!1),1}),this.m_ParentalSettingsChangeHandler=f(Jo.d.NotifySettingsChangeHandler,function(e){return 1})}return e.prototype.SetParentalState=function(e){this.m_ParentalState=e},e.prototype.SetLockState=function(e){this.m_ParentalState.locked=e},e.prototype.Init=function(e){var o=this;this.m_CMInterface=e,this.m_CMInterface.RunWhenLoggedOn(function(){var e=m.Init(Jo.a);e.Body().set_steamid(o.m_CMInterface.steamid.ConvertTo64BitString()),G.a.IN_CLIENT?SteamClient.Parental.RegisterForParentalSettingsChanges(function(e){return o.UpdateParentalState(e)}):Jo.e.GetParentalSettings(o.m_CMInterface.GetServiceTransport(),e).then(function(e){e.Body().settings().enabled_features();var t=e.Body().settings(),n=o.MsgParentalSettingsToParentalState(t);n.enabled?o.ValidateWebToken().then(function(e){n.locked=e,o.SetParentalState(n)}):(n.locked=!1,o.SetParentalState(n))})})},e.prototype.MsgParentalSettingsToParentalState=function(e){var t=new on;t.enabled=e.is_enabled(),t.features=e.enabled_features(),t.baselist={};for(var n=0,o=e.applist_base();n<o.length;n++){var i=o[n];t.baselist["App_"+i.appid()]=i.is_allowed()}t.customlist={};for(var r=0,a=e.applist_custom();r<a.length;r++){i=a[r];t.customlist["App_"+i.appid()]=i.is_allowed()}return t.locked=!0,t},e.prototype.UpdateParentalState=function(e){this.SetParentalState(e)},e.prototype.BIsFeatureBlocked=function(e){return this.m_ParentalState.locked&&0!=e&&0==(this.m_ParentalState.features&1<<e)},e.prototype.BIsAppBlocked=function(e){return!!this.isLocked&&(!this.m_ParentalState.allowallapps&&(0!=e&&(!(e>=O.f&&e<=O.g)&&(-1===[O.l,O.h,O.i,O.k,O.j].indexOf(e)&&(null!=this.m_ParentalState.customlist&&null!=this.m_ParentalState.customlist["App_"+e]?!this.m_ParentalState.customlist["App_"+e]:null==this.m_ParentalState.baselist||null==this.m_ParentalState.baselist["App_"+e]||!this.m_ParentalState.baselist["App_"+e])))))},Object.defineProperty(e.prototype,"isEnabled",{get:function(){return this.m_ParentalState.enabled},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isLocked",{get:function(){return this.m_ParentalState.locked},enumerable:!0,configurable:!0}),e.prototype.ValidateWebToken=function(){var n=this,e=G.a.SESSIONID,t=document.cookie.match("(^|; )steamparental=([^;]*)");if(!t||!t[2])return Promise.resolve(!1);var o=t[2],i=o.split("||");o=2==i.length?i[1]:i[0];var r=m.Init(Jo.c);return r.Body().set_unlock_token(e+"||"+o),new Promise(function(t,e){Jo.e.ValidateToken(n.m_CMInterface.GetServiceTransport(),r).then(function(e){1==e.GetEResult()?t(!0):t(!1)})})},Object.defineProperty(e.prototype,"locked",{get:function(){return console.log("ParentalState.locked",this.m_ParentalState.locked),this.m_ParentalState.locked},enumerable:!0,configurable:!0}),e.prototype.BIsFriendsBlocked=function(){return this.BIsFeatureBlocked(4)},e.prototype.Unlock=function(n){var t=this;if(G.a.IN_CLIENT)return new Promise(function(t,e){SteamClient.Parental.UnlockParentalLock(n,!1).then(function(e){t(e)})});var o=m.Init(Jo.b);return o.Body().set_password(n),o.Body().set_session(G.a.SESSIONID),o.Body().set_send_unlock_on_success(!0),new Promise(function(n,e){Jo.e.ValidatePassword(t.m_CMInterface.GetServiceTransport(),o).then(function(e){if(1==e.GetEResult()){var t=Date.now().toString()+"||"+e.Body().token();document.cookie="steamparental="+encodeURIComponent(t)+"; path=/"}n(e.GetEResult())})})},R.c([d.observable],e.prototype,"m_ParentalState",void 0),R.c([d.action],e.prototype,"UpdateParentalState",null),R.c([d.computed],e.prototype,"isEnabled",null),R.c([d.computed],e.prototype,"isLocked",null),R.c([d.computed],e.prototype,"locked",null),e}(),Qo=function(){function e(e,t,n){this.m_id=e,this.m_rgMembers=[],this.m_fnSort=t,this.m_fnOnUpdate=n}return Object.defineProperty(e.prototype,"id",{get:function(){return this.m_id},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"name",{get:function(){return-2==this.m_id?1==this.m_rgMembers.length?Object($.b)("#FriendGroup_InGame"):Object($.b)("#FriendGroup_InGame_Others"):0==this.m_id?Object($.b)("#Chat_MemberGroup_Online"):-1==this.m_id?Object($.b)("#Chat_MemberGroup_PartyBeacon"):this.m_strName?this.m_strName:ci.AppInfoStore.GetAppInfo(this.m_id).m_bInitialized?(this.m_strName=ci.AppInfoStore.GetAppInfo(this.m_id).m_strName,this.m_strName):(ci.AppInfoStore.RegisterCallbackOnLoad(this.OnAppInfoLoaded),"")},enumerable:!0,configurable:!0}),e.prototype.OnAppInfoLoaded=function(){this.m_strName=ci.AppInfoStore.GetAppInfo(this.m_id).m_strName,this.m_fnOnUpdate()},Object.defineProperty(e.prototype,"member_list",{get:function(){return this.m_rgMembers},enumerable:!0,configurable:!0}),e.prototype.BReadyToDisplay=function(){return!this.BIsGameGroup()||!!this.name},e.prototype.BIsGameGroup=function(){return 0<this.m_id},e.prototype.ClearMemberList=function(){this.m_rgMembers=[]},e.prototype.BHasMember=function(t){return 0<=this.m_rgMembers.findIndex(function(e){return e.accountid===t})},e.prototype.SetMembers=function(e){this.m_rgMembers=e,this.Sort()},e.prototype.SortedInsert=function(e){Object(I.a)(!this.BHasMember(e.accountid),"Double insert into bucket for accountid",e.accountid),M.i(this.m_rgMembers,e,this.m_fnSort)},e.prototype.Remove=function(t){return M.e(this.m_rgMembers,function(e){return e.accountid===t})},e.prototype.Sort=function(){this.m_rgMembers.sort(this.m_fnSort)},R.c([T.a],e.prototype,"OnAppInfoLoaded",null),e}(),Zo=function(){return function(e,t){this.rgRegistered=[],this.bFlatList=void 0,this.mapBuckets=new Map,this.nLastUpdate=0,this.msSpentSorting=0,this.groupSingletons=new Qo(-2,e,t)}}(),$o=function(){function e(){this.m_mapGroupBuckets=new Map,this.m_mapGroupBeacons=new Map,this.m_bShowMembersInGameGroups=void 0,this.LOG=Ae.create(function(){return"CGroupMemberStore"},!1)}return e.prototype.Init=function(){this.m_disposePersonaStateChanged=ci.FriendStore.AddPersonaStateChangedCallback(this.OnPersonaStateChanged),this.m_disposePlayerGameChanged=ci.FriendStore.AddPlayerGameChangedCallback(this.OnPlayerGameChanged),ci.SettingsStore.RunOnReady(this.ListenForSettingsChanges)},e.prototype.ListenForSettingsChanges=function(){var n=this;this.m_bShowMembersInGameGroups=ci.SettingsStore.FriendsSettings.bCategorizeInGameFriendsByGame,Object(d.when)(function(){return ci.SettingsStore.FriendsSettings.bCategorizeInGameFriendsByGame!==n.m_bShowMembersInGameGroups},function(){n.m_mapGroupBuckets.forEach(function(e,t){e.bFlatList=void 0,n.PerformInitialPopulate(t),n.FireMemberListChanged(e)}),n.ListenForSettingsChanges()})},e.prototype.RegisterForGroupMemberList=function(e,t){var n=this;return this.m_mapGroupBuckets.has(t)||(this.m_mapGroupBuckets.set(t,new Zo(this.FriendSortFunc,function(){n.OnGroupUpdate(t)})),this.PerformInitialPopulate(t)),this.m_mapGroupBuckets.get(t).rgRegistered.push(e),{unregister:function(){return n.UnregisterForGroupMemberList(e,t)}}},e.prototype.OnGroupUpdate=function(e){var t=this.m_mapGroupBuckets.get(e);t&&this.FireMemberListChanged(t)},e.prototype.UnregisterForGroupMemberList=function(e,t){var n=this.m_mapGroupBuckets.get(t);n&&(M.d(n.rgRegistered,e),0==n.rgRegistered.length&&this.m_mapGroupBuckets.delete(t))},e.prototype.GroupSortFunc=function(e,t){return-1==t.id&&-1!=e.id?1:-1==e.id&&-1!=t.id?-1:e.id<=0&&t.id<=0?e.id-t.id:e.id<=0&&0<t.id?1:t.id<=0&&0<e.id?-1:t.member_list.length==e.member_list.length&&t.name&&e.name?t.name.localeCompare(e.name):t.member_list.length-e.member_list.length},e.prototype.GetGroupMemberList=function(e){var t=this,n=this.m_mapGroupBuckets.get(e);if(n.bFlatList)return Object(I.a)(1==n.mapBuckets.size,"Flat list has too many buckets"),[n.mapBuckets.get(0)];var o=[];return n.mapBuckets.forEach(function(e){e.BReadyToDisplay()&&(1<e.member_list.length||!t.BucketCanBeSingleton(e))&&o.push(e)}),0<n.groupSingletons.member_list.length&&(n.groupSingletons.Sort(),o.push(n.groupSingletons)),o.sort(this.GroupSortFunc)},e.prototype.SetGroupListFlat=function(e,t){var n=this.m_mapGroupBuckets.get(e);n&&n.bFlatList!=t&&(n.bFlatList=t,this.PerformInitialPopulate(e),this.FireMemberListChanged(n))},e.prototype.ScheduledFireMemberListChanged=function(e){e.hDelayUpdate=void 0,this.FireMemberListChanged(e)},e.prototype.FireMemberListChanged=function(e){var t=this;if(!e.hDelayUpdate){var n=performance.now();if(n-e.nLastUpdate<1e3)return e.hDelayUpdate=SetBackgroundTimeout(function(){return t.ScheduledFireMemberListChanged(e)},1e3),void this.LOG("DELAY UPDATE");e.nLastUpdate=n;for(var o=0,i=e.rgRegistered;o<i.length;o++){(0,i[o])()}}},e.prototype.OnPlayerGameChanged=function(r,a,s){var c=this;this.m_mapGroupBuckets.forEach(function(e,t){var n=ci.ChatStore.GetChatRoomGroup(t);if(!n.GetMemberPartyBeacon(r)&&n.BHasMember(r)){var o=ci.FriendStore.GetPlayer(r);if(o.is_appinfo_ready(),c.LOG("OnPlayerGameChanged",o.display_name,a,s),e.bFlatList)return e.mapBuckets.get(0).Remove(r),e.mapBuckets.get(0).SortedInsert(ci.FriendStore.GetPlayer(r)),void c.FireMemberListChanged(e);if(a==s){var i=s==St?e.groupSingletons:e.mapBuckets.get(s);if(i&&i.BHasMember(r))return void c.UpdatePersonaForGroup(t,o)}c.RemoveMemberFromBucket(e,a,r),c.AddMemberToBucketID(e,s,ci.FriendStore.GetPlayer(r)),c.FireMemberListChanged(e)}})},e.prototype.OnPersonaStateChanged=function(o){var i=this;this.m_mapGroupBuckets.forEach(function(e,t){var n=ci.ChatStore.GetChatRoomGroup(t);if(n.BHasMember(o.accountid)){if(i.LOG("CGroupMemberStore - persona state",t,o.display_name),e.bReSortPending)return i.LOG(o.display_name,"not ready"),void o.is_appinfo_ready();o.is_appinfo_ready()?i.UpdatePersonaForGroup(n.GetGroupID(),o):(i.LOG("Delay sorting player "+o.accountid),ci.AppInfoStore.RegisterCallbackOnLoad(i.UpdatePersonaForGroup.bind(i,t,o)))}})},e.prototype.UpdatePersonaForGroup=function(e,t){var n=this.m_mapGroupBuckets.get(e);if(n){var o=performance.now(),i=!1;if(n.bFlatList)Object(I.a)(1==n.mapBuckets.size,"Flat map is too large"),n.mapBuckets.get(0).Remove(t.accountid),n.mapBuckets.get(0).SortedInsert(t),i=!0;else{var r=this.FindCurrentBucketForMember(n,t.accountid);if(void 0!==r){var a=void 0;-2==r?a=n.groupSingletons:1==(a=n.mapBuckets.get(r)).member_list.length&&this.BucketCanBeSingleton(a)&&(a=n.groupSingletons),(1<a.member_list.length||!this.BucketCanBeSingleton(a))&&(this.LOG("Resorting user",t.display_name,"in bucket",r),a.Remove(t.accountid),a.SortedInsert(t),i=!0)}}var s=performance.now();n.msSpentSorting+=s-o,this.LOG(e+": Resort user "+t.display_name+" took "+(s-o)+"ms (total "+n.msSpentSorting+"ms)"),i&&this.FireMemberListChanged(n)}},e.prototype.OnPartyBeaconsUpdated=function(e,t){this.m_mapGroupBeacons.set(e,t);var n=this.m_mapGroupBuckets.get(e),o=[],i=!1;if(n){for(var r=0,a=t;r<a.length;r++){var s=a[r];o.push(s.account_id);var c=this.FindCurrentBucketForMember(n,s.account_id);if(-1!=c)(m=ci.FriendStore.GetPlayer(s.account_id)).is_appinfo_ready(),i=!0,this.RemoveMemberFromBucket(n,c,s.account_id),this.AddMemberToBucketID(n,-1,m)}var l=n.mapBuckets.get(-1);if(l)for(var p=0,u=l.member_list;p<u.length;p++){var m=u[p];if(-1==o.indexOf(m.accountid)){i=!0;var d=this.GetBucketIdForPlayer(n,m,e);this.RemoveMemberFromBucket(n,-1,m.accountid),this.AddMemberToBucketID(n,d,m)}}i&&this.ReSortGroup(e)}},e.prototype.ReSortGroup=function(e){var t=this.m_mapGroupBuckets.get(e);if(t){if(t.bFlatList){Object(I.a)(1==t.mapBuckets.size,"Flat list has too many buckets");var n=performance.now(),o=t.mapBuckets.get(0);o.Sort();var i=performance.now();t.msSpentSorting+=i-n,this.LOG(e+": List ReSort took "+(i-n)+"ms (total "+t.msSpentSorting+"ms) for "+o.member_list.length+" members")}else t.mapBuckets.get(0).Sort(),t.groupSingletons.Sort();t.bReSortPending=!1,this.FireMemberListChanged(t)}},e.prototype.FriendSortFunc=function(e,t){var n=ft.FriendSortStatusComparator(e,t);if(0!=n)return n;if(e.persona.is_ingame&&t.persona.is_ingame){if(e.persona.is_in_nonsteam_game){if(!t.persona.is_in_nonsteam_game)return 1}else if(t.persona.is_in_nonsteam_game)return-1;var o=e.current_game_name,i=t.current_game_name;if(o){if(!i)return-1;if(o!=i)return o<i?-1:1}else if(i)return 1}return e.display_name.localeCompare(t.display_name)},e.prototype.PerformInitialPopulate=function(e){var t=this,n=this.m_mapGroupBuckets.get(e);n.mapBuckets.clear(),n.groupSingletons.ClearMemberList(),Object(I.a)(n,"PerformInitialPopulate didn't find group");var o=performance.now(),i=ci.ChatStore.GetChatRoomGroup(e).memberList.member_list_unsorted.slice();if(void 0===n.bFlatList&&(n.bFlatList=100<i.length||!ci.SettingsStore.FriendsSettings.bCategorizeInGameFriendsByGame),n.bFlatList){i.forEach(function(e){e.is_appinfo_ready()});var r=new Qo(0,this.FriendSortFunc,function(){t.FireMemberListChanged(n)});r.SetMembers(i),n.mapBuckets.set(0,r)}else for(var a=0,s=i;a<s.length;a++){var c=s[a],l=this.GetBucketIdForPlayer(n,c,e);this.AddMemberToBucketID(n,l,c)}ci.AppInfoStore.BHavePendingAppInfoRequests()&&(n.bReSortPending=!0,ci.AppInfoStore.RegisterCallbackOnLoad(this.ReSortGroup.bind(this,e)));var p=performance.now();n.msSpentSorting+=p-o,this.LOG("List sort took "+(p-o)+" ms for "+i.length+" members of group "+e)},e.prototype.FindCurrentBucketForMember=function(e,t){var n=void 0;return e.mapBuckets.forEach(function(e){e.BHasMember(t)&&(n=e.id)}),void 0!==n?n:e.groupSingletons.BHasMember(t)?-2:void 0},e.prototype.BIsMemberInAnyBucket=function(e,t){return void 0!==this.FindCurrentBucketForMember(e,t)},e.prototype.AddMemberToBucketID=function(e,t,n){var o=this;if(Object(I.a)(!this.BIsMemberInAnyBucket(e,n.accountid),"Trying to double add accountid",n.accountid,"which is already in bucket",this.FindCurrentBucketForMember(e,n.accountid)),Object(I.a)(!e.bFlatList||0==t,"Trying to add to non-default bucket in flat list"),-2!=t)if(e.mapBuckets.has(t)){if(!e.bFlatList)1==(i=e.mapBuckets.get(t)).member_list.length&&this.BucketCanBeSingleton(i)&&this.RemoveFromSingletons(e,i.member_list[0].accountid);e.mapBuckets.get(t).SortedInsert(n)}else{var i;(i=new Qo(t,this.FriendSortFunc,function(){o.FireMemberListChanged(e)})).SortedInsert(n),e.mapBuckets.set(t,i),!e.bFlatList&&this.BucketCanBeSingleton(i)&&this.AddToSingletons(e,n)}else this.AddToSingletons(e,n)},e.prototype.BucketCanBeSingleton=function(e){return-1!=e.id&&0!=e.id},e.prototype.AddToSingletons=function(e,t){Object(I.a)(!e.bFlatList,"Adding to singletons in flat list"),e.groupSingletons.SortedInsert(t)},e.prototype.RemoveFromSingletons=function(e,t){return Object(I.a)(!e.bFlatList,"Removing from singletons in flat list"),e.groupSingletons.Remove(t)},e.prototype.GetBucketIdForPlayer=function(e,t,n){if(e.bFlatList)return 0;var o=this.m_mapGroupBeacons.get(n);if(o&&o.find(function(e){return e.account_id==t.accountid}))return-1;return t.persona.is_ingame?t.persona.is_in_nonsteam_game?-2:t.persona.m_unGamePlayedAppID:0},e.prototype.RemoveMemberFromBucket=function(e,t,n){if(-2==t)return this.RemoveFromSingletons(e,n),!0;var o=e.mapBuckets.get(t);return!(!o||!o.Remove(n))&&(0==o.member_list.length?(this.RemoveFromSingletons(e,n),this.LOG("Deleting bucket",t),e.mapBuckets.delete(t)):1==o.member_list.length&&!e.bFlatList&&this.BucketCanBeSingleton(o)&&(this.LOG("Removing member, adding",o.member_list[0].accountid,"to singletons"),this.AddToSingletons(e,o.member_list[0])),!0)},e.prototype.AddUserAndFireCallback=function(e,t,n){var o=ci.FriendStore.GetPlayer(t),i=this.GetBucketIdForPlayer(e,o,n);this.AddMemberToBucketID(e,i,o),this.FireMemberListChanged(e)},e.prototype.OnMemberAdded=function(e,t){var n=this.m_mapGroupBuckets.get(e);n&&this.AddUserAndFireCallback(n,t,e)},e.prototype.OnMemberRemoved=function(e,t){var n=this.m_mapGroupBuckets.get(e);if(n){for(var o=0,i=Array.from(n.mapBuckets.keys());o<i.length;o++){var r=i[o];if(this.RemoveMemberFromBucket(n,r,t))return void this.FireMemberListChanged(n)}this.RemoveMemberFromBucket(n,-2,t)&&this.FireMemberListChanged(n)}},R.c([T.a],e.prototype,"ListenForSettingsChanges",null),R.c([T.a],e.prototype,"OnPlayerGameChanged",null),R.c([T.a],e.prototype,"OnPersonaStateChanged",null),R.c([T.a],e.prototype,"OnPartyBeaconsUpdated",null),e}();function ei(o,e){return function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];ci.ready_to_render?o.apply(this,t):Object(d.when)(function(){return ci.ready_to_render},function(){o.apply(e,t)})}}function ti(e,t,n){return{value:ei(n.value)}}function ni(e){return ei(e,e.name)}var oi=function(){return function(){}}(),ii=function(){return function(){}}();function ri(e,t){return e.m_unPID==t.m_unPID&&e.m_nBrowserID==t.m_nBrowserID}var ai={m_unPID:0,m_nBrowserID:-1},si=function(){function o(e,t){void 0===t&&(t={}),this.m_BrowserContextDefaultTarget=ai,this.m_AppInfoStore=le,this.m_EconomyStore=new Fe,this.m_ParentalStore=new Xo,this.m_BroadcastStore=new mo,this.m_GroupMemberStore=new $o,this.m_bReadyToRender=!1,this.m_bShuttingDown=!1,Object(I.a)(!ci,"FriendsUIApp already initialized"),ci=this,(window.g_FriendsUIApp=this).m_Storage=e,this.m_SettingsStore=t.SettingsStore||new Oo(e),this.m_FriendStore=t.FriendStore||new vt,this.m_ChatStore=t.ChatStore||new tn(this.m_FriendStore),this.m_UIStore=t.UIStore||new go(this.m_ChatStore),this.m_VoiceChatStore=new Yo(this.m_SettingsStore)}return o.prototype.InitInternal=function(e,t,n){var o=this;void 0===n&&(n=[]),this.m_CMInterface=e,this.m_NotificationManager=t;var i=this.m_FriendStore.Init(e),r=this.m_ChatStore.Init(e,this.m_VoiceChatStore),a=this.InitAdjustClockDriftFromServer();this.m_VoiceChatStore.Init(e),this.m_SettingsStore.Init(e),this.m_AppInfoStore.Init(e),this.m_UIStore.Init(),this.m_EconomyStore.Init(e),this.m_ParentalStore.Init(e),this.m_BroadcastStore.Init(e),this.m_GroupMemberStore.Init();Promise.all([i,r,a].concat(n)).then(function(){console.log("Ready To Render promises succeeded"),o.SetReadyToRender()},function(e){console.error("Ready To Render promise failed: ",e),o.SetReadyToRender()})},o.prototype.GetChatRoomBBCodeParser=function(){return this.m_ChatRoomBBCodeParser},o.prototype.GetFriendChatBBCodeParser=function(){return this.m_FriendChatBBCodeParser},o.prototype.GetNotificationBBCodeParser=function(){return this.m_NotificationBBCodeParser},Object.defineProperty(o.prototype,"CMInterface",{get:function(){return this.m_CMInterface},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"FriendStore",{get:function(){return this.m_FriendStore},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"ChatStore",{get:function(){return this.m_ChatStore},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"VoiceStore",{get:function(){return this.m_VoiceChatStore},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"UIStore",{get:function(){return this.m_UIStore},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"SettingsStore",{get:function(){return this.m_SettingsStore},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"AppInfoStore",{get:function(){return this.m_AppInfoStore},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"Storage",{get:function(){return this.m_Storage},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"NotificationManager",{get:function(){return this.m_NotificationManager},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"EconomyStore",{get:function(){return this.m_EconomyStore},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"ParentalStore",{get:function(){return this.m_ParentalStore},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"BroadcastStore",{get:function(){return this.m_BroadcastStore},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"GroupMemberStore",{get:function(){return this.m_GroupMemberStore},enumerable:!0,configurable:!0}),o.prototype.SetReadyToRender=function(){return R.b(this,void 0,void 0,function(){return R.e(this,function(e){switch(e.label){case 0:return this.m_bReadyToRender?[3,2]:(console.log("FriendsUI ready to render after "+(performance.now()-o.sm_msStartup)+"ms"),this.m_bReadyToRender=!0,[4,this.OnReadyToRender()]);case 1:e.sent(),e.label=2;case 2:return[2]}})})},Object.defineProperty(o.prototype,"ready_to_render",{get:function(){return this.m_bReadyToRender},enumerable:!0,configurable:!0}),o.prototype.GetStartupTime=function(){return o.sm_msStartup},o.prototype.ShowFriendChatDialog=function(e,t,n){return void 0===n&&(n=!0),this.UIStore.ShowFriendChatDialog(e,t,n,n)},o.prototype.GetDefaultBrowserContext=function(){return this.m_BrowserContextDefaultTarget},o.prototype.SetDefaultPopupContext=function(e){console.log("Set default popup context: "+e.m_unPID),this.m_BrowserContextDefaultTarget=e},o.prototype.InitAdjustClockDriftFromServer=function(){return R.b(this,void 0,void 0,function(){var t=this;return R.e(this,function(e){return[2,new Promise(function(n,o){t.m_CMInterface.RunWhenLoggedOn(function(){return R.b(t,void 0,void 0,function(){var t=this;return R.e(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,Object(d.when)(function(){return t.m_CMInterface.BPerformedInitialClockAdjustment()},{timeout:1e3})];case 1:return e.sent(),n(),[3,3];case 2:return e.sent(),console.warn("Timed out waiting for initial server clock drift adjustment"),o(),[3,3];case 3:return[2]}})})})})]})})},o.prototype.GetServerTimeMS=function(){return this.m_CMInterface.GetServerTimeMS()},o.prototype.GetServerRTime32=function(){return this.m_CMInterface.GetServerRTime32()},o.prototype.RTime32ToDate=function(e){return this.m_CMInterface.RTime32ToDate(e)},o.prototype.GetLocalMidnightInRTime32=function(e){void 0===o.sm_tzOffset&&(o.sm_tzOffset=60*(new Date).getTimezoneOffset(),Object(I.a)(o.sm_tzOffset||0===o.sm_tzOffset,"Computed invalid timezone offset "+o.sm_tzOffset));var t=o.sm_tzOffset||0,n=(e||this.m_CMInterface.GetServerRTime32())-t;return 86400*Math.floor(n/86400)+t},o.prototype.IsInBeta=function(){return G.a.FRIENDSUI_BETA},o.prototype.BIsValidBrowserContext=function(e){return ri(e,ai)},o.prototype.ShowCloseActiveVoiceConfirmation=function(e,t){},o.sm_msStartup=performance.now(),R.c([d.observable],o.prototype,"m_bReadyToRender",void 0),R.c([d.computed],o.prototype,"ready_to_render",null),o}(),ci=void 0,li=n("Si88"),pi=n("UnXY"),ui=n("e2SU"),mi=n("8o0Y"),di=n("G+3Z");function hi(e){return e.children}var _i=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.m_coordinator=new gi,e}return R.d(e,t),e.prototype.OnDrop=function(e,t){e<t&&t--,t!=e&&this.props.onReorder(e,t)},e.prototype.render=function(){var o=this,i=[];return i.push(Ee.createElement(yi,{coordinator:this.m_coordinator,key:"dropregion_top",index:0,onDrop:this.OnDrop})),Ee.Children.forEach(this.props.children,function(e,t){var n=e.props.id||"__list_"+t;i.push(Ee.createElement(bi,{coordinator:o.m_coordinator,data:t,key:n},e)),i.push(Ee.createElement(yi,{coordinator:o.m_coordinator,key:"dropregion_"+n,index:t+1,onDrop:o.OnDrop}))}),Ee.createElement("div",{className:"DialogReorderableList"},i)},R.c([T.a],e.prototype,"OnDrop",null),e}(Ee.Component);function fi(e){if("touches"in e){var t=e;return[t.touches[0].clientX,t.touches[0].clientY]}var n=e;return[n.clientX,n.clientY]}var gi=function(){function e(){this.m_embeddedElement=new di.a("DragGhosts"),this.m_rgDropRegions=[],this.m_rgActiveDropRegions=[]}return e.prototype.RegisterDropRegion=function(e){this.m_rgDropRegions.push(e)},e.prototype.UnregisterDropRegion=function(e){M.d(this.m_rgDropRegions,e)},e.prototype.OnDragGhostRef=function(e){this.m_dragGhost=e},e.prototype.OnDragStart=function(e){this.m_activeDraggable=e,this.m_rgActiveDropRegions=[];for(var t=0,n=this.m_rgDropRegions;t<n.length;t++){var o=n[t];o.BAcceptDraggable(e)&&(o.OnDragStarted(e),this.m_rgActiveDropRegions.push(o))}this.m_embeddedElement.ShowElement(e.GetDragDocument(),Ee.cloneElement(e.renderDragGhost(),{ref:this.OnDragGhostRef}),e)},e.prototype.EndDrag=function(){if(this.m_activeDraggable){this.m_embeddedElement.HideElement(this.m_activeDraggable.GetDragDocument(),this.m_activeDraggable),this.m_activeDropRegion&&this.m_activeDropRegion.OnDrop(this.m_activeDraggable);for(var e=0,t=this.m_rgActiveDropRegions;e<t.length;e++){t[e].OnDragEnded(this.m_activeDraggable)}this.m_activeDraggable=void 0,this.m_dropGhost=void 0,this.m_rgActiveDropRegions=[]}},e.prototype.OnDrag=function(e,t){var n=fi(t),o=n[0],i=n[1];if(this.m_activeDropRegion&&this.m_activeDropRegion.BDraggableInRegion(o,i,this.m_activeDraggable))this.m_activeDropRegion.OnDragMove(o,i,this.m_activeDraggable);else{this.m_activeDropRegion&&(this.m_activeDropRegion.OnDragLeave(this.m_activeDraggable),this.m_activeDropRegion=void 0);for(var r=0,a=this.m_rgActiveDropRegions;r<a.length;r++){var s=a[r];if(s.BDraggableInRegion(o,i,this.m_activeDraggable))return this.m_activeDropRegion=s,this.m_dragGhost&&this.m_dragGhost.state.bVisible&&this.m_dragGhost.setState({bVisible:!1}),this.m_dropGhost||(this.m_dropGhost=this.m_activeDraggable.renderDropGhost()),void this.m_activeDropRegion.OnDragEnter(this.m_activeDraggable,this.m_dropGhost)}this.m_dragGhost&&this.m_dragGhost.setState({clientX:o,clientY:i,bVisible:!0})}},R.c([T.a],e.prototype,"OnDragGhostRef",null),e}(),bi=function(n){function e(e){var t=n.call(this,e)||this;return t.m_DragInfo={bStarted:!1,startClientX:void 0,startClientY:void 0,startOffsetX:void 0,startOffsetY:void 0,startWidth:void 0,startHeight:void 0,ownerWin:void 0},t.state={bInDrag:!1},t}return R.d(e,n),e.prototype.GetDragDocument=function(){return this.m_DragInfo.ownerWin&&this.m_DragInfo.ownerWin.document},e.prototype.RecordDragStart=function(e,t,n){this.m_DragInfo.startClientX=t,this.m_DragInfo.startClientY=n;var o=e.getBoundingClientRect();this.m_DragInfo.startOffsetX=t-o.left,this.m_DragInfo.startOffsetY=n-o.top,this.m_DragInfo.startWidth=o.width,this.m_DragInfo.startHeight=o.height,this.m_DragInfo.ownerWin=e.ownerDocument.defaultView},e.prototype.ProcessDragMove=function(e){if(this.m_DragInfo.bStarted)this.props.coordinator.OnDrag(this,e);else{var t=fi(e),n=t[0],o=t[1];25<=Math.pow(n-this.m_DragInfo.startClientX,2)+Math.pow(o-this.m_DragInfo.startClientY,2)&&(this.m_DragInfo.bStarted=!0,this.forceUpdate(),this.props.coordinator.OnDragStart(this),this.props.coordinator.OnDrag(this,e))}},e.prototype.OnMouseDown=function(e){this.m_DragInfo.bStarted||(this.RecordDragStart(e.currentTarget,e.clientX,e.clientY),this.m_DragInfo.ownerWin.addEventListener("mousemove",this.ProcessDragMove),this.m_DragInfo.ownerWin.addEventListener("mouseup",this.OnMouseUp))},e.prototype.OnMouseUp=function(e){this.m_DragInfo.ownerWin.removeEventListener("mousemove",this.ProcessDragMove),this.m_DragInfo.ownerWin.removeEventListener("mouseup",this.OnMouseUp),this.ResetDragState()},e.prototype.OnTouchStart=function(e){this.m_DragInfo.bStarted||(this.RecordDragStart(e.currentTarget,e.touches[0].clientX,e.touches[0].clientY),this.m_DragInfo.ownerWin.addEventListener("touchmove",this.ProcessDragMove),this.m_DragInfo.ownerWin.addEventListener("touchend",this.OnTouchEnd))},e.prototype.OnTouchEnd=function(e){this.m_DragInfo.ownerWin.removeEventListener("touchmove",this.ProcessDragMove),this.m_DragInfo.ownerWin.removeEventListener("touchend",this.OnTouchEnd),this.ResetDragState()},e.prototype.ResetDragState=function(){this.m_DragInfo.bStarted&&this.props.coordinator.EndDrag(),this.m_DragInfo.bStarted=!1,this.m_DragInfo.startClientX=void 0,this.m_DragInfo.startClientY=void 0,this.m_DragInfo.startOffsetX=void 0,this.m_DragInfo.startOffsetY=void 0,this.m_DragInfo.ownerWin=void 0,this.forceUpdate()},e.prototype.render=function(){var e,t="DialogDraggable";return this.m_DragInfo.bStarted?(e={},t+=" DraggedOut"):e={onMouseDown:this.OnMouseDown,onTouchStart:this.OnTouchStart},Ee.createElement("div",R.a({className:t},e),this.props.children)},e.prototype.renderDropGhost=function(){return Ee.createElement(vi,{elContent:this.GetClone()})},e.prototype.renderDragGhost=function(){return Ee.createElement(Si,{elContent:this.GetClone(),offsetX:this.m_DragInfo.startOffsetX,offsetY:this.m_DragInfo.startOffsetY,width:this.m_DragInfo.startWidth,height:this.m_DragInfo.startHeight})},e.prototype.GetClone=function(){var e,t=W.findDOMNode(this);if(t&&t.childElementCount)if(1==t.childElementCount)e=t.firstElementChild.cloneNode(!0);else{e=document.createElement("div");for(var n=t.firstChild;n;n=n.nextSibling)e.appendChild(n.cloneNode(!0))}return e},R.c([T.a],e.prototype,"ProcessDragMove",null),R.c([T.a],e.prototype,"OnMouseDown",null),R.c([T.a],e.prototype,"OnMouseUp",null),R.c([T.a],e.prototype,"OnTouchStart",null),R.c([T.a],e.prototype,"OnTouchEnd",null),e}(Ee.Component),vi=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return R.d(t,e),t.prototype.OnRef=function(e){e&&e.appendChild(this.props.elContent)},t.prototype.render=function(){return Ee.createElement("div",{className:"DialogDraggable_DropGhost",ref:this.OnRef})},R.c([T.a],t.prototype,"OnRef",null),t}(Ee.Component),Si=function(n){function e(e){var t=n.call(this,e)||this;return t.state={clientX:void 0,clientY:void 0,bVisible:!0},t}return R.d(e,n),e.prototype.OnRef=function(e){e&&e.appendChild(this.props.elContent)},e.prototype.render=function(){if(!this.state.bVisible||void 0===this.state.clientX||void 0===this.state.clientY)return Ee.createElement("div",null);var e={left:this.state.clientX-(this.props.offsetX||0),top:this.state.clientY-(this.props.offsetY||0),width:this.props.width||"auto",height:this.props.height||"auto"};return Ee.createElement("div",{className:"DialogDraggable_DragGhost",style:e,ref:this.OnRef})},R.c([T.a],e.prototype,"OnRef",null),e}(Ee.Component),yi=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return R.d(e,t),e.prototype.OnDrop=function(e){t.prototype.OnDrop.call(this,e),this.props.onDrop(e.props.data,this.props.index)},e.prototype.BDraggableInRegion=function(e,t,n){var o=this.GetClientRect();return!!o&&(e>=o.left&&e<=o.right&&t>=o.top-20&&t<=o.bottom+20)},e.prototype.BAcceptDraggable=function(e){return e.props.data!=this.props.index},e}(function(n){function e(e){var t=n.call(this,e)||this;return t.state={},t}return R.d(e,n),e.prototype.componentDidMount=function(){this.props.coordinator.RegisterDropRegion(this)},e.prototype.componentWillUnmount=function(){this.props.coordinator.UnregisterDropRegion(this)},e.prototype.OnDragStarted=function(e){this.setState({bDraggableActive:!0})},e.prototype.OnDragEnded=function(e){this.setState({bDraggableActive:!1})},e.prototype.OnDragEnter=function(e,t){this.setState({dropGhost:t})},e.prototype.OnDragLeave=function(e){this.setState({dropGhost:void 0})},e.prototype.OnDragMove=function(e,t,n){},e.prototype.OnDrop=function(e){this.setState({dropGhost:void 0})},e.prototype.BAcceptDraggable=function(e){return!0},e.prototype.BDraggableInRegion=function(e,t,n){var o=this.GetClientRect();return!!o&&(e>=o.left&&e<=o.right&&t>=o.top&&t<=o.bottom)},e.prototype.GetClientRect=function(){return this.m_elDropRegion||(this.m_elDropRegion=W.findDOMNode(this)),this.m_elDropRegion&&this.m_elDropRegion.getBoundingClientRect()},e.prototype.render=function(){var e="DialogDropRegion";return this.state.bDraggableActive&&(e+=" Active"),Ee.createElement("div",{className:e},this.state.dropGhost)},e}(Ee.Component)),Ci=n("/IDK"),Ii=function(){function e(e,t){this.m_bActive=!1,this.m_fnBoundAnimationFunc=void 0,this.m_window=e,this.m_options=Object.assign({timing:"sine"},t)}return e.prototype.Start=function(){var e;switch(this.m_msStart=performance.now(),this.m_msEnd=this.m_msStart+this.m_options.msDuration,this.m_options.timing){case"linear":e=function(e){return e};break;case"cubic-in-out":e=function(e){return e<.5?4*e*e*e:(e-1)*(2*e-2)*(2*e-2)+1};break;case"sine":default:e=function(e){return.5-Math.cos(e*Math.PI)/2}}this.m_bActive=!0,this.m_fnBoundAnimationFunc=this.OnInterval.bind(this,e),this.m_window.requestAnimationFrame(this.m_fnBoundAnimationFunc)},e.prototype.BIsActive=function(){return this.m_bActive},e.prototype.End=function(){this.m_bActive&&(this.Update(1),this.ClearInterval(),this.FireOnComplete())},e.prototype.FireOnComplete=function(){this.m_options.onComplete&&this.m_options.onComplete()},e.prototype.Cancel=function(){this.m_bActive=!1},e.prototype.OnInterval=function(e){if(this.m_bActive){var t=performance.now()-this.m_msStart;if(t>=this.m_options.msDuration)this.End();else{var n=t/this.m_options.msDuration;this.Update(e(n)),this.m_window.requestAnimationFrame(this.m_fnBoundAnimationFunc)}}},e.prototype.ClearInterval=function(){this.m_bActive=!1},e}(),Ei=function(i){function e(e,t,n){var o=i.call(this,Ci.l(e),n)||this;return o.m_props={},o.m_object=e,o.m_propTargets=t,o}return R.d(e,i),e.prototype.Start=function(){for(var e in this.m_props={},this.m_propTargets){var t=parseFloat(this.m_object[e])||0,n=this.m_propTargets[e];t!=n&&(this.m_props[e]={start:t,end:n})}i.prototype.Start.call(this)},e.prototype.Update=function(e){for(var t in this.m_props){var n=this.m_props[t],o=n.start+(n.end-n.start)*e;this.m_object[t]=o}},e}(Ii),Oi=function(i){function e(e,t,n){var o=i.call(this,Ci.l(W.findDOMNode(e)),n)||this;return o.m_props={},o.m_component=e,o.m_propTargets=t,o.m_setStateOnComplete=n.setStateOnComplete,o}return R.d(e,i),e.prototype.Start=function(){for(var e in this.m_props={},this.m_propTargets){var t=parseFloat(this.m_component.state[e])||0,n=this.m_propTargets[e];t!=n&&(this.m_props[e]={start:t,end:n})}i.prototype.Start.call(this)},e.prototype.Update=function(e){var t={};for(var n in this.m_props){var o=this.m_props[n],i=o.start+(o.end-o.start)*e;t[n]=i}this.m_component.setState(t)},e.prototype.FireOnComplete=function(){i.prototype.FireOnComplete.call(this),this.m_setStateOnComplete&&this.m_component.setState(this.m_setStateOnComplete)},e}(Ii),wi=tr("DialogHeader"),Mi=(tr("DialogSubHeader"),tr("DialogFooter")),Di=tr("DialogLabel _DialogLayout"),Ti=tr("DialogBodyText"),Gi=tr("DialogBody"),Ri=tr("DialogInnerBody"),Ni=tr("DialogBodyNotificationBar"),Li=tr("DialogTwoColLayout _DialogColLayout"),ki=tr("DialogThreeColLayout _DialogColLayout"),Pi=(tr("DialogTwoThirdColLayout _DialogColLayout"),tr("DialogColumn _DialogLayout"));function Ai(e){var t=e.children,n=e.bCenterVertically,o=R.f(e,["children","bCenterVertically"]),i="DialogContent _DialogLayout"+(e.className?" "+e.className:"");return n&&(i+=" _DialogCenterVertically"),Ee.createElement("div",R.a({},o,{className:i}),Ee.createElement("div",{className:"DialogContent_InnerWidth"},t))}var Bi=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return R.d(t,e),t.prototype.OnSubmit=function(e){e.preventDefault(),this.props.onSubmit&&this.props.onSubmit(e)},t.prototype.render=function(){return Ee.createElement("form",R.a({},this.props,{onSubmit:this.OnSubmit}))},R.c([T.a],t.prototype,"OnSubmit",null),t}(Ee.Component);function Fi(e){var t=e.classNameContent,n=e.bCenterVertically,o=R.f(e,["classNameContent","bCenterVertically"]);return Ee.createElement(Ai,{className:t,bCenterVertically:n},Ee.createElement(Bi,R.a({},o)))}function Vi(e){e.svgicon;var t,n=R.f(e,["svgicon"]),o="DialogButton _DialogLayout Primary"+(e.className?" "+e.className:""),i=void 0!==e.svgicon;return i&&(o+=" hasSVGIcon",t=e.svgicon),Ee.createElement("button",R.a({type:e.onClick?"button":"submit"},n,{className:o}),i&&Ee.createElement(t,null),e.children)}function xi(e){e.svgicon;var t,n=R.f(e,["svgicon"]),o="DialogButton _DialogLayout Secondary"+(e.className?" "+e.className:""),i=void 0!==e.svgicon;return i&&(o+=" hasSVGIcon",t=e.svgicon),Ee.createElement("button",R.a({type:"button"},n,{className:o}),i&&Ee.createElement(t,null),e.children)}function Ui(e){e.svgicon;var t,n=R.f(e,["svgicon"]),o="TextButton"+(e.className?" "+e.className:""),i=void 0!==e.svgicon;return i&&(o+=" hasSVGIcon",t=e.svgicon),Ee.createElement("button",R.a({type:"button"},n,{className:o}),i&&Ee.createElement(t,null),e.children)}function ji(e){var t="DialogHBar"+(e.className?" "+e.className:"");return Ee.createElement("div",R.a({},e,{className:t}))}function Hi(e){return Ee.createElement(Li,null,Ee.createElement(Vi,{onClick:e.onOK,disabled:e.bOKDisabled},e.strOKText||Object($.b)("#Button_Confirm")," "),Ee.createElement(xi,{onClick:e.onCancel},e.strCancelText||Object($.b)("#Button_Cancel")))}var Wi=function(n){function e(e){var t=n.call(this,e)||this;return t.state={m_CopiedYPos:0,m_bPlayingCopiedAnimation:!1,m_bCompletedCopiedAnimation:!1},t}return R.d(e,n),e.prototype.OnInputRef=function(e){this.m_elInput=e},Object.defineProperty(e.prototype,"element",{get:function(){return this.m_elInput},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"value",{get:function(){return this.m_elInput&&this.m_elInput.value},enumerable:!0,configurable:!0}),e.prototype.OnCopyClick=function(e){var t=this;if(this.m_elInput){this.m_elInput.select();var n=this.m_elInput.ownerDocument;if(n.queryCommandEnabled("copy")){n.execCommand("copy"),e.currentTarget.focus(),this.m_CopiedAnimation&&this.m_CopiedAnimation.Cancel();this.state.m_bPlayingCopiedAnimation;this.setState({m_bCompletedCopiedAnimation:!1}),this.setState({m_CopiedYPos:-4},function(){t.m_CopiedAnimation=new Oi(t,{m_CopiedYPos:-24},{msDuration:300,timing:"sine",setStateOnComplete:{m_bCompletedCopiedAnimation:!0}}),t.m_CopiedAnimation.Start()})}}},e.prototype.OnClearClick=function(e){this.m_elInput&&this.m_elInput.value&&(Object.getOwnPropertyDescriptor(window.HTMLInputElement.prototype,"value").set.call(this.m_elInput,""),this.m_elInput.dispatchEvent(new Event("input",{bubbles:!0})))},e.prototype.componentWillReceiveProps=function(e){Object(I.a)(!e.bShowClearAction||e.onChange,"In order for bShowClearAction to work correctly, you should be handling onChange and passing value to the Dialog.Input.")},e.prototype.render=function(){var e=this.props,t=e.label,n=e.explainer,o=e.bShowCopyAction,i=e.bShowClearAction,r=R.f(e,["label","explainer","bShowCopyAction","bShowClearAction"]),a="DialogInput DialogInputPlaceholder _DialogTextInputBase"+(r.className?" "+r.className:""),s="copiedAnimation",c=this.state.m_bCompletedCopiedAnimation;this.m_CopiedAnimation&&(s="copiedAnimation animationPlaying"),c&&(s="copiedAnimation animationComplete");var l={};void 0!==this.state.m_CopiedYPos&&(l.transform="translateY("+this.state.m_CopiedYPos+"px)");var p=void 0;n&&(p=Ee.createElement("div",{className:"DialogLabelExplainer"},n));var u=Ee.createElement(Ee.Fragment,null,Ee.createElement("div",{className:"DialogInput_Wrapper _DialogLayout"},Ee.createElement("input",R.a({type:"text"},r,{className:a,ref:this.OnInputRef})),o&&Ee.createElement("div",{className:"displayRow"},Ee.createElement(xi,{className:"DialogInput_CopyAction Primary",onClick:this.OnCopyClick},Object($.b)("#Button_CopyLink")),Ee.createElement("div",{style:l,className:s},"Link Copied")),i&&r.value&&Ee.createElement("div",{className:"DialogInput_ClearAction",onClick:this.OnClearClick},Ee.createElement(ui.ib,null))),p);return t?Ee.createElement("div",{className:"DialogInputLabelGroup _DialogLayout "},Ee.createElement("label",null,Ee.createElement("div",{className:"DialogLabel"},t," ",Ee.createElement("span",{className:"DialogInputRequirementLabel"},this.props.requiredLabel)," "),u)):u},R.c([T.a],e.prototype,"OnInputRef",null),R.c([T.a],e.prototype,"OnCopyClick",null),R.c([T.a],e.prototype,"OnClearClick",null),e}(Ee.PureComponent),zi=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return R.d(t,e),t.prototype.OnBackgroundClick=function(){this.m_elInput&&this.m_elInput.focus()},t.prototype.OnInputFocus=function(e){this.m_bFocused||(this.m_bFocused=!0,this.forceUpdate()),this.props.onFocus&&this.props.onFocus(e)},t.prototype.OnInputBlur=function(e){this.m_bFocused&&(this.m_bFocused=!1,this.forceUpdate()),this.props.onBlur&&this.props.onBlur(e)},t.prototype.render=function(){var e=this.props,t=e.label,n=e.explainer,o=e.children,i=(e.className,R.f(e,["label","explainer","children","className"]));return Ee.createElement("div",{className:"DialogInputLabelGroup _DialogLayout DialogListBuilderInput"},Ee.createElement("label",null,t&&Ee.createElement("div",{className:"DialogLabel"},t),Ee.createElement("div",{className:"_DialogInputContainer"+(this.m_bFocused?" Active":""),onClick:this.OnBackgroundClick},Ee.createElement("div",{className:"DialogListBuilderInput_List"},Ee.Children.map(o,function(e,t){return Ee.createElement("div",{className:"DialogListBuilderInput_ListItem",key:t},e)}),Ee.createElement("input",R.a({type:"text"},i,{className:"DialogListBuilderInput_Input DialogInputPlaceholder",ref:this.OnInputRef,onFocus:this.OnInputFocus,onBlur:this.OnInputBlur,size:4})))),this.props.explainer&&Ee.createElement("div",{className:"DialogLabelExplainer"},n)))},R.c([T.a],t.prototype,"OnBackgroundClick",null),R.c([T.a],t.prototype,"OnInputFocus",null),R.c([T.a],t.prototype,"OnInputBlur",null),t}(Wi),qi=function(n){function e(e){var t=n.call(this,e)||this;return t.state={checked:e.checked,disabled:e.disabled},t}return R.d(e,n),e.prototype.componentWillReceiveProps=function(e){e.checked!=this.state.checked&&this.setState({checked:e.checked}),e.disabled!=this.state.disabled&&this.setState({disabled:e.disabled})},e.prototype.shouldComponentUpdate=function(e,t){return e.label!=this.props.label||e.description!=this.props.description||e.onChange!=this.props.onChange||e.disabled!=this.props.disabled||e.checked!=this.state.checked||t.checked!=this.state.checked},Object.defineProperty(e.prototype,"checked",{get:function(){return this.state.checked},enumerable:!0,configurable:!0}),e.prototype.Toggle=function(){if(!this.props.disabled){var e=!this.state.checked;this.setState({checked:e}),this.props.onChange&&this.props.onChange(e)}},e.prototype.KeyDown=function(e){32==e.keyCode&&(this.Toggle(),e.preventDefault(),e.stopPropagation())},R.c([T.a],e.prototype,"Toggle",null),R.c([T.a],e.prototype,"KeyDown",null),e}(Ee.Component),Ki=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return R.d(t,e),t.prototype.render=function(){var e="DialogCheckbox"+(this.state.checked?" Active":"");return 1==this.state.disabled&&(e+=" Disabled"),this.props.label?Ee.createElement("div",{className:"DialogCheckbox_Container _DialogLayout "+(this.props.classname?this.props.classname:""),tabIndex:this.props.tabIndex||0,onClick:this.Toggle},Ee.createElement("div",{className:e},Ee.createElement(ui.k,null)),Ee.createElement("div",{className:"DialogToggle_Label"},Ee.createElement("span",null,this.props.label)),Ee.createElement("div",{style:{clear:"left"}}),this.props.description&&Ee.createElement("div",{className:"DialogToggle_Description"},this.props.description)):Ee.createElement("div",{className:e,onClick:this.Toggle,tabIndex:this.props.tabIndex||0},Ee.createElement(ui.k,null))},t}(qi),Yi=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return R.d(t,e),t.prototype.render=function(){var e=this.state.checked?" Active":"";return Ee.createElement("div",{className:"DialogRoundCheckbox"},Ee.createElement("div",{className:"DialogRoundCheckbox_Control"+e,onClick:this.Toggle,tabIndex:this.props.tabIndex||0},Ee.createElement("div",{className:"DialogRoundCheckbox_OuterCircle"},Ee.createElement("div",{className:"DialogRoundCheckbox_InnerCircle"}))))},t}(qi),Ji=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return R.d(t,e),t.prototype.OnOffKeyDown=function(e){37==e.keyCode&&this.state.checked||39==e.keyCode&&!this.state.checked?(this.Toggle(),e.preventDefault(),e.stopPropagation()):this.KeyDown(e)},t.prototype.render=function(){var e="DialogOnOffToggle _DialogInputContainer _DialogLayout "+(this.props.classname?this.props.classname:"");return this.props.disabled&&(e+=" Disabled"),Ee.createElement("div",{className:e,tabIndex:this.props.tabIndex||0,onKeyDown:this.OnOffKeyDown},Ee.createElement("div",{className:"displayColumn alignSelfCenter"},Ee.createElement("div",{className:"DialogToggle_Label"},Ee.createElement("span",null,this.props.label)),this.props.description&&Ee.createElement("div",{className:"DialogToggle_Description"},this.props.description),this.props.children),Ee.createElement("div",{className:"DialogOnOffToggle_Control",onClick:this.Toggle},Ee.createElement("div",{className:"DialogOnOffToggle_Option Off"+(this.state.checked?"":" Active")},Object($.b)("#Dialog_Off")),Ee.createElement("div",{className:"DialogOnOffToggle_Option On"+(this.state.checked?" Active":"")},Object($.b)("#Dialog_On"))))},R.c([T.a],t.prototype,"OnOffKeyDown",null),t}(qi),Xi=function(n){function e(e){var t=n.call(this,e)||this;return t.state={value:t.ClampValue(e.value)},t}return R.d(e,n),Object.defineProperty(e.prototype,"value",{get:function(){return this.state.value},enumerable:!0,configurable:!0}),e.prototype.ClampValue=function(e){return void 0===e||isNaN(e)||e<this.props.min?this.props.min:e>this.props.max?this.props.max:e},e.prototype.BPropsValid=function(){return this.props.max>this.props.min},e.prototype.shouldComponentUpdate=function(e,t){return t.value!=this.state.value||(e.max!==this.props.max||e.min!==this.props.min||e.value!==this.state.value&&e.value!==this.props.value||e.onChange!==this.props.onChange)},e.prototype.componentWillReceiveProps=function(e){e.value!=this.props.value&&this.setState({value:e.value})},e.prototype.OnMouseDown=function(e){this.m_elSlider=e.currentTarget,this.m_rectSlider=this.m_elSlider.getBoundingClientRect(),this.AdjustSliderForClientX(e.clientX),this.m_elSlider.ownerDocument.defaultView.addEventListener("mousemove",this.OnMouseMove),this.m_elSlider.ownerDocument.defaultView.addEventListener("mouseup",this.OnMouseUp)},e.prototype.OnMouseMove=function(e){this.AdjustSliderForClientX(e.clientX)},e.prototype.OnMouseUp=function(e){this.m_elSlider.ownerDocument.defaultView.removeEventListener("mousemove",this.OnMouseMove),this.m_elSlider.ownerDocument.defaultView.removeEventListener("mouseup",this.OnMouseUp)},e.prototype.OnTouchStart=function(e){this.m_elSlider=e.currentTarget,this.m_rectSlider=this.m_elSlider.getBoundingClientRect(),this.AdjustSliderForClientX(e.touches[0].clientX),this.m_elSlider.ownerDocument.defaultView.addEventListener("touchmove",this.OnTouchMove),this.m_elSlider.ownerDocument.defaultView.addEventListener("touchend",this.OnTouchEnd)},e.prototype.OnTouchMove=function(e){this.AdjustSliderForClientX(e.touches[0].clientX)},e.prototype.OnTouchEnd=function(e){this.m_elSlider.ownerDocument.defaultView.removeEventListener("touchmove",this.OnTouchMove),this.m_elSlider.ownerDocument.defaultView.removeEventListener("touchend",this.OnTouchEnd)},e.prototype.OnKeyDown=function(e){var t=1;e.ctrlKey&&(t=Math.max(1,Math.floor(.1*(this.props.max-this.props.min)+.5))),37==e.keyCode?(this.IncrementValue(-1*t),e.preventDefault()):39==e.keyCode&&(this.IncrementValue(1*t),e.preventDefault())},e.prototype.AdjustSliderForClientX=function(e){var t=(e-this.m_rectSlider.left)/(this.m_rectSlider.right-this.m_rectSlider.left)*(this.props.max-this.props.min);t=Math.floor(t+.5);var n=this.ClampValue(t);n!=this.state.value&&(this.setState({value:n}),this.props.onChange&&this.props.onChange(n))},e.prototype.IncrementValue=function(e){var t=this.ClampValue(this.state.value+e);t!=this.state.value&&(this.setState({value:t}),this.props.onChange&&this.props.onChange(t))},e.prototype.render=function(){var e={},t={};if(this.BPropsValid()){var n=100*(this.state.value-this.props.min)/(this.props.max-this.props.min)+"%";e.width=n,t.left=n}var o=this.props,i=o.label,r=o.explainer,a=(R.f(o,["label","explainer"]),void 0);return r&&(a=Ee.createElement("div",{className:"DialogLabelExplainer"},r)),Ee.createElement("div",{className:"DialogSlider_Container _DialogInputContainer _DialogLayout",onKeyDown:this.OnKeyDown,tabIndex:this.props.tabIndex||0},i&&Ee.createElement("div",{className:"DialogLabel"},i),Ee.createElement("div",{className:"DialogSlider_Slider",onMouseDown:this.OnMouseDown,onTouchStart:this.OnTouchStart},Ee.createElement("div",{className:"DialogSlider_Value",style:e}),Ee.createElement("div",{className:"DialogSlider_Grabber",style:t})),a)},R.c([T.a],e.prototype,"OnMouseDown",null),R.c([T.a],e.prototype,"OnMouseMove",null),R.c([T.a],e.prototype,"OnMouseUp",null),R.c([T.a],e.prototype,"OnTouchStart",null),R.c([T.a],e.prototype,"OnTouchMove",null),R.c([T.a],e.prototype,"OnTouchEnd",null),R.c([T.a],e.prototype,"OnKeyDown",null),e}(Ee.Component),Qi=function(n){function e(e){var t=n.call(this,e)||this;return t.state={iSelectedOption:t.FindActiveOptionIndex(e.selectedOption),bOpened:!1},t}return R.d(e,n),e.prototype.FindAndSetActiveOption=function(e){var t=this.FindActiveOptionIndex(e);t!==this.state.iSelectedOption&&this.setState({iSelectedOption:t})},e.prototype.FindActiveOptionIndex=function(e){for(var t=0;t<this.props.rgOptions.length;t++)if(this.props.rgOptions[t].data===e)return t},Object.defineProperty(e.prototype,"value",{get:function(){return void 0!==this.state.iSelectedOption?this.props.rgOptions[this.state.iSelectedOption]:void 0},enumerable:!0,configurable:!0}),e.prototype.SetSelectedOption=function(e){null!=e?this.FindAndSetActiveOption(e):this.setState({iSelectedOption:void 0})},e.prototype.shouldComponentUpdate=function(e,t,n){if(e.selectedOption!=this.props.selectedOption){this.FindActiveOptionIndex(e.selectedOption);if(this.state.iSelectedOption!==t.iSelectedOption)return!0}if(t.bOpened!==this.state.bOpened||t.iSelectedOption!==this.state.iSelectedOption)return!0;for(var o=0,i=["label","selectedOption","tabIndex","onChange","strDefaultLabel"];o<i.length;o++){var r=i[o];if(e[r]!==this.props[r])return!0}return!(!this.state.bOpened||!this.didOptionsChange(e.rgOptions))},e.prototype.didOptionsChange=function(e){if(e.length!=this.props.rgOptions.length)return!0;for(var t=0;t<e.length;t++)if(e[t].label!==this.props.rgOptions[t].label)return!0;return!1},e.prototype.componentWillReceiveProps=function(e){e.selectedOption!==this.props.selectedOption&&this.FindAndSetActiveOption(e.selectedOption),this.didOptionsChange(e.rgOptions)&&(this.HideMenu(),this.m_iMenuInstance=void 0)},e.prototype.OnInputRef=function(e){this.m_elInput=e},e.prototype.ToggleMenu=function(){this.state.bOpened?this.HideMenu():this.ShowMenu()},e.prototype.OnItemSelected=function(e,t){this.HideMenu(),this.setState({iSelectedOption:e}),this.props.onChange&&this.props.onChange(void 0!==e?this.props.rgOptions[e]:void 0,this)},e.prototype.ShowMenu=function(){this.m_iMenuInstance?this.m_iMenuInstance.Show():(this.m_iMenuInstance=Object(mi.a)(Ee.createElement(Zi,{rgOptions:this.props.rgOptions,fnOnItemSelected:this.OnItemSelected}),this.m_elInput,{bOverlapHorizontal:!0,bMatchWidth:!0,bFitToWindow:!0,strClassName:"DialogMenuPosition"}),this.m_iMenuInstance.SetOnHideCallback(this.HideMenu)),this.setState({bOpened:!0})},e.prototype.HideMenu=function(){this.m_iMenuInstance&&this.m_iMenuInstance.Hide(),this.setState({bOpened:!1})},e.prototype.render=function(){var e=void 0!==this.state.iSelectedOption&&this.props.rgOptions[this.state.iSelectedOption],t=e?e.label:this.props.strDefaultLabel,n="DialogDropDown _DialogInputContainer",o="DialogInputLabelGroup _DialogLayout";return this.state.bOpened&&(n+=" Active"),this.props.strClassName&&(o+=" "+this.props.strClassName),Ee.createElement("div",{className:o},this.props.label&&Ee.createElement("div",{className:"DialogLabel"},this.props.label),Ee.createElement("div",{className:n,tabIndex:this.props.tabIndex||0,onClick:this.ToggleMenu,ref:this.OnInputRef},Ee.createElement("div",{className:"DialogDropDown_Arrow"},Ee.createElement(ui.n,null)),t))},R.c([T.a],e.prototype,"OnInputRef",null),R.c([T.a],e.prototype,"ToggleMenu",null),R.c([T.a],e.prototype,"OnItemSelected",null),R.c([T.a],e.prototype,"ShowMenu",null),R.c([T.a],e.prototype,"HideMenu",null),e}(Ee.Component),Zi=function(n){function e(e){var t=n.call(this,e)||this;return t.state={iFocus:0},t}return R.d(e,n),e.prototype.OnItemClicked=function(e){var t=parseInt(e.currentTarget.getAttribute("data-dropdown-index"));(t||0===t)&&0<=t&&t<this.props.rgOptions.length&&this.props.fnOnItemSelected(t,this.props.rgOptions[t])},e.prototype.render=function(){var n=this,e=this.props.rgOptions.map(function(e,t){return Ee.createElement("div",{className:"DialogDropDownMenu_Item",key:t,"data-dropdown-index":t,onClick:n.OnItemClicked},e.label)});return Ee.createElement("div",{className:"DialogDropDownMenu _DialogInputContainer"},e)},R.c([T.a],e.prototype,"OnItemClicked",null),e}(Ee.Component),$i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return R.d(t,e),t}(Ee.Component),er=function(n){function e(e){var t=n.call(this,e)||this;return t.state={activePage:-1},t}return R.d(e,n),e.prototype.OnActivePageRef=function(e){this.m_ActivePage=e instanceof $i?e:(Object(I.a)(!e,'PagedSettingsDialog page "'+this.GetActivePage().title+'" does not derive from PagedSettingsPageComponent'),null)},e.prototype.GetActivePage=function(){return this.state.activePage<0||this.state.activePage>=this.props.pages.length?this.props.pages[0]:this.props.pages[this.state.activePage]},e.prototype.SelectPage=function(e){e!=this.state.activePage&&(this.m_ActivePage&&!this.m_ActivePage.OKToSwitchAway()||this.setState({activePage:e}))},e.prototype.render=function(){for(var s=this,c=this.GetActivePage(),l=[],e=function(e){var t=p.props.pages[e],n=t==c,o=t.className||"",i=t.click||function(){s.SelectPage(e)},r=["PagedSettingsDialog_PageListItem"],a=!1;"ChatRoomLeave"==t.className&&(a=!0),n&&r.push("Active"),r.push(o),l.push(Ee.createElement("div",{className:r.join(" "),key:t.title,onClick:i},a&&Ee.createElement(ui.gb,null),t.title))},p=this,t=0;t<this.props.pages.length;t++)e(t);var n=c.hideTitle,o="";c.uniqueName&&(o=" Page_"+c.uniqueName.replace(/\s/g,""));var i=!1!==c.enabled;return i||(o+=" noPermission"),Ee.createElement("div",{className:(this.props.className?this.props.className:"")+" PagedSettingsDialog"},Ee.createElement("div",{className:"PagedSettingsDialog_PageListColumn"},Ee.createElement("div",{className:"PagedSettingsDialog_Title"},this.props.title),Ee.createElement("div",{className:"PagedSettingsDialog_PageList"},l)),Ee.createElement(pi,{className:"DialogContentTransition"},c&&Ee.createElement(li,{key:c.title,classNames:"opacityfade-anim",timeout:300},Ee.createElement(Ai,{className:"PagedSettingsDialog_PageContent"+o},!n&&Ee.createElement(wi,null,c.title,!i&&Ee.createElement(Ni,null,Ee.createElement(ui.z,null),Object($.b)("#Chat_Settings_Permission_Denied"))),null!=c.content&&Ee.cloneElement(c.content,{ref:this.OnActivePageRef})))))},R.c([T.a],e.prototype,"OnActivePageRef",null),e}(Ee.Component);function tr(n){return function(e){var t=n+(e.className?" "+e.className:"");return Ee.createElement("div",R.a({},e,{className:t}))}}var nr=function(n){function e(e){var t=n.call(this,e)||this;return t.m_bAcceptDrag=!1,t.m_deferredEnter=null,t.m_divElement=null,t}return R.d(e,n),e.prototype.BindDiv=function(e){this.m_divElement=e},Object.defineProperty(e.prototype,"div",{get:function(){return this.m_divElement},enumerable:!0,configurable:!0}),e.prototype.DeliverDeferredDragEnter=function(){var e=_d.DragDropManager.GetDragData();return this.props.fnDragEnter(e,this.m_deferredEnter.bFiles)},e.prototype.OnDragEnter=function(e){if(!this.m_bAcceptDrag){var t=_d.DragDropManager.GetDragData(),n=this.props.bAcceptsFiles&&-1!=e.dataTransfer.types.indexOf("Files");t&&-1!=this.props.rgAcceptedTypes.indexOf(t.type)?this.m_bAcceptDrag=!0:this.m_bAcceptDrag=!!n,this.m_bAcceptDrag&&this.props.fnDragEnter&&(this.m_deferredEnter={bFiles:n}),this.m_bAcceptDrag&&(e.preventDefault(),e.stopPropagation())}},e.prototype.OnDragLeave=function(e){if(this.m_bAcceptDrag){if(!Object(Ci.c)(e))return;this.m_bAcceptDrag=!1,e.preventDefault(),e.stopPropagation(),this.props.fnDragLeave&&this.props.fnDragLeave()}},e.prototype.OnDragOver=function(e){if(this.m_bAcceptDrag){if(this.m_deferredEnter){var t=this.DeliverDeferredDragEnter();if(this.m_deferredEnter=null,!t)return void(this.m_bAcceptDrag=!1)}e.preventDefault(),e.stopPropagation(),this.props.fnDragOver&&this.props.fnDragOver(e)}},e.prototype.OnDrop=function(e){if(this.m_bAcceptDrag){this.m_bAcceptDrag=!1,e.preventDefault(),e.stopPropagation();var t=_d.DragDropManager.GetDragData();t&&-1!=this.props.rgAcceptedTypes.indexOf(t.type)?this.props.fnDrop&&this.props.fnDrop(t,e):this.props.bAcceptsFiles&&0!=e.dataTransfer.files.length&&this.props.fnDrop&&this.props.fnDrop(null,e)}},e.prototype.render=function(){var e=this.props,t=(e.rgAcceptedTypes,e.bAcceptsFiles,e.fnDragEnter,e.fnDragLeave,e.fnDragOver,e.fnDrop,R.f(e,["rgAcceptedTypes","bAcceptsFiles","fnDragEnter","fnDragLeave","fnDragOver","fnDrop"]));return Ee.createElement("div",R.a({},t,{ref:this.BindDiv,className:"DropTarget "+this.props.className,onDragEnter:this.OnDragEnter,onDragLeave:this.OnDragLeave,onDragOver:this.OnDragOver,onDrop:this.OnDrop}),this.props.children)},R.c([T.a],e.prototype,"BindDiv",null),R.c([T.a],e.prototype,"DeliverDeferredDragEnter",null),R.c([T.a],e.prototype,"OnDragEnter",null),R.c([T.a],e.prototype,"OnDragLeave",null),R.c([T.a],e.prototype,"OnDragOver",null),R.c([T.a],e.prototype,"OnDrop",null),e}(Ee.PureComponent),or=n("okNM"),ir=n("EGkk"),rr=n("JtU4"),ar=function(n){function e(e){var t=n.call(this,e)||this;return t.state={error:null},t}return R.d(e,n),e.prototype.componentDidCatch=function(e,t){var n={error:e,info:t};this.setState({error:n})},e.prototype.clearError=function(){this.setState({error:null})},e.prototype.render=function(){var e=this.state.error;if(e){var t=e.error?e.error.stack:"Stack missing",n=e.info?e.info.componentStack:"",o=e.error&&e.error.message||"unknown error";return Ee.createElement("div",{style:{overflow:"auto"}},Ee.createElement("h1",{style:{marginTop:"15px",marginLeft:"15px",color:"white",fontSize:"20px",display:"inline-block"}},'Error: "',o,'"'),"   ",Ee.createElement("span",{style:{textDecoration:"underline",cursor:"pointer"},onClick:this.clearError},"(x) Dismiss"),Ee.createElement("br",null),Ee.createElement("pre",{style:{marginTop:"15px",marginLeft:"15px",color:"white",fontSize:"16px"}},t),Ee.createElement("pre",{style:{marginTop:"15px",marginLeft:"15px",color:"white",fontSize:"16px"}},"The error occurred while rendering:",n))}return this.props.children},R.c([T.a],e.prototype,"clearError",null),e}(Ee.Component);function sr(t){var e,n={};t.onEscKeypress&&(n.tabIndex=0,n.onKeyDown=function(e){27==e.keyCode&&t.onEscKeypress()},n.onClick=function(e){e.currentTarget===e.target&&t.onEscKeypress()},e=function(e){e&&(Ci.e(e,e.ownerDocument.activeElement)||e.focus())});var o=["ModalPosition"];return t.className&&o.push(t.className),t.bDestructiveWarning&&o.push("Destructive"),Ee.createElement("div",R.a({className:o.join(" ")},n,{ref:e}),Ee.createElement("div",{className:"ModalPosition_Content"},!t.hideTopBar&&Ee.createElement("div",{className:"ModalPosition_TopBar"}),t.onEscKeypress&&Ee.createElement("div",{className:"ModalPosition_Dismiss"},Ee.createElement("div",{className:"closeButton",onClick:t.onEscKeypress},Ee.createElement(ui.jb,null))),Ee.createElement(ar,null,t.children)))}var cr=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return R.d(t,e),t.prototype.Cancel=function(){this.props.onCancel(),this.props.closeModal()},t.prototype.OK=function(){this.props.onOK(),this.props.closeModal()},t.prototype.componentDidMount=function(){var e=W.findDOMNode(this);if(e){var t=e.querySelector("button[type=submit]");t&&t.focus()}},t.prototype.render=function(){return Ee.createElement(sr,{onEscKeypress:this.Cancel,bDestructiveWarning:this.props.bDestructiveWarning},Ee.createElement(Fi,{classNameContent:"GenericConfirmDialog",onSubmit:this.OK,bCenterVertically:!0},Ee.createElement(wi,null,this.props.strTitle),Ee.createElement(Gi,null,Ee.createElement(Ti,null,this.props.strDescription,this.props.children)),Ee.createElement(Mi,null,!this.props.bAlertDialog&&Ee.createElement(Hi,{onCancel:this.Cancel,strOKText:this.props.strOKButtonText,strCancelText:this.props.strCancelButtonText}),this.props.bAlertDialog&&Ee.createElement(Vi,null,this.props.strOKButtonText))))},R.c([T.a],t.prototype,"Cancel",null),R.c([T.a],t.prototype,"OK",null),t}(Ee.Component),lr=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return R.d(t,e),t.prototype.render=function(){var e=this.props.ModalManager.modals;if(!e||!e.length)return null;var o=this.props.ModalManager.active_modal,t=e.map(function(e,t){var n="chat_modal_position"+(e!=o?" inactive":" active");return Ee.createElement("div",{className:n,key:t},e.element)});return Ee.createElement("div",{className:"chat_full_modaloverlay"},Ee.createElement("div",{className:"chat_modal_position chat_modal_background"}),t)},t=R.c([or.observer],t)}(Ee.Component),pr=function(){function e(){this.m_bUsePopups=!1,this.m_rgModals=d.observable.array(null,{deep:!1})}return Object.defineProperty(e.prototype,"modals",{get:function(){return this.m_rgModals},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"active_modal",{get:function(){return this.m_rgModals.length?this.m_rgModals[this.m_rgModals.length-1]:void 0},enumerable:!0,configurable:!0}),e.prototype.ShowModal=function(e){var t=this,n={element:e};return this.m_rgModals.push(n),{Close:function(){var e=t.m_rgModals.indexOf(n);-1!=e&&t.m_rgModals.splice(e,1)}}},e}();function ur(e){var t=mr.get(e);return t||(t=new pr,mr.set(e,t)),t}var mr=new WeakMap,dr=function(n){function e(e){var t=n.call(this,e)||this;return t.state={maximized:t.BIsMaximized()},t}return R.d(e,n),e.prototype.BIsMaximized=function(){var e=this.props.popup.screen.availWidth-this.props.popup.innerWidth,t=this.props.popup.screen.availHeight-this.props.popup.innerHeight;return 0===e&&0===t},e.prototype.componentDidMount=function(){this.props.popup.addEventListener("resize",this.UpdateMaximizeState)},e.prototype.componentWillUnmount=function(){this.props.popup.removeEventListener("resize",this.UpdateMaximizeState)},e.prototype.UpdateMaximizeState=function(){var e=this.BIsMaximized();e!=this.state.maximized&&this.setState({maximized:e})},e.prototype.render=function(){var e=this.props.popup,t="title-area-icon";return this.state.maximized?t+=" restoreButton":t+=" maximizeButton",Ee.createElement("div",{className:"TitleBar title-area"},Ee.createElement("div",{className:"title-area-highlight"}),Ee.createElement("div",{className:"title-area-children"},this.props.children),!this.props.hideActions&&Ee.createElement("div",{className:"title-bar-actions"},Ee.createElement("div",{className:"title-area-icon closeButton",onClick:function(){e&&e.close()}},Ee.createElement(ui.jb,null)),!this.props.hideMinMax&&Ee.createElement("div",{className:t,onClick:function(){e.SteamClient.Window.ToggleMaximize()}},this.state.maximized&&Ee.createElement(ui.O,null),!this.state.maximized&&Ee.createElement(ui.B,null)),!this.props.hideMinMax&&Ee.createElement("div",{className:"title-area-icon minimizeButton",onClick:function(){e.SteamClient.Window.Minimize()}},Ee.createElement(ui.E,null))))},R.c([T.a],e.prototype,"UpdateMaximizeState",null),e}(Ee.Component),hr=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e.reduce(function(e,t){return t?"string"==typeof t?e?e+" "+t:t:"object"==typeof t?e?e+" "+_r(t):_r(t):e:e},"")};function _r(n){return Object.keys(n).reduce(function(e,t){return n[t]?e?e+" "+t:t:e},"")}function fr(e,t,n,o,i){var r,a=e.props.closeModal,s=Ee.cloneElement(e,{closeModal:function(){r&&r.Close(),a&&a()}});if(_.b.USE_POPUPS&&o&&n){var c=new gr(t,n,o,s,i);c.Show(),r=c}else r=ur(t).ShowModal(s);return r}var gr=function(a){function e(e,t,n,o,i){var r=a.call(this,t,{title:n.strTitle,html_class:"client_chat_frame fullheight ModalDialogPopup",body_class:hr("fullheight",n.bodyClass),owner_window:void 0,replace_existing_popup:!0,target_browser:i,availscreenwidth:e.screen.availWidth,availscreenheight:e.screen.availHeight})||this;return r.m_bModalInitiatedClose=!1,r.m_windowOpener=e,r.m_modalProps=n,r.m_modalElement=o,r}return R.d(e,a),e.prototype.Close=function(){this.m_bModalInitiatedClose=!0,a.prototype.Close.call(this)},e.prototype.UpdateParamsBeforeShow=function(e){var t=this.m_modalProps.popupWidth||500,n=this.m_modalProps.popupHeight||400,o=this.m_windowOpener.screen,i=(o.availWidth-t)/2,r=(o.availHeight-n)/2,a=o;return void 0!==a.availLeft&&void 0!==a.availTop&&(i+=a.availLeft,r+=a.availTop),R.a({},e,{dimensions:{width:t,height:n,left:i,top:r}})},e.prototype.OnLoad=function(){},e.prototype.OnResize=function(){},e.prototype.OnClose=function(){this.m_bModalInitiatedClose||this.m_modalProps.closeModal&&this.m_modalProps.closeModal()},e.prototype.Render=function(e,t){t.setAttribute("class","fullheight popup_chat_frame"),this.m_modalElement&&W.render(Ee.createElement(br,{popup:e},this.m_modalElement),t)},e}(rr.a);function br(e){return Ee.createElement("div",{className:"PopupFullWindow",onContextMenu:ir.i},Ee.createElement(dr,{hideMinMax:!0,popup:e.popup}),Ee.createElement(lr,{ModalManager:ur(e.popup)}),e.children)}function vr(n,o,e,t,i,r,a){return void 0===i&&(i=Object($.b)("#Button_Cancel")),s=function(e){var t=Cr(n,o);fr(e,n,"alertdialog",t,pd(n))},c=o,l=e,p=t,u=i,m=r,d=a,new Promise(function(e,t){s(Ee.createElement(cr,{strTitle:c,strDescription:l,strOKButtonText:p,strCancelButtonText:u,onOK:e,onCancel:t,bDestructiveWarning:m,children:d}))});var s,c,l,p,u,m,d}function Sr(e,t,n,o,i,r,a){return void 0===i&&(i=Object($.b)("#Button_Cancel")),vr(e,t,n,o,i,r,a).then(function(){return Promise.resolve(!0)}).catch(function(){return Promise.resolve(!1)})}function yr(n,o,e,t){return void 0===t&&(t=Object($.b)("#Button_OK")),i=function(e){var t=Cr(n,o);fr(e,n,"alertdialog",t,pd(n))},r=o,a=e,s=t,new Promise(function(e,t){i(Ee.createElement(cr,{bAlertDialog:!0,strTitle:r,strDescription:a,strOKButtonText:s,onOK:e,onCancel:e}))});var i,r,a,s}function Cr(e,t){return ci.UIStore.GetPerContextChatData(ld(e)).BUsePopups()&&e.innerWidth<600?{strTitle:t,popupWidth:638,popupHeight:300}:null}function Ir(e,t,n){fr(Ee.createElement(Er,{player:t}),n,"NicknameDialog",{strTitle:Object($.b)("#Friend_Menu_AddNickname"),popupWidth:640,popupHeight:400},pd(n))}var Er=function(n){function e(e){var t=n.call(this,e)||this;return t.state={strCurrentNameEntry:t.props.player.nickname||""},t}return R.d(e,n),e.prototype.HandleTextEntry=function(e){this.setState({strCurrentNameEntry:e.currentTarget.value})},e.prototype.HandleSubmit=function(e){var t=this;ci.FriendStore.SetPlayerNickname(this.props.player,this.state.strCurrentNameEntry).then(function(e){1==e&&t.props.closeModal&&t.props.closeModal()})},e.prototype.componentWillReceiveProps=function(e){e.player!=this.props.player&&this.setState({strCurrentNameEntry:e.player.nickname})},e.prototype.render=function(){var e="friend editNickname",t=this.props.player.has_nickname;return this.props.player.persona.is_ingame?e+=" ingame":this.props.player.persona.is_online&&(e+=" online"),t&&(e+=" nickNamed"),Ee.createElement(sr,{className:"Dialog_EditNickName",onEscKeypress:this.props.closeModal},Ee.createElement(Fi,{classNameContent:"NicknameDialog",onSubmit:this.HandleSubmit},Ee.createElement(wi,null,t?Object($.b)("#Friend_Menu_ChangeNickname"):Object($.b)("#Friend_Menu_AddNickname")),Ee.createElement(Gi,null,Ee.createElement(Ti,null,t?Object($.b)("#Nickname_EditNickname"):Object($.b)("#Nickname_AddANickname")),Ee.createElement(Ti,null,Ee.createElement("div",{className:e},Ee.createElement("img",{className:"avatarMedium",src:this.props.player.persona.avatar_url_full}),Ee.createElement("div",{className:"labelHolder"},Ee.createElement("div",{className:"mediumName"},this.props.player.secondary_display_name),Ee.createElement("div",{className:"nickNamedAs"},Object($.b)("#Nickname_NickNameAsDialog")),Ee.createElement("div",{className:"mediumName asNickName"},Ee.createElement(Wi,{placeholder:t?Object($.b)("#Nickname_PlaceHolderNickName"):Object($.b)("#Nickname_PlaceHolderNickNameFresh"),className:"nicknameInput",value:this.state.strCurrentNameEntry,onChange:this.HandleTextEntry,autoFocus:!0,bShowClearAction:!0})))))),Ee.createElement(Mi,null,Ee.createElement(Hi,{onCancel:this.props.closeModal}))))},R.c([T.a],e.prototype,"HandleTextEntry",null),R.c([T.a],e.prototype,"HandleSubmit",null),e=R.c([or.observer],e)}(Ee.Component),Or=function(n){function e(e){var t=n.call(this,e)||this;return t.m_friendList=null,t.m_rctChosenFriends=[],t.state={rgFriendsChosen:[],strInputValue:""},t}return R.d(e,n),Object.defineProperty(e.prototype,"selectedFriendCount",{get:function(){return this.state.rgFriendsChosen.length},enumerable:!0,configurable:!0}),e.prototype.OnTextInput=function(e){this.setState({strInputValue:e.currentTarget.value})},e.prototype.OnInputKeyDown=function(e){var t=this;if(13==e.keyCode){if(e.currentTarget.value.trim().length||this.m_friendList.BHasSelection()){e.preventDefault();var n=this.m_friendList.GetSelectedFriend();n&&this.SelectFriendSuggestion(n)}}else if(8==e.keyCode&&0==e.currentTarget.selectionEnd&&this.state.rgFriendsChosen.length){e.preventDefault();var o=void 0;this.setState(function(e){return o=e.rgFriendsChosen[e.rgFriendsChosen.length-1],{rgFriendsChosen:e.rgFriendsChosen.slice(0,e.rgFriendsChosen.length-1)}},function(){t.props.onFriendRemoved&&t.props.onFriendRemoved(o)})}else this.m_friendList.BHandleInputKeyPress(e)&&e.preventDefault()},e.prototype.SelectFriendSuggestion=function(t){var e=this;this.setState({strInputValue:""}),this.m_friendList.ClearSelection(),this.setState(function(e){return-1==e.rgFriendsChosen.indexOf(t)?{rgFriendsChosen:e.rgFriendsChosen.concat([t])}:null},function(){e.props.onFriendSelected&&e.props.onFriendSelected(t)})},e.prototype.RemoveFriendFromList=function(t){var e=this;this.setState(function(e){return{rgFriendsChosen:M.a(e.rgFriendsChosen,t)}},function(){e.props.onFriendRemoved&&e.props.onFriendRemoved(t)})},e.prototype.OnFriendsListRef=function(e){this.m_friendList=e},e.prototype.componentWillReceiveProps=function(e){e.rgSelectedFriends!==this.props.rgSelectedFriends&&void 0!==e.rgSelectedFriends&&(void 0!==this.props.rgSelectedFriends&&M.g(e.rgSelectedFriends,this.props.rgSelectedFriends)||this.setState({rgFriendsChosen:e.rgSelectedFriends.map(function(e){return ci.FriendStore.GetFriend(e)})}))},e.prototype.componentWillUpdate=function(e,t){this.BuildChosenFriendList(t)},e.prototype.componentWillMount=function(){if(this.props.rgSelectedFriends){var e=this.props.rgSelectedFriends.map(function(e){return ci.FriendStore.GetFriend(e)});e=e.filter(function(e){return null!=e}),this.setState({rgFriendsChosen:e}),this.BuildChosenFriendList(R.a({},this.state,{rgFriendsChosen:e}))}},e.prototype.BuildChosenFriendList=function(e){var t=this,n=!1;if(e.rgFriendsChosen.length!=this.m_rctChosenFriends.length)n=!0;else for(var o=0;o<e.rgFriendsChosen.length;o++)if(e.rgFriendsChosen[o].accountid!=this.m_rctChosenFriends[o].key){n=!0;break}if(n){var i=this.props.chosenFriendComponent||Mr;this.m_rctChosenFriends=e.rgFriendsChosen.map(function(e){return Ee.createElement(i,{friend:e,key:e.accountid,onClick:t.RemoveFriendFromList})})}},e.prototype.render=function(){var e=0<this.state.rgFriendsChosen.length,t=["FriendPicker"];return e&&t.push("FriendPicker_FriendsChosen"),Ee.createElement("div",{className:t.join(" ")},Ee.createElement(zi,{onChange:this.OnTextInput,onKeyDown:this.OnInputKeyDown,label:this.props.label,value:this.state.strInputValue,placeholder:e?"":Object($.b)("#FriendPicker_StartTyping"),autoFocus:this.props.autoFocus},this.m_rctChosenFriends),1==this.props.bDropInvite&&Ee.createElement("div",{className:"DialogLabel"},Object($.b)("#Chat_InviteFriends_DropInvite")),Ee.createElement(wr,{ref:this.OnFriendsListRef,eSort:this.props.eSort,strInputValue:this.state.strInputValue,setExcludedFriends:this.props.setExcludedFriends,rgFriendsChosen:this.state.rgFriendsChosen,fnSelectFriendSuggestion:this.SelectFriendSuggestion}))},R.c([T.a],e.prototype,"OnTextInput",null),R.c([T.a],e.prototype,"OnInputKeyDown",null),R.c([T.a],e.prototype,"SelectFriendSuggestion",null),R.c([T.a],e.prototype,"RemoveFriendFromList",null),R.c([T.a],e.prototype,"OnFriendsListRef",null),e}(Ee.Component),wr=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.m_iSelectedFriendIndex=-1,e.m_rgFriendSuggestions=[],e}return R.d(e,t),e.prototype.BuildFriendsList=function(t){this.m_rgFriendsList=ci.FriendStore.all_friends,t.setExcludedFriends&&t.setExcludedFriends.size&&(this.m_rgFriendsList=this.m_rgFriendsList.filter(function(e){return!t.setExcludedFriends.has(e.accountid)}));var o=ci.ChatStore.FriendChatStore;switch(this.props.eSort){case 0:this.m_rgFriendsList.sort(function(e,t){var n=o.GetFriendLastChatTime(t.accountid)-o.GetFriendLastChatTime(e.accountid);return 0!==n?n:ft.DefaultFriendSortComparator(e,t)});break;default:case 1:this.m_rgFriendsList.sort(function(e,t){return e.display_name.localeCompare(t.display_name)})}this.BuildFriendSuggestionList(t)},e.prototype.componentWillMount=function(){this.BuildFriendsList(this.props)},e.prototype.componentWillReceiveProps=function(e){e.setExcludedFriends!=this.props.setExcludedFriends&&this.BuildFriendsList(e)},e.prototype.ClearSelection=function(){this.m_iSelectedFriendIndex=-1},e.prototype.BHasSelection=function(){return-1!==this.m_iSelectedFriendIndex},e.prototype.GetSelectedFriend=function(){return-1!==this.m_iSelectedFriendIndex?this.m_rgFriendSuggestions[this.m_iSelectedFriendIndex]:this.m_rgFriendSuggestions.length?this.m_rgFriendSuggestions[0]:null},e.prototype.BHandleInputKeyPress=function(e){return(38==e.keyCode||40==e.keyCode||34==e.keyCode||33==e.keyCode)&&(this.m_rgFriendSuggestions.length&&(38==e.keyCode?this.m_iSelectedFriendIndex--:33==e.keyCode?this.m_iSelectedFriendIndex=Math.max(0,this.m_iSelectedFriendIndex-5):34==e.keyCode?this.m_iSelectedFriendIndex=Math.min(this.m_rgFriendSuggestions.length-1,this.m_iSelectedFriendIndex+5):40==e.keyCode&&this.m_iSelectedFriendIndex++,this.m_iSelectedFriendIndex=(this.m_iSelectedFriendIndex+this.m_rgFriendSuggestions.length)%this.m_rgFriendSuggestions.length,this.forceUpdate()),!0)},e.prototype.OnFriendSuggestionClicked=function(e){this.props.fnSelectFriendSuggestion(this.m_rgFriendSuggestions[this.GetIndex(e)])},e.prototype.OnFriendSuggestionMouseEnter=function(e){this.m_iSelectedFriendIndex=this.GetIndex(e),this.forceUpdate()},e.prototype.OnFriendSelected=function(e){this.props.fnSelectFriendSuggestion(e)},e.prototype.OnFocusFriendRef=function(e){e&&Object(Ci.o)(e,e.parentElement)},e.prototype.BuildFriendSuggestionList=function(e){var t,n=void 0;-1!==this.m_iSelectedFriendIndex&&(t=this.m_rgFriendSuggestions[this.m_iSelectedFriendIndex]);var o=e.strInputValue&&e.strInputValue.trim().toLocaleLowerCase();this.m_rgFriendSuggestions=[];for(var i=0;i<this.m_rgFriendsList.length&&this.m_rgFriendSuggestions.length<100;i++){var r=this.m_rgFriendsList[i];-1===e.rgFriendsChosen.indexOf(r)&&(o&&!r.BMatchesSearchString(o,!1)||(r===t&&(n=this.m_rgFriendSuggestions.length),this.m_rgFriendSuggestions.push(r)))}-1===this.m_iSelectedFriendIndex&&o.length?this.m_iSelectedFriendIndex=0:void 0!==n?this.m_iSelectedFriendIndex=n:this.m_iSelectedFriendIndex>=this.m_rgFriendSuggestions.length&&(this.m_iSelectedFriendIndex=this.m_rgFriendSuggestions.length-1)},e.prototype.GetIndex=function(e){return Math.max(0,Math.min(this.m_rgFriendSuggestions.length,parseInt(e.currentTarget.getAttribute("data-index"))))},e.prototype.componentWillUpdate=function(e,t){this.BuildFriendSuggestionList(e)},e.prototype.render=function(){var e,i=this,t=this.m_rgFriendSuggestions.map(function(e,t){var n="FriendPicker_SuggestedFriend",o=t===i.m_iSelectedFriendIndex;return o&&(n+=" Focus"),Ee.createElement("div",{className:n,onClick:i.OnFriendSuggestionClicked,onMouseEnter:i.OnFriendSuggestionMouseEnter,key:e.accountid,ref:o?i.OnFocusFriendRef:null,"data-index":t},Ee.createElement(zc,{noActions:!0,friend:e,context:null}))});if(""!=this.props.strInputValue||1==this.props.eSort||0==this.props.eSort)e=Ee.createElement(Ee.Fragment,null,t);else{for(var n=new Set(this.props.setExcludedFriends),o=0,r=this.props.rgFriendsChosen;o<r.length;o++){var a=r[o];a&&!n.has(a.accountid)&&n.add(a.accountid)}var s={bSingleClickActivate:!0,disableContextMenu:!0},c=0,l=ci.FriendStore.FavoritesStore.favorites.map(function(e){return e.friend&&!n.has(e.friend.accountid)?(c++,Ee.createElement(zc,R.a({friend:e.friend,key:e.friend.accountid,className:"",context:{},action:i.OnFriendSelected},s,{bFriendsListEntry:!0}))):null}),p=Ee.createElement(Vc,{group:ci.FriendStore.FriendGroupStore.ingame_group,key:ci.FriendStore.FriendGroupStore.ingame_group.id,collapsed:!1,searchString:this.props.strInputValue,fnOnSearchSelection:function(){},friendSelectAction:this.OnFriendSelected,setExcludedFriends:n,friendProps:s}),u=ci.FriendStore.FriendGroupStore.default_groups.map(function(e){return Ee.createElement(Vc,{group:e,key:e.id,collapsed:!1,searchString:i.props.strInputValue,fnOnSearchSelection:function(){},friendSelectAction:i.OnFriendSelected,setExcludedFriends:n,friendProps:s})});e=Ee.createElement(Ee.Fragment,null,0<c&&Ee.createElement("div",{className:"friendGroup"},Ee.createElement("div",{className:"groupName"},Object($.b)("#FriendGroup_Favorites")),l),p,u)}return Ee.createElement("div",{className:"FriendPicker_Suggestions CompactFriendsList"},Ee.createElement("div",{className:"insetShadow verticalInsetShadow"}),Ee.createElement("div",{className:"FriendPicker_Suggestions_List"},e))},R.c([T.a],e.prototype,"OnFriendSuggestionClicked",null),R.c([T.a],e.prototype,"OnFriendSuggestionMouseEnter",null),R.c([T.a],e.prototype,"OnFriendSelected",null),R.c([T.a],e.prototype,"OnFocusFriendRef",null),e}(Ee.Component);function Mr(e){return Ee.createElement(Wc,{friend:e.friend,context:null},Ee.createElement("div",{className:"FriendPicker_ChosenFriend",onClick:function(){e.onClick(e.friend)}},Ee.createElement("span",null,e.friend.display_name),Ee.createElement(ui.jb,null)))}function Dr(e,t,n){var o=n?[n.accountid]:[];fr(Ee.createElement(Tr,{browserContext:e,rgPreSelectedFriends:o}),t,"CreateFriendCategoryDialog",{strTitle:Object($.b)("#FriendGroup_Menu_CreateGroup"),popupWidth:664,popupHeight:700},pd(t))}var Tr=function(n){function e(e){var t=n.call(this,e)||this;return t.state={strNameEntry:e.group?e.group.name:"",strError:null},t}return R.d(e,n),e.prototype.HandleTextEntry=function(e){this.setState({strNameEntry:e.target.value,strError:null})},e.prototype.HandleSubmit=function(e){var t=this,n=this.m_friendPicker.state.rgFriendsChosen,o=this.state.strNameEntry;if(this.props.group){for(var i=new Set(this.props.group.GetCurrentMemberSet()),r=[],a=[],s=0,c=n;s<c.length;s++){var l=c[s];i.has(l.accountid)?i.delete(l.accountid):r.push(l.persona.m_steamid.ConvertTo64BitString())}i.forEach(function(e){a.push(D.a.InitFromAccountID(e).ConvertTo64BitString())}),ci.FriendStore.FriendGroupStore.ManageGroup(this.props.group,o,r,a).then(function(e){e?t.props.closeModal&&t.props.closeModal():t.setState({strError:Object($.b)("#FriendGroup_ManageGroup_ErrorFailed")})})}else{if(!o)return void this.setState({strError:Object($.b)("#FriendGroup_CreateGroup_ErrorNeedName")});var p=n.map(function(e){return e.persona.m_steamid.ConvertTo64BitString()});ci.FriendStore.FriendGroupStore.CreateGroup(o,p).then(function(e){e?t.props.closeModal&&t.props.closeModal():t.setState({strError:Object($.b)("#FriendGroup_CreateGroup_ErrorFailed")})})}},e.prototype.OnFriendPickerRef=function(e){this.m_friendPicker=e},e.prototype.render=function(){return Ee.createElement(sr,{onEscKeypress:this.props.closeModal},Ee.createElement(Fi,{classNameContent:"ManageGroupDialog",onSubmit:this.HandleSubmit},Ee.createElement(wi,null,this.props.group?Object($.b)("#FriendGroup_Menu_Manage"):Object($.b)("#FriendGroup_Menu_CreateGroup")),Ee.createElement(Gi,null,this.state.strError&&Ee.createElement(Ti,{className:"nicknameError"},this.state.strError),Ee.createElement(Wi,{type:"text",label:Object($.b)("#FriendGroup_CategoryName"),className:"nicknameInput",value:this.state.strNameEntry,onChange:this.HandleTextEntry,autoFocus:!0}),Ee.createElement(Or,{ref:this.OnFriendPickerRef,label:Object($.b)("#FriendGroup_CategoryMembers"),eSort:1,rgSelectedFriends:this.props.rgPreSelectedFriends})),Ee.createElement(Mi,null,Ee.createElement(Hi,{onCancel:this.props.closeModal}))))},R.c([T.a],e.prototype,"HandleTextEntry",null),R.c([T.a],e.prototype,"HandleSubmit",null),R.c([T.a],e.prototype,"OnFriendPickerRef",null),e}(Ee.Component),Gr=function(n){function e(e){var t=n.call(this,e)||this;return t.m_mapCategoryChecks=d.observable.map(),t.state={strError:null},t}return R.d(e,n),e.prototype.componentWillReceiveProps=function(e){e.friend!=this.props.friend&&this.m_mapCategoryChecks.clear()},e.prototype.HandleSubmit=function(e){var a=this,o=[];ci.FriendStore.FriendGroupStore.user_groups.forEach(function(e){if(a.m_mapCategoryChecks.has(e.unique_id)){var t=void 0,n=void 0;a.m_mapCategoryChecks.get(e.unique_id)?n=e:t=e,o.push(ci.FriendStore.FriendGroupStore.TransferFriendFromToGroup(a.props.friend,t,n))}}),Promise.all(o).then(function(e){for(var t=!1,n=0,o=e;n<o.length;n++)for(var i=0,r=o[n];i<r.length;i++){r[i]||(t=!0)}t?a.setState({strError:Object($.b)("#FriendGroup_ManageGroup_ErrorFailed")}):a.props.closeModal()})},e.prototype.CreateNew=function(e){Dr(cd(this,e),Object(Ci.m)(e),this.props.friend)},e.prototype.render=function(){return Ee.createElement(sr,{onEscKeypress:this.props.closeModal},Ee.createElement(Fi,{classNameContent:"AssignCategoriesDialog",onSubmit:this.HandleSubmit},Ee.createElement(wi,null,Object($.b)("#FriendGroup_Categorize_Title")),Ee.createElement(Gi,null,this.state.strError&&Ee.createElement(Ti,{className:"nicknameError"},this.state.strError),Ee.createElement(Li,null,Ee.createElement(Pi,null,Ee.createElement(zc,{friend:this.props.friend,className:"AssignCategoriesDialog_Friend",noActions:!0,context:null}))),Ee.createElement(Rr,{friend:this.props.friend,mapChecks:this.m_mapCategoryChecks}),Ee.createElement(Li,{className:"AssignCategoriesDialog_AddNewButton"},Ee.createElement(xi,{onClick:this.CreateNew},Object($.b)("#FriendGroup_Categorize_AddNew")))),Ee.createElement(Mi,null,Ee.createElement(Hi,{onCancel:this.props.closeModal}))))},R.c([T.a],e.prototype,"HandleSubmit",null),R.c([T.a],e.prototype,"CreateNew",null),e}(Ee.Component),Rr=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return R.d(t,e),t.prototype.render=function(){var t=this,e=ci.FriendStore.FriendGroupStore.user_groups.map(function(e){return Ee.createElement(Nr,{friend:t.props.friend,group:e,key:e.unique_id,mapChecks:t.props.mapChecks})});return Ee.createElement(Ee.Fragment,null,Ee.createElement(Di,null,Object($.b)("#FriendGroup_Categorize_Categories")),Ee.createElement("div",{className:"FriendCategoryCheckboxes_List"},e))},t=R.c([or.observer],t)}(Ee.Component),Nr=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return R.d(t,e),t.prototype.OnToggle=function(e){e!=this.props.group.HasMember(this.props.friend.accountid)?this.props.mapChecks.set(this.props.group.unique_id,e):this.props.mapChecks.delete(this.props.group.unique_id)},t.prototype.OnContextMenu=function(e){aa(cd(this,e),this.props.group,e)},t.prototype.render=function(){var e,t=this.props.group,n=this.props.friend;return e=this.props.mapChecks.has(t.unique_id)?this.props.mapChecks.get(t.unique_id):t.HasMember(n.accountid),Ee.createElement("div",{onContextMenu:this.OnContextMenu},Ee.createElement(Ki,{label:t.name,checked:e,onChange:this.OnToggle}))},R.c([T.a],t.prototype,"OnToggle",null),R.c([T.a],t.prototype,"OnContextMenu",null),t=R.c([or.observer],t)}(Ee.Component),Lr={TimeOfDay:new Intl.DateTimeFormat($.a.GetPreferredLocales(),{hour:"numeric",minute:"numeric"}),TimeOfDayWithSecs:new Intl.DateTimeFormat($.a.GetPreferredLocales(),{hour:"numeric",minute:"numeric",second:"numeric"}),TimeInWeek:Intl.DateTimeFormat($.a.GetPreferredLocales(),{weekday:"long",hour:"numeric",minute:"numeric"}),FullTimestamp:Intl.DateTimeFormat($.a.GetPreferredLocales(),{weekday:"long",year:"numeric",month:"numeric",day:"numeric",hour:"numeric",minute:"numeric"}),FullTimestampNoWeekday:Intl.DateTimeFormat($.a.GetPreferredLocales(),{year:"numeric",month:"numeric",day:"numeric",hour:"numeric",minute:"numeric"})},kr={TimeOfDay:new Intl.DateTimeFormat($.a.GetPreferredLocales(),{hour:"numeric",minute:"numeric",hour12:!1}),TimeOfDayWithSecs:new Intl.DateTimeFormat($.a.GetPreferredLocales(),{hour:"numeric",minute:"numeric",second:"numeric",hour12:!1}),TimeInWeek:Intl.DateTimeFormat($.a.GetPreferredLocales(),{weekday:"long",hour:"numeric",minute:"numeric",hour12:!1}),FullTimestamp:Intl.DateTimeFormat($.a.GetPreferredLocales(),{weekday:"long",year:"numeric",month:"numeric",day:"numeric",hour:"numeric",minute:"numeric",hour12:!1}),FullTimestampNoWeekday:Intl.DateTimeFormat($.a.GetPreferredLocales(),{year:"numeric",month:"numeric",day:"numeric",hour:"numeric",minute:"numeric",hour12:!1})};function Pr(e,t){null==t.bIncludeWeekday&&(t.bIncludeWeekday=!0),null==t.bRelativeDate&&(t.bRelativeDate=!0);var n,o=ci.RTime32ToDate(e),i=ci.GetLocalMidnightInRTime32(),r=ci.SettingsStore.FriendsSettings.b24HourClock?kr:Lr,a=t.Format;null==a&&(a=t.bTimeOnly||i-86400<=e?t.bIncludeSeconds?r.TimeOfDayWithSecs:r.TimeOfDay:t.bRelativeDate&&i-432e3<=e?r.TimeInWeek:t.bIncludeWeekday?r.FullTimestamp:r.FullTimestampNoWeekday);try{n=a.format(o)}catch(e){n=Object($.b)("#ChatRoom_Timestamp_InvalidDate")}return!t.bTimeOnly&&t.bRelativeDate&&i-86400<=e&&e<i&&(n=Object($.b)("#ChatRoom_Timestamp_Yesterday",n)),n}function Ar(e){var t="undefined"!=typeof SteamClient&&void 0!==SteamClient.SharedConnection,n=e.bDisableContextMenu,o=e.href,i=R.f(e,["bDisableContextMenu","href"]);return t&&!o.startsWith("steam://")&&(o="steam://openurl/"+o),Ee.createElement("a",R.a({},i,{href:o,target:"_blank",rel:"noopener noreferrer",onContextMenu:n?null:Fr}),e.children)}function Br(t){return Ee.createElement(Ee.Fragment,null,Ee.createElement(ir.d,{onSelected:function(){Ci.j(t.strURL)}},Object($.b)("#ContextMenu_CopyLinkURL")),Ee.createElement(ir.d,{onSelected:function(e){Ur(e,t.strURL)}},Object($.b)("#ContextMenu_OpenLinkInNewWindow")))}function Fr(e){var t=e.currentTarget;return Object(mi.a)(Ee.createElement(ir.c,null,Ee.createElement(Br,{strURL:t.href})),e)}function Vr(e,t){return xr(e,e.currentTarget.src,t)}function xr(e,t,n){return Object(mi.a)(Ee.createElement(ir.c,null,n&&Ee.createElement(Br,{strURL:n}),Ee.createElement(ir.d,{onSelected:function(){Ci.j(t)}},Object($.b)("#ContextMenu_CopyImageURL")),Ee.createElement(ir.d,{onSelected:function(e){Ur(e,t)}},Object($.b)("#ContextMenu_OpenImageInNewWindow"))),e)}function Ur(e,t){var n;if(n="currentTarget"in e?e.currentTarget.ownerDocument.defaultView:e,"undefined"!=typeof SteamClient&&void 0!==SteamClient.SharedConnection){var o=ld(n);SteamClient.WebChat.OpenURLInClient(t,o.m_unPID)}else 0==t.indexOf("steam://")?n.location.href=t:n.open(t,null,"menubar,location,resizable,scrollbars,status,noopener")}var jr=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return R.d(t,e),t.prototype.render=function(){return Ee.createElement(Ee.Fragment,null,Pr(this.props.rtime,{bTimeOnly:this.props.bTimeOnly,bIncludeSeconds:this.props.bIncludeSeconds}))},t=R.c([or.observer],t)}(Ee.Component);var Hr=function(o){function e(e){var t=o.call(this,e)||this,n=ci.FriendStore.self;return t.state={strCurrentNameEntry:n.primary_display_name,strError:""},t}return R.d(e,o),e.prototype.HandleTextEntry=function(e){this.setState({strCurrentNameEntry:e.currentTarget.value,strError:""})},e.prototype.HandleSubmit=function(e){this.SetPersonaName(this.state.strCurrentNameEntry)},e.prototype.DisplayError=function(e){this.setState({strError:e})},e.prototype.SetPersonaName=function(e){var o=this;if(this.setState({strError:""}),G.a.IN_CLIENT&&null!=SteamClient.WebChat.SetPersonaName)SteamClient.WebChat.SetPersonaName(this.state.strCurrentNameEntry).then(function(e){e?o.DisplayError(Object($.b)(e)):o.props.closeModal&&o.props.closeModal()});else{var t=new FormData;t.append("sessionid",G.a.SESSIONID),t.append("persona",e);var n=ci.FriendStore.self,i=G.a.CHAT_BASE_URL+"profiles/"+n.steamid64+"/ajaxsetpersonaname/";C.a.post(i,t).then(function(e){var t=e.data;if(t.success)o.props.closeModal&&o.props.closeModal();else{var n=t.message.replace("<br />","");o.DisplayError(n)}}).catch(function(e){o.DisplayError(Object($.b)("#Friends_NameChangeFailed_Info"))})}},e.prototype.render=function(){var e=ci.FriendStore.self,t="friend changePersonaName";e.persona.is_ingame?t+=" ingame":e.persona.is_online&&(t+=" online");var n=!1;return this.state.strError&&(n=!0),Ee.createElement(sr,{className:"Dialog_ChangePersonaName",onEscKeypress:this.props.closeModal},Ee.createElement(Fi,{classNameContent:"ChangePersonaNameDialog",onSubmit:this.HandleSubmit},Ee.createElement(wi,null,Object($.b)("#ChangePersona_Title")),Ee.createElement(Gi,null,Ee.createElement(Ti,null,Object($.b)("#ChangePersona_Description")),Ee.createElement(Ti,null,Ee.createElement("div",{className:t},Ee.createElement("img",{className:"avatarMedium",src:e.persona.avatar_url_full}),Ee.createElement("div",{className:"labelHolder"},n&&Ee.createElement("div",{className:"error"},this.state.strError),Ee.createElement("div",null,Ee.createElement("div",null,Object($.b)("#ChangePersona_Change")),Ee.createElement("div",{className:"mediumName"},Ee.createElement(Wi,{placeholder:Object($.b)("#ChangePersona_PlaceHolder"),className:"changePersonaInput",value:this.state.strCurrentNameEntry,onChange:this.HandleTextEntry,autoFocus:!0}))))))),Ee.createElement(Mi,null,Ee.createElement(Hi,{onCancel:this.props.closeModal}))))},R.c([T.a],e.prototype,"HandleTextEntry",null),R.c([T.a],e.prototype,"HandleSubmit",null),e=R.c([or.observer],e)}(Ee.Component),Wr=n("ugMY"),zr=n.n(Wr),qr=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return R.d(t,e),t.prototype.render=function(){var e=this.props,t=e.persona,n=e.size,o=e.className,i=e.statusStyle,r=e.statusPosition,a=e.children,s=R.f(e,["persona","size","className","statusStyle","statusPosition","children"]),c=t.avatar_url_medium;return"Small"==n?c=t.avatar_url:"Large"!=n&&"X-Large"!=n||(c=t.avatar_url_full),Ee.createElement("div",R.a({className:hr(zr.a.avatarHolder,"avatarHolder","no-drag",n||"Medium",o)},s),Ee.createElement("div",{className:hr(zr.a.avatarStatus,"avatarStatus",r),style:i}),Ee.createElement("img",{className:hr(zr.a.avatar,"avatar"),src:c,draggable:!1}),a)},t=R.c([or.observer],t)}(Ee.Component),Kr=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return R.d(t,e),t.prototype.render=function(){var e=this.props,t=e.persona,n=e.size,o=e.className,i=(e.statusStyle,e.statusPosition),r=e.children,a=R.f(e,["persona","size","className","statusStyle","statusPosition","children"]);return Ee.createElement("div",R.a({className:hr(zr.a.friendavatar,"friend","FriendAvatar",ne(t),o)},a),r,Ee.createElement(qr,{persona:t,size:n,statusPosition:i}))},t=R.c([or.observer],t)}(Ee.Component);var Yr=function(n){function e(e){var t=n.call(this,e)||this;return t.state=t.ComputeStateFromNotificationSettings(t.props.player.notification_settings),t}return R.d(e,n),e.prototype.ConvertENotificationSettingToBoolean=function(e){return 1==e},e.prototype.ComputeStateFromNotificationSettings=function(e){var t,n=!1,o=!1;for(var i in e){if(0!=e[i]){o=!0;break}}return o?((t=sn.DefaultFriendsSettings()).bNotifications_ShowIngame=this.ConvertENotificationSettingToBoolean(e.Notifications_ShowInGame),t.bNotifications_ShowMessage=this.ConvertENotificationSettingToBoolean(e.Notifications_ShowMessage),t.bNotifications_ShowOnline=this.ConvertENotificationSettingToBoolean(e.Notifications_ShowOnline),t.bSounds_PlayIngame=this.ConvertENotificationSettingToBoolean(e.Sounds_PlayInGame),t.bSounds_PlayMessage=this.ConvertENotificationSettingToBoolean(e.Sounds_PlayMessage),t.bSounds_PlayOnline=this.ConvertENotificationSettingToBoolean(e.Sounds_PlayOnline)):(n=!0,t=ci.SettingsStore.FriendsSettings),{settings:t,bUseDefaults:n}},e.prototype.ConvertBooleanToENotificationSetting=function(e){return e?1:2},e.prototype.FriendSettingsToNotificationSettings=function(e){var t=new _t;return t.Notifications_SendMobile=this.props.player.notification_settings.Notifications_SendMobile,this.state.bUseDefaults||(t.Notifications_ShowInGame=this.ConvertBooleanToENotificationSetting(this.state.settings.bNotifications_ShowIngame),t.Notifications_ShowMessage=this.ConvertBooleanToENotificationSetting(this.state.settings.bNotifications_ShowMessage),t.Notifications_ShowOnline=this.ConvertBooleanToENotificationSetting(this.state.settings.bNotifications_ShowOnline),t.Sounds_PlayInGame=this.ConvertBooleanToENotificationSetting(this.state.settings.bSounds_PlayIngame),t.Sounds_PlayMessage=this.ConvertBooleanToENotificationSetting(this.state.settings.bSounds_PlayMessage),t.Sounds_PlayOnline=this.ConvertBooleanToENotificationSetting(this.state.settings.bSounds_PlayOnline)),t},e.prototype.HandleSubmit=function(e){var t=this;ci.FriendStore.SetPlayerNotificationSettings(this.props.player,this.FriendSettingsToNotificationSettings(this.state.settings)).then(function(e){1==e&&t.props.closeModal&&t.props.closeModal()})},e.prototype.componentWillReceiveProps=function(e){e.player!=this.props.player&&this.setState(this.ComputeStateFromNotificationSettings(e.player.notification_settings))},e.prototype.OnSettingToggled=function(e,t){var n;this.setState({settings:R.a({},this.state.settings,(n={},n[e]=t,n))})},e.prototype.FriendsSettingsCheckbox=function(t){var n=this;return Ee.createElement(Ki,{key:t.strName,disabled:this.state.bUseDefaults,onChange:function(e){n.OnSettingToggled(t.strName,e)},checked:!!this.state.settings[t.strName]})},e.prototype.NotificationRow=function(e){var t=this.FriendsSettingsCheckbox;return Ee.createElement("div",null,Ee.createElement("div",{className:"FriendsSettingsNotificationRow"},Ee.createElement("div",{className:"FriendsSettingsNotificationRow_Label"},e.strLabel),Ee.createElement("div",{className:"FriendsSettingsNotificationRow_Checkbox"},Ee.createElement(t,{strName:e.strNameShow})),Ee.createElement("div",{className:"FriendsSettingsNotificationRow_Checkbox"},Ee.createElement(t,{strName:e.strNameSound}))))},e.prototype.OnDefaultToggled=function(e){e?this.setState({settings:ci.SettingsStore.FriendsSettings,bUseDefaults:!0}):this.setState({bUseDefaults:!1})},e.prototype.render=function(){var t=this,e=this.NotificationRow,n=this.state.bUseDefaults,o="friend editFriendNotifications";return o+=ne(this.props.player.persona),Ee.createElement(sr,{className:"Dialog_FriendNotifications",onEscKeypress:this.props.closeModal},Ee.createElement(Fi,{classNameContent:"FriendNotificationsDialog",onSubmit:this.HandleSubmit},Ee.createElement(wi,null,Object($.b)("#Friend_Menu_NotificationsTitle")),Ee.createElement(Gi,{className:n?"useDefaults":""},Ee.createElement(Ti,null,Object($.b)("#FriendNotifications_Instructions",this.props.player.display_name)),Ee.createElement(Ti,null,Ee.createElement("div",{className:o},Ee.createElement(qr,{persona:this.props.player.persona,size:"Large"}),Ee.createElement("div",{className:"labelHolder"},this.props.player.primary_display_name,!this.props.player.is_display_name_nickname&&this.props.player.has_secondary_display_name&&Ee.createElement("span",{className:"playerNickname"}," (",this.props.player.secondary_display_name,")"),this.props.player.is_display_name_nickname&&Ee.createElement("span",{className:"playerNicknameBracket",title:Object($.b)("#isNickname")},"*")))),Ee.createElement(Ki,{classname:"useDefaultsCheckBox",label:Object($.b)("#FriendNotifications_UseDefaults"),onChange:function(e){t.OnDefaultToggled(e)},checked:this.state.bUseDefaults}),Ee.createElement("div",{className:"SettingsGroup"},Ee.createElement("div",{className:"FriendsSettingsNotificationRow FriendsSettingsNotificationRow_Header"},Ee.createElement("div",{className:"FriendsSettingsNotificationRow_Label"},Object($.b)("#FriendSettings_Notification_Table_Label")),Ee.createElement("div",{className:"FriendsSettingsNotificationRow_Checkbox"},Object($.b)("#FriendSettings_Notification_Table_Show")),Ee.createElement("div",{className:"FriendsSettingsNotificationRow_Checkbox"},Object($.b)("#FriendSettings_Notification_Table_Play"))),Ee.createElement(e,{strLabel:Object($.b)("#FriendSettings_FriendNotification_FriendJoins"),strNameShow:"bNotifications_ShowIngame",strNameSound:"bSounds_PlayIngame"}),Ee.createElement(e,{strLabel:Object($.b)("#FriendSettings_FriendNotification_FriendOnline"),strNameShow:"bNotifications_ShowOnline",strNameSound:"bSounds_PlayOnline"}),Ee.createElement(e,{strLabel:Object($.b)("#FriendSettings_Notification_ChatMessage"),strNameShow:"bNotifications_ShowMessage",strNameSound:"bSounds_PlayMessage"}))),Ee.createElement(Mi,null,Ee.createElement(Hi,{onCancel:this.props.closeModal}))))},R.c([T.a],e.prototype,"HandleSubmit",null),R.c([T.a],e.prototype,"OnSettingToggled",null),R.c([T.a],e.prototype,"FriendsSettingsCheckbox",null),R.c([T.a],e.prototype,"NotificationRow",null),R.c([T.a],e.prototype,"OnDefaultToggled",null),e=R.c([or.observer],e)}(Ee.Component);function Jr(e,t,n,o){return Object(mi.a)(Ee.createElement(Zr,{browserContext:e,context:t,friend:n,ownerWindow:o.currentTarget.ownerDocument.defaultView}),o)}var Xr=Object(or.observer)(function(e){var t=e.friend,n=[],o=t.persona_name_history,i=t.persona_name_history_loaded;if(i&&0<o.length)for(var r=0,a=0,s=o;a<s.length;a++){var c=s[a];n.push(Ee.createElement("div",{className:"recentName",key:"name_history_"+r},c)),r++}else i?n.push(Ee.createElement("div",{className:"recentName",key:"name_history_none"},Object($.b)("#Friend_Menu_RecentAliases_None"))):n.push(Ee.createElement("div",{className:"recentName",key:"name_history_loading"},Object($.b)("#Friend_Menu_RecentAliases_Loading")));return Ee.createElement(Ee.Fragment,null,Ee.createElement(ir.e,{label:Object($.b)("#Friend_Menu_RecentAliases")},n))}),Qr=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return R.d(t,e),t.prototype.OnToggle=function(e){this.props.group.ToggleMemberRoleState(this.props.friend.accountid,e)},t.prototype.render=function(){var i=this,r=this.props.group.DefaultRoleID(),a=this.props.group.GetMemberRoleIDs(this.props.friend.accountid),e=this.props.group.BIsAccountIDOwner(this.props.friend.accountid),s=this.props.group.BCanEditRoles(),t=this.props.group.GetRoles().slice().sort(function(e,t){return e.role_id==r?1:t.role_id==r?-1:parseInt(e.role_id)-parseInt(t.role_id)}).map(function(t){var e=-1!=a.findIndex(function(e){return e==t.role_id});if(!e&&!s)return null;var n=t.name,o=i.props.group.BCanIAssignRole(t.role_id);return t.role_id==r?n=Object($.b)("#ChatRoomRole_Member"):n.startsWith("#ChatRoomRole_")&&(n=Object($.b)(n)),Ee.createElement(ea,{key:t.role_id,friend:i.props.friend,group:i.props.group,roleName:n,roleID:t.role_id,bHasRole:e,bEditable:o})}),n=s&&!e?Object($.b)("#Friend_Menu_EditRoles"):Object($.b)("#Friend_Menu_ViewRoles");return Ee.createElement(Ee.Fragment,null,Ee.createElement(ir.e,{label:n},e?Ee.createElement(ir.d,{className:"FriendMenuRoleCheckbox disabled",key:"role",onSelected:function(){},bInteractableItem:!0},Ee.createElement(ui.j,null),"Owner"):t))},R.c([T.a],t.prototype,"OnToggle",null),t=R.c([or.observer],t)}(Ee.Component),Zr=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return R.d(t,e),t.prototype.ShowFriendProfile=function(e){Ur(e,this.props.friend.GetCommunityProfileURL()),e.stopPropagation()},t.prototype.InviteFriend=function(){var t=this;ci.FriendStore.SendFriendInvite(this.props.friend).then(function(e){yr(t.props.ownerWindow,Object($.b)("#Friend_Menu_AddToFriendsList"),4==e?Object($.b)("#Friend_InviteSent"):3==e?Object($.b)("#Friend_MutualInviteSent",t.props.friend.display_name):Object($.b)("#Friend_InviteError",t.props.friend.display_name))})},t.prototype.AcceptIncomingInvite=function(){var t=this;ci.FriendStore.SendFriendInvite(this.props.friend).then(function(e){yr(t.props.ownerWindow,Object($.b)("#Friend_Menu_AddToFriendsList"),3==e?Object($.b)("#Friend_MutualInviteSent",t.props.friend.display_name):Object($.b)("#Friend_InviteError",t.props.friend.display_name))})},t.prototype.IgnoreIncomingInvite=function(){var t=this;ci.FriendStore.RemoveFriend(this.props.friend).then(function(e){yr(t.props.ownerWindow,Object($.b)("#Friend_Menu_IgnoreIncomingInvite"),1==e?Object($.b)("#Friend_IgnoreIncomingInvite_Success",t.props.friend.display_name):Object($.b)("#Friend_IgnoreIncomingInvite_Error",t.props.friend.display_name))})},t.prototype.RemoveFriend=function(){var t=this,e=4==this.props.friend.efriendrelationship,n=Object($.b)(e?"#Friend_Menu_CancelInvitation":"#Friend_Menu_RemoveFromFriendsList"),o=Object($.b)(e?"#Friend_CancelInvitation_Confirm":"#Friend_RemoveFromFriendsList_Confirm",this.props.friend.display_name),i=Object($.b)(e?"#Button_Confirm":"#Friend_Menu_RemoveFromFriendsList"),r=Object($.b)(e?"#Friend_CancelInvitation_Error":"#Friend_RemoveFromFriendsList_Error");vr(this.props.ownerWindow,n,o,i,Object($.b)("#Button_Cancel"),!0).then(function(){ci.FriendStore.RemoveFriend(t.props.friend).then(function(e){3!=e&&6!=e||yr(t.props.ownerWindow,n,r)})}).catch(function(){})},t.prototype.BlockFriend=function(){var e=this;vr(this.props.ownerWindow,Object($.b)("#Friend_Menu_BlockAllCommunication"),Object($.b)("#Friend_Block_Confirm",this.props.friend.display_name),Object($.b)("#Friend_Menu_BlockAllCommunication")).then(function(){ci.FriendStore.BlockPlayer(e.props.friend)}).catch(function(){})},t.prototype.UnblockFriend=function(){var e=this;vr(this.props.ownerWindow,Object($.b)("#Friend_Menu_UnblockAllCommunication"),Object($.b)("#Friend_Unblock_Confirm",this.props.friend.display_name),Object($.b)("#Friend_Menu_UnblockAllCommunication")).then(function(){ci.FriendStore.BlockPlayer(e.props.friend,!0)}).catch(function(){})},t.prototype.InviteToGame=function(e){ci.FriendStore.InviteToGame(this.props.friend,e)},t.prototype.InviteToLobby=function(e,t){ci.FriendStore.InviteToLobby(this.props.friend,e,t)},t.prototype.InviteToWatch=function(){ci.FriendStore.InviteToWatch(this.props.friend)},t.prototype.InviteToVoice=function(e,t){Jp({invitee:this.props.friend,invitedto:e},null,this.props.ownerWindow)},t.prototype.render=function(){var e,t=this,o=this.props,n=o.context||{},i=[],r=[],a=o.friend,s=ci.FriendStore.FavoritesStore,c=ci.FriendStore.self==a,l="favorites"==n.chatContext,p=n.group;!p&&n.chat instanceof kt&&(p=n.chat.GetGroup());var u=!1,m=a.is_friend,d=2==a.efriendrelationship,h=4==a.efriendrelationship,_=d||4==a.efriendrelationship,f=ci.FriendStore.self.persona.m_unGamePlayedAppID,g=a.persona.m_unGamePlayedAppID;n.chat&&(n.chat instanceof Jt?(e=n.chat).BVoiceActive()&&(u=!0):n.chat instanceof kt&&n.chat.BVoiceActive()&&(u=!0)),m||d||c||i.push(Ee.createElement("div",{className:"contextMenuLabel contextMenuNotAFriend",key:"header"},Object($.b)("#Friend_Menu_NotAFriendLabel"))),u&&!c&&i.push(Ee.createElement($r,{friend:this.props.friend})),n.tab&&i.push(Ee.createElement(ir.d,{key:"closetab",onSelected:function(){ci.UIStore.CloseTab(o.browserContext,n.tab)}},Object($.b)("#Chat_CloseTabAction"))),e||n.tab||d||h||c||a.is_blocked||i.push(Ee.createElement(ir.d,{key:"chat",className:m?"":"notFriends",onSelected:function(){o.friend.OpenChatDialog(o.browserContext)}},Object($.b)("#Friend_Menu_SendMessage")));var b=a.persona.is_online&&!e&&!d&&!h&&!c&&!a.is_blocked,v=ci.ChatStore.GetActiveVoiceChat();if(v&&v instanceof Jt&&v.accountid_partner==a.accountid?i.push(Ee.createElement(ir.d,{key:"voicechat",onSelected:function(){v.ToggleVoiceChat()}},Object($.b)("#Friend_Menu_StopVoiceChat"))):b&&(v instanceof kt?i.push(Ee.createElement(ir.d,{key:"voicechat",className:"contextVoiceInvite",onSelected:function(){t.InviteToVoice(v,n)}},Ee.createElement(ui.gb,null),Object($.b)("#Chat_Actions_InviteFriend_VoiceChat"))):i.push(Ee.createElement(ir.d,{key:"voicechat",onSelected:function(){ci.UIStore.ShowFriendChatDialogAndStartVoice(o.browserContext,a.accountid)}},Object($.b)("#Friend_Menu_StartVoiceChat")))),i.push(Ee.createElement(ir.d,{key:"viewprofile",onSelected:this.ShowFriendProfile},Object($.b)("#Friend_Menu_ViewProfile"))),p&&i.push(Ee.createElement(oa,{key:"moderationoptions",friend:a,bIsSelf:c,group:p,ownerWindow:o.ownerWindow})),!c){if(m){if(r.push(Ee.createElement(ir.d,{key:"setnickname",onSelected:function(){Ir(o.browserContext,o.friend,o.ownerWindow)}},Object($.b)(o.friend.has_nickname?"#Friend_Menu_ChangeNickname":"#Friend_Menu_AddNickname"))),s.BIsFavorited({friend:a}))(l?i:r).push(Ee.createElement(ir.d,{key:"quickaccess",onSelected:function(e){ci.FriendStore.FavoritesStore.RemoveFromFavorites({friend:e})}.bind(null,a)},Object($.b)("#Friend_Menu_RemoveFromQuickAccess")));else r.push(Ee.createElement(ir.d,{key:"quickaccess",onSelected:function(e){ci.FriendStore.FavoritesStore.AddToFavorites({friend:e})}.bind(null,a)},Object($.b)("#Friend_Menu_AddToQuickAccess")));if(r.push(Ee.createElement(ir.d,{key:"managecategories",onSelected:function(){var e,t,n;e=o.browserContext,t=o.ownerWindow,n=o.friend,0==ci.FriendStore.FriendGroupStore.user_groups.length?Dr(e,t,n):fr(Ee.createElement(Gr,{browserContext:e,friend:n}),t,"AssignFriendCategoryDialog",{strTitle:Object($.b)("#FriendGroup_Menu_CreateGroup"),popupWidth:664,popupHeight:580},pd(t))}},Object($.b)("#FriendGroup_Menu_Categorize"))),r.push(Ee.createElement(ir.d,{key:"notifications",onSelected:function(){return o.browserContext,e=o.friend,t=o.ownerWindow,void fr(Ee.createElement(Yr,{player:e}),t,"FriendNotificationsDialog",{strTitle:Object($.b)("#Friend_Menu_Notifications"),popupWidth:640,popupHeight:490},pd(t));var e,t}},Object($.b)("#Friend_Menu_Notifications"))),l||r.push(Ee.createElement(ir.d,{key:"removefriend",onSelected:this.RemoveFriend},Object($.b)("#Friend_Menu_RemoveFromFriendsList"))),r.push(Ee.createElement(Xr,{key:"aliases",friend:a})),ci.FriendStore.self.persona.is_ingame&&ci.BroadcastStore.is_broadcast_capable&&i.push(Ee.createElement(ir.d,{key:"invitetowatch",onSelected:function(){t.InviteToWatch()}},Object($.b)("#Friend_Menu_InviteToWatch"))),0!=f&&"0"!=ci.FriendStore.self.persona.m_game_lobby_id){var S=ci.AppInfoStore.GetAppInfo(f);i.push(Ee.createElement(ir.d,{key:"lobbyinvite",onSelected:function(){t.InviteToLobby(f,ci.FriendStore.self.persona.m_game_lobby_id)}},Object($.b)("#Friend_Menu_InviteToLobby"),Ee.createElement("div",{className:"contextMenuSectionHeader"},Ee.createElement("div",{className:"contextMenuGameIcon"},Ee.createElement("img",{className:"GameIcon",src:S.icon_url})),Ee.createElement("div",{className:"contextMenuGameName"},S.name))))}else if(0!=f&&f!=g){S=ci.AppInfoStore.GetAppInfo(f);i.push(Ee.createElement(ir.d,{key:"gameinvite",onSelected:function(){t.InviteToGame(f)}},Object($.b)("#Friend_Menu_InviteToGame"),Ee.createElement("div",{className:"contextMenuSectionHeader"},Ee.createElement("div",{className:"contextMenuGameIcon"},Ee.createElement("img",{className:"GameIcon",src:S.icon_url})),Ee.createElement("div",{className:"contextMenuGameName"},S.name))))}i.push(Ee.createElement(ta,{key:"trading",friend:a}))}else d?(i.push(Ee.createElement(ir.d,{key:"acceptincominginvite",onSelected:this.AcceptIncomingInvite},Object($.b)("#Friend_Menu_AcceptIncomingInvite"))),i.push(Ee.createElement(ir.d,{key:"ignoreincominginvite",onSelected:this.IgnoreIncomingInvite},Object($.b)("#Friend_Menu_IgnoreIncomingInvite"))),i.push(Ee.createElement(Xr,{key:"aliases",friend:a}))):h?i.push(Ee.createElement(ir.d,{key:"remove",onSelected:this.RemoveFriend},Object($.b)("#Friend_Menu_CancelInvitation"))):i.push(Ee.createElement(ir.d,{key:"invite",onSelected:this.InviteFriend},Object($.b)("#Friend_Menu_AddToFriendsList")));_&&i.push(Ee.createElement(ir.d,{key:"setnickname",onSelected:function(){Ir(o.browserContext,o.friend,o.ownerWindow)}},Object($.b)(o.friend.has_nickname?"#Friend_Menu_ChangeNickname":"#Friend_Menu_AddNickname"))),l&&!a.is_blocked||r.push(Ee.createElement(ir.d,{key:"block",onSelected:a.is_blocked?this.UnblockFriend:this.BlockFriend},Object($.b)(a.is_blocked?"#Friend_Menu_UnblockAllCommunication":"#Friend_Menu_BlockAllCommunication")))}if(!i)return null;var y=void 0;return this.props.context&&this.props.context.group&&(y=this.props.context.group.GetMemberPartyBeacon(this.props.friend.accountid)),Ee.createElement(ir.c,{className:"friendsContextMenu"},i,1==r.length&&r,1<r.length&&Ee.createElement(ir.e,{label:Object($.b)("#Friend_Menu_Manage")},r),!!a.persona.m_broadcastAccountId&&!c&&Ee.createElement(ra,{friend:a,ownerWindow:o.ownerWindow,browserContext:o.browserContext}),!!a.persona.m_unGamePlayedAppID&&!c&&Ee.createElement(ia,{unAppID:a.persona.m_unGamePlayedAppID,strGameName:a.current_game_name,ulGameID:a.persona.m_gameid,friend:a,partyBeacon:y}))},R.c([T.a],t.prototype,"ShowFriendProfile",null),R.c([T.a],t.prototype,"InviteFriend",null),R.c([T.a],t.prototype,"AcceptIncomingInvite",null),R.c([T.a],t.prototype,"IgnoreIncomingInvite",null),R.c([T.a],t.prototype,"RemoveFriend",null),R.c([T.a],t.prototype,"BlockFriend",null),R.c([T.a],t.prototype,"UnblockFriend",null),R.c([T.a],t.prototype,"InviteToGame",null),R.c([T.a],t.prototype,"InviteToLobby",null),R.c([T.a],t.prototype,"InviteToWatch",null),R.c([T.a],t.prototype,"InviteToVoice",null),t}(Ee.PureComponent),$r=function(o){function e(e){var t=o.call(this,e)||this,n=ci.VoiceStore.ConvertGainValueToSliderValue(ci.VoiceStore.GetPerUserGainLevel(t.props.friend.accountid),Yo.k_MaxPerUserGainMultiplier);return t.state={volumeNumber:n},t}return R.d(e,o),e.prototype.OnFriendVolumeChanged=function(e){ci.VoiceStore.SetPerUserGainLevel(this.props.friend.accountid,ci.VoiceStore.ConvertSliderToGainValue(e,Yo.k_MaxPerUserGainMultiplier)),this.setState({volumeNumber:e})},e.prototype.OnMutingClick=function(e){var t=ci.VoiceStore.GetPerUserMuting(this.props.friend.accountid);ci.VoiceStore.SetPerUserMuting(this.props.friend.accountid,!t),this.forceUpdate()},e.prototype.OnInlineVolumeClick=function(e){this.forceUpdate()},e.prototype.render=function(){var e=this.state.volumeNumber,t="VolumeIcon",n=ci.VoiceStore.GetPerUserMuting(this.props.friend.accountid);return 65<e?t+=" HighestVolume":45<e?t+=" HighVolume":e<46&&24<e?t+=" MedVolume":e<25&&(t+=" LowVolume"),Ee.createElement(ir.d,{key:"volume",onSelected:function(){},bInteractableItem:!0},Ee.createElement("div",{className:"InlineVolume"+(n?" Muted":""),onClick:this.OnInlineVolumeClick},Ee.createElement("button",{className:t,onClick:this.OnMutingClick},Ee.createElement(ui.hb,null)),Ee.createElement(Xi,{min:0,max:100,label:"",value:e,onChange:this.OnFriendVolumeChanged}),Ee.createElement("div",{className:"volumePercentage"},2*e,"%")))},R.c([T.a],e.prototype,"OnFriendVolumeChanged",null),R.c([T.a],e.prototype,"OnMutingClick",null),R.c([T.a],e.prototype,"OnInlineVolumeClick",null),e=R.c([or.observer],e)}(Ee.Component),ea=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return R.d(t,e),t.prototype.OnChange=function(e){this.props.group.SetMemberRoleState(this.props.friend.accountid,this.props.roleID,e)},t.prototype.render=function(){return Ee.createElement(ir.d,{className:"FriendMenuRoleCheckbox"+(this.props.bEditable?"":" disabled"),key:"role",onSelected:function(){},bInteractableItem:!0},Ee.createElement(Ki,{label:this.props.roleName,checked:this.props.bHasRole,onChange:this.OnChange,disabled:!this.props.bEditable}))},R.c([T.a],t.prototype,"OnChange",null),t=R.c([or.observer],t)}(Ee.Component),ta=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return R.d(t,e),t.prototype.SendTradeOffer=function(e){var t="NewTradeOffer"+this.props.friend.accountid;Object(Ci.m)(e).open(ci.EconomyStore.GetDefaultTradeOfferURLForFriend(this.props.friend.accountid),t,"height=1120,width=1028,resize=yes,scrollbars=yes").focus()},t.prototype.InviteToTrade=function(){ci.FriendStore.InviteToTrade(this.props.friend)},t.prototype.render=function(){var e=this.props.friend;return Ee.createElement(ir.e,{label:Object($.b)("#FriendMenu_Trading")},Ee.createElement(na,{friend:e}),Ee.createElement(ir.d,{onSelected:this.SendTradeOffer},Object($.b)("#FriendMenu_SendTradeOffer")),e.persona.is_online&&Ee.createElement(ir.d,{onSelected:this.InviteToTrade},Object($.b)("#Friend_Menu_InviteToTrade")))},R.c([T.a],t.prototype,"SendTradeOffer",null),R.c([T.a],t.prototype,"InviteToTrade",null),t}(Ee.Component);function na(t){return Ee.createElement(ir.d,{onSelected:function(e){Ur(e,t.friend.GetCommunityProfileURL()+"inventory/")}},Object($.b)("#FriendMenu_ViewInventory"))}var oa=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return R.d(t,e),t.prototype.BanFriend=function(){return R.b(this,void 0,void 0,function(){return R.e(this,function(e){switch(e.label){case 0:return[4,Sr(this.props.ownerWindow,Object($.b)("#Friend_Ban"),Object($.b)("#Friend_Ban_Confirm",this.props.friend.display_name),Object($.b)("#Friend_Ban_Button"),Object($.b)("#Button_Cancel"),!0)];case 1:return e.sent()&&this.props.group.SetUserBanState(this.props.friend.accountid,!0),[2]}})})},t.prototype.OnKickFriend=function(){var o=this,e=this.props.group,i=la,r=this.props.ownerWindow;new Promise(function(e,t){var n=Cr(r,Object($.b)("#Friend_Kick",o.props.friend.display_name));fr(Ee.createElement(pa,{OnOK:e,OnCancel:t,OnSet:function(e){i=e}}),r,"alertdialog",n,pd(r))}).then(function(){return e.KickUser(o.props.friend.accountid,Math.floor(Date.now()/1e3+i))}).catch(function(){})},t.prototype.render=function(){var e=[],t=this.props.friend,n=this.props.group;return n.BHasMember(t.accountid)?(!this.props.bIsSelf&&n.BCanKick()&&e.push(Ee.createElement(ir.d,{disabled:!n.BCanKickMember(t.accountid),key:"kick",onSelected:this.OnKickFriend},Object($.b)("#Friend_Menu_KickFromChatRoom"))),!this.props.bIsSelf&&n.BCanBan()&&e.push(Ee.createElement(ir.d,{disabled:!n.BCanBanMember(t.accountid),key:"ban",onSelected:this.BanFriend},Object($.b)("#Friend_Menu_Ban"))),n&&e.push(Ee.createElement(Qr,{key:"editroles",friend:t,group:n,bEditable:n.BCanEditRoles()}))):e.push(Ee.createElement(ir.d,{disabled:!0,key:"notmember",onSelected:null},Object($.b)("#Friend_Menu_HasLeftChat"))),e},R.c([T.a],t.prototype,"BanFriend",null),R.c([T.a],t.prototype,"OnKickFriend",null),t}(Ee.Component),ia=function(n){function e(e){var t=n.call(this,e)||this;return t.state={bShowViewGameInfo:void 0,bIsSubscribedToApp:void 0},To.b.BIsSubscribedApp(t.props.unAppID).then(function(e){t.setState({bShowViewGameInfo:To.b.BClientSupportsMessage("ViewGameInfoForSteamID"),bIsSubscribedToApp:e})}),t}return R.d(e,n),e.prototype.ShowStorePage=function(e){Ur(e,G.a.STORE_BASE_URL+"app/"+this.props.unAppID),e.stopPropagation()},e.prototype.ShowCommunityHub=function(e){Ur(e,G.a.COMMUNITY_BASE_URL+"app/"+this.props.unAppID),e.stopPropagation()},e.prototype.LaunchGame=function(e){Ur(e,"steam://rungameid/"+(this.props.ulGameID||this.props.unAppID)),e.stopPropagation()},e.prototype.WatchGame=function(e){ci.UIStore.SetFriendBroadcastVisible(this.props.friend.steamid64,!0),this.props.friend.OpenChatDialog(cd(this,e))},e.prototype.JoinGame=function(t){var n=this,o=this.props.friend;o.persona.has_joinable_game_flag||o.persona.has_server_ip?To.b.OpenJoinGameDialog(o.steamid64).then(function(e){e.success||n.JoinLobby(o,t)}).catch(function(){n.JoinLobby(o,t)}):this.JoinLobby(o,t)},e.prototype.ViewGameInfo=function(e){var t=this.props.friend;To.b.ViewGameInfoForSteamID(t.steamid64)},e.prototype.JoinLobby=function(e,t){e.persona.is_in_valid_lobby?Ur(t,"steam://joinlobby/"+e.persona.m_gameid+"/"+e.persona.m_game_lobby_id+"/"+e.steamid64):this.LaunchGame(t)},e.prototype.ShowInSteam=function(e){Ur(e,"steam://store/"+this.props.unAppID),e.stopPropagation()},e.prototype.JoinPartyBeacon=function(e){Ur(e,"steam://joinparty/"+this.props.unAppID+"/"+this.props.partyBeacon.beacon_id),e.stopPropagation()},e.prototype.render=function(){if(!this.props.unAppID)return null;var e=[],t=void 0,n=this.props.friend,o=ci.AppInfoStore.GetAppInfo(this.props.unAppID);if(!o.is_valid)return null;if(o.is_initialized)if(this.props.bShowLargeHeader)t=Ee.createElement("div",{className:"contextMenuGameHeader"},Ee.createElement("img",{className:"GameHeader",src:o.logo_url}));else{var i=Ee.createElement("span",{className:"contextMenuGameName"},Object($.b)("#Friend_Menu_ViewGameStorePageGameName",this.props.strGameName||o.name));t=Ee.createElement("div",{className:"contextMenuSectionHeader"},Ee.createElement("div",{className:"contextMenuGameIcon"},Ee.createElement("img",{className:"GameIcon",src:o.icon_url})),i)}return void 0===this.state.bIsSubscribedToApp?e.push(Ee.createElement(ir.d,{className:"contextMenuGameOptions contextMenuPlayButton",key:"showinsteam",onSelected:this.ShowInSteam},Ee.createElement(ui.J,null),Object($.b)("#Friend_Menu_ShowInSteam"))):this.state.bIsSubscribedToApp&&(this.props.partyBeacon?e.push(Ee.createElement(ir.d,{className:"contextMenuGameOptions contextMenuPlayButton contextMenuPartyBeacon",key:"joinparty",onSelected:this.JoinPartyBeacon},Ee.createElement(ui.J,null),Object($.b)("#Friend_Menu_JoinFriendPartyBeacon"))):n&&(n.persona.is_in_joinable_game||n.persona.is_in_valid_lobby)&&e.push(Ee.createElement(ir.d,{className:"contextMenuGameOptions contextMenuPlayButton",key:"joingame",onSelected:this.JoinGame},Ee.createElement(ui.J,null),Object($.b)("#Friend_Menu_JoinFriendGame"))),e.push(Ee.createElement(ir.d,{className:"contextMenuGameOptions contextMenuPlayButton",key:"launchgame",onSelected:this.LaunchGame},Ee.createElement(ui.J,null),Object($.b)("#Friend_Menu_LaunchFriendGame")))),n&&e.push(Ee.createElement(ir.d,{className:"contextMenuGameOptions",key:"watchgame",onSelected:this.WatchGame},Object($.b)("#Friend_Menu_WatchFriendGame"))),n&&this.state.bShowViewGameInfo&&e.push(Ee.createElement(ir.d,{className:"contextMenuGameOptions",key:"viewgameinfo",onSelected:this.ViewGameInfo},Object($.b)("#Friend_Menu_ViewGameInfo"))),e.push(Ee.createElement(ir.d,{className:"contextMenuGameOptions",key:"viewstorepage",onSelected:this.ShowStorePage},Object($.b)("#Friend_Menu_ViewGameStorePage"))),e.push(Ee.createElement(ir.d,{className:"contextMenuGameOptions",key:"viewcommunityhub",onSelected:this.ShowCommunityHub},Object($.b)("#Friend_Menu_ViewCommunityHub"))),Ee.createElement(Ee.Fragment,null,Ee.createElement(ir.d,{className:"contextMenuGameTitle contextMenuUnselectable",onSelected:null},t),Ee.createElement("div",{className:"contextMenuSectionContent"},e))},R.c([T.a],e.prototype,"ShowStorePage",null),R.c([T.a],e.prototype,"ShowCommunityHub",null),R.c([T.a],e.prototype,"LaunchGame",null),R.c([T.a],e.prototype,"WatchGame",null),R.c([T.a],e.prototype,"JoinGame",null),R.c([T.a],e.prototype,"ViewGameInfo",null),R.c([T.a],e.prototype,"ShowInSteam",null),R.c([T.a],e.prototype,"JoinPartyBeacon",null),e=R.c([or.observer],e)}(Ee.Component),ra=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return R.d(t,e),t.prototype.WatchStream=function(){var e=this.props.browserContext,t=this.props.friend,n=t.persona.m_broadcastAccountId;ci.UIStore.ShowOrActivateBroadcast(e,n,!0).ShowWatchPromptDialog(t)},t.prototype.render=function(){var e=this.props.friend;return Ee.createElement(Ee.Fragment,null,Ee.createElement(ir.d,{className:"contextMenuBroadcast contextMenuUnselectable",onSelected:null},Ee.createElement("div",{className:"contextMenuBroadcastTitle"},Object($.b)("#Broadcast_Watching")),Ee.createElement("div",{className:"contextMenuBroadcastSubtitle"},e.GetBroadcastDescription())),Ee.createElement("div",{className:"contextMenuSectionContent"},Ee.createElement(ir.d,{className:"contextMenuGameOptions",onSelected:this.WatchStream},Object($.b)("#Broadcast_WatchStream"))))},R.c([T.a],t.prototype,"WatchStream",null),t=R.c([or.observer],t)}(Ee.Component);function aa(e,t,n){return Object(mi.a)(Ee.createElement(sa,{browserContext:e,group:t,ownerWindow:n.currentTarget.ownerDocument.defaultView}),n)}function sa(o){var e=[];return o.group&&o.group.modifiable&&(e.push(Ee.createElement(ir.d,{key:"managegroup",onSelected:function(){var e,t,n;e=o.browserContext,t=o.group,n=o.ownerWindow,fr(Ee.createElement(Tr,{browserContext:e,group:t,rgPreSelectedFriends:t.member_accountid_list}),n,"CreateFriendCategoryDialog",{strTitle:Object($.b)("#FriendGroup_Menu_Manage"),popupWidth:664,popupHeight:700},pd(n))}},Object($.b)("#FriendGroup_Menu_Manage"))),e.push(Ee.createElement(ir.d,{key:"removegroup",onSelected:function(){ci.FriendStore.FriendGroupStore.RemoveGroup(o.group)}},Object($.b)("#FriendGroup_Menu_Remove")))),Ee.createElement(ir.c,{className:"friendsContextMenu"},e,Ee.createElement(ir.d,{key:"creategroup",onSelected:function(){Dr(o.browserContext,o.ownerWindow)}},Object($.b)("#FriendGroup_Menu_CreateGroup")))}var ca=function(t){function e(e){return t.call(this,e)||this}return R.d(e,t),e.prototype.SetUserOnline=function(){ci.FriendStore.SetUserPersonaState(1)},e.prototype.SetUserInvisible=function(){ci.FriendStore.SetUserPersonaState(7)},e.prototype.SetUserAway=function(){ci.FriendStore.SetUserPersonaState(3)},e.prototype.SetUserOffline=function(){ci.SignOutOfFriends(this.props.browserContext)},e.prototype.ToggleUserDND=function(){ci.FriendStore.SetUserDoNotDisturb(!ci.FriendStore.GetUserDoNotDisturb())},e.prototype.ShowUserProfile=function(e){Ur(e,ci.FriendStore.self.GetCommunityProfileURL()),e.stopPropagation()},e.prototype.EditProfile=function(e){Ur(e,ci.FriendStore.self.GetCommunityProfileURL()+"edit"),e.stopPropagation()},e.prototype.EditName=function(e){var t;this.props.browserContext,t=this.props.ownerWindow,fr(Ee.createElement(Hr,null),t,"ChangePersonaDialog",{strTitle:Object($.b)("#Friend_Menu_AddNickname"),popupWidth:640,popupHeight:400},pd(t))},e.prototype.render=function(){var e=[],t=[],n=1==ci.FriendStore.self.persona.m_ePersonaState;e.push(Ee.createElement(ir.b,{key:"state_online",bChecked:n,onSelected:this.SetUserOnline},Object($.b)("#PersonaStateOnline")));var o=3==ci.FriendStore.self.persona.m_ePersonaState;e.push(Ee.createElement(ir.b,{key:"state_away",bChecked:o,onSelected:this.SetUserAway},Object($.b)("#PersonaStateAway")));var i=7==ci.FriendStore.self.persona.m_ePersonaState;if(e.push(Ee.createElement(ir.b,{key:"state_invisible",bChecked:i,onSelected:this.SetUserInvisible},Object($.b)("#PersonaStateInvisible"),Ee.createElement("div",{className:"persona_menu_descriptor"},Object($.b)("#PersonaStateInvisibleDescriptor")))),G.a.IN_CLIENT&&ci.SettingsStore.BClientHasFeatureOrOnWeb("DoNotDisturb")){var r=0==ci.FriendStore.self.persona.m_ePersonaState;e.push(Ee.createElement(ir.b,{key:"state_offline",bChecked:r,onSelected:this.SetUserOffline},Object($.b)("#PersonaStateOffline"),Ee.createElement("div",{className:"persona_menu_descriptor"},Object($.b)("#PersonaStateOfflineDescriptor"))))}if(ci.SettingsStore.BClientHasFeatureOrOnWeb("DoNotDisturb")){var a=ci.FriendStore.GetUserDoNotDisturb();t.push(Ee.createElement(ir.b,{key:"do_not_disturb",bChecked:!1,onSelected:this.ToggleUserDND},Ee.createElement(Ki,{key:"dnd_checkbox",classname:"DNDCheckBox",checked:a,label:Object($.b)("#User_ToggleDoNotDisturb")}),Ee.createElement("div",{className:"persona_menu_dnd_descriptor"},Object($.b)("#PersonaStateDoNotDisturbDescriptor"))))}return t.push(Ee.createElement(ir.d,{key:"editname",onSelected:this.EditName},Object($.b)("#Friend_Menu_ChangeMyName"))),t?Ee.createElement(ir.c,{className:"friendsContextMenu currentUserContextMenu"},Ee.createElement("div",{className:"contextMenuSectionContent"},e),t):null},R.c([T.a],e.prototype,"SetUserOnline",null),R.c([T.a],e.prototype,"SetUserInvisible",null),R.c([T.a],e.prototype,"SetUserAway",null),R.c([T.a],e.prototype,"SetUserOffline",null),R.c([T.a],e.prototype,"ToggleUserDND",null),R.c([T.a],e.prototype,"ShowUserProfile",null),R.c([T.a],e.prototype,"EditProfile",null),R.c([T.a],e.prototype,"EditName",null),e}(Ee.PureComponent),la=3600,pa=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return R.d(t,e),t.prototype.OnCancel=function(){this.props.OnCancel(),this.props.closeModal()},t.prototype.OnOK=function(){this.props.OnOK(),this.props.closeModal()},t.prototype.OnDropDownChange=function(e,t){this.props.OnSet(e.data)},t.prototype.render=function(){var e=[{label:Object($.b)("#Friend_Kick_Hour"),data:la},{label:Object($.b)("#Friend_Kick_Day"),data:86400},{label:Object($.b)("#Friend_Kick_Week"),data:604800}];return Ee.createElement(sr,{onEscKeypress:this.OnCancel},Ee.createElement(Fi,{classNameContent:"KickUserDialog",onSubmit:this.OnOK,bCenterVertically:!0},Ee.createElement(wi,null," ",Object($.b)("#Friend_Kick")," "),Ee.createElement(Gi,null,Ee.createElement(Ti,null,Object($.b)("#Friend_Kick_How_Long")),Ee.createElement(Qi,{strDefaultLabel:Object($.b)("#Friend_Kick_Hour"),rgOptions:e,onChange:this.OnDropDownChange,selectedOption:void 0})),Ee.createElement(Mi,null,Ee.createElement(Hi,{onCancel:this.OnCancel,strOKText:Object($.b)("#Friend_Kick_Button"),strCancelText:Object($.b)("#Button_Cancel")}))))},R.c([T.a],t.prototype,"OnCancel",null),R.c([T.a],t.prototype,"OnOK",null),R.c([T.a],t.prototype,"OnDropDownChange",null),t}(Ee.Component);function ua(e,t,n,o,i){ma(e,t,n,o,!1,i)}function ma(e,t,n,o,i,r){fr(Ee.createElement(_a,{browserContext:e,chatRoomGroup:n,chatRoom:o,bIsDropInvite:i,vecInvitePlayers:r}),t,"ChatRoomGroupInviteDialog",{strTitle:Object($.b)("#Chat_CreateChatRoom"),popupWidth:664,popupHeight:680},pd(t))}var da=function(t){function e(e){return t.call(this,e)||this}return R.d(e,t),e.prototype.componentDidMount=function(){var e=this.props.chat.lastChatLinkInfo;(!e||Date.now()>=e.rtExpires)&&this.GenerateLink(86400)},e.prototype.GenerateLink=function(e){this.props.chat.CreateInviteLink(e)},e.prototype.OnFocus=function(e){e.target.select()},e.prototype.render=function(){var e=this.props.chat.lastChatLinkInfo,t=Object($.b)("#Chat_Invite_Loading");return this.props.disabled&&(e=void 0,t=""),Ee.createElement(Ee.Fragment,null,Ee.createElement(Wi,{label:Object($.b)("#Chat_Invite_Linkheader"),className:"InviteFriendToChatDialog_LinkInput",type:"text",value:e?e.strInviteURL:t,readOnly:!0,bShowCopyAction:!!e,onFocus:this.OnFocus,onClick:this.OnFocus}),!this.props.disabled&&Ee.createElement(ha,{onGenerate:this.GenerateLink,chat:this.props.chat}))},R.c([T.a],e.prototype,"GenerateLink",null),R.c([T.a],e.prototype,"OnFocus",null),e=R.c([or.observer],e)}(Ee.Component),ha=function(t){function e(e){return t.call(this,e)||this}return R.d(e,t),e.prototype.OnDropDownChange=function(e,t){this.props.onGenerate(e.data),t.SetSelectedOption(void 0)},e.prototype.CreateExpiresText=function(e){return 0==e?Object($.b)("#InviteLink_ExpiresNever_Short"):3600<e-ci.GetServerRTime32()?Object($.b)("#InviteLink_ExpiresDay_Short"):Object($.b)("#InviteLink_ExpiresHour_Short")},e.prototype.render=function(){var e=this.props.chat.lastChatLinkInfo,t=[{label:Object($.b)("#InviteLink_ExpiresHour_Short"),data:3600},{label:Object($.b)("#InviteLink_ExpiresDay_Short"),data:86400},{label:Object($.b)("#InviteLink_ExpiresNever_Short"),data:0}];return Ee.createElement("div",{className:"expireLinkInContainer"},Ee.createElement(Di,null,Object($.b)("#InviteLink_ExpireDropDownLabel")),Ee.createElement(Qi,{strClassName:"inviteLinkDropDown",rgOptions:t,strDefaultLabel:e?this.CreateExpiresText(e.rtExpires):Ee.createElement("span",null," "),onChange:this.OnDropDownChange,selectedOption:void 0}))},R.c([T.a],e.prototype,"OnDropDownChange",null),e=R.c([or.observer],e)}(Ee.Component),_a=function(n){function e(e){var t=n.call(this,e)||this;return t.state={bShowSubmit:e.vecInvitePlayers&&0<e.vecInvitePlayers.length,dropToInviteFriend:void 0,bHaveNonBetaFriendsSelected:!1},t.BuildMemberOfGroupSet(e),t}return R.d(e,n),e.prototype.componentWillReceiveProps=function(e){e.chatRoomGroup!=this.props.chatRoomGroup&&this.BuildMemberOfGroupSet(e),e.vecInvitePlayers&&0<e.vecInvitePlayers.length&&this.setState({bShowSubmit:!0})},e.prototype.BuildMemberOfGroupSet=function(e){var t=e.chatRoomGroup;this.m_setMembersOfGroup=t.memberList.GetCurrentMemberSet()},e.prototype.DismissDialog=function(){this.props.closeModal()},e.prototype.OnSubmit=function(){if(this.m_friendPicker&&this.m_friendPicker.state.rgFriendsChosen.length)for(var e=0,t=this.m_friendPicker.state.rgFriendsChosen;e<t.length;e++){var n=t[e];this.props.chatRoomGroup.InviteFriend(n.accountid,this.props.chatRoom)}this.props.closeModal()},e.prototype.OnFriendPickerRef=function(e){this.m_friendPicker=e,this.OnFriendPickerChange()},e.prototype.OnFriendPickerChange=function(){var e=!1,t=!1;if(this.m_friendPicker){e=0<this.m_friendPicker.selectedFriendCount;for(var n=function(e){if(!1===e.is_in_beta)return t=!0,"break";void 0===e.is_in_beta&&Object(d.when)(function(){return void 0!==e.is_in_beta},o.OnFriendPickerChange)},o=this,i=0,r=this.m_friendPicker.state.rgFriendsChosen;i<r.length;i++){if("break"===n(r[i]))break}}var a=e;a==this.state.bShowSubmit&&t==this.state.bHaveNonBetaFriendsSelected||this.setState({bShowSubmit:a,bHaveNonBetaFriendsSelected:t})},e.prototype.OnDragEnter=function(e,t){if(Object(I.a)(e&&"friend"==e.type||t,"Invalid data type passed to ChatRoomGroupDialog.OnDragEnter"),e){var n=e;n.friend&&(this.setState({dropToInviteFriend:n.friend}),this.m_friendPicker&&this.m_friendPicker.SelectFriendSuggestion(n.friend))}return!0},e.prototype.OnDragLeave=function(){this.state.dropToInviteFriend&&(this.m_friendPicker&&this.m_friendPicker.RemoveFriendFromList(this.state.dropToInviteFriend),this.setState({dropToInviteFriend:void 0}))},e.prototype.OnDrop=function(e,t){if(Object(I.a)(e&&"friend"==e.type,"Invalid data type passed to ChatRoomGroupDialog.OnDrop"),e&&"friend"==e.type){var n=e;n.friend&&(this.state.dropToInviteFriend&&this.setState({dropToInviteFriend:void 0}),_d.DragDropManager.SetDropConsumed(),this.m_friendPicker&&this.m_friendPicker.SelectFriendSuggestion(n.friend))}},e.prototype.GetDragDropProps=function(){var e={rgAcceptedTypes:["friend"]};return e.fnDragEnter=this.OnDragEnter,e.fnDragLeave=this.OnDragLeave,e.fnDrop=this.OnDrop,e},e.prototype.render=function(){var t=this,e=this.props.chatRoomGroup.GetDefaultChatRoom();this.props.chatRoom&&(e=this.props.chatRoom);var n,o=this.props.chatRoomGroup.name,i=null!=this.props.chatRoom,r=new Set([]),a=this.props.chatRoomGroup.BCanInvite();return a?this.props.chatRoom||(r=this.m_setMembersOfGroup):this.props.chatRoom?ci.FriendStore.all_friends.forEach(function(e){t.props.chatRoomGroup.BHasMember(e.accountid)||r.add(e.accountid)}):Object(I.a)(!1,"User should not be able to invite to the group"),n=this.props.bIsDropInvite?Object($.b)("#Chat_InviteFriends_DropInvite_Pre"):a?Object($.b)("#Chat_InviteFriends"):Object($.b)("#Chat_InviteGroupMembers"),Ee.createElement(sr,{onEscKeypress:this.DismissDialog},Ee.createElement(Fi,{classNameContent:"ChatRoomGroupInviteDialog"+(this.props.bIsDropInvite?" IsDropInvite":""),onSubmit:this.OnSubmit},Ee.createElement(wi,null,i?Ee.createElement("div",null,Object($.b)("#Chat_Actions_InviteFriend_VoiceChat"),Ee.createElement("div",{className:"DialogHeaderSubtitle DialogHighlight"},'"',this.props.chatRoom.name,'"')):Object($.b)("#Chat_Actions_InviteFriend"),Ee.createElement("div",{className:"displayRow"},Ee.createElement(xs,{group:this.props.chatRoomGroup,small:!0}),Ee.createElement("div",{className:"DialogHeaderSubtitle DialogHighlight"},o))),Ee.createElement(Gi,null,!this.props.bIsDropInvite&&a&&Ee.createElement(Ee.Fragment,null,Ee.createElement("div",{className:"inviteLinkContainer"},Ee.createElement(da,{chat:e,disabled:!1})),Ee.createElement("div",{className:"OrSeparator"},Ee.createElement("div",{className:"HBar"}),Ee.createElement("div",{className:"OrSeparatorLabel"},Object($.b)("#Chat_InviteFriends_OR_Separator")),Ee.createElement("div",{className:"HBar"}))),Ee.createElement(nr,R.a({className:""},this.GetDragDropProps()),Ee.createElement(Ti,{className:"CreateChat_NonBetaFriendsWarning"+(ci.IsInBeta()?"":" Released")+(this.state.bHaveNonBetaFriendsSelected?" Active":"")},Ee.createElement(fa,null),Object($.b)(ci.IsInBeta()?"#Chat_InviteFriend_SomeUnavailable":"#Chat_InviteFriend_SomeUnavailable_Released")),Ee.createElement(Or,{ref:this.OnFriendPickerRef,label:n,eSort:1,onFriendSelected:this.OnFriendPickerChange,onFriendRemoved:this.OnFriendPickerChange,setExcludedFriends:r,rgSelectedFriends:this.props.vecInvitePlayers,bDropInvite:this.props.bIsDropInvite,chosenFriendComponent:ga}))),Ee.createElement(Mi,null,Ee.createElement("div",{className:"DialogTwoColLayout _DialogColLayout"},Ee.createElement(Vi,{disabled:!this.state.bShowSubmit},Object($.b)("#Chat_Invite")),Ee.createElement(xi,{onClick:this.DismissDialog},Object($.b)("#Button_Close"))))))},R.c([T.a],e.prototype,"DismissDialog",null),R.c([T.a],e.prototype,"OnSubmit",null),R.c([T.a],e.prototype,"OnFriendPickerRef",null),R.c([T.a],e.prototype,"OnFriendPickerChange",null),R.c([T.a],e.prototype,"OnDragEnter",null),R.c([T.a],e.prototype,"OnDragLeave",null),R.c([T.a],e.prototype,"OnDrop",null),e}(Ee.PureComponent);function fa(){return Ee.createElement("div",{className:"FriendPicker_InvitedFriend_NotInBetaWarning",title:Object($.b)(ci.IsInBeta()?"#Chat_InviteFriend_SomeUnavailable":"#Chat_InviteFriend_SomeUnavailable_Released")},"!")}var ga=Object(or.observer)(function(e){var t=e.friend.is_in_beta||void 0===e.friend.is_in_beta;return Ee.createElement(Ee.Fragment,null,Ee.createElement(Wc,{friend:e.friend,context:null},Ee.createElement("div",{className:"FriendPicker_ChosenFriend"+(t?"":" FriendPicker_InvitedFriendNotInBeta"),onClick:function(){e.onClick(e.friend)}},!t&&Ee.createElement(fa,null),Ee.createElement("span",null,e.friend.display_name),Ee.createElement(ui.jb,null))))});function ba(e,t,n){var o,i=cd(null,e);return t.BIsClanChatRoom()&&(o=ci.FriendStore.ClanStore.GetClan(t.GetClanID())),Object(mi.a)(Ee.createElement(va,{browserContext:i,group:t,clan:o,context:n,ownerWindow:e.currentTarget.ownerDocument.defaultView}),e)}var va=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return R.d(t,e),t.prototype.OpenChatWindow=function(e){this.props.group?ci.UIStore.ShowAndOrActivateChatRoomGroup(this.props.browserContext,this.props.group,!0):this.props.clan.OpenChatDialog(this.props.browserContext,!0)},t.prototype.ShowClanProfile=function(e){var t;if(this.props.clan.BIsOGG())t=G.a.COMMUNITY_BASE_URL+"app/"+this.props.clan.GetOGGAppID();else{var n=this.props.clan.steamid;t=G.a.COMMUNITY_BASE_URL+"gid/"+n.ConvertTo64BitString()}Ur(e,t),e.stopPropagation()},t.prototype.LeaveChatRoomGroup=function(e){!function(o,i){R.b(this,void 0,void 0,function(){var t,n;return R.e(this,function(e){switch(e.label){case 0:return t=ld(o),n=i.BIsClanChatRoom()?"#Chat_Actions_LeaveChatRoomGroup_ClanConfirm":i.BIsAccountIDOwner(ci.CMInterface.steamid.GetAccountID())?"#Chat_Actions_OwnerLeaveChatRoomGroup_Confirm":"#Chat_Actions_LeaveChatRoomGroup_Confirm",[4,Sr(o,Object($.b)("#Chat_Actions_LeaveChatRoomGroup"),Object($.b)(n,i.name),Object($.b)("#Chat_Actions_LeaveChatRoomGroup"))];case 1:return e.sent()&&i.LeaveChatRoomGroup(t),[2]}})})}(e.currentTarget.ownerDocument.defaultView,this.props.group)},t.prototype.render=function(){var e=this,t=[],n=this.props.group,o=this.props.clan,i=this.props.context||{},r=ci.FriendStore.FavoritesStore;i.tab?t.push(Ee.createElement(ir.d,{key:"closetab",onSelected:function(){ci.UIStore.CloseTab(e.props.browserContext,i.tab)}},Object($.b)("#Chat_CloseTabAction"))):i.is_chat_window||t.push(Ee.createElement(ir.d,{key:"opentab",onSelected:this.OpenChatWindow},Object($.b)("#Chat_Actions_OpenChat"))),o&&!o.BIsOGG()&&t.push(Ee.createElement(ir.d,{key:"viewprofile",onSelected:this.ShowClanProfile},Object($.b)("#Friend_Menu_ViewProfile"))),t.push(Ee.createElement(ir.d,{key:"leavechatroom",onSelected:this.LeaveChatRoomGroup},Object($.b)(o?"#Chat_Actions_LeaveChatRoom":"#Chat_Actions_LeaveChatRoomGroup")));var a=o?{clan:o}:{chat:n};return ci.FriendStore.FavoritesStore.BIsFavorited(a)?i.is_favorites&&t.push(Ee.createElement(ir.d,{key:"quickaccess",onSelected:function(){r.RemoveFromFavorites(a)}},Object($.b)("#Friend_Menu_RemoveFromQuickAccess"))):t.push(Ee.createElement(ir.d,{key:"quickaccess",onSelected:function(){r.AddToFavorites(a)}},Object($.b)("#Friend_Menu_AddToQuickAccess"))),o&&o.BIsOGG()&&t.push(Ee.createElement(ia,{unAppID:o.GetOGGAppID(),strGameName:o.name})),Ee.createElement(ir.c,{className:"chatRoomListItemContextMenu"},t)},R.c([T.a],t.prototype,"OpenChatWindow",null),R.c([T.a],t.prototype,"ShowClanProfile",null),R.c([T.a],t.prototype,"LeaveChatRoomGroup",null),t}(Ee.Component);function Sa(e,t,n,o,i){return t.GetDefaultChatID()==n?null:ya.BIsMenuEmpty(t,n,!!i)?null:Object(mi.a)(Ee.createElement(ya,{browserContext:e,group:t,roomID:n,ownerWindow:o.currentTarget.ownerDocument.defaultView,onStartRoomRename:i}),o)}var ya=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return R.d(t,e),t.prototype.ShowInviteDialog=function(){var e=this.props.group.GetChatRoom(this.props.roomID);ua(this.props.browserContext,this.props.ownerWindow,this.props.group,e)},t.prototype.SaveVoiceRoom=function(e){var t,n,o,i=Object(Ci.m)(e);t=i,n=this.props.group,o=this.props.roomID,fr(Ee.createElement(Ca,{group:n,roomID:o}),t,"SaveVoiceRoomDialog",{strTitle:Object($.b)("#Chat_SaveVoiceRoom"),popupWidth:664,popupHeight:380},pd(t))},t.prototype.RemoveRoom=function(){var n=this;vr(this.props.ownerWindow,Object($.b)("#Chat_Actions_RemoveRoom"),Object($.b)("#Chat_Actions_RemoveRoom_Confirm"),Object($.b)("#Chat_Actions_RemoveRoom_Action")).then(function(){var e=n.props.group,t=n.props.roomID;e.DeleteChatRoom(t)}).catch(function(){})},t.prototype.ChangeRoomName=function(){this.props.onStartRoomRename(this.props.roomID)},t.BIsMenuEmpty=function(e,t,n){var o=e.GetDefaultChatID()==t,i=e.BIsTempVoiceChannel(t),r=e.BCanAdminChannel();return!e.BIsVoiceChannel(t)&&((!i||!r)&&(!(n&&!o&&!i&&r)&&!(!o&&r)))},t.prototype.render=function(){var e=[],t=this.props.group,n=this.props.roomID,o=t.GetDefaultChatID()==n,i=t.BIsTempVoiceChannel(n),r=t.BCanAdminChannel();t.BCanInvite();return e.push(Ee.createElement(ir.d,{key:"invitefriend",onSelected:this.ShowInviteDialog},Object($.b)("#Chat_Actions_InviteFriendtoVoice"))),i&&e.push(Ee.createElement(ir.d,{key:"savechannel",className:r?"":"noPermission",onSelected:this.SaveVoiceRoom},!r&&Ee.createElement(ui.z,null),Object($.b)("#Chat_Actions_SaveChannel"))),this.props.onStartRoomRename&&!o&&!i&&r&&e.push(Ee.createElement(ir.d,{key:"renameroom",onSelected:this.ChangeRoomName},Object($.b)("#Chat_Actions_ChangeRoomName"))),!o&&r&&e.push(Ee.createElement(ir.d,{key:"removeroom",onSelected:this.RemoveRoom},Object($.b)("#Chat_Actions_RemoveRoom"))),e.length<1?(console.log("warning: empty context menu. Did someone not update BIsMenuEmpty?"),null):Ee.createElement(ir.c,{className:"friendsContextMenu"},e)},R.c([T.a],t.prototype,"ShowInviteDialog",null),R.c([T.a],t.prototype,"SaveVoiceRoom",null),R.c([T.a],t.prototype,"RemoveRoom",null),R.c([T.a],t.prototype,"ChangeRoomName",null),t}(Ee.PureComponent);var Ca=function(n){function e(e){var t=n.call(this,e)||this;return t.state={strName:"",strError:void 0},t}return R.d(e,n),e.prototype.HandleTextEntry=function(e){this.setState({strName:e.target.value})},e.prototype.HandleSubmit=function(e){e&&e.preventDefault();var t=this.state.strName;0!=t.length?(this.props.group.RenameRoom(this.props.roomID,t),this.props.closeModal()):this.setState({strError:Object($.b)("#Chat_SaveVoiceRoom_Error_EmptyName")})},e.prototype.render=function(){return Ee.createElement(sr,{onEscKeypress:this.props.closeModal},Ee.createElement(Fi,{classNameContent:"SaveVoiceRoomDialog",onSubmit:this.HandleSubmit},Ee.createElement(wi,null,Object($.b)("#Chat_SaveVoiceRoom")),Ee.createElement(Gi,null,this.state.strError&&Ee.createElement(Ti,{className:"nicknameError"},this.state.strError),Ee.createElement(Ti,null,Object($.b)("#Chat_SaveVoiceRoom_Description")),Ee.createElement(Wi,{type:"text",label:Object($.b)("#Chat_SaveVoiceRoom_Name"),className:"nicknameInput",value:this.state.strName,onChange:this.HandleTextEntry,autoFocus:!0})),Ee.createElement(Mi,null,Ee.createElement(Hi,{onCancel:this.props.closeModal}))))},R.c([T.a],e.prototype,"HandleTextEntry",null),R.c([T.a],e.prototype,"HandleSubmit",null),e=R.c([or.observer],e)}(Ee.Component),Ia=n("1w3K"),Ea=function(n){function e(e){var t=n.call(this,e)||this;return t.state={ulSelectedGroupID:""},t}return R.d(e,n),e.prototype.BindDiv=function(e){this.m_elDiv=e},Object.defineProperty(e.prototype,"div",{get:function(){return this.m_elDiv},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"recommendedHeight",{get:function(){return this.m_elDiv.clientHeight},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"maximumHeight",{get:function(){return this.recommendedHeight},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"minimumHeight",{get:function(){return 0},enumerable:!0,configurable:!0}),e.prototype.OnGroupSelected=function(e){e==this.state.ulSelectedGroupID?this.setState({ulSelectedGroupID:""}):this.setState({ulSelectedGroupID:e})},e.prototype.render=function(){var t=this,e=this.props.chats.currentChatRoomGroups.sort(function(e,t){return t.time_last_activity-e.time_last_activity});return Ee.createElement("div",{className:"ChatRoomList CompactFriendsList",ref:this.BindDiv},0==e.length&&Ee.createElement("div",{className:"ChatRoomList_Empty"},Object($.b)("#Chat_ChatRoomList_Empty"),Ee.createElement("br",null),Ee.createElement("br",null),Object($.d)("#Chat_ChatRoomList_Empty_How",Ee.createElement(Ar,{href:G.a.COMMUNITY_BASE_URL+"my/groups/"},Object($.b)("#Chat_ChatRoomList_Empty_HowLink")))),e.map(function(e){return Ee.createElement(Oa,{key:e.GetGroupID(),group:e,bExpanded:!1,onSelect:t.OnGroupSelected})}),Ee.createElement("div",{className:"disconnectBlocker"}))},R.c([T.a],e.prototype,"BindDiv",null),R.c([T.a],e.prototype,"OnGroupSelected",null),e=R.c([or.observer],e)}(Ee.Component),Oa=function(n){function e(e){var t=n.call(this,e)||this;return t.m_bAcceptDrag=!1,t.state={friendDrag:void 0,bStateExpanded:!1,bNonGroupHovered:!1,broadcastInfo:e.group.watching_broadcast_steamid&&lo.StartInfo(e.group.watching_broadcast_steamid.ConvertTo64BitString())},t}return R.d(e,n),e.prototype.GetDragDropProps=function(e){void 0===e&&(e=!0);var t={};return e&&(t.onDragEnter=this.OnDragEnter,t.onDragOver=this.OnDragOver,t.onDragLeave=this.OnDragLeave,t.onDrop=this.OnDrop),t.draggable=!0,t.onDragStart=this.OnDragStart,t.onDragEnd=this.OnDragEnd,t},e.prototype.OnDragStart=function(e){var t=this.props.group;if(t.BIsClanChatRoom()){var n=ci.FriendStore.ClanStore.GetClan(t.GetClanID());_d.DragDropManager.StartDrag({type:"clan",clan:n})}else _d.DragDropManager.StartDrag({type:"chatroomgroup",group:t})},e.prototype.componentWillUnmount=function(){this.state.broadcastInfo&&lo.StopInfo(this.state.broadcastInfo)},e.prototype.OnDragEnd=function(e){_d.DragDropManager.EndDrag()},e.prototype.OnDragEnter=function(e){var t=_d.DragDropManager.GetDragData();if(t&&"friend"==t.type){var n=t.friend;this.m_bAcceptDrag=!0,e.preventDefault(),this.setState({friendDrag:n})}else this.m_bAcceptDrag=!1;e&&(e.preventDefault(),this.m_bAcceptDrag&&e.stopPropagation())},e.prototype.OnDragOver=function(e){this.m_bAcceptDrag&&(e.preventDefault(),e.stopPropagation())},e.prototype.OnDragLeave=function(e){Object(Ci.c)(e)&&(this.m_bAcceptDrag=!1,this.state.friendDrag&&this.setState({friendDrag:void 0}))},e.prototype.OnDrop=function(e){var t=_d.DragDropManager.GetDragData();if(t&&"friend"==t.type){e.preventDefault(),e.stopPropagation();var n=this.props.group.memberList.member_list.slice(),o=t;if(null!=o.friend&&-1!=n.indexOf(o.friend))return;_d.DragDropManager.SetDropConsumed(),this.props.group.InviteFriend(o.friend.accountid),this.setState({friendDrag:void 0})}},e.prototype.OnClick=function(e){ci.UIStore.ShowAndOrActivateChatRoomGroup(cd(this),this.props.group,!0)},e.prototype.OnToggleSelected=function(e){this.setState({bStateExpanded:!this.state.bStateExpanded}),e.stopPropagation()},e.prototype.OnOpenGroup=function(e){ci.UIStore.ShowAndOrActivateChatRoomGroup(cd(this),this.props.group,!0),e.stopPropagation()},e.prototype.OnContextMenu=function(e){ba(e,this.props.group)},e.prototype.OnMouseEnterNonTitle=function(){this.setState({bNonGroupHovered:!0})},e.prototype.OnMouseLeaveNonTitle=function(){this.setState({bNonGroupHovered:!1})},e.prototype.render=function(){var e=this.props.group,t=this.state.bStateExpanded,n=null!==e.watching_broadcast_steamid,o=n&&new D.a(e.watching_broadcast_steamid),i=n&&this.state.broadcastInfo?this.state.broadcastInfo.m_strTitle||this.state.broadcastInfo.m_strAppTitle||Object($.b)("#PersonaStateWatchingBroadcast_Player",ci.FriendStore.GetPlayer(o.GetAccountID()).display_name):void 0,r=["ChatRoomListGroupItem"],a=this.props.group.hasVoiceRoom;return a||r.push("NoChannels"),t&&r.push("ShowAllChannels"),this.state.bNonGroupHovered&&r.push("NonGroupHovered"),n&&r.push("HasLinkedBroadcast"),Ee.createElement("div",R.a({className:r.join(" ")},this.GetDragDropProps(!0)),Ee.createElement("div",{className:"ChatRoomListGroupItem_header",onClick:this.OnClick,onContextMenu:this.OnContextMenu},Ee.createElement(xs,{group:e,small:!0}),n&&Ee.createElement("div",{className:"steamTVSubtitle"},Ee.createElement(ui.W,null),": ",i," "),Ee.createElement("div",{className:"groupNameStatusContainer"},Ee.createElement("div",{className:"displayRow"},Ee.createElement("div",{className:"chatRoomName"},this.props.group.name),Ee.createElement("div",{className:"ContextMenuButton",onClick:this.OnContextMenu,onMouseEnter:this.OnMouseEnterNonTitle,onMouseLeave:this.OnMouseLeaveNonTitle},Ee.createElement(ui.n,null))),!t&&a&&Ee.createElement(Ta,{group:e})),Ee.createElement(wa,{group:e}),a&&Ee.createElement("div",{onMouseEnter:this.OnMouseEnterNonTitle,onMouseLeave:this.OnMouseLeaveNonTitle},Ee.createElement(Ma,{expanded:t,onClick:this.OnToggleSelected}))),a&&Ee.createElement("div",{className:"detailsView"},Ee.createElement("div",{className:"ChatRoomListGroupItemChatRooms"},Ee.createElement(Da,{group:e,expanded:t}))))},R.c([T.a],e.prototype,"OnDragStart",null),R.c([T.a],e.prototype,"OnDragEnd",null),R.c([T.a],e.prototype,"OnDragEnter",null),R.c([T.a],e.prototype,"OnDragOver",null),R.c([T.a],e.prototype,"OnDragLeave",null),R.c([T.a],e.prototype,"OnDrop",null),R.c([T.a],e.prototype,"OnClick",null),R.c([T.a],e.prototype,"OnToggleSelected",null),R.c([T.a],e.prototype,"OnOpenGroup",null),R.c([T.a],e.prototype,"OnContextMenu",null),R.c([T.a],e.prototype,"OnMouseEnterNonTitle",null),R.c([T.a],e.prototype,"OnMouseLeaveNonTitle",null),e=R.c([or.observer],e)}(Ee.Component),wa=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return R.d(t,e),t.prototype.render=function(){var e=this.props.group,t=this.props.chat;if(e&&!e.HasUnreadChatMessage||t&&!t.has_any_unread_messages)return null;var n=(this.props.className||"")+" ChatUnreadMessageIndicator";return(e&&e.HasUnreadMention||t&&t.has_unread_mention)&&(n+=" UnreadMention"),Ee.createElement("div",{className:n},Ee.createElement("div",{className:"chatUnreadCircle"},"@"))},t=R.c([or.observer],t)}(Ee.Component);function Ma(e){var t=e.expanded?Object($.b)("#Chat_ChatRoomListO_OpenGroupCollapse"):Object($.b)("#Chat_ChatRoomListO_OpenGroupExpand");return Ee.createElement("div",{className:"openGroupButton",title:t,onClick:e.onClick},Ee.createElement(ui.m,null))}var Da=Object(or.observer)(function(e){for(var t=[],n=0,o=e.group.voiceRoomList;n<o.length;n++){var i=o[n];(e.expanded||i.voice_active_contains_self)&&t.push(i)}var r=null;return t&&(r=t.map(function(e){return Ee.createElement(li,{classNames:"heightcollapseandfade-anim",timeout:300,key:e.unique_id},Ee.createElement(Wa,{key:e.unique_id,chat:e,bRenameActive:!1,context:"ChatRoomList",onSelect:e.StartVoiceChat}))})),Ee.createElement(Ia.TransitionGroup,null,r)}),Ta=Object(or.observer)(function(e){for(var t=[],n=0,o=e.group.voiceRoomList;n<o.length;n++){var i=o[n];if(!i.voice_active_contains_self){var r=i.voice_active_member_list;if(0!=r.member_count){var a=r.member_list.filter(function(e){return e.is_friend});0!=a.length&&((a=r.member_list.slice()).sort(ft.FriendSortByFriendOrNotComparator),t.push({ulRoomID:i.unique_id,rgFriends:a}))}}}return t&&0!=t.length?Ee.createElement("div",{className:"membersInVoice"},Ee.createElement("div",{className:"voiceChannelIcon"},Ee.createElement(ui.gb,null)),t.map(function(e){return Ee.createElement(Ga,{key:e.ulRoomID,friendsInRoom:e})})):null}),Ga=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return R.d(t,e),t.prototype.render=function(){var e=this.props.friendsInRoom;return Ee.createElement("span",{className:"voiceChatGroup"},e.rgFriends.map(function(e){return Ee.createElement(Wc,{key:e.accountid,friend:e,context:{},disableContextMenu:!1},Ee.createElement("img",{className:"voiceFriendAvatar"+(e.is_friend?"":" isNotFriend"),src:e.persona.avatar_url,draggable:!1}))}))},t=R.c([or.observer],t)}(Ee.Component),Ra=n("c7k8"),Na=function(){function e(){this.m_vecObjects=[],this.OnUnload=this.OnUnload.bind(this),Object({NODE_ENV:"production",STEAM_BUILD:"buildbot",VALVE_BUILD:"false"}).MOBILE_BUILD||window.addEventListener("unload",this.OnUnload)}return e.prototype.OnUnload=function(){for(var e=0,t=this.m_vecObjects;e<t.length;e++){t[e].DeleteObserver()}this.m_vecObjects=[]},e.prototype.CreateObserver=function(e,t){var n=new La(e,t);return this.m_vecObjects.push(n),n},e.prototype.DeleteObserver=function(e){if(e){var t=e,n=this.m_vecObjects.indexOf(t);0<=n&&(t.DeleteObserver(),this.m_vecObjects.splice(n,1))}},e}(),La=function(){function e(e,t){this.m_resizeObserver=t?new t.ResizeObserver(e):new ResizeObserver(e)}return e.prototype.DeleteObserver=function(){this.m_resizeObserver&&(this.m_resizeObserver.disconnect(),delete this.m_resizeObserver)},e.prototype.observe=function(e){this.m_resizeObserver&&this.m_resizeObserver.observe(e)},e.prototype.unobserve=function(e){this.m_resizeObserver&&this.m_resizeObserver.unobserve(e)},e.prototype.disconnect=function(){this.m_resizeObserver&&this.m_resizeObserver.disconnect()},e}(),ka=new Na,Pa=function(n){function e(e){var t=n.call(this,e)||this;return t.m_elContainer=null,t.m_resizeObserver=null,t.state={nWidth:0,nHeight:0},t}return R.d(e,n),e.prototype.componentWillUnmount=function(){this.m_resizeObserver&&ka.DeleteObserver(this.m_resizeObserver)},e.prototype.BindContainerRef=function(e){this.m_resizeObserver&&(this.m_resizeObserver.disconnect(),this.m_resizeObserver=null),this.m_elContainer=e,this.m_elContainer&&(this.m_resizeObserver=ka.CreateObserver(this.OnResize,Object(Ci.l)(this.m_elContainer)),this.m_resizeObserver.observe(this.m_elContainer),this.UpdateDimensions(this.m_elContainer.clientWidth,this.m_elContainer.clientHeight))},e.prototype.UpdateDimensions=function(e,t){this.state.nWidth==e&&this.state.nHeight==t||this.setState({nWidth:e,nHeight:t})},e.prototype.OnResize=function(e,t){var n=0,o=0;if(0<e.length){var i=e[0].contentRect;n=i.width,o=i.height}this.UpdateDimensions(n,o)},e.prototype.render=function(){var e={width:this.state.nWidth,height:this.state.nHeight},t=this.props.children(e),n=this.props.className;return Ee.createElement("div",{className:n,style:{position:"absolute",top:0,right:0,bottom:0,left:0},ref:this.BindContainerRef},t)},R.c([T.a],e.prototype,"BindContainerRef",null),R.c([T.a],e.prototype,"OnResize",null),e}(Ee.Component);function Aa(e,t){return e.filter(function(e){return e.BMatchesSearchString(t,!1)})}var Ba=function(n){function e(e){var t=n.call(this,e)||this;return t.state={bCollapsed:!1},t}return R.d(e,n),e.prototype.OnRoomsContextMenu=function(e){var t=this;if(this.props.groupView.GetGroup().BCanAdminChannel()){var n=e.currentTarget.ownerDocument.defaultView;Object(mi.a)(Ee.createElement(ir.c,null,Ee.createElement(ir.d,{onSelected:function(){t.CreateTextChannel(n)}},Object($.b)("#GroupSettings_Channels_CreateText")),Ee.createElement(ir.d,{onSelected:function(){t.CreateVoiceChannel(n)}},Object($.b)("#GroupSettings_Channels_CreateVoice"))),e)}},e.prototype.CreateTextChannel=function(e){fr(Ee.createElement(xa,{ownerWin:e,groupView:this.props.groupView,bVoiceChannel:!1,bJoinChannel:!0}),e)},e.prototype.CreateVoiceChannel=function(e){fr(Ee.createElement(xa,{ownerWin:e,groupView:this.props.groupView,bVoiceChannel:!0,bJoinChannel:!0}),e)},e.prototype.render=function(){var e=this.props.groupView.GetGroup(),t=e.GetDefaultChatRoom(),n=e.IsNamedGroupChat(),o=!1,i=!1,r="chatRoomGroupNavColumn",a=this.props.groupView.IsVoiceActive(),s=this.props.groupView.isChannelListCollapsed;return e.voiceRoomList.length<1&&!n&&(o=!0,r+=" defaultChatOnly"),t&&0!=t.voice_active_member_list.member_count||!(e.voiceRoomList.length<1)||a||(i=!0,r+=" noActiveVoiceChannels"),s&&(r+=" chatRoomGroupNavCollapsed"),this.props.inactive||i&&o?Ee.createElement("div",{className:r}):Ee.createElement("div",{className:r},Ee.createElement("div",{className:"chatRoomChannelGroups",onContextMenu:this.OnRoomsContextMenu},n&&Ee.createElement(Ua,{groupView:this.props.groupView}),(!i||!o)&&Ee.createElement(Ha,{groupView:this.props.groupView})),Ee.createElement("div",{className:"disconnectBlocker"}))},R.c([T.a],e.prototype,"OnRoomsContextMenu",null),e=R.c([or.observer],e)}(Ee.Component),Fa=function(t){function e(e){return t.call(this,e)||this}return R.d(e,t),e.prototype.GetMembersMatchingSearch=function(e){var t=Aa(this.props.groupView.GetGroup().memberList.member_list,e);return t.sort(ft.DefaultFriendSortComparator),t},e.prototype.OnMemberListToggleViewClick=function(e){this.props.groupView.SetMemberListCollapsed(this.props.groupView.isMemberListExpanded)},e.prototype.OnSearchInput=function(e){this.props.groupView.SetMemberSearchEnabled(e.currentTarget.value)},e.prototype.OnSearchSubmit=function(e){e.preventDefault();var t=this.props.groupView,n=t.normalizedMemberSearch;if(n&&n.length){var o=this.GetMembersMatchingSearch(n);o.length&&o[0].OpenChatDialog(cd(this,e))}t.ClearMemberSearch()},e.prototype.OnSearchKeyDown=function(e){27==e.keyCode&&(e.preventDefault(),e.currentTarget.blur(),this.props.groupView.ClearMemberSearch())},e.prototype.OnClearSearch=function(){this.props.groupView.ClearMemberSearch()},e.prototype.OnSearchFocus=function(){this.props.groupView.SetMemberSearchEnabled()},e.prototype.OnSearchBlur=function(){0==this.props.groupView.GetMemberSearch().length&&this.props.groupView.ClearMemberSearch()},e.prototype.render=function(){var e=this.props.groupView,t=e.isMemberListExpanded,n=e.GetMemberSearch(),o="MemberListColumn",i=Object($.b)("#Tooltip_MemberCollapse");t||(o+=" MemberListViewCompact",i=Object($.b)("#Tooltip_MemberExpand"));var r="MemberListOptionsContainer";return e.IsMemberSearchActive()&&(r+=" SearchActive"),Ee.createElement("div",{className:o},Ee.createElement("div",{className:r},Ee.createElement("div",{className:"MemberListOption ToggleMemberListView"+(0<n.length?" SearchActive":""),onClick:this.OnMemberListToggleViewClick,title:i},Ee.createElement(ui.m,null)),Ee.createElement("form",{className:"socialInputContainer",name:"friendSearchForm",onSubmit:this.OnSearchSubmit},Ee.createElement("div",{className:"inputContainer no-drag"},Ee.createElement("input",{id:"memberListSearchInputID",className:"friendSearchInput",type:"text",name:"memberlistSearch",placeholder:Object($.b)("#SearchByName"),defaultValue:n,onInput:this.OnSearchInput,onKeyDown:this.OnSearchKeyDown,onFocus:this.OnSearchFocus,onBlur:this.OnSearchBlur,autoComplete:"off"}),Ee.createElement("div",{className:"friendSearchClear",onClick:this.OnClearSearch},Ee.createElement(ui.jb,null))))),Ee.createElement(Va,{groupView:this.props.groupView,inactive:this.props.inactive}),Ee.createElement("div",{className:"disconnectBlocker"}))},R.c([T.a],e.prototype,"OnMemberListToggleViewClick",null),R.c([T.a],e.prototype,"OnSearchInput",null),R.c([T.a],e.prototype,"OnSearchSubmit",null),R.c([T.a],e.prototype,"OnSearchKeyDown",null),R.c([T.a],e.prototype,"OnClearSearch",null),R.c([T.a],e.prototype,"OnSearchFocus",null),R.c([T.a],e.prototype,"OnSearchBlur",null),e=R.c([or.observer],e)}(Ee.Component),Va=function(n){function e(e){var t=n.call(this,e)||this;return t.m_mapCollapsedBuckets=new Map,t.m_refList=Ee.createRef(),t.m_disposeGetMemberList=ci.GroupMemberStore.RegisterForGroupMemberList(t.OnMemberListChanged,t.props.groupView.GetGroup().GetGroupID()),t.state={nBucketChanges:1},t}return R.d(e,n),e.prototype.componentWillUnmount=function(){this.m_disposeGetMemberList.unregister()},e.prototype.GetFriendRenderContext=function(){var e=this.props.groupView.GetGroup();return this.m_renderContext&&this.m_renderContext.group==e||(this.m_renderContext={group:e,chatContext:"chatmemberlist"}),this.m_renderContext},e.prototype.OnMemberListChanged=function(){var e=this.state.nBucketChanges+1;this.setState({nBucketChanges:e}),null!=this.m_refList.current&&this.m_refList.current.recomputeRowHeights()},e.prototype.SortedPlayerSortFunc=function(e,t){return e.display_name.localeCompare(t.display_name)},e.prototype.BuildFilteredBuckets=function(e,t){for(var n=[],o=0,i=e;o<i.length;o++){var r=i[o],a=Aa(r.member_list,t);if(0<a.length){var s=new Qo(r.id,this.SortedPlayerSortFunc,function(){});s.SetMembers(a),n.push(s)}}return n},e.prototype.GetListGroupForIndex=function(e,t){for(var n=0,o=e;n<o.length;n++){var i=o[n];if(t<0)break;var r=this.GetVisibleRowsForBucket(i);if(t<r)return{index:t,bucket:i};t-=r}return null},e.prototype.GetVisibleRowsForBucket=function(e){return this.BIsBucketCollapsed(e)?1:e.member_list.length+1},e.prototype.OnToggleBucketCollapsed=function(e){1<this.m_rgLastRenderBuckets.length&&(this.m_mapCollapsedBuckets.set(e.id,!this.BIsBucketCollapsed(e)),this.OnMemberListChanged())},e.prototype.BIsBucketCollapsed=function(e){return this.m_mapCollapsedBuckets.get(e.id)},e.prototype.GetRowHeight=function(e){var t=this.m_rgLastRenderBuckets,n=this.GetListGroupForIndex(t,e.index);return n?0==n.index?28:36:0},e.prototype.RenderRow=function(e){var t=this,n=e.index,o=(e.isScrolling,e.key,e.isVisible,e.style),i=this.m_rgLastRenderBuckets,r=this.GetListGroupForIndex(i,n);if(!r)return null;n=r.index;var a=r.bucket;if(0==n)return Ee.createElement("div",{key:"group_"+a.id,style:o},Ee.createElement(qa,{collapsible:1<this.m_rgLastRenderBuckets.length,collapsed:this.BIsBucketCollapsed(a),memberCount:a.member_list.length,name:a.name,onToggleCollapse:function(){t.OnToggleBucketCollapsed(a)}}));var s=a.BIsGameGroup();n--;var c=a.member_list[n];return Ee.createElement("div",{key:c.accountid,style:o,className:"chatroomBucket_"+this.GetFriendlyNameForBucket(a.id)},Ee.createElement(Ka,{friend:c,bHideGameName:s,groupView:this.props.groupView,context:this.GetFriendRenderContext()}))},e.prototype.GetFriendlyNameForBucket=function(e){switch(e){case-1:return"partybeacon"}return"regular"},e.prototype.render=function(){var t=this;if(this.props.inactive)return null;var e=ci.GroupMemberStore.GetGroupMemberList(this.props.groupView.GetGroup().GetGroupID()),n=this.state.nBucketChanges;if(0==e.length)return null;var o=this.props.groupView.normalizedMemberSearch;0<o.length&&(e=this.BuildFilteredBuckets(e,o)),this.m_rgLastRenderBuckets=e;for(var i=0,r=0,a=e;r<a.length;r++){var s=a[r];i+=this.GetVisibleRowsForBucket(s)}var c,l=function(e){return Ee.createElement(Ra.b,{ref:t.m_refList,className:"ChatRoomMemberScrollList_List",width:e.width,height:e.height,rowCount:i,rowHeight:t.GetRowHeight,rowRenderer:t.RenderRow,bucketChanges:n})};return c=G.a.IN_CLIENT?Ee.createElement(Pa,{className:"friendGroup"},l):Ee.createElement(Ra.a,{className:"friendGroup"},l),Ee.createElement("div",{className:"chatRoomMembers CompactFriendsList groupMemberList",style:{position:"relative"}},c)},R.c([T.a],e.prototype,"OnMemberListChanged",null),R.c([T.a],e.prototype,"OnToggleBucketCollapsed",null),R.c([T.a],e.prototype,"GetRowHeight",null),R.c([T.a],e.prototype,"RenderRow",null),e=R.c([or.observer],e)}(Ee.Component),xa=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return R.d(t,e),t.prototype.OnSubmit=function(){var t=this,e=this.m_refInput&&this.m_refInput.value;e&&this.props.groupView.GetGroup().CreateChatRoom(e,this.props.bVoiceChannel).then(function(e){e&&(t.props.closeModal(),t.props.bJoinChannel&&(t.props.bVoiceChannel?e.StartVoiceChat():t.props.groupView.SelectChat(e.GetRoomID())))}).catch(function(e){yr(t.props.ownerWin,Object($.b)("#Generic_Error"),Object($.b)("#Chat_CreateChatRoom_GenericError")),t.props.closeModal()})},t.prototype.render=function(){var t=this;return Ee.createElement(sr,{onEscKeypress:this.props.closeModal},Ee.createElement(Fi,{classNameContent:"CreateChatChannelDialog",onSubmit:this.OnSubmit},Ee.createElement(wi,null,Object($.b)(this.props.bVoiceChannel?"#GroupSettings_Channels_CreateVoice":"#GroupSettings_Channels_CreateText")),Ee.createElement(Gi,null,Ee.createElement(Wi,{ref:function(e){t.m_refInput=e},autoFocus:!0,label:Object($.b)("#Chat_SaveVoiceRoom_Name")})),Ee.createElement(Mi,null,Ee.createElement(Hi,{onCancel:this.props.closeModal}))))},R.c([T.a],t.prototype,"OnSubmit",null),t}(Ee.Component);var Ua=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return R.d(t,e),t.prototype.OnCreateNewTextChannel=function(e){var t,n,o,i=Object(Ci.m)(e);this.props.groupView.GetGroup().BCanAdminChannel()&&(t=i,n=this.props.groupView,o=!1,fr(Ee.createElement(xa,{ownerWin:t,groupView:n,bVoiceChannel:o,bJoinChannel:!0}),t,"CreateChatChannelDialog",{strTitle:Object($.b)("#GroupSettings_Channels_CreateText"),popupWidth:664,popupHeight:280},pd(t)))},t.prototype.OnStartChannelRename=function(e){this.props.groupView.StartRoomRename(e)},t.prototype.OnChannelRename=function(e,t){this.props.groupView.GetGroup().RenameRoom(e,t)},t.prototype.OnEndChannelRename=function(){this.props.groupView.EndRoomRename()},t.prototype.ToggleCollapseExpand=function(){var e=this.props.groupView;e.SetChannelListCollapsed(!e.isChannelListCollapsed)},t.prototype.render=function(){var t=this,n=this.props.groupView,e=n.GetGroup().textRoomList,o=n.GetGroup().BCanAdminChannel(),i=n.isChannelListCollapsed;return Ee.createElement("div",{className:"chatRoomTextChannelsGroup"},Ee.createElement("div",{className:"ChannelTypeTitle",title:Object($.b)("#Tooltip_TextChannel")},Ee.createElement("div",{className:"ChannelTypeLabel"+(o?"":" NoPermission"),onClick:this.OnCreateNewTextChannel,title:o?Object($.b)("#Tooltip_TextChannelCreate"):Object($.b)("#Tooltip_NoPermissionChannelCreate")},o?Object($.b)("#Chat_AddTextChat"):Object($.b)("#Chat_CreateTextChannel_DefaultName")),Ee.createElement("div",{className:"chatRoomGroupNavCollapseExpand",title:Object($.b)(i?"#Tooltip_ExpandList":"#Tooltip_MinimizeList"),onClick:this.ToggleCollapseExpand},Ee.createElement(ui.m,null))),e.map(function(e){return Ee.createElement(ja,{key:e.unique_id,chat:e,bRenameActive:n.IsRoomRenameActive(e.GetRoomID()),bActiveChat:e==n.GetActiveChatView().chat,bDefaultRoom:e==n.GetGroup().GetDefaultChatRoom(),onStartRename:t.OnStartChannelRename,onRename:t.OnChannelRename,onEndRename:t.OnEndChannelRename})}))},R.c([T.a],t.prototype,"OnCreateNewTextChannel",null),R.c([T.a],t.prototype,"OnStartChannelRename",null),R.c([T.a],t.prototype,"OnChannelRename",null),R.c([T.a],t.prototype,"OnEndChannelRename",null),R.c([T.a],t.prototype,"ToggleCollapseExpand",null),t=R.c([or.observer],t)}(Ee.Component),ja=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return R.d(t,e),t.prototype.ToggleTextChat=function(){if(!this.props.bRenameActive){var e=ci.UIStore.IsChatRoomGroupActive(cd(this),this.props.chat.GetGroup()),t=ci.UIStore.ShowAndOrActivateChatRoomGroup(cd(this),this.props.chat.GetGroup(),!0),n=t.GetPopoverChatView();e&&n&&n.chat&&n.chat==this.props.chat?t.ClosePopoverChat():t.SelectChat(this.props.chat.GetRoomID())}},t.prototype.OnContextMenu=function(e){this.props.bRenameActive||Sa(cd(this,e),this.props.chat.GetGroup(),this.props.chat.GetRoomID(),e,this.props.onStartRename)},t.prototype.render=function(){var e=this.props.chat,t="chatRoomTextChannel";this.props.bActiveChat&&(t+=" ActiveTextChannel");var n="chatRoomTextChannelName";this.props.bDefaultRoom&&(n+=" IsCommonsChannel");var o=this.props.bRenameActive&&!this.props.chat.GetVoiceAllowed();return Ee.createElement("div",{className:t,onClick:this.ToggleTextChat,onContextMenu:this.OnContextMenu},Ee.createElement(wa,{chat:e}),Ee.createElement("div",{className:"chatRoomTextChannelIcon"},Ee.createElement(ui.Z,null)),!o&&Ee.createElement("div",{className:n},e.name),!this.props.bDefaultRoom&&o&&Ee.createElement(za,{chat:this.props.chat,onRename:this.props.onRename,onEndRename:this.props.onEndRename}))},R.c([T.a],t.prototype,"ToggleTextChat",null),R.c([T.a],t.prototype,"OnContextMenu",null),t=R.c([or.observer],t)}(Ee.Component),Ha=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return R.d(t,e),t.prototype.CreateVoiceRoom=function(){this.props.groupView.GetGroup().CreateAndJoinTempVoiceRoom()},t.prototype.OnVoiceRoomSelected=function(e){this.props.groupView.GetRenameRoomID()==e.GetRoomID()||(ci.ChatStore.VoiceChat.GetActiveVoiceChatID()==e.GetRoomID()||(this.props.groupView.ClosePopoverChat(),e.StartVoiceChat()))},t.prototype.OnStartChannelRename=function(e){this.props.groupView.StartRoomRename(e)},t.prototype.OnChannelRename=function(e,t){this.props.groupView.GetGroup().RenameRoom(e,t)},t.prototype.OnEndChannelRename=function(){this.props.groupView.EndRoomRename()},t.prototype.render=function(){var t=this,n=this.props.groupView,e=n.GetGroup().voiceRoomList;return Ee.createElement("div",{className:"chatRoomVoiceChannelsGroup"},Ee.createElement("div",{className:"ChannelTypeTitle",title:Object($.b)("#Tooltip_VoiceChannelCreate"),onClick:this.CreateVoiceRoom},Ee.createElement("div",{className:"ChannelTypeLabel"},Object($.b)("#Chat_AddVoiceChat")),Ee.createElement("div",{className:"ChatRoomAddRoomBtn",title:Object($.b)("#Tooltip_VoiceChannelCreate")},Ee.createElement(ui.K,null))),e.map(function(e){return Ee.createElement(Wa,{key:e.unique_id,context:"VoiceRoomsGroup",chat:e,bRenameActive:n.GetRenameRoomID()==e.GetRoomID(),onSelect:function(){t.OnVoiceRoomSelected(e)},onStartRename:t.OnStartChannelRename,onRename:t.OnChannelRename,onEndRename:t.OnEndChannelRename})}))},R.c([T.a],t.prototype,"CreateVoiceRoom",null),R.c([T.a],t.prototype,"OnVoiceRoomSelected",null),R.c([T.a],t.prototype,"OnStartChannelRename",null),R.c([T.a],t.prototype,"OnChannelRename",null),R.c([T.a],t.prototype,"OnEndChannelRename",null),t=R.c([or.observer],t)}(Ee.Component),Wa=function(n){function e(e){var t=n.call(this,e)||this;return t.state={dropToInviteFriend:void 0,bDropConfirmationNotice:!1},t}return R.d(e,n),e.prototype.OnContextMenu=function(e){this.props.bRenameActive||Sa(cd(this,e),this.props.chat.GetGroup(),this.props.chat.GetRoomID(),e,this.props.onStartRename),e.preventDefault(),e.stopPropagation()},e.prototype.InviteToChat=function(e){ua(cd(this,e),e.currentTarget.ownerDocument.defaultView,this.props.chat.GetGroup(),this.props.chat),e.stopPropagation()},e.prototype.OnDragEnter=function(e,t){if(Object(I.a)(e&&"friend"==e.type,"Invalid type passed to VoiceRoom.OnDragEnter"),e){var n=e;n.friend&&this.setState({dropToInviteFriend:n.friend})}return!0},e.prototype.OnDragLeave=function(){this.state.dropToInviteFriend&&this.setState({dropToInviteFriend:void 0})},e.prototype.OnDragOver=function(e){e.dataTransfer.dropEffect="move"},e.prototype.OnDrop=function(e,t){var n=this;if(Object(I.a)(e&&"friend"==e.type,"Invalid data type passed to ChatRoomGroupDialog.OnDrop"),e&&"friend"==e.type){var o=e;if(o.friend&&o.friend!=ci.FriendStore.self){this.state.dropToInviteFriend&&this.setState({dropToInviteFriend:void 0}),_d.DragDropManager.SetDropConsumed();var i=t.currentTarget.ownerDocument.defaultView;this.props.chat.GetGroup().BIsUserGroupMember(o.friend)?(this.props.chat.GetGroup().InviteFriend(o.friend.accountid,this.props.chat),this.setState({bDropConfirmationNotice:!0}),this.m_dropInviteInvitee=o.friend,this.m_dropConfirmationInterval=window.setInterval(function(){n.setState({bDropConfirmationNotice:!1}),window.clearInterval(n.m_dropConfirmationInterval)},1200)):Jp({invitee:o.friend,chatview:null,invitedto:this.props.chat},cd(this,t),i)}}},e.prototype.GetDragDropProps=function(){var e={rgAcceptedTypes:["friend"]};return e.fnDragEnter=this.OnDragEnter,e.fnDragOver=this.OnDragOver,e.fnDragLeave=this.OnDragLeave,e.fnDrop=this.OnDrop,e},e.prototype.GetFriendContext=function(){var e=this.props.chat&&this.props.chat.GetGroup().readyToRender?this.props.chat:null;return this.m_FriendContext&&this.m_FriendContext.chat==e||(this.m_FriendContext={chat:e}),this.m_FriendContext},e.prototype.render=function(){var t=this,e=this.props.chat.GetGroup(),n=this.props.chat==e.GetDefaultChatRoom(),o=ci.ChatStore.VoiceChat.GetActiveVoiceChatID()==this.props.chat.GetRoomID(),i=ci.CMInterface.steamid.GetAccountID(),r=ci.FriendStore.GetPlayer(i),a=this.props.chat.voice_active_contains_only_self,s="emptyChannelNotice",c=this.props.chat.voice_active_member_list.member_list.map(function(e){return Ee.createElement(li,{key:e.accountid,classNames:"friend-anim",timeout:320},Ee.createElement(zc,{friend:e,key:e.accountid,context:t.GetFriendContext(),showVoiceLevel:!0,bInVoiceList:!0}))}),l=this.props.chat.voice_active_contains_friends;o&&!this.props.chat.voice_active_contains_self&&(0==c.length&&(a=!0),l=!0,c.push(Ee.createElement(li,{key:i,classNames:"friend-anim",timeout:320},Ee.createElement(zc,{friend:r,key:i,context:this.GetFriendContext(),showVoiceLevel:!0}))));var p=["chatRoomVoiceChannel"];o&&p.push("ActiveVoiceChannel"),l||"ChatRoomList"!=this.props.context||p.push("MinimizeMemberList"),this.state.dropToInviteFriend&&p.push("voiceRoomActiveDrop"),o&&a&&(s+=" Visible");var u=this.props.chat.IsUnsavedVoiceChannel(),m=this.props.chat.name;return Ee.createElement(nr,R.a({className:p.join(" "),onClick:this.props.onSelect},this.GetDragDropProps()),Ee.createElement("div",{className:"chatRoomVoiceChannelIconGlow"}),Ee.createElement("div",{className:"chatRoomVoiceChannelNameContainer",onContextMenu:this.OnContextMenu},Ee.createElement("div",{className:"chatRoomVoiceChannelIcon"},Ee.createElement(ui.gb,null)),!this.props.bRenameActive&&Ee.createElement("div",{className:"chatRoomVoiceChannelName"+(u?" unsavedVoiceChannel":"")},m),this.props.bRenameActive&&Ee.createElement(za,{chat:this.props.chat,onRename:this.props.onRename,onEndRename:this.props.onEndRename}),!this.props.bRenameActive&&Ee.createElement(Ee.Fragment,null,Ee.createElement("div",{onContextMenu:this.OnContextMenu,onClick:this.OnContextMenu,className:"VoiceControlPanelButton chatPinRoom",title:"Channel Options"},Ee.createElement(ui.n,null)))),Ee.createElement("div",{className:"VoiceChannelParticipants CompactFriendsList"},!l&&c,l&&Ee.createElement(pi,{enter:!0,exit:!0},c)),Ee.createElement("div",{className:s},Object($.b)("#Chat_VoiceEmptyChannel")),Ee.createElement(wc,{name:m,chat:this.props.chat,nostatus:!0}),!n&&Ee.createElement(ja,{chat:this.props.chat,bRenameActive:!1,bActiveChat:!1,bDefaultRoom:!1}),Ee.createElement("div",{className:"ScratchPadConnect"}),this.state.bDropConfirmationNotice&&Ee.createElement("div",{className:"dropConfirmationNotice"+(this.state.bDropConfirmationNotice?" Active":"")},Ee.createElement("div",{className:"dropConfirmationLabel"},Ee.createElement("img",{className:"avatar",src:this.m_dropInviteInvitee.persona.avatar_url_medium}))),Ee.createElement("div",{className:"dropTargetBox"}))},R.c([T.a],e.prototype,"OnContextMenu",null),R.c([T.a],e.prototype,"InviteToChat",null),R.c([T.a],e.prototype,"OnDragEnter",null),R.c([T.a],e.prototype,"OnDragLeave",null),R.c([T.a],e.prototype,"OnDragOver",null),R.c([T.a],e.prototype,"OnDrop",null),e=R.c([or.observer],e)}(Ee.Component),za=function(n){function e(e){var t=n.call(this,e)||this;return t.m_strValue="",t.m_strValue=t.props.chat.name,t}return R.d(e,n),e.prototype.componentWillReceiveProps=function(e){this.props.chat!=e.chat&&(this.m_strValue=e.chat.name)},e.prototype.componentDidMount=function(){window.addEventListener("keydown",this.OnGlobalKeyDown,!1)},e.prototype.componentWillUnmount=function(){window.removeEventListener("keydown",this.OnGlobalKeyDown,!1)},e.prototype.BindInputRef=function(e){e&&e.focus()},e.prototype.OnChange=function(e){this.m_strValue=e.target.value},e.prototype.OnSubmit=function(e){this.SubmitAndClose(),e.preventDefault()},e.prototype.OnGlobalKeyDown=function(e){27==e.keyCode&&this.Close()},e.prototype.OnBlur=function(e){this.SubmitAndClose()},e.prototype.SubmitAndClose=function(){this.props.onRename(this.props.chat.GetRoomID(),this.m_strValue),this.Close()},e.prototype.Close=function(){this.props.onEndRename()},e.prototype.render=function(){return Ee.createElement("form",{className:"RenameChatRoomInline",onSubmit:this.OnSubmit},Ee.createElement("input",{ref:this.BindInputRef,type:"text",value:this.m_strValue,onChange:this.OnChange,onBlur:this.OnBlur}))},R.c([d.observable],e.prototype,"m_strValue",void 0),R.c([T.a],e.prototype,"BindInputRef",null),R.c([T.a],e.prototype,"OnChange",null),R.c([T.a],e.prototype,"OnSubmit",null),R.c([T.a],e.prototype,"OnGlobalKeyDown",null),R.c([T.a],e.prototype,"OnBlur",null),e=R.c([or.observer],e)}(Ee.Component),qa=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return R.d(t,e),t.prototype.OnToggleCollapsed=function(e){this.props.onToggleCollapse()},t.prototype.render=function(){var e=this.props.collapsed,t=this.props.memberCount,n=this.props.name,o="groupName";return e&&(o+=" Collapsed"),Ee.createElement("div",{className:o,onClick:this.OnToggleCollapsed},Ee.createElement("div",{className:"groupIcon"},Ee.createElement(ui.t,null)),this.props.collapsible&&Ee.createElement("div",{className:"ExpandPlusMinus"},Ee.createElement(ui.K,null)),Ee.createElement("span",{className:"groupCountCollapsed"},t),Ee.createElement("div",{className:"groupLabelsContainer"},Ee.createElement("span",{className:"groupNameLabel"},n),Ee.createElement("span",{className:"groupCount"},"(",t,")")))},R.c([T.a],t.prototype,"OnToggleCollapsed",null),t}(Ee.PureComponent),Ka=function(t){function e(e){return t.call(this,e)||this}return R.d(e,t),e.prototype.OnFriendSelected=function(){this.props.friend.OpenChatDialog(cd(null)),this.props.groupView.ClearMemberSearch()},e.prototype.render=function(){var e=[],t="",n=this.props.groupView,o=n.GetGroup(),i=n.isMemberListExpanded,r=o.GetMemberRank(this.props.friend.accountid),a=this.props.friend.efriendrelationship;switch(r){default:break;case 30:t="Moderator";break;case 40:t="Officer";break;case 50:t="Owner",o.BIsClanChatRoom()||e.push(Ee.createElement("div",{key:"rankIcon",className:"rankIcon rankOwner"+(this.props.friend.is_friend?" isFriend":"")},Ee.createElement(ui.j,null)))}switch(o.BIsClanChatRoom()&&(40<=r?e.push(Ee.createElement("div",{key:"rankIcon",className:"rankIcon rankOwner"},Ee.createElement("img",{src:G.a.COMMUNITY_CDN_URL+"public/images/skin_1/comment_modindicator_officer.png"}))):30<=r&&e.push(Ee.createElement("div",{key:"rankIcon",className:"rankIcon rankOwner"},Ee.createElement("img",{src:G.a.COMMUNITY_CDN_URL+"public/images/skin_1/comment_modindicator_moderator.png"})))),a){case 3:case 6:e.push(Ee.createElement("div",{key:"friendIcon",className:"chatMemberFriendIcon"},Ee.createElement(ui.q,null)));break;case 2:e.push(Ee.createElement("div",{key:"friendIcon",className:"chatMemberFriendIcon"},Ee.createElement(ui.q,{bPending:!0})))}o.GetMemberPartyBeacon(this.props.friend.accountid)&&e.push(Ee.createElement("div",{key:"playIcon",className:"chatMemberPartyBeaconIcon"},Ee.createElement(ui.J,null)));var s={friend:this.props.friend,context:this.props.context,className:t,action:this.OnFriendSelected,bHideGameName:this.props.bHideGameName};return i?Ee.createElement(zc,R.a({},s,{listStatusIndicatorLeft:e})):Ee.createElement(Kc,R.a({},s),e)},R.c([T.a],e.prototype,"OnFriendSelected",null),e=R.c([or.observer],e)}(Ee.Component),Ya=n("twdX"),Ja=n.n(Ya),Xa=function(t){function e(e){return t.call(this,e)||this}return R.d(e,t),e.prototype.AddSizeClass=function(e){"small"==this.props.size?e.push(Ja.a.throbber_small):"medium"==this.props.size?e.push(Ja.a.throbber_medium):"xlarge"==this.props.size?e.push(Ja.a.throbber_xlarge):e.push(Ja.a.throbber_large)},e.prototype.render=function(){var e=[Ja.a.LoadingWrapper,"SteamLogoThrobber"];this.AddSizeClass(e),void 0===this.props.string&&e.push(Ja.a.noString),this.props.className&&e.push(this.props.className);var t=Oe.a.createElement("div",{className:e.join(" ")},Oe.a.createElement("div",{className:Ja.a.Throbber},Oe.a.createElement(ui.ab,{className:Ja.a.base}),Oe.a.createElement(ui.ab,{className:Ja.a.blur})));return"center"==this.props.position&&(t=Oe.a.createElement("div",{className:Ja.a.throbber_center_wrapper},t,Oe.a.createElement("div",{className:Ja.a.ThrobberText},this.props.string))),t},e}(Oe.a.PureComponent);var Qa=function(n){function e(e){var t=n.call(this,e)||this;return t.m_inviteLinks={loadingState:"pending",rgInviteLinks:null},t.m_bans=new Ut,t.m_invitedUsers={loadingState:"pending",rgInvitedUsers:null},t.state={strRoomName:t.props.groupView.GetGroup().name},t}return R.d(e,n),e.prototype.DismissDialog=function(){this.props.closeModal()},e.prototype.CloseDialog=function(){this.props.closeModal()},e.prototype.OnLeave=function(e){var t=this,n=e.currentTarget.ownerDocument.defaultView,o=cd(null,e),i=this.props.groupView.GetGroup(),r=i.BIsClanChatRoom()?"#Chat_Actions_LeaveChatRoomGroup_ClanConfirm":i.BIsAccountIDOwner(ci.CMInterface.steamid.GetAccountID())?"#Chat_Actions_OwnerLeaveChatRoomGroup_Confirm":"#Chat_Actions_LeaveChatRoomGroup_Confirm";vr(n,Object($.b)("#GroupSettings_Leave_Section"),Object($.b)(r,i.name),Object($.b)("#GroupSettings_Leave_Button")).then(function(){i.LeaveChatRoomGroup(o)}).then(function(){t.props.closeModal()}).catch(function(){})},e.prototype.GetPageList=function(){var e=this.props.groupView.GetGroup(),t=[],n=(e.GetMyRank(),e.BCanAdminGroup()),o=e.BIsAccountIDOwner(ci.CMInterface.steamid.GetAccountID()),i=e.BCanInvite(),r=e.BCanAdminChannel(),a=e.BCanBan();return e.IsNamedGroupChat()?(t.push({title:Object($.b)("#GroupSettings_General_Section"),uniqueName:"GroupSettings_General",content:Ee.createElement($a,{group:e,enabled:n}),enabled:n}),t.push({title:Object($.b)("#GroupSettings_Channels_Section"),uniqueName:"GroupSettings_Channels",content:Ee.createElement(ns,{groupView:this.props.groupView,enabled:r}),enabled:r}),t.push({title:Object($.b)("#GroupSettings_Permissions_Section"),uniqueName:"GroupSettings_Permissions",content:Ee.createElement(is,{group:e,enabled:o}),enabled:o,hideTitle:!0}),t.push({title:Object($.b)("#GroupSettings_Invite_Section"),uniqueName:"GroupSettings_Invite",content:Ee.createElement(rs,{group:e,inviteLinks:this.m_inviteLinks,enabled:i}),enabled:i}),t.push({title:Object($.b)("#GroupSettings_InvitedUsers_Section"),uniqueName:"GroupSettings_InvitedUsers",content:Ee.createElement(as,{group:e,invitedUsers:this.m_invitedUsers,enabled:i}),enabled:i}),t.push({title:Object($.b)("#GroupSettings_Bans_Section"),uniqueName:"GroupSettings_Bans",content:Ee.createElement(ss,{group:e,bans:this.m_bans,enabled:a}),enabled:a})):(t.push({title:Object($.b)("#GroupSettings_Save_Section"),uniqueName:"GroupSettings_Save",content:Ee.createElement(Za,{group:e}),enabled:!0}),t.push({title:Object($.b)("#GroupSettings_Invite_Section"),uniqueName:"GroupSettings_Invite",content:Ee.createElement(rs,{group:e,inviteLinks:this.m_inviteLinks,enabled:i}),enabled:i})),t.push({title:Object($.b)("#GroupSettings_Leave_Section"),content:Ee.createElement(es,{group:e}),className:"ChatRoomLeave",click:this.OnLeave}),t},e.prototype.render=function(){var e=this.GetPageList();return Ee.createElement(sr,{onEscKeypress:this.DismissDialog},Ee.createElement(er,{title:Object($.b)("#GroupSettings"),className:"ChatRoomSettingsDialog",pages:e}))},R.c([d.observable],e.prototype,"m_inviteLinks",void 0),R.c([d.observable],e.prototype,"m_invitedUsers",void 0),R.c([T.a],e.prototype,"DismissDialog",null),R.c([T.a],e.prototype,"CloseDialog",null),R.c([T.a],e.prototype,"OnLeave",null),e=R.c([or.observer],e)}(Ee.Component),Za=function(n){function e(e){var t=n.call(this,e)||this;return t.m_bSaving=!1,t.m_strError="",t}return R.d(e,n),e.prototype.BindInputRef=function(e){this.m_refInput=e},e.prototype.OKToSwitchAway=function(){return!0},e.prototype.AnimateUpgrade_In=function(){document.getElementById("animUp")},e.prototype.AnimateUpgrade_Out=function(){document.getElementById("animDown")},e.prototype.SaveGroup=function(){var t=this,e=this.props.group;this.m_bSaving=!1,this.m_strError="",e.SaveChatRoomGroup(this.m_refInput.value).catch(function(e){t.m_bSaving=!1,t.m_strError=12==e?Object($.b)("#GroupSettings_Save_NameError"):Object($.b)("#GroupSettings_Save_GenericError")})},e.prototype.render=function(){var e=this.m_bSaving,t=this.m_strError;return Ee.createElement(Bi,{className:"DialogBody",onSubmit:this.SaveGroup},Ee.createElement(Ti,null,Object($.b)("#GroupSettings_Save_Desc"),Ee.createElement("div",null,Ee.createElement("ul",null,Ee.createElement("li",null,Object($.b)("#GroupSettings_Save_Feature_1")),Ee.createElement("li",null,Object($.b)("#GroupSettings_Save_Feature_2")),Ee.createElement("li",null,Object($.b)("#GroupSettings_Save_Feature_3")),Ee.createElement("li",null,Object($.b)("#GroupSettings_Save_Feature_4"))))),Ee.createElement(Wi,{ref:this.BindInputRef,autoFocus:!0,label:Object($.b)("#GroupSettings_Save_NameGroup"),disabled:e}),!e&&Ee.createElement(Ee.Fragment,null,0<t.length&&Ee.createElement("div",{className:"ErrorWhileSaving"},t),Ee.createElement(Vi,{className:"_FixedHeight"},Object($.b)("#GroupSettings_Save_Section"))),e&&Ee.createElement(Xa,null))},R.c([d.observable],e.prototype,"m_bSaving",void 0),R.c([d.observable],e.prototype,"m_strError",void 0),R.c([T.a],e.prototype,"BindInputRef",null),R.c([T.a],e.prototype,"AnimateUpgrade_In",null),R.c([T.a],e.prototype,"AnimateUpgrade_Out",null),R.c([T.a],e.prototype,"SaveGroup",null),e=R.c([or.observer],e)}($i),$a=function(n){function e(e){var t=n.call(this,e)||this;return t.m_strRoomName=t.props.group.IsNamedGroupChat()?t.props.group.name:"",t.m_strTagLine=t.props.group.tagline,t.state={bNameSubmitted:!1,bTaglineSubmitted:!1},t}return R.d(e,n),e.prototype.OKToSwitchAway=function(){return!0},e.prototype.AvatarUploadEResultToString=function(e){var t="#Chat_Settings_Error_Unknown";switch(e){case 21:t="#Chat_Settings_Error_NotLoggedOn";break;case 112:t="#Chat_Settings_Error_LimitedUser";break;case 15:t="#Chat_Settings_Error_AccessDenied";break;case 2:t="#Chat_Settings_Error_FailedToUpload";break;case 25:t="#Chat_Settings_Error_FileTooLarge";break;case 8:t="#Chat_Settings_Error_InvalidImage";break;case 37:t="#Chat_Settings_Error_ServerError"}return Object($.b)(t)},e.prototype.SetChatRoomGroupAvatarEResultToString=function(e){var t="#Chat_Settings_Error_Unknown";switch(e){case 10:case 8:case 32:t="#Chat_Settings_Error_ServerError";break;case 15:t="#Chat_Settings_Error_NotAdmin"}return Object($.b)(t)},e.prototype.OnFileChange=function(e){var n=this,t=e.target.files[0],o=this.props.group;e.preventDefault();var i=new FormData;i.set("sessionid",G.a.SESSIONID),i.set("avatar",t);C.a.post(G.a.CHAT_BASE_URL+"chat/avatarfileupload/",i,{headers:{"content-type":"multipart/form-data"}}).then(function(e){1==e.data.success&&o.SetChatRoomGroupAvatar(e.data.sha).catch(function(e){var t=n.SetChatRoomGroupAvatarEResultToString(e);yr(window,Object($.b)("#Generic_Error"),t)})}).catch(function(e){var t=n.AvatarUploadEResultToString(e.response.data.success);yr(window,Object($.b)("#Generic_Error"),t),console.log(e.response)})},e.prototype.bindFileUploadControl=function(e){this.m_fileInput=e},e.prototype.OnNameChange=function(e){this.m_strRoomName=e.target.value,this.setState({bNameSubmitted:!1})},e.prototype.OnAvatarChange=function(){this.m_fileInput.click()},e.prototype.OnTagLineChange=function(e){this.m_strTagLine=e.target.value,this.setState({bTaglineSubmitted:!1})},e.prototype.OnNameBlur=function(){var e=this.props.group;(e.IsNamedGroupChat()||this.m_strRoomName)&&(e.IsNamedGroupChat()&&e.name==this.m_strRoomName||(e.RenameChatRoomGroup(this.m_strRoomName),document.getElementById("b1").blur(),this.setState({bNameSubmitted:!0})))},e.prototype.OnTagLineBlur=function(){var e=this.props.group;e.tagline!=this.m_strTagLine&&(e.SetChatRoomGroupTagline(this.m_strTagLine),this.setState({bTaglineSubmitted:!0}),document.getElementById("b2").blur())},e.prototype.OnSubmitSent=function(){this.OnTagLineBlur(),this.OnNameBlur()},e.prototype.render=function(){var e;if(this.props.group.BIsClanChatRoom())e=Ee.createElement("div",null);else if(null==this.props.group.GetOwnerAccountID())e=Ee.createElement("div",null," ",Object($.b)("#Chat_Settings_No_Owner")," ");else{var t=ci.FriendStore.GetPlayer(this.props.group.GetOwnerAccountID());e=Ee.createElement("div",null,Ee.createElement(Di,null," ",Object($.b)("#Chat_Settings_General_Owner")),Ee.createElement(zc,{className:"groupOwnerFriend",friend:t,context:null}))}return Ee.createElement(Bi,{onSubmit:this.OnSubmitSent,className:"DialogBody"},Ee.createElement(Li,null,Ee.createElement("div",{className:"AvatarAndUser"},Ee.createElement(Di,null,Object($.b)("#Chat_Settings_General_Icon")),Ee.createElement("img",{className:"currentUserAvatar largeAvatar no-drag",src:this.props.group.hasAvatar?this.props.group.avatar_url_full:"data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs="}),!this.props.group.hasAvatar&&Ee.createElement("div",{className:"noIconLabel"},Object($.b)("#Chat_Settings_General_NoIcon")),Ee.createElement("input",{type:"file",style:{display:"none"},name:"fileupload",accept:".png, .jpg, .jpeg, .gif",ref:this.bindFileUploadControl,onChange:this.OnFileChange}),Ee.createElement(xi,{onClick:this.OnAvatarChange,disabled:!this.props.enabled},Object($.b)(this.props.group.hasAvatar?"#Chat_Settings_General_ChangeIcon":"#Chat_Settings_General_AddIcon"))),Ee.createElement("div",{className:"GeneralChatSettings"},Ee.createElement(Wi,{autoComplete:"off",id:"b1",className:"groupChatName",label:Object($.b)("#Chat_Settings_General_Chat_Name"),type:"text",value:this.m_strRoomName,onChange:this.OnNameChange,onBlur:this.OnNameBlur,autoFocus:!0,disabled:!this.props.enabled}),Ee.createElement("input",{type:"submit",style:{display:"none"}}),Ee.createElement(Wi,{autoComplete:"off",id:"b2",className:"groupChatTag",label:Object($.b)("#Chat_Settings_General_Tagline"),type:"text",value:this.m_strTagLine,onChange:this.OnTagLineChange,onBlur:this.OnTagLineBlur,disabled:!this.props.enabled}),e)))},R.c([d.observable],e.prototype,"m_strRoomName",void 0),R.c([d.observable],e.prototype,"m_strTagLine",void 0),R.c([T.a],e.prototype,"OnFileChange",null),R.c([T.a],e.prototype,"bindFileUploadControl",null),R.c([T.a],e.prototype,"OnNameChange",null),R.c([T.a],e.prototype,"OnAvatarChange",null),R.c([T.a],e.prototype,"OnTagLineChange",null),R.c([T.a],e.prototype,"OnNameBlur",null),R.c([T.a],e.prototype,"OnTagLineBlur",null),R.c([T.a],e.prototype,"OnSubmitSent",null),e=R.c([or.observer],e)}($i),es=function(t){function e(e){return t.call(this,e)||this}return R.d(e,t),e.prototype.OKToSwitchAway=function(){return!0},e.prototype.OnLeave=function(e){var t=this,n=e.currentTarget.ownerDocument.defaultView,o=cd(null,e),i=this.props.group.BIsClanChatRoom()?"#Chat_Actions_LeaveChatRoomGroup_ClanConfirm":this.props.group.BIsAccountIDOwner(ci.CMInterface.steamid.GetAccountID())?"#Chat_Actions_OwnerLeaveChatRoomGroup_Confirm":"#Chat_Actions_LeaveChatRoomGroup_Confirm";vr(n,Object($.b)("#GroupSettings_Leave_Section"),Object($.b)(i,this.props.group.name),Object($.b)("#GroupSettings_Leave_Button")).then(function(){t.props.group.LeaveChatRoomGroup(o)}).catch(function(){})},e.prototype.render=function(){return Ee.createElement("div",null,Object($.b)("#GroupSettings_Leave_Confirm"),Ee.createElement(xi,{onClick:this.OnLeave},Object($.b)("#GroupSettings_Leave_Button")))},R.c([T.a],e.prototype,"OnLeave",null),e=R.c([or.observer],e)}($i),ts=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return R.d(t,e),t.prototype.render=function(){var e=this,t=this.props.roomList.indexOf(this.props.room);Object(I.a)(-1!==t,"Couldn't find CChatRoom inside of its list?");var n=t-1,o=function(){e.props.room.GetGroup().ReorderRoom(e.props.roomList[n].GetRoomID(),e.props.room.GetRoomID())},i=t+1,r=function(){e.props.room.GetGroup().ReorderRoom(e.props.room.GetRoomID(),e.props.roomList[i].GetRoomID())};return(n<0||this.props.roomList[n].BIsDefaultRoom())&&(o=void 0),i>=this.props.roomList.length&&(r=void 0),this.props.room.BIsDefaultRoom()&&(r=o=void 0),this.props.enabled||(r=o=void 0),void 0===o&&void 0===r?null:Ee.createElement("div",{className:"rolePriorityContainer"},Ee.createElement("div",{className:"rolePriorityButton roleUp"+(void 0===o?" Disabled":""),onClick:o},Ee.createElement(ui.p,{angle:0})),Ee.createElement("div",{className:"rolePriorityButton roleDown"+(void 0===r?" Disabled":""),onClick:r},Ee.createElement(ui.p,{angle:180})))},t=R.c([or.observer],t)}(Ee.Component),ns=function(t){function e(e){return t.call(this,e)||this}return R.d(e,t),e.prototype.OKToSwitchAway=function(){return!0},e.prototype.OnCreateNewTextChannel=function(e){var t=e.currentTarget.ownerDocument.defaultView;fr(Ee.createElement(xa,{ownerWin:t,groupView:this.props.groupView,bVoiceChannel:!1,bJoinChannel:!1}),t)},e.prototype.OnCreateNewVoiceChannel=function(e){var t=e.currentTarget.ownerDocument.defaultView;fr(Ee.createElement(xa,{ownerWin:t,groupView:this.props.groupView,bVoiceChannel:!0,bJoinChannel:!1}),t)},e.prototype.OnDeleteChannel=function(e,n){vr(e.currentTarget.ownerDocument.defaultView,Object($.b)("#GroupSettings_Channels_DeleteChannel"),Object($.b)("#GroupSettings_Channels_DeleteConfirm"),Object($.b)("#GroupSettings_Channels_DeleteButtonLabel"),Object($.b)("#Button_Cancel"),!0).then(function(){var e=n.GetGroup(),t=n.GetRoomID();e.DeleteChatRoom(t)}).catch(function(){})},e.prototype.render=function(){var o=this,i=this.props.groupView.GetGroup().textRoomList,r=this.props.groupView.GetGroup().voiceRoomList,t=function(t,e,n){return Ee.createElement("div",{key:t.GetRoomID(),className:"ChatGroupSettingsChannels_Row"},Ee.createElement("div",{className:"_DialogRow _DialogRowBackground"},Ee.createElement("div",{className:"_DialogRowLabel"},n?Ee.createElement(ui.gb,null):Ee.createElement(ui.Z,null),Ee.createElement("div",{className:t.IsDefaultRoomForGroup()?"HomeChannel":"",style:{alignSelf:"center"}},t.name)),t.IsDefaultRoomForGroup()&&Ee.createElement("div",{className:"_DialogRowSecondaryLabel"},Object($.b)("#GroupSettings_Channels_HomeChannelDeleteLabel")),!t.IsDefaultRoomForGroup()&&o.props.enabled&&Ee.createElement("div",{className:"ChannelDeleteButton",onClick:function(e){return o.OnDeleteChannel(e,t)}},Object($.b)("#GroupSettings_Channels_Delete"))),Ee.createElement(ts,{room:t,roomList:n?r:i,enabled:o.props.enabled}))},e=i.map(function(e){return t(e,name,!1)}),n=r.map(function(e){return t(e,name,!0)});return Ee.createElement(Bi,{className:"DialogBody"},Ee.createElement(wi,null,Ee.createElement(Li,null,Ee.createElement(xi,{className:"DialogButtonTall",svgicon:ui.Z,onClick:this.OnCreateNewTextChannel,disabled:!this.props.enabled}," ",Object($.b)("#GroupSettings_Channels_CreateText")," "),Ee.createElement(xi,{className:"DialogButtonTall",svgicon:function(){return ui.gb({})},onClick:this.OnCreateNewVoiceChannel,disabled:!this.props.enabled}," ",Object($.b)("#GroupSettings_Channels_CreateVoice")," "))),Ee.createElement(Ri,null,0!=e.length&&Ee.createElement("div",{className:"displayColumn flexShrinkNone",style:{marginBottom:"32px"}},Ee.createElement(Di,null,Object($.b)("#GroupSettings_Channels_TextChannels")),Ee.createElement(ji,null),e),0!=n.length&&Ee.createElement("div",{className:"displayColumn flexShrinkNone"},Ee.createElement(Di,null,Object($.b)("#GroupSettings_Channels_VoiceChannels")),Ee.createElement(ji,null),n)))},R.c([T.a],e.prototype,"OnCreateNewTextChannel",null),R.c([T.a],e.prototype,"OnCreateNewVoiceChannel",null),R.c([T.a],e.prototype,"OnDeleteChannel",null),e=R.c([or.observer],e)}($i),os=function(n){function e(e){var t=n.call(this,e)||this;ci.FriendStore.self;return t.state={strRoleName:""},t}return R.d(e,n),e.prototype.OnSubmit=function(){var t=this,e=this.m_refInput&&this.m_refInput.value.trim();e&&0!=e.length&&(this.props.closeModal(),this.props.group.CreateRole(e).catch(function(e){yr(t.props.ownerWin,Object($.b)("#Generic_Error"),Object($.b)("#GroupSettings_CreateRole_GenericError")),t.props.closeModal()}))},e.prototype.HandleTextEntry=function(e){this.setState({strRoleName:e.target.value})},e.prototype.render=function(){var t=this,e=0<this.state.strRoleName.length;return Ee.createElement(sr,{onEscKeypress:this.props.closeModal},Ee.createElement(Fi,{classNameContent:"CreateChatChannelDialog",onSubmit:this.OnSubmit},Ee.createElement(wi,null,Object($.b)("#GroupSettings_CreateRole_Title")),Ee.createElement(Gi,null,Ee.createElement(Wi,{ref:function(e){t.m_refInput=e},autoFocus:!0,label:Object($.b)("#GroupSettings_CreateRole_Description"),value:this.state.strRoleName,onChange:this.HandleTextEntry})),Ee.createElement(Mi,null,Ee.createElement(Hi,{onCancel:this.props.closeModal,bOKDisabled:!e}))))},R.c([T.a],e.prototype,"OnSubmit",null),R.c([T.a],e.prototype,"HandleTextEntry",null),e}(Ee.Component),is=function(n){function e(e){var t=n.call(this,e)||this;return t.state={editRoleID:void 0,editRoleName:void 0,editRoleActions:void 0},t}return R.d(e,n),e.prototype.OKToSwitchAway=function(){return!0},e.prototype.OnCreateRole=function(e){var t=e.currentTarget.ownerDocument.defaultView;fr(Ee.createElement(os,{ownerWin:t,group:this.props.group}),t)},e.prototype.BCanLocalUserEditRole=function(e){return this.props.group.BCanIModifyRole(e)},e.prototype.BCanLocalUserAssignRole=function(){return this.props.group.BCanIAssignRoles()},e.prototype.EditRole=function(e){var t=this.props.group.GetRoleName(e),n=this.props.group.GetRoleActions(e);t&&n&&this.setState({editRoleID:e,editRoleName:t,editRoleActions:n})},e.prototype.RenameRole=function(e,t){var n=this;this.props.group.RenameRole(e,t).catch(function(e){n.setState({editRoleName:n.props.group.GetRoleName(n.state.editRoleID)})})},e.prototype.DeleteRole=function(e,t){var n=this,o=e.currentTarget.ownerDocument.defaultView;if(t!=this.props.group.DefaultRoleID()){var i=this.props.group.GetRoleName(t),r=Ee.createElement("div",{style:{marginTop:"8px",color:"white"}},i);vr(window,Object($.b)("#GroupSettings_Permissions_ConfirmDeleteTitle"),Object($.b)("#GroupSettings_Permissions_ConfirmDelete"),Object($.b)("#GroupSettings_Permissions_ConfirmDeleteButton"),Object($.b)("#Button_Cancel"),!0,r).then(function(){return n.props.group.DeleteRole(t)}).then(function(){n.setState({editRoleID:void 0})}).catch(function(e){null!=e&&yr(o,Object($.b)("#Generic_Error"),Object($.b)("#GroupSettings_DeleteRole_GenericError"))})}},e.prototype.OnEditRoleNameChange=function(e){this.setState({editRoleName:e.target.value})},e.prototype.OnEditRoleNameBlur=function(){this.RenameRole(this.state.editRoleID,this.state.editRoleName),document.getElementById("b1").blur()},e.prototype.DoesRoleGrantPermission=function(e,t){return!0},e.prototype.OnSettingToggled=function(e,t){this.props.group.SetRoleAction(this.state.editRoleID,e,t)},e.prototype.PermissionToggleRow=function(t){var n=this,e=!1,o=this.props.group.GetRoleActions(this.state.editRoleID);return o&&(e=o.BCanPerformAction(t.eAction)),Ee.createElement(Ji,{key:t.eAction,onChange:function(e){n.OnSettingToggled(t.eAction,e)},label:t.strLabel,checked:e,disabled:t.disabled})},e.prototype.MoveRoleUp=function(e){var t=this,n=this.props.group.GetRoleOrdinal(e),o=Math.max(0,n-1);this.props.group.ReorderRole(e,o).then(function(e){t.forceUpdate()})},e.prototype.MoveRoleDown=function(e){var t=this,n=this.props.group.GetRoleOrdinal(e)+1;this.props.group.ReorderRole(e,n).then(function(e){t.forceUpdate()})},e.prototype.render=function(){var a=this,s=this.props.group.BIsClanChatRoom();if(null!=this.state.editRoleID&&this.props.group.GetRoleActions(this.state.editRoleID)){var e=this.PermissionToggleRow,t=this.state.editRoleID==this.props.group.DefaultRoleID(),n=t&&!s?Object($.b)("#ChatRoomRole_Member"):this.state.editRoleName,o=this.BCanLocalUserEditRole(this.state.editRoleID);return Ee.createElement(Bi,{onSubmit:this.OnEditRoleNameBlur},Ee.createElement("div",null,Ee.createElement(wi,{style:{opacity:.25,marginBottom:0}},Object($.b)("#GroupSettings_Permissions_Section")),Ee.createElement(Ui,{className:"backToPermissionsButton allCaps",onClick:function(){a.setState({editRoleID:void 0})},svgicon:ui.Y},Object($.b)("#GroupSettings_Permissions_BackButton"))),Ee.createElement(wi,{className:"permissionDetailsPage"},!o&&Ee.createElement(Ni,null,Ee.createElement(ui.z,null),Object($.b)("#Chat_Settings_Permission_Denied")),Ee.createElement("div",{className:"roleEditHeader"},!s&&Ee.createElement(Wi,{autoComplete:"off",id:"b1",className:"editRoleName",label:Object($.b)("#GroupSettings_Permissions_RoleName"),type:"text",value:n,disabled:t||!o,onChange:this.OnEditRoleNameChange,onBlur:this.OnEditRoleNameBlur}),s&&Object($.b)(n))),Ee.createElement(Gi,null,Ee.createElement("div",{className:"SettingsGroup PermissionsGroup"},Ee.createElement(Di,{className:"PermissionsSectionHeader"},Object($.b)("#GroupSettings_Permissions_Heading_General")),Ee.createElement(e,{eAction:6,strLabel:Object($.b)("#GroupSettings_Permissions_Chat"),disabled:!o}),Ee.createElement(e,{eAction:10,strLabel:Object($.b)("#GroupSettings_Permissions_MentionAll"),disabled:!o}),Ee.createElement(e,{eAction:11,strLabel:Object($.b)("#GroupSettings_Permissions_SetWatchingBroadcast"),disabled:!o})),Ee.createElement("div",{className:"SettingsGroup PermissionsGroup"},Ee.createElement(Di,{className:"PermissionsSectionHeader"},Object($.b)("#GroupSettings_Permissions_Heading_MembersAndRoles")),Ee.createElement(e,{eAction:2,strLabel:Object($.b)("#GroupSettings_Permissions_Kick"),disabled:!o}),Ee.createElement(e,{eAction:3,strLabel:Object($.b)("#GroupSettings_Permissions_Ban"),disabled:!o}),Ee.createElement(e,{eAction:4,strLabel:Object($.b)("#GroupSettings_Permissions_Invite"),disabled:!o}),Ee.createElement(e,{eAction:8,strLabel:Object($.b)("#GroupSettings_Permissions_ChangeGroupRoles"),disabled:!o||t}),!s&&Ee.createElement(e,{eAction:9,strLabel:Object($.b)("#GroupSettings_Permissions_ChangeUserRoles"),disabled:!o||t})),Ee.createElement("div",{className:"SettingsGroup PermissionsGroup"},Ee.createElement(Di,{className:"PermissionsSectionHeader"},Object($.b)("#GroupSettings_Permissions_Heading_RoomManagement")),Ee.createElement(e,{eAction:5,strLabel:Object($.b)("#GroupSettings_Permissions_ChangeTaglineAvatarName"),disabled:!o}),Ee.createElement(e,{eAction:1,strLabel:Object($.b)("#GroupSettings_Permissions_CreateRenameDeleteChannel"),disabled:!o}))),Ee.createElement(Mi,null,!s&&!t&&o&&Ee.createElement(xi,{className:"deleteButton",onClick:function(e){a.DeleteRole(e,a.state.editRoleID)}},Object($.b)("#GroupSettings_Permissions_DeleteRoleButton"))))}var c=this.props.group.DefaultRoleID(),l=this.props.group.GetRoles().slice().sort(function(e,t){return e.role_id==c?1:t.role_id==c?-1:e.ordinal-t.ordinal}),i=this.props.group.GetHighestRankRoleIDForPermission(ci.FriendStore.self.accountid,8),p=i?this.props.group.GetRoleOrdinal(i):Number.MAX_VALUE-1,u=this.props.group.BIsAccountIDOwner(ci.FriendStore.self.accountid),m=!1,r=this.BCanLocalUserAssignRole(),d=l.map(function(t,e){var n=!1,o=a.BCanLocalUserEditRole(t.role_id),i=o&&(u||t.ordinal>p+1)&&0<t.ordinal,r=o&&e<l.length-2;return o&&(m=!0),t.role_id==c?r=i=!(n=!0):a.props.group.BMemberHasRole(ci.FriendStore.self.accountid,t.role_id)&&(n=!0),Ee.createElement("div",{className:"roleRow",key:t.role_id},Ee.createElement(xi,{className:"roleButton"+(n&&!u?" currentUserRole":""),onClick:function(e){a.EditRole(t.role_id)}},Ee.createElement(ui.k,null),Object($.b)(t.name),Ee.createElement("span",{className:"roleSubtitle"},o?Object($.b)("#Generic_Edit"):Object($.b)("#Generic_View"))),!s&&m&&2<l.length&&(i||r)&&Ee.createElement("div",{className:"rolePriorityContainer"},Ee.createElement("div",{className:"rolePriorityButton roleUp"+(i?"":" Disabled"),onClick:function(e){a.MoveRoleUp(t.role_id),e.stopPropagation()}},Ee.createElement(ui.p,{angle:0})),Ee.createElement("div",{className:"rolePriorityButton roleDown"+(r?"":" Disabled"),onClick:function(e){a.MoveRoleDown(t.role_id),e.stopPropagation()}},Ee.createElement(ui.p,{angle:180}))))}),h=Object($.b)("#ChatRoomRole_Description_NoEdit");if(s){var _=D.a.InitFromClanID(this.props.group.GetClanID()),f=G.a.COMMUNITY_BASE_URL+"gid/"+_.ConvertTo64BitString()+"/membersManage";h=Object($.d)("#ChatRoomRole_Description_Clan",Ee.createElement(Ar,{href:f},Object($.b)("#ChatRoomRole_Description_ClanLink")))}else m&&!u?h=Object($.b)("#ChatRoomRole_Description"):(r||u)&&(h=Object($.b)("#ChatRoomRole_Description_NoEditCanAssign"));return Ee.createElement("div",{className:"roleList"},Ee.createElement(wi,null,Object($.b)("#GroupSettings_Permissions_Section"),!this.props.enabled&&!m&&Ee.createElement(Ni,null,Ee.createElement(ui.z,null),Object($.b)("#Chat_Settings_Permission_Denied_Permissions"))),Ee.createElement(Ti,null,h),Ee.createElement("div",{className:"roleEditHeader"},Ee.createElement(Di,null,Object($.b)("#GroupSettings_Permissions_RolesTitle")," "),!u&&Ee.createElement(Di,{className:"meKey"},Ee.createElement(ui.k,null),Object($.b)("#GroupSettings_meKey_Desc")),u&&Ee.createElement(Di,{className:"meKey"},Ee.createElement(ui.j,null),Object($.b)("#GroupSettings_meKey_Desc_Owner"))),Ee.createElement(Bi,{className:"DialogBody"},Ee.createElement(xi,{disabled:!0,className:"roleButton owner",svgicon:ui.j,onClick:function(){}},Object($.b)("#ChatRoomRole_Owner"),Ee.createElement("span",{className:"roleSubtitle"},Object($.b)("#ChatRoomRole_OwnerSubtitle"))),d),!s&&Ee.createElement(Vi,{className:"createNewRoleButton",svgicon:ui.K,onClick:this.OnCreateRole,disabled:!this.props.group.BCanICreateRoles()},Object($.b)("#GroupSettings_Permissions_CreateNew")))},R.c([T.a],e.prototype,"OnCreateRole",null),R.c([T.a],e.prototype,"EditRole",null),R.c([T.a],e.prototype,"RenameRole",null),R.c([T.a],e.prototype,"DeleteRole",null),R.c([T.a],e.prototype,"OnEditRoleNameChange",null),R.c([T.a],e.prototype,"OnEditRoleNameBlur",null),R.c([T.a],e.prototype,"OnSettingToggled",null),R.c([T.a],e.prototype,"PermissionToggleRow",null),R.c([T.a],e.prototype,"MoveRoleUp",null),R.c([T.a],e.prototype,"MoveRoleDown",null),e=R.c([or.observer],e)}($i),rs=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return R.d(t,e),t.prototype.OKToSwitchAway=function(){return!0},t.prototype.componentWillMount=function(){var t=this.props.inviteLinks;if("loaded"!=t.loadingState){var e=this.props.group;this.props.enabled&&"pending"==t.loadingState?e.GetInviteLinksForGroup().then(function(e){setTimeout(function(){"loaded"==e.loadingState&&(t.rgInviteLinks=e.rgInviteLinks.sort(function(e,t){return e.time_expires()-t.time_expires()})),t.loadingState=e.loadingState},500)}):this.props.inviteLinks.loadingState="denied"}},t.prototype.OnDeleteLink=function(n){var e=this,o=this.props.inviteLinks,t=Ee.createElement("div",{style:{marginTop:"5px",color:"#dee2e5"}},Object(he.a)(n.invite_code()));vr(window,Object($.b)("#GroupSettings_Invite_ConfirmDeleteTitle"),Object($.b)("#GroupSettings_Invite_ConfirmDelete"),Object($.b)("#GroupSettings_Invite_ConfirmDeleteButton"),Object($.b)("#Button_Cancel"),!0,t).then(function(){e.props.group.DeleteInviteLink(n.invite_code()).then(function(e){Object(I.a)("loaded"==o.loadingState,"somehow got a valid link to delete without links being loaded");var t=o.rgInviteLinks.findIndex(function(e){return e.invite_code()==n.invite_code()});0<=t&&(o.rgInviteLinks.splice(t,1),console.log("removed link",o.rgInviteLinks))})}).then(function(){}).catch(function(){})},t.prototype.FormatExpires=function(e){return 2145916800<e?Object($.b)("#GroupSettings_Invite_NeverExpires"):ci.RTime32ToDate(e).toLocaleString([],{year:"numeric",month:"numeric",day:"numeric",hour:"numeric",minute:"numeric"})},t.prototype.HandleFocus=function(e){e.target.select()},t.prototype.render=function(){var n=this,e=this.props.inviteLinks,t=void 0;if("pending"==e.loadingState)t=Ee.createElement("div",null,Ee.createElement(Xa,null));else if("denied"==e.loadingState)t=Ee.createElement("div",null,Object($.b)("#GroupSettings_Invite_Denied"));else if("failed"==e.loadingState)t=Ee.createElement("div",null,Object($.b)("#GroupSettings_Invite_Failed"));else if("loaded"==e.loadingState){var o;t=0==(o=e.rgInviteLinks.map(function(t){return Ee.createElement("tr",{key:t.invite_code()},Ee.createElement("td",null," ",Ee.createElement(Wi,{className:"inviteURLLink",value:Object(he.a)(t.invite_code()),readOnly:!0,onClick:n.HandleFocus,onFocus:n.HandleFocus})," "),Ee.createElement("td",{className:"dateCell allCaps"}," ",n.FormatExpires(t.time_expires())," "),Ee.createElement("td",{className:"buttonCell"},Ee.createElement(xi,{onClick:function(e){return n.OnDeleteLink(t)},disabled:!n.props.enabled},Object($.b)("#GroupSettings_Invite_Delete"))))})).length?Ee.createElement("div",null,Object($.b)("#GroupSettings_Invite_NoInvites")):Ee.createElement("table",{className:"DialogSpanningTable InviteLinksTable"},Ee.createElement("thead",null,Ee.createElement("tr",null,Ee.createElement("th",{className:"inviteCodeColumn"}," ",Object($.b)("#GroupSettings_Invite_Code")," "),Ee.createElement("th",{className:"dateColumn"}," ",Object($.b)("#GroupSettings_Invite_Expiration")," "),Ee.createElement("th",{className:"buttonColumn"}," "))),Ee.createElement("tbody",null,o))}return Ee.createElement(Bi,{className:"DialogBody"},this.props.enabled&&Ee.createElement("div",{className:"inviteLinkContainer"},Ee.createElement(da,{chat:this.props.group.GetDefaultChatRoom(),disabled:!this.props.enabled})),this.props.enabled&&Ee.createElement("div",{className:"OrSeparator"},Ee.createElement(ji,null)),t)},R.c([T.a],t.prototype,"OnDeleteLink",null),R.c([T.a],t.prototype,"HandleFocus",null),t=R.c([or.observer],t)}($i),as=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return R.d(t,e),t.prototype.OKToSwitchAway=function(){return!0},t.prototype.componentWillMount=function(){var t=this.props.invitedUsers;if("loaded"!=t.loadingState){var e=this.props.group;"pending"==t.loadingState&&e.GetInvitedUsersForGroup().then(function(e){setTimeout(function(){"loaded"==e.loadingState&&(t.rgInvitedUsers=e.rgInvitedUsers.sort(function(e,t){return e.time_invited()-t.time_invited()})),t.loadingState=e.loadingState},500)})}},t.prototype.RevokeInvite=function(e,t){var n=this,o=ci.FriendStore.GetPlayer(t),i=e.currentTarget.ownerDocument.defaultView,r=Ee.createElement(zc,{className:"friend",friend:o,context:null,disableContextMenu:!0});vr(window,Object($.b)("#GroupSettings_InvitedUsers_RevokeTitle"),Object($.b)("#GroupSettings_InvitedUsers_RevokeBody"),Object($.b)("#GroupSettings_InvitedUsers_RevokeConfirm"),Object($.b)("#Button_Cancel"),!0,r).then(function(){n.props.group.RevokeInvite(t).then(function(){M.e(n.props.invitedUsers.rgInvitedUsers,function(e){return e.accountid()===t})}).catch(function(e){yr(i,Object($.b)("#Generic_Error"),Object($.b)("#GroupSettings_InvitedUsers_RevokeGenericError"))})}).catch(function(){})},t.prototype.FormatDate=function(e){return ci.RTime32ToDate(e).toLocaleString([],{year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"numeric"})},t.prototype.render=function(){var n=this;if("loaded"!=this.props.invitedUsers.loadingState)return Ee.createElement(Bi,null,"pending"==this.props.invitedUsers.loadingState?Ee.createElement(Xa,{size:"medium"}):Object($.b)("#GroupSettings_InvitedUsers_Failed"));if(!this.props.invitedUsers.rgInvitedUsers||0==this.props.invitedUsers.rgInvitedUsers.length)return Ee.createElement(Bi,null,Object($.b)("#GroupSettings_InvitedUsers_Noone"));var e=this.props.invitedUsers.rgInvitedUsers.map(function(t){var e=ci.FriendStore.GetPlayer(t.accountid());return Ee.createElement("tr",{className:"hoverRow",key:t.accountid()},Ee.createElement("td",{className:"friendCell"}," ",Ee.createElement(zc,{friend:e,context:null,bHideGameName:!0,bHidePersona:!0})," "),Ee.createElement("td",{className:"dateCell"}," ",n.FormatDate(t.time_invited())," "),Ee.createElement("td",{className:"buttonCell"},Ee.createElement(xi,{onClick:function(e){return n.RevokeInvite(e,t.accountid())},disabled:!n.props.enabled},Object($.b)("#GroupSettings_InvitedUsers_RevokeInvite"))))});return Ee.createElement(Bi,{className:"DialogBody"},Ee.createElement("table",{className:"DialogSpanningTable InvitedUsersTable"},Ee.createElement("thead",null,Ee.createElement("tr",{className:"headerRow"},Ee.createElement("th",{className:"friendColumn"},Object($.b)("#GroupSettings_InvitedUsers_InvitedHeader")," "),Ee.createElement("th",{className:"dateColumn"}," ",Object($.b)("#GroupSettings_InvitedUsers_InvitedDate")," "),Ee.createElement("th",{className:"buttonColumn"}," "))),Ee.createElement("tbody",null,e)))},R.c([T.a],t.prototype,"RevokeInvite",null),t=R.c([or.observer],t)}($i),ss=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return R.d(t,e),t.prototype.OKToSwitchAway=function(){return!0},t.prototype.componentWillMount=function(){var e=this.props.group,t=this.props.bans;"pending"==t.loadingState&&e.GetBanList().then(function(e){setTimeout(function(){t.rgBans=e.rgBans,t.loadingState=e.loadingState},500)})},t.prototype.componentWillUnmount=function(){},t.prototype.OnClickUnban=function(e,t){var n=this,o=ci.FriendStore.GetPlayer(t),i=e.currentTarget.ownerDocument.defaultView,r=Ee.createElement(zc,{className:"friend",friend:o,context:null,disableContextMenu:!0});vr(window,Object($.b)("#GroupSettings_Bans_UnbanTitle"),Object($.b)("#GroupSettings_Bans_UnbanBody",o.display_name),Object($.b)("#GroupSettings_Bans_UnbanConfirm"),Object($.b)("#Button_Cancel"),!0,r).then(function(){n.props.group.SetUserBanState(t,!1).then(function(){M.e(n.props.bans.rgBans,function(e){return e.accountid()===t})}).catch(function(e){yr(i,Object($.b)("#Generic_Error"),Object($.b)("#GroupSettings_Bans_UnbanGenericError"))})}).catch(function(){})},t.prototype.FormatDate=function(e){return ci.RTime32ToDate(e).toLocaleString([],{year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"numeric"})},t.prototype.render=function(){var e,n=this;if("loaded"==this.props.bans.loadingState)return 0==this.props.bans.rgBans.length?Ee.createElement(Bi,null,Object($.b)("#GroupSettings_Bans_NoOneBanned")):(e=this.props.bans.rgBans.map(function(t){var e=ci.FriendStore.GetPlayer(t.accountid());return Ee.createElement("tr",{className:"hoverRow",key:t.accountid()},Ee.createElement("td",{className:"friendCell"}," ",Ee.createElement(zc,{friend:e,context:null})," "),Ee.createElement("td",{className:"dateCell"}," ",n.FormatDate(t.time_banned())," "),Ee.createElement("td",{className:"buttonCell"}," ",Ee.createElement(xi,{onClick:function(e){return n.OnClickUnban(e,t.accountid())}},Object($.b)("#GroupSettings_Bans_RevokeBan"))))}),Ee.createElement(Bi,{className:"DialogBody"},Ee.createElement("table",{className:"DialogSpanningTable BannedUsersTable"},Ee.createElement("thead",null,Ee.createElement("tr",{className:"headerRow"},Ee.createElement("th",{className:"friendColumn"},Object($.b)("#GroupSettings_Bans_InvitedHeader")," "),Ee.createElement("th",{className:"dateColumn"}," ",Object($.b)("#GroupSettings_Bans_BannedDate")," "),Ee.createElement("th",{className:"buttonColumn"}," "))),Ee.createElement("tbody",null,e))));var t=void 0;return t="pending"==this.props.bans.loadingState?Ee.createElement(Xa,{size:"medium"}):"denied"==this.props.bans.loadingState?Object($.b)("#GroupSettings_Bans_AccessDenied"):Object($.b)("#GroupSettings_Bans_Failed"),Ee.createElement(Bi,{className:"DialogBody"},t)},R.c([T.a],t.prototype,"OnClickUnban",null),t=R.c([or.observer],t)}($i),cs=n("F2OU"),ls=n.n(cs),ps=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return R.d(t,e),Object.defineProperty(t,"hoverClass",{get:function(){return ls.a.hoverParent},enumerable:!0,configurable:!0}),t.prototype.render=function(){var e=this.props,t=e.persona,n=e.animating,o=e.className,i=e.size,r=e.dim,a=R.f(e,["persona","animating","className","size","dim"]),s="";return"medium"==i?s=ls.a.Medium:"large"==i&&(s=ls.a.Large),Ee.createElement("div",R.a({className:hr(ls.a.SnoozeContainer,t.online_state,o,n&&ls.a.animating,s,r&&ls.a.Dim)},a),Ee.createElement("div",{"data-text":"Z",className:hr(ls.a.SnoozeZ,ls.a.Z1)},"Z"),Ee.createElement("div",{"data-text":"Z",className:hr(ls.a.SnoozeZ,ls.a.Z2)},"Z"),Ee.createElement("div",{"data-text":"Z",className:hr(ls.a.SnoozeZ,ls.a.Z3)},"Z"))},t=R.c([or.observer],t)}(Ee.Component),us=n("Cebd"),ms=n.n(us),ds=Object(or.observer)(function(e){var t=e.persona,n=e.className,o=R.f(e,["persona","className"]);if(!t)return null;if(!t.is_online)return null;var i=t.HasStateFlag(512),r=t.HasStateFlag(2048),a=!r&&t.HasStateFlag(1024);return Ee.createElement(Ee.Fragment,null,i&&Ee.createElement("div",R.a({className:hr(n,ms.a.PersonaStatusIcon,ms.a.MobilePhoneIcon,ne(t)),title:Object($.b)("#Platform_Hint_Mobile")},o),Ee.createElement(ui.F,null)),r&&Ee.createElement("div",R.a({className:hr(n,ms.a.PersonaStatusIcon,ms.a.VRIcon,ne(t)),title:Object($.b)("#Platform_Hint_VR")},o),Ee.createElement(ui.db,null)),a&&Ee.createElement("div",R.a({className:hr(n,ms.a.PersonaStatusIcon,ms.a.BigPictureIcon,ne(t)),title:Object($.b)("#Platform_Hint_BigPicture")},o),Ee.createElement(ui.d,null)))}),hs=n("s13G"),_s=n.n(hs);function fs(e){return Ee.createElement(Ee.Fragment,null,Ee.createElement("span",{className:_s.a.partyBeaconJoin},Object($.b)("#User_WantsToPlay"))," – ",e.persona.GetCurrentGameName())}var gs,bs,vs=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return R.d(t,e),t.prototype.render=function(){var e=this.props,t=e.className,n=e.onContextMenu,o=e.persona,i=e.eFriendRelationship,r=e.bIsSelf,a=e.bParenthesizeNicknames,s=e.strNickname,c=e.bCompactView,l=e.bHideGameName,p=e.bHideEnhancedRichPresenceLabel,u=e.bHideSnooze,m=e.renderStatus,d=e.renderRichPresence,h=e.bHidePersona,_=e.bDNDSet,f=e.bHasPartyBeacon,g=R.f(e,["className","onContextMenu","persona","eFriendRelationship","bIsSelf","bParenthesizeNicknames","strNickname","bCompactView","bHideGameName","bHideEnhancedRichPresenceLabel","bHideSnooze","renderStatus","renderRichPresence","bHidePersona","bDNDSet","bHasPartyBeacon"]),b=null,v=null,S=null,y=[t,_s.a.personaNameAndStatusLabel,ne(o),c&&_s.a.compactView];m?v=m():f||o.has_public_party_beacon?v=Ee.createElement(fs,{persona:o}):Object(O.a)(i)?(v=Object($.b)("#PersonaStateBlocked"),y.push(_s.a.blocked)):o.is_ingame?(v=o.GetCurrentGameName(),r||h?r&&o.is_awayOrSnooze&&(S=Object($.b)("#PersonaStateAway")):S=o.GetCurrentGameRichPresence()):o.m_broadcastAccountId&&(v=Object($.b)("#PersonaStateWatchingBroadcast")),v||(v=o.GetLocalizedOnlineStatus()),!o.is_awayOrSnooze||h||u||(b=Ee.createElement(ps,{persona:o}));var C=null;n?C=Ee.createElement("div",{className:"ContextMenuButton",onClick:n},Ee.createElement(ui.n,null)):y.push(_s.a.noContextMenu),h&&y.push(_s.a.hidePersona),d&&(S=d()),!l&&S||y.push(_s.a.twoLine);var I=s&&!a,E=I?s:o.m_strPlayerName;return Ee.createElement("div",R.a({},g,{className:hr.apply(void 0,y),onContextMenu:n}),Ee.createElement("div",{className:_s.a.statusAndName},Ee.createElement("div",{className:_s.a.playerName},E||" ",a&&s&&Ee.createElement("span",{className:_s.a.playerNickname},"(",s,")")),_&&Ee.createElement("div",{className:_s.a.DNDContainer,title:Object($.b)("#User_ToggleDoNotDisturb")},Ee.createElement(ui.l,null)),I&&Ee.createElement("span",{className:_s.a.playerNicknameBracket,title:Object($.b)("#isNickname")}," *"),Ee.createElement(ds,{persona:o}),b,C),!h&&Ee.createElement("div",{className:_s.a.richPresenceContainer},(!l||!S)&&Ee.createElement("div",{className:hr(_s.a.gameName,_s.a.richPresenceLabel,"no-drag")},v),!p&&S&&Ee.createElement("div",{className:hr(_s.a.richPresenceLabel,"no-drag")},S)))},t=R.c([or.observer],t)}(Ee.Component),Ss=function(n){function e(e){var t=n.call(this,e)||this;return t.m_bSettingsChanged=!1,t.m_bCommunityPreferencesChanged=!1,t.state={friendSettings:Object.assign({},e.friendsSettingsInitial),communityPreferences:Object.assign({},e.communityPreferencesInitial)},t}return R.d(e,n),e.prototype.componentWillReceiveProps=function(e){for(var t={},n=0,o=Object.keys(e.friendsSettingsInitial);n<o.length;n++){var i=o[n];e.friendsSettingsInitial[i]!=this.props.friendsSettingsInitial[i]&&(t[i]=e.friendsSettingsInitial[i])}for(var r={},a=0,s=Object.keys(e.communityPreferencesInitial);a<s.length;a++){i=s[a];e.communityPreferencesInitial[i]!=this.props.communityPreferencesInitial[i]&&(r[i]=e.communityPreferencesInitial[i])}this.setState({friendSettings:R.a({},this.state.friendSettings,t),communityPreferences:R.a({},this.state.communityPreferences,r)})},e.prototype.OKToSwitchAway=function(){return!0},e.prototype.OnSubmit=function(){this.props.onSubmit(this.state.friendSettings,this.state.communityPreferences),this.m_bSettingsChanged=!1,this.m_bCommunityPreferencesChanged=!1},e.prototype.HandleRadioChange=function(e){this.setState({friendSettings:R.a({},this.state.friendSettings,{nChatFlashMode:parseInt(e.currentTarget.value)})}),this.m_bSettingsChanged=!0},e.prototype.OnSettingToggled=function(e,t){var n;this.setState({friendSettings:R.a({},this.state.friendSettings,(n={},n[e]=t,n))}),this.m_bSettingsChanged=!0},e.prototype.OnCommunityPreferenceToggled=function(e,t){var n;this.setState({communityPreferences:R.a({},this.state.communityPreferences,(n={},n[e]=t,n))}),this.m_bCommunityPreferencesChanged=!0},e.prototype.componentDidUpdate=function(e,t){this.props.bSubmitImmediate&&(this.m_bSettingsChanged||this.m_bCommunityPreferencesChanged)&&this.props.onSubmit(this.state.friendSettings,this.state.communityPreferences),this.m_bSettingsChanged=!1,this.m_bCommunityPreferencesChanged=!1},e.prototype.FriendsSettingsToggleRow=function(t){var n=this;return Ee.createElement(Ji,{key:t.strName,onChange:function(e){n.OnSettingToggled(t.strName,e)},label:t.strLabel,checked:!!this.state.friendSettings[t.strName],description:t.strDesc?t.strDesc:""})},e.prototype.FriendsSettingsCheckbox=function(t){var n=this;return Ee.createElement(Ki,{key:t.strName,onChange:function(e){n.OnSettingToggled(t.strName,e)},checked:!!this.state.friendSettings[t.strName]})},e.prototype.FriendsSettingsCommunityPreferenceToggleRow=function(t){var n=this;return Ee.createElement(Ji,{key:"CommunityPreference"+t.strName,onChange:function(e){n.OnCommunityPreferenceToggled(t.strName,e)},label:t.strLabel,checked:!!this.state.communityPreferences[t.strName],description:t.strDesc?t.strDesc:""},t.children)},R.c([T.a],e.prototype,"OnSubmit",null),R.c([T.a],e.prototype,"HandleRadioChange",null),R.c([T.a],e.prototype,"OnSettingToggled",null),R.c([T.a],e.prototype,"OnCommunityPreferenceToggled",null),R.c([T.a],e.prototype,"FriendsSettingsToggleRow",null),R.c([T.a],e.prototype,"FriendsSettingsCheckbox",null),R.c([T.a],e.prototype,"FriendsSettingsCommunityPreferenceToggleRow",null),e}($i);(bs=gs||(gs={}))[bs.k_EChatFontSizeSmall=1]="k_EChatFontSizeSmall",bs[bs.k_EChatFontSizeDefault=2]="k_EChatFontSizeDefault",bs[bs.k_EChatFontSizeLarge=3]="k_EChatFontSizeLarge";var ys=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return R.d(t,e),t.prototype.render=function(){var e=this.props.bParenthesizeNicknames,t=Object($.b)("#FriendSettings_ExampleFriend"),n=Object($.b)("#FriendSettings_ExampleNickname"),o=new oe(new D.a);return o.m_strPlayerName=t,o.m_ePersonaState=1,o.m_strAvatarHash=ee,Ee.createElement("div",{className:"friend online friendSettingsFakeFriend"},Ee.createElement(qr,{className:"fakeFriendAvatar",persona:o,statusPosition:"right"}),Ee.createElement(vs,{className:"labelHolder",persona:o,eFriendRelationship:3,bIsSelf:!1,strNickname:n,bParenthesizeNicknames:e,bCompactView:!1}))},t}(Ee.Component),Cs=function(t){function e(e){return t.call(this,e)||this}return R.d(e,t),e.prototype.SetChatFontSize=function(e){this.setState({friendSettings:R.a({},this.state.friendSettings,{nChatFontSize:e})}),this.m_bSettingsChanged=!0},e.prototype.render=function(){var e=this,t=this.FriendsSettingsToggleRow,n=this.state.friendSettings.nChatFontSize;return Ee.createElement(Bi,{className:"DialogBody",onSubmit:this.OnSubmit},Ee.createElement("div",{className:"SettingsGroup"},Ee.createElement(t,{strName:"bCompactFriendsList",strLabel:Object($.b)("#FriendSettings_CompactFriendsAndChat")}),Ee.createElement(t,{strName:"bCompactQuickAccess",strLabel:Object($.b)("#FriendSettings_CompactQuickAccess")}),Ee.createElement(Di,{className:"friendSettingsSubheader"},Object($.b)("#FriendSettings_ChatFontSize")),Ee.createElement(ki,{className:"FriendsSettingsChatFontSizeSection_ButtonRow"},Ee.createElement(xi,{className:"smallFontSetting "+(n==gs.k_EChatFontSizeSmall?"Primary":"Off"),onClick:function(){return e.SetChatFontSize(gs.k_EChatFontSizeSmall)}},Object($.b)("#FriendSetting_ChatFontSmall")),Ee.createElement(xi,{className:"defaultFontSetting "+(n==gs.k_EChatFontSizeDefault?"Primary":"Off"),onClick:function(){return e.SetChatFontSize(gs.k_EChatFontSizeDefault)}},Object($.b)("#FriendSetting_ChatFontDefault")),Ee.createElement(xi,{className:"largeFontSetting "+(n==gs.k_EChatFontSizeLarge?"Primary":"Off"),onClick:function(){return e.SetChatFontSize(gs.k_EChatFontSizeLarge)}},Object($.b)("#FriendSetting_ChatFontLarge")))),!this.props.bSubmitImmediate&&Ee.createElement(Hi,{onCancel:this.props.onCancel}))},R.c([T.a],e.prototype,"SetChatFontSize",null),e=R.c([or.observer],e)}(Ss),Is=function(t){function e(e){return t.call(this,e)||this}return R.d(e,t),e.prototype.render=function(){var e=this.FriendsSettingsToggleRow,t=G.a.IN_CLIENT?"#FriendSettings_RememberOpenChats_DescClient":"#FriendSettings_RememberOpenChats_Desc";return Ee.createElement(Bi,{className:"DialogBody",onSubmit:this.OnSubmit},Ee.createElement("div",{className:"SettingsGroup"},this.props.bShowPopupOpts&&Ee.createElement(e,{strName:"bAlwaysNewChatWindow",strLabel:Object($.b)("#FriendSettings_AlwaysNewChatWindow")}),Ee.createElement(e,{strName:"bDisableEmbedInlining",strLabel:Object($.b)("#FriendSettings_DisableEmbedInlining")}),Ee.createElement(e,{strName:"bRememberOpenChats",strLabel:Object($.b)("#FriendSettings_RememberOpenChats"),strDesc:Object($.b)(t)}),Ee.createElement(e,{strName:"b24HourClock",strLabel:Object($.b)("#FriendSettings_AlwaysUse24HourClock")})))},e=R.c([or.observer],e)}(Ss),Es=function(t){function e(e){return t.call(this,e)||this}return R.d(e,t),e.prototype.render=function(){var e=this.FriendsSettingsToggleRow,t=this.FriendsSettingsCommunityPreferenceToggleRow;return Ee.createElement(Bi,{className:"DialogBody",onSubmit:this.OnSubmit},Ee.createElement("div",{className:"SettingsGroup"},Ee.createElement(t,{strName:"bParenthesizeNicknames",strLabel:Object($.b)("#FriendSettings_ParenthesizeNicknames")},Ee.createElement(ys,{bParenthesizeNicknames:this.state.communityPreferences.bParenthesizeNicknames})),Ee.createElement(e,{strName:"bCategorizeInGameFriendsByGame",strLabel:Object($.b)("#FriendSettings_CategorizeInGameFriendsByGame")}),Ee.createElement(e,{strName:"bHideOfflineFriendsInTagGroups",strLabel:Object($.b)("#FriendSettings_HideOfflineFriendsInCategories")}),Ee.createElement(e,{strName:"bHideCategorizedFriends",strLabel:Object($.b)("#FriendSettings_HideCategorizedFriends")}),Ee.createElement(e,{strName:"bForceAlphabeticFriendSorting",strLabel:Object($.b)("#FriendSettings_SortFriendsByStatus")}),this.props.bDoNotDisturbSupported&&Ee.createElement(e,{strName:"bSignIntoFriends",strLabel:Object($.b)("#FriendSettings_SignInToFriends")})))},e=R.c([or.observer],e)}(Ss),Os=function(n){function e(e){var t=n.call(this,e)||this;return t.m_rgMicOptions=[{label:"Default",data:"default"}],t.m_rgOutputOptions=[{label:"Default",data:"default"}],t.state={showAdvanced:!1,micOptionsReady:!1,outputOptionsReady:!1,hotkeyCapturing:!1},navigator.mediaDevices.enumerateDevices().then(t.gotMediaDevices).catch(t.gotMediaDevicesError),t}return R.d(e,n),e.prototype.gotMediaDevices=function(e){for(var t=0;t<e.length;++t){var n=e[t];if("audioinput"==n.kind){if("default"!=n.deviceId){var o=n.label;"communications"==n.deviceId&&(o=Object($.b)("#Voice_DefaultCommunicationsDefault")),this.m_rgMicOptions.push({label:o,data:n.deviceId})}}else if("audiooutput"==n.kind&&"default"!=n.deviceId){o=n.label;"communications"==n.deviceId&&(o=Object($.b)("#Voice_DefaultCommunicationsDefault")),this.m_rgOutputOptions.push({label:o,data:n.deviceId})}}this.setState({micOptionsReady:!0}),this.setState({outputOptionsReady:!0})},e.prototype.gotMediaDevicesError=function(){this.setState({micOptionsReady:!0}),this.setState({outputOptionsReady:!0})},e.prototype.OKToSwitchAway=function(){return!0},e.prototype.onSubmit=function(){return!1},e.prototype.VoiceSettingsRefMarker=function(e){e&&e.ownerDocument&&(this.m_elVoiceSettingsMarkerScroll=e,this.m_window=e.ownerDocument.defaultView)},e.prototype.OnShowAdvancedSettings=function(){var e=this;this.setState({showAdvanced:!this.state.showAdvanced}),this.m_iTimeOutVoiceSettingsScroll=this.m_window.setTimeout(function(){e.m_elVoiceSettingsMarkerScroll&&e.state.showAdvanced&&e.m_elVoiceSettingsMarkerScroll.scrollIntoView({behavior:"smooth"}),e.m_window.clearTimeout(e.m_iTimeOutVoiceSettingsScroll)},200)},e.prototype.OnMicDropdownChanged=function(e){this.props.voiceStore.SetSelectedMic(e.data)},e.prototype.OnOutputDeviceDropdownChanged=function(e){this.props.voiceStore.SetSelectedOutput(e.data)},e.prototype.OnInputGainChanged=function(e){this.props.voiceStore.SetVoiceInputGain(this.props.voiceStore.ConvertSliderToGainValue(e,Yo.k_MaxInputOutputGainValue))},e.prototype.OnOutputGainChanged=function(e){this.props.voiceStore.SetVoiceOutputGain(this.props.voiceStore.ConvertSliderToGainValue(e,Yo.k_MaxInputOutputGainValue))},e.prototype.OnToggleEchoCancellation=function(e){this.props.voiceStore.SetUseEchoCancellation(e)},e.prototype.OnToggleNoiseCancellation=function(e){this.props.voiceStore.SetUseNoiseCancellation(e)},e.prototype.OnToggleAutoGainControl=function(e){this.props.voiceStore.SetUseAutoGainControl(e)},e.prototype.SetNoiseGateOff=function(){this.props.voiceStore.SetUseNoiseGateLevel(Po.k_ENoiseGateLevel_Off)},e.prototype.SetNoiseGateMedium=function(){this.props.voiceStore.SetUseNoiseGateLevel(Po.k_ENoiseGateLevel_Medium)},e.prototype.SetNoiseGateHigh=function(){this.props.voiceStore.SetUseNoiseGateLevel(Po.k_ENoiseGateLevel_High)},e.prototype.SetHotKeyCaptureState=function(e){0==e?(null!=SteamClient.WebChat&&null!=SteamClient.WebChat.UnregisterForMouseXButtonDown&&SteamClient.WebChat.UnregisterForMouseXButtonDown(),this.setState({hotkeyCapturing:!1})):(this.setState({hotkeyCapturing:!0}),null!=SteamClient.WebChat&&null!=SteamClient.WebChat.RegisterForMouseXButtonDown&&SteamClient.WebChat.RegisterForMouseXButtonDown(this.OnXButtonDown))},e.prototype.OnXButtonDown=function(e){0<e&&this.state.hotkeyCapturing&&(null!=SteamClient.WebChat&&null!=SteamClient.WebChat.SetPushToTalkMouseButton&&(SteamClient.WebChat.SetPushToTalkMouseButton(e),ci.VoiceStore.RefreshPushToTalkKeySettings()),this.SetHotKeyCaptureState(!1))},e.prototype.OnTogglePushToTalk=function(){if("undefined"!=typeof SteamClient&&null!=SteamClient.WebChat&&null!=SteamClient.WebChat.SetPushToTalkEnabled){var e=ci.VoiceStore.GetPushToTalkEnabled();SteamClient.WebChat.SetPushToTalkEnabled(!e),ci.VoiceStore.SetPushToTalkEnabled(!e)}},e.prototype.OnSetOpenMic=function(){"undefined"!=typeof SteamClient&&null!=SteamClient.WebChat&&null!=SteamClient.WebChat.SetPushToTalkEnabled&&(SteamClient.WebChat.SetPushToTalkEnabled(!1),ci.VoiceStore.SetPushToTalkEnabled(!1))},e.prototype.OnSetPushToTalk=function(){"undefined"!=typeof SteamClient&&null!=SteamClient.WebChat&&null!=SteamClient.WebChat.SetPushToTalkEnabled&&(SteamClient.WebChat.SetPushToTalkEnabled(!0),ci.VoiceStore.SetPushToTalkEnabled(!0))},e.prototype.OnSetPushToMute=function(){"undefined"!=typeof SteamClient&&null!=SteamClient.WebChat&&null!=SteamClient.WebChat.SetPushToMuteEnabled&&(SteamClient.WebChat.SetPushToMuteEnabled(!0),ci.VoiceStore.SetPushToMuteEnabled(!0))},e.prototype.AssignHotkey=function(){0==this.state.hotkeyCapturing&&this.SetHotKeyCaptureState(!0)},e.prototype.ClearHotKey=function(){"undefined"!=typeof SteamClient&&null!=SteamClient.WebChat&&null!=SteamClient.WebChat.SetPushToTalkHotKey&&(SteamClient.WebChat.SetPushToTalkHotKey(0),ci.VoiceStore.RefreshPushToTalkKeySettings())},e.prototype.onMouseDown=function(e){0!=this.state.hotkeyCapturing&&0!=e.button&&this.onClick(e)},e.prototype.onClick=function(e){0!=this.state.hotkeyCapturing&&(null!=SteamClient.WebChat&&null!=SteamClient.WebChat.SetPushToTalkMouseButton&&(SteamClient.WebChat.SetPushToTalkMouseButton(e.button),ci.VoiceStore.RefreshPushToTalkKeySettings()),this.SetHotKeyCaptureState(!1),e.preventDefault(),e.stopPropagation())},e.prototype.onContextMenu=function(e){e.preventDefault(),e.stopPropagation()},e.prototype.onKeyDown=function(e){0!=this.state.hotkeyCapturing&&(null!=SteamClient.WebChat&&null!=SteamClient.WebChat.SetPushToTalkHotKey&&(SteamClient.WebChat.SetPushToTalkHotKey(e.keyCode),ci.VoiceStore.RefreshPushToTalkKeySettings()),this.SetHotKeyCaptureState(!1),e.preventDefault(),e.stopPropagation())},e.prototype.OnPPTSoundChecked=function(e){ci.VoiceStore.SetPushToTalkOrMuteSoundsEnabled(e)},e.prototype.CopyVoiceLogsToClipboard=function(){var e=ci.ChatStore.VoiceChat.GetVoiceLogs(),t=document.createElement("textarea");t.textContent=e,t.style.position="fixed",document.body.appendChild(t),t.select();try{document.execCommand("copy")}catch(e){console.warn("Copy voice logs to clipboard failed.",e)}finally{document.body.removeChild(t)}},e.prototype.componentWillUnmount=function(){ci.VoiceStore.IsLocalMicTestActive()&&ci.VoiceStore.EndLocalMicTest()},e.prototype.OnStartLocalMicTest=function(){ci.VoiceStore.InitiateLocalMicTest()},e.prototype.OnStopLocalMicTest=function(){ci.VoiceStore.EndLocalMicTest()},e.prototype.render=function(){var t=this,e=ci.VoiceStore.GetPushToTalkEnabled(),n=ci.VoiceStore.GetPushToMuteEnabled(),o=!1,i=(ci.VoiceStore.GetPushToTalkHotKeyVK(),ci.VoiceStore.GetPushToTalkHotKeyDisplayString()),r=Object($.b)("#VoicePushToTalkAssigned"),a=Object($.b)("#VoicePushToMuteAssigned"),s=Object($.b)("#VoiceMuteToggleAssigned"),c=ci.VoiceStore.GetPushToTalkOrMuteSoundsEnabled(),l=ci.SettingsStore.BClientHasFeatureOrOnWeb("NewVoiceHotKeyState"),p=ci.VoiceStore.IsLocalMicTestActive(),u=ci.FriendStore.self;"undefined"!=typeof SteamClient&&null!=SteamClient.WebChat&&null!=SteamClient.WebChat.GetPushToTalkEnabled&&(o=!0),this.state.hotkeyCapturing&&(r=Object($.b)("#VoicePushToTalkPressHotKey"));var m=this.props.voiceStore.GetUseNoiseGateLevel();return Ee.createElement(Bi,{className:"DialogBody VoiceSettings",onContextMenu:this.onContextMenu,onSubmit:this.onSubmit,onMouseDown:this.onMouseDown,onClick:this.onClick,onKeyDown:this.onKeyDown},Ee.createElement("div",{className:"_FixedHeight"},Ee.createElement("div",{className:"voiceSelfHeader"},Ee.createElement("div",{className:"DialogLabel"},Object($.b)("#VoiceSetupHeader")),Ee.createElement("div",{className:"voiceMicTestContainer"},Ee.createElement("div",{className:"voiceSelfDirections",title:Object($.b)("#VoiceWhenMicIsWorking")},Ee.createElement(zc,{friend:u,key:u.accountid,showVoiceLevel:!0,context:void 0,noActions:!0,listStatusIndicator:Ee.createElement("div",{className:"connectionSpinner"})}),Ee.createElement(xi,{className:"LocalMicTestButton "+(p?"Primary":"Off"),onClick:p?this.OnStopLocalMicTest:this.OnStartLocalMicTest},p?Object($.b)("#VoiceStopLocalMicTest"):Object($.b)("#VoiceStartLocalMicTest"))))),this.state.micOptionsReady&&Ee.createElement(Qi,{strClassName:"InputDevice",label:Object($.b)("#VoiceDevice"),rgOptions:this.m_rgMicOptions,strDefaultLabel:Object($.b)("#DefaultMic"),selectedOption:this.props.voiceStore.GetSelectedMic(),onChange:this.OnMicDropdownChanged}),!this.state.micOptionsReady&&Ee.createElement(Qi,{label:Object($.b)("#VoiceDevice"),rgOptions:this.m_rgMicOptions,strDefaultLabel:Object($.b)("#MicLoading...")}),this.state.outputOptionsReady&&Ee.createElement(Qi,{label:Object($.b)("#VoiceOutputDevice"),rgOptions:this.m_rgOutputOptions,strDefaultLabel:Object($.b)("#DefaultOutputDevice"),selectedOption:this.props.voiceStore.GetSelectedOutputDevice(),onChange:this.OnOutputDeviceDropdownChanged}),!this.state.outputOptionsReady&&Ee.createElement(Qi,{label:Object($.b)("#VoiceOutputDevice"),rgOptions:this.m_rgOutputOptions,strDefaultLabel:Object($.b)("#OutputDeviceLoading...")}),Ee.createElement(Di,null,Object($.b)("#VoiceVolume")),Ee.createElement(Li,{className:"DialogLabelStrong"},Ee.createElement(Xi,{min:0,max:100,label:Object($.b)("#VoiceInputGain"),explainer:Object($.b)("#VoiceInputGainExplainer"),value:this.props.voiceStore.ConvertGainValueToSliderValue(this.props.voiceStore.GetVoiceInputGain(),Yo.k_MaxInputOutputGainValue),onChange:this.OnInputGainChanged}),Ee.createElement(Xi,{min:0,max:100,label:Object($.b)("#VoiceOutputGain"),explainer:Object($.b)("#VoiceOutputGainExplainer"),value:this.props.voiceStore.ConvertGainValueToSliderValue(this.props.voiceStore.GetVoiceOutputGain(),Yo.k_MaxInputOutputGainValue),onChange:this.OnOutputGainChanged})),"undefined"!=typeof SteamClient&&null!=SteamClient.WebChat&&null!=SteamClient.WebChat.SetPushToMuteEnabled?Ee.createElement("div",{className:"_DialogSection pushToTalkSection"+(o?"":" disabled")},Ee.createElement(Di,null,Object($.b)("#VoiceTransmissionType_Label"),!o&&Ee.createElement("span",{className:"disabledNotice"}," (",Object($.b)("#VoiceTransmissionType_Disabled"),") ")),Ee.createElement(ki,{className:"FriendsSettingsVoiceTransmissionType_ButtonRow"},Ee.createElement(xi,{className:e||n?"Off":"Primary",onClick:this.OnSetOpenMic},Object($.b)("#VoiceTransmissionType_OpenMic")),Ee.createElement(xi,{className:e?"Primary":"Off",disabled:!o,onClick:this.OnSetPushToTalk},Object($.b)("#VoiceTransmissionType_PushToTalk")),Ee.createElement(xi,{className:n?"Primary":"Off",disabled:!o,onClick:this.OnSetPushToMute},Object($.b)("#VoiceTransmissionType_PushToMute")),Ee.createElement("div",{className:"pushToKeyAssignContainer displayColumn"+(l||n||e?" showPTTOptions":"")},Ee.createElement("div",{className:"displayRow"},Ee.createElement(Di,{className:"DialogLabelExplainer"},e?r:n?a:s),Ee.createElement(xi,{disabled:!o,className:this.state.hotkeyCapturing&&"capturingKey",onClick:this.AssignHotkey},i),!e&&!n&&Ee.createElement(xi,{className:"ClearHotKeyButton",onClick:this.ClearHotKey,title:Object($.b)("#VoiceClearHotKeyTooltip")},Ee.createElement(ui.jb,null))),Ee.createElement("div",{className:"PPTSoundOption DialogLabelExplainer"},Ee.createElement(Ki,{onChange:function(e){t.OnPPTSoundChecked(e)},label:Object($.b)("#VoicePushToSomethingSoundOption"),checked:c}))))):Ee.createElement("div",{className:"_DialogSection pushToTalkSection"+(o?"":" disabled")},Ee.createElement(Di,null,Object($.b)("#VoiceTransmissionType"),!o&&Ee.createElement("span",{className:"disabledNotice"}," (",Object($.b)("#g_DisabledOnWeb"),") ")),Ee.createElement(Ji,{disabled:!o,label:Object($.b)("#VoiceTransmissionTypeExplainer"),checked:e,onChange:this.OnTogglePushToTalk}),e&&Ee.createElement("div",{className:"pushtoTalkKeyAssignContainer displayRow"},Ee.createElement(Di,{className:"DialogLabelExplainer"},r),Ee.createElement(xi,{disabled:!o,className:this.state.hotkeyCapturing&&"capturingKey",onClick:this.AssignHotkey},i))),Ee.createElement("div",{className:"_DialogSection"},Ee.createElement(Di,null,Object($.b)("#VoiceTransmisionThreshold")),Ee.createElement(Di,{className:"DialogLabelStrong"},Object($.b)("#VoiceTransmissionThresholdExplainer")),Ee.createElement(ki,{className:"FriendsSettingsFlashSection_ButtonRow"},Ee.createElement(xi,{className:m<=Po.k_ENoiseGateLevel_Low?"Primary":"Off",onClick:this.SetNoiseGateOff},Object($.b)("#VoiceTransmissionThresholdOff")),Ee.createElement(xi,{className:m==Po.k_ENoiseGateLevel_Medium?"Primary":"Off",onClick:this.SetNoiseGateMedium},Object($.b)("#VoiceTransmissionThresholdMedium")),Ee.createElement(xi,{className:m==Po.k_ENoiseGateLevel_High?"Primary":"Off",onClick:this.SetNoiseGateHigh},Object($.b)("#VoiceTransmissionThresholdHigh"))),Ee.createElement(Di,{className:"DialogLabelExplainer"},Object($.b)("#VoiceTransmissionThresholdRecommended"))),Ee.createElement(xi,{className:"advancedSettingsButton",onClick:this.OnShowAdvancedSettings},this.state.showAdvanced?Object($.b)("#VoiceHideAdvancedSettings"):Object($.b)("#VoiceShowAdvancedSettings")),Ee.createElement("div",{className:"advancedSettings"+(this.state.showAdvanced?" showAdvanced":"")},Ee.createElement(Di,null,Object($.b)("#VoiceAdvancedSettings")),Ee.createElement(Di,{className:"DialogLabelExplainer Left"},Object($.b)("#VoiceAdvancedSettingsExplainer")),Ee.createElement(Ji,{label:Object($.b)("#VoiceEchoCancellation"),checked:this.props.voiceStore.GetUseEchoCancellation(),onChange:this.OnToggleEchoCancellation}),Ee.createElement(Ji,{label:Object($.b)("#VoiceNoiseCancellation"),checked:this.props.voiceStore.GetUseNoiseCancellation(),onChange:this.OnToggleNoiseCancellation}),Ee.createElement(Ji,{label:Object($.b)("#VoiceAutoGainControl"),checked:this.props.voiceStore.GetUseAutoGainControl(),onChange:this.OnToggleAutoGainControl}),Ee.createElement(xi,{className:"copyVoiceLogsButton",onClick:this.CopyVoiceLogsToClipboard},Object($.b)("#CopyVoiceChatLogs"))),Ee.createElement("div",{className:"scrollToRef",ref:this.VoiceSettingsRefMarker})))},R.c([T.a],e.prototype,"gotMediaDevices",null),R.c([T.a],e.prototype,"gotMediaDevicesError",null),R.c([T.a],e.prototype,"onSubmit",null),R.c([T.a],e.prototype,"VoiceSettingsRefMarker",null),R.c([T.a],e.prototype,"OnShowAdvancedSettings",null),R.c([T.a],e.prototype,"OnMicDropdownChanged",null),R.c([T.a],e.prototype,"OnOutputDeviceDropdownChanged",null),R.c([T.a],e.prototype,"OnInputGainChanged",null),R.c([T.a],e.prototype,"OnOutputGainChanged",null),R.c([T.a],e.prototype,"OnToggleEchoCancellation",null),R.c([T.a],e.prototype,"OnToggleNoiseCancellation",null),R.c([T.a],e.prototype,"OnToggleAutoGainControl",null),R.c([T.a],e.prototype,"SetNoiseGateOff",null),R.c([T.a],e.prototype,"SetNoiseGateMedium",null),R.c([T.a],e.prototype,"SetNoiseGateHigh",null),R.c([T.a],e.prototype,"OnXButtonDown",null),R.c([T.a],e.prototype,"OnTogglePushToTalk",null),R.c([T.a],e.prototype,"OnSetOpenMic",null),R.c([T.a],e.prototype,"OnSetPushToTalk",null),R.c([T.a],e.prototype,"OnSetPushToMute",null),R.c([T.a],e.prototype,"AssignHotkey",null),R.c([T.a],e.prototype,"ClearHotKey",null),R.c([T.a],e.prototype,"onMouseDown",null),R.c([T.a],e.prototype,"onClick",null),R.c([T.a],e.prototype,"onContextMenu",null),R.c([T.a],e.prototype,"onKeyDown",null),R.c([T.a],e.prototype,"OnPPTSoundChecked",null),R.c([T.a],e.prototype,"CopyVoiceLogsToClipboard",null),R.c([T.a],e.prototype,"OnStartLocalMicTest",null),R.c([T.a],e.prototype,"OnStopLocalMicTest",null),e=R.c([or.observer],e)}($i);function ws(e,t){fr(Ee.createElement(Ms,{browserContext:e}),t,Object($.b)("#Settings"),{strTitle:Object($.b)("#Settings"),popupWidth:842,popupHeight:720},pd(t))}var Ms=function(t){function e(e){return t.call(this,e,Object($.b)("#Settings"))||this}return R.d(e,t),e.prototype.SaveFriendSettings=function(e,t){ci.SettingsStore.BUpdateFriendsSettings(e),ci.SettingsStore.SetCommunityPreferences(t)},e.prototype.render=function(){var e=ci.UIStore.GetPerContextChatData(this.props.browserContext),t={friendsSettingsInitial:ci.SettingsStore.FriendsSettings,communityPreferencesInitial:ci.SettingsStore.CommunityPreferences,onCancel:this.props.closeModal,onSubmit:this.SaveFriendSettings,bShowClientOpts:G.a.IN_CLIENT,bShowPopupOpts:e.BUsePopups(),bShowGroupOpts:!0,bSubmitImmediate:!0,bDoNotDisturbSupported:G.a.IN_CLIENT&&ci.SettingsStore.BClientHasFeatureOrOnWeb("DoNotDisturb")},n={title:Object($.b)("#FriendSettings_Title"),className:"FriendSettingsContainer",pages:[{title:Object($.b)("#FriendSettings_Friends"),uniqueName:"FriendSettings_Friends",content:Ee.createElement(Es,R.a({},t))},{title:Object($.b)("#FriendSettings_Chat"),uniqueName:"FriendSettings_Chat",content:Ee.createElement(Is,R.a({},t))},{title:Object($.b)("#FriendSettings_SizeAndScaling"),uniqueName:"FriendSettings_SizeAndScaling",content:Ee.createElement(Cs,R.a({},t))},{title:Object($.b)("#FriendSettings_Notifications"),uniqueName:"FriendSettings_Notifications",content:Ee.createElement(Ds,R.a({},t))},{title:Object($.b)("#FriendSettings_Voice"),uniqueName:"FriendSettings_Voice",content:Ee.createElement(Os,{onCancel:this.props.closeModal,voiceStore:ci.ChatStore.VoiceChat})}]};return Ee.createElement(sr,{onEscKeypress:this.props.closeModal},Ee.createElement(er,R.a({},n)))},e=R.c([or.observer],e)}(Ee.Component),Ds=function(n){function e(e){var t=n.call(this,e)||this;return t.m_rgOptions=Ts(!1),t}return R.d(e,n),e.prototype.FriendsSettingsNotificationRow=function(e){var t=this.FriendsSettingsCheckbox;return Ee.createElement("div",null,Ee.createElement("div",{className:"FriendsSettingsNotificationRow"},Ee.createElement("div",{className:"FriendsSettingsNotificationRow_Label"},e.strLabel),Ee.createElement("div",{className:"FriendsSettingsNotificationRow_Checkbox"},Ee.createElement(t,{strName:e.strNameShow})),Ee.createElement("div",{className:"FriendsSettingsNotificationRow_Checkbox"},Ee.createElement(t,{strName:e.strNameSound}))))},e.prototype.render=function(){var e=this.state.friendSettings,t=this.FriendsSettingsNotificationRow;return Ee.createElement(Bi,{className:"DialogBody",onSubmit:this.OnSubmit},Ee.createElement("div",{className:"SettingsGroup"},Ee.createElement("div",{className:"FriendsSettingsNotificationRow FriendsSettingsNotificationRow_Header"},Ee.createElement("div",{className:"FriendsSettingsNotificationRow_Label"},Object($.b)("#FriendSettings_Notification_Table_Label")),Ee.createElement("div",{className:"FriendsSettingsNotificationRow_Checkbox"},Object($.b)("#FriendSettings_Notification_Table_Show")),Ee.createElement("div",{className:"FriendsSettingsNotificationRow_Checkbox"},Object($.b)("#FriendSettings_Notification_Table_Play"))),Ee.createElement(t,{strLabel:Object($.b)("#FriendSettings_Notification_FriendJoins"),strNameShow:"bNotifications_ShowIngame",strNameSound:"bSounds_PlayIngame"}),Ee.createElement(t,{strLabel:Object($.b)("#FriendSettings_Notification_FriendOnline"),strNameShow:"bNotifications_ShowOnline",strNameSound:"bSounds_PlayOnline"}),Ee.createElement(t,{strLabel:Object($.b)("#FriendSettings_Notification_ChatMessage"),strNameShow:"bNotifications_ShowMessage",strNameSound:"bSounds_PlayMessage"}),Ee.createElement(t,{strLabel:Object($.b)("#FriendSettings_Notification_ChatRoomNotification"),strNameShow:"bNotifications_ShowChatRoomNotification",strNameSound:"bSounds_PlayChatRoomNotification"}),this.props.bShowGroupOpts&&Ee.createElement(t,{strLabel:Object($.b)("#FriendSettings_Notification_GroupEvent"),strNameShow:"bNotifications_EventsAndAnnouncements",strNameSound:"bSounds_EventsAndAnnouncements"})),this.props.bShowPopupOpts&&this.props.bShowClientOpts&&Ee.createElement("div",{className:"SettingsGroup"},Ee.createElement("div",{className:"FriendsSettingsFlashSection"},Ee.createElement(Di,{className:"FriendsSettingsFlashSection_Header"},Object($.b)("#FriendSettings_Flash_Header")),Ee.createElement(ki,{className:"FriendsSettingsFlashSection_ButtonRow"},Ee.createElement(xi,{className:0==e.nChatFlashMode?"Primary":"Off",value:0,onClick:this.HandleRadioChange},Object($.b)("#FriendSettings_Flash_Always")),Ee.createElement(xi,{className:1==e.nChatFlashMode?"Primary":"Off",value:1,onClick:this.HandleRadioChange},Object($.b)("#FriendSettings_Flash_Minimized")),Ee.createElement(xi,{className:2==e.nChatFlashMode?"Primary":"Off",value:2,onClick:this.HandleRadioChange},Object($.b)("#FriendSettings_Flash_Never"))))),!this.props.bSubmitImmediate&&Ee.createElement(Hi,{onCancel:this.props.onCancel}))},R.c([T.a],e.prototype,"FriendsSettingsNotificationRow",null),e=R.c([or.observer],e)}(Ss);Ee.createElement("div",{className:"notificationChimeAndToast FriendsSettingsNotificationRow"},Ee.createElement(Ki,null),Ee.createElement(Ki,null));function Ts(e){void 0===e&&(e=!0);var t=[];return e&&(t=t.concat([{label:Ee.createElement("span",{className:"ChannelSpecificNotificationSettings_Inherit"},Object($.b)("#NotificationSetting_Inherit")),data:0}])),t=t.concat([{label:Object($.b)("#NotificationSetting_AllMessages"),data:4},{label:Object($.b)("#NotificationSetting_AnyMention",ci.FriendStore.self.display_name),data:3},{label:Object($.b)("#NotificationSetting_DirectMention",ci.FriendStore.self.display_name),data:2},{label:Object($.b)("#NotificationSetting_None"),data:1}])}var Gs=function(n){function e(e){var t=n.call(this,e)||this;return t.m_rgSelectOptions=Ts(!1),t.state={cSavesInFlight:0},t}return R.d(e,n),e.prototype.IncrementSavesInFlight=function(){this.setState(function(e){return{cSavesInFlight:e.cSavesInFlight+1}})},e.prototype.DecrementSavesInFlight=function(){this.setState(function(e){return Object(I.a)(0<e.cSavesInFlight,"expected "+e.cSavesInFlight+" > 0"),{cSavesInFlight:e.cSavesInFlight-1}})},e.prototype.WrapSavePromise=function(e){this.IncrementSavesInFlight(),e.then(this.DecrementSavesInFlight,this.DecrementSavesInFlight)},e.prototype.OnGroupNotificationLevelChanged=function(e){this.WrapSavePromise(this.props.group.SetNotificationPreferences(e))},e.prototype.OnShowUnreadIndicatorChanged=function(e){this.WrapSavePromise(this.props.group.SetNotificationPreferences(void 0,void 0,e))},e.prototype.DismissDialog=function(){this.props.closeModal()},e.prototype.OnFriendsSettingsClicked=function(e){ws(cd(this,e),e.currentTarget.ownerDocument.defaultView)},e.prototype.render=function(){var e,t=this,n=this.props.group,o=n.chatRoomList.filter(function(e){return e.BShouldTrackUnreadMessages()}),i=0<o.length;if(1==o.length&&0==o[0].GetDesktopNotificationLevelSetting()&&0==o[0].GetMobileNotificationLevelsetting()&&(i=!1),i){var r=o.map(function(e){return Ee.createElement(Rs,{fnHandleSave:t.WrapSavePromise,group:n,chat:e,key:e.unique_id})});e=Ee.createElement(Ee.Fragment,null,Ee.createElement("div",{className:"notificationsChannelListContainer\t"},r))}return Ee.createElement(sr,{onEscKeypress:this.DismissDialog},Ee.createElement(Fi,{classNameContent:"ChatRoomNotificationSettingsDialog"},Ee.createElement(wi,null,Object($.b)("#NotificationSettings_Title")),Ee.createElement(Di,null,Object($.d)("#NotificationSettings_SubTitle",Ee.createElement("span",{className:"whiteText"},n.name))),Ee.createElement(Gi,null,Ee.createElement(Di,{className:"NotificationSettingsSavingIndicator "+(this.state.cSavesInFlight?"Saving":"")},"Saving ..."),Ee.createElement(Ns,{drop_down_options:this.m_rgSelectOptions,get_notification_level:function(e){return t.props.group.GetDesktopNotificationLevel(e)},set_notification_level:this.OnGroupNotificationLevelChanged,get_muted:function(){return t.props.group.BIsUnreadIndicatorMuted()},set_muted:this.OnShowUnreadIndicatorChanged}),i&&Ee.createElement(Ee.Fragment,null,Ee.createElement(ji,null),Ee.createElement(Li,{className:"notificationsChannelHeader"},Ee.createElement(Di,{className:"NotificationChannelNameLabel"},Object($.b)("#GroupSettings_Channels_TextChannels")),Ee.createElement(Di,{className:"OverrideChannelLabel"},Object($.b)("#NotificationSetting_ShortLabel"))),Ee.createElement(Ri,{className:"scrollMaskVertical"},e))),Ee.createElement(Mi,null,Object($.d)("#NotificationSetting_Footer_Desc",Ee.createElement("span",{className:"textLink",onClick:this.OnFriendsSettingsClicked},Object($.b)("#FriendSettings_Title"))))))},R.c([T.a],e.prototype,"IncrementSavesInFlight",null),R.c([T.a],e.prototype,"DecrementSavesInFlight",null),R.c([T.a],e.prototype,"WrapSavePromise",null),R.c([T.a],e.prototype,"OnGroupNotificationLevelChanged",null),R.c([T.a],e.prototype,"OnShowUnreadIndicatorChanged",null),R.c([T.a],e.prototype,"DismissDialog",null),R.c([T.a],e.prototype,"OnFriendsSettingsClicked",null),e=R.c([or.observer],e)}(Ee.Component),Rs=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.m_rgSelectOptions=Ts(),e}return R.d(e,t),e.prototype.OnChatNotificationLevelChanged=function(e){this.props.fnHandleSave(this.props.chat.SetNotificationPreferences(e.data))},e.prototype.render=function(){var e=this.props.chat;e.GetDesktopNotificationLevelSetting();return Ee.createElement(ki,{className:"notificationsChannel"},Ee.createElement("div",{className:"NotificationChannelName"},e.name),Ee.createElement(Qi,{rgOptions:this.m_rgSelectOptions,selectedOption:e.GetDesktopNotificationLevelSetting(),onChange:this.OnChatNotificationLevelChanged}))},R.c([T.a],e.prototype,"OnChatNotificationLevelChanged",null),e=R.c([or.observer],e)}(Ee.Component),Ns=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return R.d(t,e),t.prototype.OnNotificationLevelChanged=function(e){this.props.set_notification_level(e.data)},t.prototype.OnShowUnreadIndicatorChanged=function(e){this.props.set_muted(!e)},t.prototype.render=function(){var e=this.props.get_notification_level(!0);this.props.bIsDefault&&0==e&&(e=4);var t=this.props.get_notification_level();return this.props.bIsDefault&&0==t&&(t=4),Ee.createElement("div",{className:"ChatRoomNotificationSettingsDialog"},Ee.createElement("div",{className:"notificationGeneralHeader"+(this.props.bIsDefault?" isDefault":"")},Ee.createElement(Di,null,this.props.bIsDefault?Object($.b)("#NotificationSetting_DefaultLabel"):Object($.b)("#NotificationSetting_Label"))),Ee.createElement("div",{style:{marginBottom:16}},Ee.createElement("div",{className:"notificationRow"},Ee.createElement(Qi,{rgOptions:this.props.drop_down_options,selectedOption:e,onChange:this.OnNotificationLevelChanged})),4!=t&&Ee.createElement("div",{className:"indicatorOptionContainer"},Ee.createElement(Ji,{classname:"indicatorOption",label:Object($.b)("#NotificationSetting_Indicator"),onChange:this.OnShowUnreadIndicatorChanged,checked:!this.props.get_muted()}),Ee.createElement("div",{className:"ChatUnreadMessageIndicator"+(this.props.get_muted()?" Hidden":"")},Ee.createElement("div",{className:"chatUnreadCircle"})))))},R.c([T.a],t.prototype,"OnNotificationLevelChanged",null),R.c([T.a],t.prototype,"OnShowUnreadIndicatorChanged",null),t=R.c([or.observer],t)}(Ee.Component),Ls=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return R.d(t,e),t.prototype.render=function(){var e=this.props,t=e.src,n=e.duration,o=e.className,i=R.f(e,["src","duration","className"]),r={backgroundImage:"url("+t+")",transitionDuration:n/1e3+"s"};return Ee.createElement(Ia.TransitionGroup,R.a({},i,{className:hr("crossfade",o)}),Ee.createElement(Ia.CSSTransition,{classNames:"crossfade-anim",timeout:n||500,key:t,style:r},Ee.createElement("div",{className:"crossfade-img"})))},t}(Ee.Component),ks=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return R.d(t,e),t.prototype.InviteFriend=function(e){ua(cd(this,e),e.currentTarget.ownerDocument.defaultView,this.props.groupView.GetGroup())},t.prototype.OpenSettings=function(e){var t,n;t=Object(Ci.m)(e),n=this.props.groupView,fr(Ee.createElement(Qa,{groupView:n}),t,"ChatRoomGroupSettings",{strTitle:Object($.b)("#GroupSettings"),popupWidth:842,popupHeight:600},pd(t))},t.prototype.OpenNotificationPreferences=function(e){!function(e,t){var n=t.GetGroup().textRoomList.length;7<n&&(n=7);var o=60*n;n<2&&(o-=32),fr(Ee.createElement(Gs,{group:t.GetGroup()}),e,"ChatRoomGroupNotificationSettings",{strTitle:Object($.b)("#NotificationSettings_Title"),popupWidth:600,popupHeight:348+o},pd(e))}(Object(Ci.m)(e),this.props.groupView)},t.prototype.OnContextMenu=function(e){ba(e,this.props.groupView.GetGroup(),{is_chat_window:!0})},t.prototype.render=function(){var e=this.props.groupView,t=e.GetGroup(),n=t.name,o=t.tagline,i=!1;t.readyToRender&&(i=t.BCanInvite());var r=e.GetGroup().watching_broadcast_steamid&&!e.isBroadcastShown;return Ee.createElement("div",{className:"chatRoomHeader"},Ee.createElement("div",{className:"chatRoomGroupHeader"+(r?" notifyBroadcast":""),onContextMenu:this.OnContextMenu},Ee.createElement(xs,{group:t}),Ee.createElement("div",{className:"chatRoomGroupHeaderNameandTag"},Ee.createElement("div",{className:"chatRoomGroupHeaderName"},n),Ee.createElement("div",{className:"chatRoomGroupHeaderTagline"},o)),Ee.createElement("div",{className:"chatRoomGroupSpacer"}),t.readyToRender&&Ee.createElement(Ee.Fragment,null,r&&this.RenderBroadcastPeek(),Ee.createElement("div",{className:"chatRoomGroupControls"},Ee.createElement("div",{className:"chatRoomOptions"},Ee.createElement("div",{className:"chatRoomButton ManageNotifications",onClick:this.OpenNotificationPreferences,title:Object($.b)("#Tooltip_NotificationSettings")},Ee.createElement(ui.c,null)),i&&Ee.createElement("div",{className:"chatRoomButton InviteToGroupChat",onClick:this.InviteFriend,title:Object($.b)("#Tooltip_InviteToGroup")},Ee.createElement(ui.y,null)),!i&&Ee.createElement("div",{className:"chatRoomButton InviteToGroupChat Disabled",onClick:function(e){},title:Object($.b)("#Tooltip_InviteToGroup_Denied")},Ee.createElement(ui.y,null)),Ee.createElement("div",{className:"chatRoomButton GroupChatSettings",onClick:this.OpenSettings,title:Object($.b)("#Tooltip_GroupChatSettings")},Ee.createElement(ui.g,null))),Ee.createElement("div",{className:"chatRoomGroupStats"},Ee.createElement(As,{group:t}),Ee.createElement(Fs,{group:t}),Ee.createElement(Bs,{group:t}))))))},t.prototype.RenderBroadcastPeek=function(){var e=this.props,t=e.groupView,n=e.onBroadcastPreviewClick,o=t.GetGroup(),i=o.watching_broadcast_steamid.ConvertTo64BitString(),r=o.BCanIAssociateBroadcast()?function(){return vr(window,Object($.b)("#Broadcast_EndWatchParty"),Object($.b)("#Broadcast_EndWatchPartyPrompt"),Object($.b)("#Broadcast_EndWatchParty")).then(function(){return o.SetChatRoomGroupWatchingBroadcast(void 0)})}:void 0;return Ee.createElement(Ps,{broadcastId:i,key:i,onClick:n,onRequestClose:r})},R.c([T.a],t.prototype,"InviteFriend",null),R.c([T.a],t.prototype,"OpenSettings",null),R.c([T.a],t.prototype,"OpenNotificationPreferences",null),R.c([T.a],t.prototype,"OnContextMenu",null),t=R.c([or.observer],t)}(Ee.Component),Ps=function(n){function e(e){var t=n.call(this,e)||this;return t.state={info:lo.StartInfo(e.broadcastId)},t}return R.d(e,n),e.prototype.componentWillUnmount=function(){lo.StopInfo(this.state.info)},e.prototype.OnCloseClick=function(e){this.props.onRequestClose&&(e.stopPropagation(),this.props.onRequestClose())},e.prototype.render=function(){var e=this.props,t=e.onClick,n=e.onRequestClose,o=this.state.info,i=o.m_strAppTitle,r=o.m_strThumbnailUrl,a=o.m_strTitle,s=new D.a(this.props.broadcastId),c=a;return a||(c=Object($.b)("#PersonaStateWatchingBroadcast_Player",ci.FriendStore.GetPlayer(s.GetAccountID()).display_name)),Ee.createElement("div",{className:"broadcastInfoContainer",onClick:t},Ee.createElement("div",{className:"broadcastDetails"},Ee.createElement("div",{className:"nowWatching"},Object($.b)("#Broadcast_NowWatching")),Ee.createElement("div",{className:"gameTitle"},i),Ee.createElement("div",{className:"broadcastTitle"},c)),Ee.createElement("div",{className:"thumbnail"},r&&Ee.createElement(Ls,{className:"thumbnailImg",src:r,duration:2500})),n&&Ee.createElement("div",{className:"actions",onClick:this.OnCloseClick},Ee.createElement(ui.ib,null)))},R.c([T.a],e.prototype,"OnCloseClick",null),e=R.c([or.observer],e)}(Ee.Component),As=Object(or.observer)(function(e){var t=e.group;return Ee.createElement("div",{className:"statMemberStat statMembersTotal"},Ee.createElement("div",{className:"statCircle"}),Object($.c)("#Chat_Members",t.memberCountTotal))}),Bs=Object(or.observer)(function(e){var t=e.group;return 0==t.memberCountInGame?null:Ee.createElement("div",{className:"statMemberStat statMembersInGame",title:Object($.c)("#Chat_Members_InGame_Tooltip",t.memberCountInGame)},Ee.createElement("div",{className:"statCircle"}),t.memberCountInGame)}),Fs=Object(or.observer)(function(e){var t=e.group;return 0==t.memberCountOnline?null:Ee.createElement("div",{className:"statMemberStat statMembersOnline",title:Object($.c)("#Chat_Members_Online_Tooltip",t.memberCountOnline)},Ee.createElement("div",{className:"statCircle"}),t.memberCountOnline)}),Vs=Object(or.observer)(function(e){if(!e.small&&!e.micro&&e.clan.BIsOGG()&&e.clan.GetOGGAppID()){var t=ci.AppInfoStore.GetAppInfo(e.clan.GetOGGAppID());return Ee.createElement("div",{className:"ChatRoomGroupOGGAvatar "+(e.large?"Large":"")},Ee.createElement("img",{className:"OGGAvatar",src:t.header_image_url}))}var n="";return e.micro?n="Micro":e.small?n="Small":e.large&&(n="Large"),Ee.createElement("div",{className:"ChatRoomGroupAvatar "+n},Ee.createElement("img",{className:"ChatRoomGroupAvatar_Avatar",src:e.large?e.clan.avatar_url_full:e.clan.avatar_url_medium}))}),xs=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return R.d(t,e),t.prototype.render=function(){var n=this,e=this.props.group;if(e&&e.BIsClanChatRoom()){var t=ci.FriendStore.ClanStore.GetClan(e.GetClanID());return Ee.createElement(Vs,{clan:t,micro:this.props.micro,small:this.props.small,large:this.props.large})}var o="";if(this.props.micro?o="Micro":this.props.small?o="Small":this.props.large&&(o="Large"),e&&!e.IsNamedGroupChat()){var i=e.members_to_highlight,r=i.members,a=i.remaining_count;if(r.length){var s=r.length+(a?1:0);return Ee.createElement("div",{className:"ChatRoomMultiFriendAvatar With"+s+"Items "+o},r.map(function(e,t){return Ee.createElement("img",{src:n.props.large?e.persona.avatar_url_medium:e.persona.avatar_url,key:t,className:"MultiAvatar Index"+t})}),0<a&&Ee.createElement("div",{className:"ChatRoomMultiFriendMore MultiAvatar Index3"},"+",a))}}if(e&&e.hasIcon)return Ee.createElement("div",{className:"ChatRoomGroupAvatar HasAvatar "+o},Ee.createElement("img",{className:"ChatRoomGroupAvatar_Avatar",src:e.avatar_url_full}));var c="";e?c=e.name:this.props.name&&(c=this.props.name);var l=function(e){if(e.length<=2)return e;for(var t=e.charAt(1),n=Ln(t),o=2;o<e.length;o++){var i=e.charAt(o);if(n||!Ln(i)){if(" "==i){0<(i=e.charAt(o+1)).length&&(t=i);break}}else n=!0,t=i}return e.charAt(0)+t}(c),p="ChatRoomGroupAvatar "+o;return Nn(l)&&(p+=" EmojiInitials"),Ee.createElement("div",{className:p},Ee.createElement("div",{className:"ChatRoomGroupAvatar_initials"},l))},t=R.c([or.observer],t)}(Ee.Component);var Us=function(n){function e(e){var t=n.call(this,e)||this;return t.m_iActiveDragIndex=void 0,t.m_ActiveDrag=void 0,t.m_ActiveDragOut=void 0,t.m_bGhostIsDupe=!1,t.m_rgFavoriteElementRefs=[],t.m_bAcceptDrag=!1,t.state={bHintDismissed:_d.UIDisplayPrefs.bFavoritesHintDismissed},t}return R.d(e,n),e.prototype.DismissFavoritesHint=function(){this.setState({bHintDismissed:!0}),_d.SetUIDisplayPref("bFavoritesHintDismissed",!0)},e.prototype.render=function(){var r=this,e=this.props.FavoritesStore.favorites,a=this.m_ActiveDrag,t="quickAccessFriends emptyQuickAccess";if(this.state.bHintDismissed&&(t+=" hintDismissed"),e.length||a){var n=e,o=ci.SettingsStore.FriendsSettings.bCompactQuickAccess;if(a){if(this.m_bGhostIsDupe&&n.findIndex(function(e){return pt(e,a)}),void 0===this.m_iActiveDragIndex||this.m_iActiveDragIndex>=n.length)n=n.concat([R.a({isActiveDrag:!0},a)]);else{this.m_iActiveDragIndex;n=n.slice(0,this.m_iActiveDragIndex).concat([R.a({isActiveDrag:!0},a)],n.slice(this.m_iActiveDragIndex))}}var i=n.map(function(e,t){var n;if(e.friend)n="f"+e.friend.accountid;else if(e.clan)n="cl"+e.clan.clanid;else{if(!e.chat)return null;n="cg"+e.chat.GetGroupID()}var o=r.m_bGhostIsDupe&&!e.isActiveDrag&&pt(a,e),i=e.isActiveDrag;return i&&(n+="dragGhost"),Ee.createElement(js,{favorite:e,index:t,friendRenderContext:r.GetFriendRenderContext(),key:n,bIsDragGhost:i,bIsDragOutGhost:o,ref:r.OnFavoriteElementRef.bind(r,t)})}),s="quickAccessFriends";return o&&(s+=" compactQuickAccess"),Ee.createElement(nr,R.a({className:s},this.GetDragDropProps()),i,Ee.createElement("div",{className:"dropTargetBox"}))}return Ee.createElement(nr,R.a({className:t},this.GetDragDropProps()),Ee.createElement("div",{className:"quickAccessFriendsMessage"},Object($.b)("#FriendsList_Favorites_Hint")),!this.state.bHintDismissed&&Ee.createElement("div",{className:"quickAccessFriendsMessageDismiss",onClick:this.DismissFavoritesHint},Object($.b)("#Generic_Got_It")),Ee.createElement("div",{className:"dropTargetBox"}))},e.prototype.OnFavoriteElementRef=function(e,t){this.m_rgFavoriteElementRefs[e]=t},e.prototype.GetFriendRenderContext=function(){return this.m_FriendRenderContext||(this.m_FriendRenderContext={chatContext:"friendslist"}),this.m_FriendRenderContext},e.prototype.GetDragDropProps=function(){var e={rgAcceptedTypes:["friend","chattab","chatroomgroup","clan"]};return e.fnDragEnter=this.OnDragEnter,e.fnDragOver=this.OnDragOver,e.fnDragLeave=this.OnDragLeave,e.fnDrop=this.OnDrop,e.onDragStart=this.OnDragStart,e.onDragEndCapture=this.OnDragEnd,e},e.prototype.OnDragStart=function(e){var t=_d.DragDropManager.GetDragData();!t||"friend"!=t.type&&"chatroomgroup"!=t.type&&"clan"!=t.type||(t.is_favorite=!0,this.m_ActiveDragOut=this.FindItemFromDrag(t))},e.prototype.OnDragEnd=function(e){var t=_d.DragDropManager.GetDragData(),n=this.FindItemFromDrag(t);if(n&&"is_favorite"in t&&t.is_favorite&&!_d.DragDropManager.BWasDropConsumed()){var o=e.currentTarget.getBoundingClientRect();100<Object(Ci.k)(o,e.clientX,e.clientY)&&(this.props.FavoritesStore.RemoveFromFavorites(n),_d.DragDropManager.EndDrag())}this.m_ActiveDragOut=void 0},e.prototype.FindItemFromDrag=function(e){var t,n,o,i;if("friend"==e.type)n=e.friend;else if("chattab"==e.type){var r=e.tab;if(r instanceof xt){var a=r.GetGroup();a.BIsClanChatRoom()&&(o=ci.FriendStore.ClanStore.GetClan(a.GetClanID())),i=a}else{n=r.GetChatView().chat.chat_partner}}else"chatroomgroup"==e.type?i=e.group:"clan"==e.type&&(o=e.clan);return n?n.is_friend&&(t={friend:n}):o?t={clan:o}:i&&(t={chat:i}),t},e.prototype.OnDragEnter=function(e,t){var n=this.FindItemFromDrag(e);return n&&!pt(this.m_ActiveDrag,n)&&(this.m_ActiveDrag=n,this.m_bGhostIsDupe=this.props.FavoritesStore.BIsFavorited(n)),!0},e.prototype.OnDragOver=function(e){for(var t,n,o=0,i=this.m_rgFavoriteElementRefs;o<i.length;o++){var r=i[o],a=r&&r.GetBoundingClientRect();if(a){var s=Object(Ci.k)(a,e.clientX,e.clientY);(void 0===n||s<n)&&(n=s,t=r)}}t&&(this.m_iActiveDragIndex=t.props.index),e.dataTransfer.dropEffect="copy"},e.prototype.ResetDragState=function(){this.m_ActiveDrag=void 0,this.m_ActiveDragOut=void 0,this.m_iActiveDragIndex=void 0},e.prototype.OnDragLeave=function(){this.m_ActiveDrag&&this.ResetDragState()},e.prototype.OnDrop=function(e,t){var n=this.FindItemFromDrag(e);this.m_ActiveDrag;n?(_d.DragDropManager.SetDropConsumed(),this.props.FavoritesStore.AddToFavorites(n,this.m_iActiveDragIndex),this.ResetDragState()):this.m_ActiveDrag&&this.ResetDragState()},R.c([d.observable],e.prototype,"m_iActiveDragIndex",void 0),R.c([d.observable],e.prototype,"m_ActiveDrag",void 0),R.c([d.observable],e.prototype,"m_ActiveDragOut",void 0),R.c([T.a],e.prototype,"DismissFavoritesHint",null),R.c([T.a],e.prototype,"OnDragStart",null),R.c([T.a],e.prototype,"OnDragEnd",null),R.c([T.a],e.prototype,"OnDragEnter",null),R.c([T.a],e.prototype,"OnDragOver",null),R.c([T.a],e.prototype,"OnDragLeave",null),R.c([T.a],e.prototype,"OnDrop",null),e=R.c([or.observer],e)}(Ee.Component),js=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return R.d(t,e),t.prototype.GetBoundingClientRect=function(){var e=W.findDOMNode(this);return e?e.getBoundingClientRect():null},t.prototype.onFavoriteElementClick=function(e){var t=this.props.favorite;if(t.friend)this.props.favorite.friend.OpenChatDialog(cd(null,e));else if(t.clan)t.clan.OpenChatDialog(cd(this,e));else{if(!t.chat)return;ci.UIStore.ShowAndOrActivateChatRoomGroup(cd(this,e),t.chat,!0)}e.stopPropagation()},t.prototype.OnFavoriteElementContextMenu=function(e){var t,n,o,i,r,a=this.props.favorite;if(a.friend)Jr(cd(this,e),this.props.friendRenderContext,a.friend,e);else if(a.clan)t=e,n=a.clan,o={is_favorites:!0},r=cd(null,t),n.GetChatGroupIDIfLoaded()&&(i=ci.ChatStore.GetChatRoomGroup(n.GetChatGroupIDIfLoaded())),Object(mi.a)(Ee.createElement(va,{browserContext:r,group:i,clan:n,context:o,ownerWindow:t.currentTarget.ownerDocument.defaultView}),t);else{if(!a.chat)return;ba(e,a.chat,{is_favorites:!0})}e.stopPropagation()},t.prototype.render=function(){var e,t,n="quickAccessFriend",o=this.props.favorite;this.props.bIsDragGhost?n+=" dropGhost":this.props.bIsDragOutGhost&&(n+=" dragOriginGhost"),this.props.bIsDragOutGhost&&(e={display:"none"}),t=o.friend?Ee.createElement(Hs,{key:o.friend.accountid,friend:o.friend,friendRenderContext:this.props.friendRenderContext,className:n}):o.clan?Ee.createElement(Ws,{key:o.clan.clanid,clan:o.clan,className:n}):o.chat?Ee.createElement(zs,{key:o.chat.GetGroupID(),chat:o.chat,className:n}):null;var i=Ee.createElement("div",{style:e,className:"favoriteElement",onClick:this.onFavoriteElementClick,onContextMenu:this.OnFavoriteElementContextMenu},t);return o.friend?Ee.createElement(Wc,{friend:o.friend,context:this.props.friendRenderContext},i):i},R.c([T.a],t.prototype,"onFavoriteElementClick",null),R.c([T.a],t.prototype,"OnFavoriteElementContextMenu",null),t}(Ee.Component),Hs=Object(or.observer)(function(e){var t=e.friend,n=ci.SettingsStore.FriendsSettings.bCompactQuickAccess,o=null;t.persona.is_awayOrSnooze&&(o=Ee.createElement(ps,{persona:t.persona,className:"SnoozeContainer",size:"medium",dim:!0}));var i=void 0;if(t.persona.is_ingame){var r=ci.AppInfoStore.GetAppInfo(t.persona.m_unGamePlayedAppID);r.is_valid&&(i=Ee.createElement("div",{className:"FavoriteFriend_GameIcon"},Ee.createElement("img",{className:"gameIcon",src:r.icon_url,draggable:!1})))}for(var a=!1,s=0,c=ci.ChatStore.FriendChatStore.GetUnfilteredFriendsWithUnreadMessages();s<c.length;s++){if(c[s].accountid_partner==t.accountid){a=!0;break}}var l=null;return a&&(l=Ee.createElement("div",{className:"ChatUnreadMessageIndicator"},Ee.createElement("div",{className:"chatUnreadCircle"}))),Ee.createElement(zc,{friend:t,key:t.accountid,className:e.className,context:e.friendRenderContext,bFriendsListEntry:!0,bSingleClickActivate:!0},Ee.createElement("div",null,Ee.createElement(qr,{persona:t.persona,size:"Medium"},i,o),!n&&Ee.createElement("div",{className:"playerNameQuickAccessContainer"},Ee.createElement("div",{className:"playerName"},t.display_name),t.is_display_name_nickname&&Ee.createElement("span",{className:"playerNicknameBracket",title:Object($.b)("#isNickname")},"*")),l))}),Ws=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return R.d(t,e),t.prototype.OnDragStart=function(e){_d.DragDropManager.StartDrag({type:"clan",clan:this.props.clan})},t.prototype.OnDragEnd=function(e){_d.DragDropManager.EndDrag()},t.prototype.render=function(){var e="QuickAccessFriend QuickAccessClan",t=ci.SettingsStore.FriendsSettings.bCompactQuickAccess;this.props.className&&(e+=" "+this.props.className);var n=null,o=this.props.clan.GetChatGroupIDIfLoaded();if(o){var i=ci.ChatStore.GetChatRoomGroup(o);i&&(n=Ee.createElement(wa,{group:i}))}return Ee.createElement("div",{className:e,draggable:!0,onDragStart:this.OnDragStart,onDragEnd:this.OnDragEnd},Ee.createElement(Vs,{clan:this.props.clan,small:!0}),!t&&Ee.createElement("div",{className:"clanName"},this.props.clan.name),n)},R.c([T.a],t.prototype,"OnDragStart",null),R.c([T.a],t.prototype,"OnDragEnd",null),t=R.c([or.observer],t)}(Ee.Component),zs=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return R.d(t,e),t.prototype.OnDragStart=function(e){_d.DragDropManager.StartDrag({type:"chatroomgroup",group:this.props.chat})},t.prototype.OnDragEnd=function(e){_d.DragDropManager.EndDrag()},t.prototype.render=function(){var e="QuickAccessChat",t=null,n=ci.SettingsStore.FriendsSettings.bCompactQuickAccess;return this.props.chat.HasUnreadChatMessage&&(t=Ee.createElement(wa,{group:this.props.chat})),this.props.className&&(e+=" "+this.props.className),Ee.createElement("div",{className:e,draggable:!0,onDragStart:this.OnDragStart,onDragEnd:this.OnDragEnd},Ee.createElement(xs,{group:this.props.chat}),!n&&Ee.createElement("div",{className:"clanName"},this.props.chat.name),t)},R.c([T.a],t.prototype,"OnDragStart",null),R.c([T.a],t.prototype,"OnDragEnd",null),t=R.c([or.observer],t)}(Ee.Component);function qs(e,t,n,o,i){void 0===o&&(o=!1),fr(Ee.createElement(Ys,{browserContext:e,chatViewToReplace:n,bHideChatNameEntry:o,vecInvitePlayers:i}),t,"CreateChatDialog",{strTitle:Object($.b)("#Chat_CreateChatRoom"),popupWidth:664,popupHeight:580},pd(t))}function Ks(e,n,t,o){var i=ld(e),r=ci.ChatStore.FindNamelessChatGroupWithFriends(t);r?ci.UIStore.ReplaceFriendChatWithGroup(i,n,r):ci.ChatStore.CreateChatRoomGroup(i,"",t,o).then(function(e){ci.UIStore.GetPerContextChatData(i);var t=ci.ChatStore.GetChatRoomGroup(e);t&&ci.UIStore.ReplaceFriendChatWithGroup(i,n,t)}).catch(function(){yr(e,Object($.b)("#Generic_Error"),Object($.b)("#Chat_CreateChatRoom_GenericError"))})}var Ys=function(n){function e(e){var t=n.call(this,e)||this;ci.FriendStore.self;return t.state={strCurrentNameEntry:"",strError:void 0,bHaveAnyFriendsSelected:e.vecInvitePlayers&&0<e.vecInvitePlayers.length,bHaveNonBetaFriendsSelected:!1,bCreateInFlight:!1},t}return R.d(e,n),e.prototype.HandleTextEntry=function(e){this.setState({strCurrentNameEntry:e.target.value})},e.prototype.OnFriendPickerRef=function(e){this.m_friendPicker=e},e.prototype.OnFriendListSelectionChanged=function(){var e=!1,t=!1;if(this.m_friendPicker){e=0<this.m_friendPicker.selectedFriendCount;for(var n=function(e){if(!1===e.is_in_beta)return t=!0,"break";void 0===e.is_in_beta&&Object(d.when)(function(){return void 0!==e.is_in_beta},o.OnFriendListSelectionChanged)},o=this,i=0,r=this.m_friendPicker.state.rgFriendsChosen;i<r.length;i++){if("break"===n(r[i]))break}}e==this.state.bHaveAnyFriendsSelected&&t==this.state.bHaveNonBetaFriendsSelected||this.setState({bHaveAnyFriendsSelected:e,bHaveNonBetaFriendsSelected:t})},e.prototype.HandleSubmit=function(e){var t=this;if(e&&e.preventDefault(),!this.state.bCreateInFlight){var n=Object(Ci.m)(e);this.setState(function(e){return e.bCreateInFlight||t.InternalDoSubmit(n),{bCreateInFlight:!0}})}},e.prototype.InternalDoSubmit=function(e){var t=this,n=[];this.m_friendPicker&&(n=this.m_friendPicker.state.rgFriendsChosen.map(function(e){return e.persona.m_steamid.ConvertTo64BitString()}));var o=this.props.chatViewToReplace;if(o){var i=new ft(this.props.chatViewToReplace.chat.accountid_partner);return n.push(i.persona.m_steamid.ConvertTo64BitString()),Ks(e,o,n),void this.props.closeModal()}var r=this.props.bHideChatNameEntry?"":this.state.strCurrentNameEntry;ci.ChatStore.CreateChatRoomGroup(this.props.browserContext,r,n,this.props.creationOptions).then(function(e){t.props.closeModal()}).catch(function(){t.setState({strError:Object($.b)("#Chat_CreateChatRoom_GenericError"),bCreateInFlight:!1})})},e.prototype.IsChatRoomNameValid=function(){return 0<this.state.strCurrentNameEntry.length},e.prototype.render=function(){var e=this.props.chatViewToReplace?this.props.chatViewToReplace.chat.chat_partner:null,t=Object($.b)("#Chat_CreateChatRoom_Button"),n=new Set;this.props.chatViewToReplace&&n.add(this.props.chatViewToReplace.chat.accountid_partner);var o=!1;this.state.bCreateInFlight?(o=!1,t=Object($.b)("#GroupSettings_Permissions_Saving")):e?o=this.state.bHaveAnyFriendsSelected:(o=this.IsChatRoomNameValid()||this.state.bHaveAnyFriendsSelected,this.IsChatRoomNameValid()&&!this.state.bHaveAnyFriendsSelected?t=Object($.b)("#Chat_CreateChatRoom_Button"):this.state.bHaveAnyFriendsSelected&&!this.IsChatRoomNameValid()?t=Object($.b)("#Chat_CreateChatRoom_InviteFriends"):this.state.bHaveAnyFriendsSelected&&this.IsChatRoomNameValid()&&(t=Object($.b)("#Chat_CreateChatRoom_Button_wFriends")));var i=this.props.strTitle||(e?Object($.b)("#Chat_CreateChatRoom_InviteFriends"):Object($.b)("#Chat_CreateChatRoom"));return Ee.createElement(sr,{onEscKeypress:this.props.closeModal},Ee.createElement(Fi,{classNameContent:"CreateChatDialog",onSubmit:this.HandleSubmit},Ee.createElement(wi,null,i),Ee.createElement(Gi,null,e&&Ee.createElement(Ti,null,Ee.createElement("span",null,Object($.b)("#Chat_CreateChatRoom_With"),Ee.createElement("span",{className:"DialogHighlight"},Object($.b)("#Chat_CreateChatRoom_You")),Object($.b)("#Chat_CreateChatRoom_And"),Ee.createElement("span",{className:"DialogHighlight"},e.display_name))),this.state.strError&&Ee.createElement(Ti,{className:"nicknameError"},this.state.strError),!this.props.bHideChatNameEntry&&Ee.createElement(Wi,{type:"text",label:Object($.b)("#Chat_Settings_Room_Name"),className:"nicknameInput",value:this.state.strCurrentNameEntry,onChange:this.HandleTextEntry,autoFocus:!0}),Ee.createElement(Ti,{className:"CreateChat_NonBetaFriendsWarning "+(ci.IsInBeta()?"":" Released")+(this.state.bHaveNonBetaFriendsSelected?" Active":"")},Ee.createElement(Js,null),Object($.b)(ci.IsInBeta()?"#Chat_InviteFriend_SomeUnavailable":"#Chat_InviteFriend_SomeUnavailable_Released")),Ee.createElement(Or,{ref:this.OnFriendPickerRef,label:Object($.b)("#Chat_DropToInviteGroup"),eSort:1,setExcludedFriends:n,autoFocus:this.props.bHideChatNameEntry,onFriendSelected:this.OnFriendListSelectionChanged,onFriendRemoved:this.OnFriendListSelectionChanged,rgSelectedFriends:this.props.vecInvitePlayers,chosenFriendComponent:Xs})),Ee.createElement(Mi,null,Ee.createElement(Hi,{strOKText:t,onCancel:this.props.closeModal,bOKDisabled:!o}))))},R.c([T.a],e.prototype,"HandleTextEntry",null),R.c([T.a],e.prototype,"OnFriendPickerRef",null),R.c([T.a],e.prototype,"OnFriendListSelectionChanged",null),R.c([T.a],e.prototype,"HandleSubmit",null),e=R.c([or.observer],e)}(Ee.Component);function Js(){return Ee.createElement("div",{className:"FriendPicker_InvitedFriend_NotInBetaWarning",title:Object($.b)(ci.IsInBeta()?"#Chat_InviteFriend_SomeUnavailable":"#Chat_InviteFriend_SomeUnavailable_Released")},"!")}var Xs=Object(or.observer)(function(e){var t=e.friend.is_in_beta||void 0===e.friend.is_in_beta;return Ee.createElement(Ee.Fragment,null,Ee.createElement(Wc,{friend:e.friend,context:null},Ee.createElement("div",{className:"FriendPicker_ChosenFriend"+(t?"":" FriendPicker_InvitedFriendNotInBeta"),onClick:function(){e.onClick(e.friend)}},!t&&Ee.createElement(Js,null),Ee.createElement("span",null,e.friend.display_name),Ee.createElement(ui.jb,null))))}),Qs=n("r6f6"),Zs=n.n(Qs),$s=function(){function e(e){this.m_bLoadingData=!1,this.m_accountid=e}return Object.defineProperty(e.prototype,"community_data",{get:function(){return this.m_communityData},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"community_data_ready",{get:function(){return void 0!==this.m_communityData},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"player_level",{get:function(){return this.m_communityData&&this.m_communityData.level},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"player_level_class",{get:function(){return this.m_communityData&&this.m_communityData.level_class},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"player_badge",{get:function(){return this.m_communityData&&this.m_communityData.favorite_badge},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"player_in_game",{get:function(){return this.m_communityData&&this.m_communityData.in_game},enumerable:!0,configurable:!0}),e.prototype.EnsureCommunityDataLoaded=function(){var n=this;void 0!==this.m_communityData||this.m_bLoadingData||(this.m_bLoadingData=!0,C.a.get(_.b.CHAT_BASE_URL+"miniprofile/"+this.m_accountid+"/json").then(function(e){var t=e.data;t.level&&t.level_class&&(n.m_communityData=t),n.m_bLoadingData=!1}).catch(function(e){n.m_bLoadingData=!1}))},R.c([d.observable],e.prototype,"m_communityData",void 0),e}(),ec=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return R.d(t,e),t.prototype.render=function(){var e=this.props.community_data&&this.props.community_data.favorite_badge;return e?Ee.createElement("div",{className:Zs.a.miniProfileFeaturedContainer},Ee.createElement("div",{className:Zs.a.favoriteBadgeIcon},Ee.createElement("img",{src:e.icon,className:Zs.a.badgeIcon})),Ee.createElement("div",{className:hr(Zs.a.featuredLabels,Zs.a.favoriteBadgeDescription)},Ee.createElement("div",{className:Zs.a.featuredTitle},e.name),Ee.createElement("div",{className:Zs.a.featuredSubTitle},Object($.b)("#Hover_BadgeXP",e.xp)))):null},t=R.c([or.observer],t)}(Ee.Component),tc=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return R.d(t,e),t.prototype.render=function(){return this.props.community_data_ready?Ee.createElement("div",{className:Zs.a.miniProfileFeaturedContainer},Ee.createElement("div",{className:this.props.community_data.level_class},Ee.createElement("span",{className:Zs.a.friendPlayerLevelNum},this.props.community_data.level)),Ee.createElement("div",{className:Zs.a.featuredLabels},Ee.createElement("div",{className:Zs.a.featuredTitle},Object($.b)("#Hover_SteamLevel")+" "))):null},t=R.c([or.observer],t)}(Ee.Component),nc=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return R.d(t,e),t.prototype.render=function(){var e=this.props.persona;return Ee.createElement("div",{className:Zs.a.miniProfileGameContainer},this.props.persona.GetCurrentGameLogoURL()&&Ee.createElement("img",{className:Zs.a.gameLogo,src:this.props.persona.GetCurrentGameLogoURL()}),Ee.createElement("div",{className:hr(Zs.a.gameContent,Zs.a.persona,Zs.a.ingame,Zs.a.ellipsis)},Ee.createElement("div",{className:Zs.a.gameState},Object($.b)(e.is_in_nonsteam_game?"#PersonaStateInNonSteamGame":"#PersonaStateInGame")),this.props.persona.GetCurrentGameName(),this.props.persona.HasCurrentGameRichPresence()&&Ee.createElement("div",{className:Zs.a.richPresence},this.props.persona.GetCurrentGameRichPresence())))},t=R.c([or.observer],t)}(Ee.Component),oc=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return R.d(t,e),t.prototype.render=function(){var e,t,n=this.props.broadcast_description;return n&&(e=Object($.b)("#PersonaStateWatchingBroadcast"),t=n),Ee.createElement("div",{className:Zs.a.miniProfileGameContainer},this.props.persona.GetBroadcastGameLogoURL()&&Ee.createElement("img",{className:Zs.a.gameLogo,src:this.props.persona.GetBroadcastGameLogoURL()}),Ee.createElement("div",{className:hr(Zs.a.gameContent,Zs.a.persona,Zs.a.watchingbroadcast,Zs.a.ellipsis)},Ee.createElement("div",{className:Zs.a.gameState},e),t&&Ee.createElement("div",{className:Zs.a.richPresence},t),Ee.createElement("div",{className:Zs.a.watchingbroadcastThumbnail},this.props.broadcast_thumbnail)))},t=R.c([or.observer],t)}(Ee.Component),ic=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return R.d(t,e),t.prototype.render=function(){var e=this.props,t=(e.className,e.persona),n=(e.community_data_ready,e.community_data,e.nickname),o=e.is_friend,i=e.is_blocked,r=(e.friend_relationship,e.broadcast_description,e.broadcast_thumbnail,e.mutual_friends,R.f(e,["className","persona","community_data_ready","community_data","nickname","is_friend","is_blocked","friend_relationship","broadcast_description","broadcast_thumbnail","mutual_friends"])),a=void 0,s=Zs.a.miniProfileContent;t.is_ingame?a=Ee.createElement(nc,R.a({},this.props)):t.is_watchingbroadcast?a=Ee.createElement(oc,R.a({},this.props)):s+=" "+Zs.a.notInOrWatchingGame;var c=!0,l=!1,p=!1;o||(s+=" "+Zs.a.notFriends,c=!1),i&&(s+=" "+Zs.a.communicationBlocked,p=!0);var u=void 0!==n,m=void 0,d=t.is_awayOrSnooze;return m=u?Ee.createElement("div",{className:hr(Zs.a.personaName,Zs.a.hasNickname)},"(",Ee.createElement("div",{className:Zs.a.personaNameLabel},t.m_strPlayerName),")"):Ee.createElement("div",{className:Zs.a.personaName},Ee.createElement("div",{className:Zs.a.personaNameLabel},t.m_strPlayerName)),2==this.props.friend_relationship&&(l=!0),Ee.createElement(Ee.Fragment,null,Ee.createElement("div",R.a({className:hr(this.props.className,Zs.a.miniProfile)},r),Ee.createElement("div",{className:s},Ee.createElement("div",{className:Zs.a.miniProfileBackground},Ee.createElement("img",{className:Zs.a.miniProfileBackgroundBlur,src:t.avatar_url})),Ee.createElement("div",{className:Zs.a.miniProfileHeader},Ee.createElement("div",{className:hr(Zs.a.miniProfilePlayer,t.online_state,d&&Zs.a.isAway,ne(t))},Ee.createElement(qr,{persona:this.props.persona,size:"X-Large",statusPosition:"bottom",className:Zs.a.playerAvatar}),d&&Ee.createElement(ps,{persona:t,animating:!0,className:Zs.a.SnoozeContainer,size:"large"}),Ee.createElement("div",{className:Zs.a.playerContent},Ee.createElement("div",{className:Zs.a.playerName},Ee.createElement("div",{className:Zs.a.persona},u&&Ee.createElement("div",{className:hr(Zs.a.personaName,Zs.a.nickName)},Ee.createElement("div",{className:Zs.a.personaNameLabel},this.props.nickname),Ee.createElement("div",{className:Zs.a.playerNicknameBracket,title:Object($.b)("#isNickname")},"*")),m,Ee.createElement(ds,{persona:t}),d&&Ee.createElement("div",{className:Zs.a.awayStatusLabel},Object($.b)("#PersonaStateAway")),!t.is_online&&Ee.createElement("div",{className:Zs.a.awayStatusLabel},this.props.persona.GetLocalizedOnlineStatus()),"online"==t.online_state&&!d&&Ee.createElement("div",{className:Zs.a.awayStatusLabel},Object($.b)("#PersonaStateOnline")),!c&&Ee.createElement("div",{className:Zs.a.miniProfileNotFriends},l?Object($.b)("#Friend_Menu_NotAFriendRequesting"):Object($.b)("#Friend_Menu_NotAFriendLabel")),p&&Ee.createElement("div",{className:Zs.a.miniProfileBlocked},Object($.b)("#PersonaStateBlocked"))))))),a,Ee.createElement("div",{className:Zs.a.miniProfileBottom},Ee.createElement(ec,R.a({},this.props)),Ee.createElement(tc,R.a({},this.props))),Ee.createElement("div",{className:Zs.a.mutualFriends},this.props.mutual_friends))))},t=R.c([or.observer],t)}(Ee.Component),rc=n("H+H8"),ac=n.n(rc),sc=function(n){function e(e){var t=n.call(this,e)||this;return t.m_bNoSpace=!1,t.state={x:void 0,y:void 0,hoverPositionReady:!1},t}return R.d(e,n),e.prototype.bindHover=function(e){this.m_elHover=e||void 0,this.positionHover()},e.prototype.componentDidUpdate=function(){this.positionHover()},e.prototype.render=function(){var e=Object.assign({left:this.state.x,top:this.state.y},this.props.style),t=!this.props.visibilityObserver||this.props.visibilityObserver.visible;return Ee.createElement("div",{className:hr(this.props.className,ac.a.HoverPosition,t&&this.state.hoverPositionReady&&ac.a.ready,this.m_bNoSpace&&ac.a.nospace),style:e,ref:this.bindHover},this.props.children)},e.prototype.positionHover=function(){var e=this.m_elHover,t=this.props.target;if(e&&t&&(!this.state.hoverPositionReady||!this.props.visibilityObserver||this.props.visibilityObserver.visible)){var n=t.ownerDocument.defaultView;if(n&&!n.closed){var o=e.querySelector(".hover_arrow.left"),i=e.querySelector(".hover_arrow.right"),r=i,a=t.getBoundingClientRect(),s=e.getBoundingClientRect(),c=a.left,l=a.top,p=a.right+s.width+14,u=n.innerWidth-p,m=a.left-s.width;if(u<14&&u<m){if((c=a.left-s.width+2+3)<-10)return e.setAttribute("style","display: none;"),this.m_bNoSpace=!0,void(this.props.onNoSpace&&this.props.onNoSpace());o&&o.setAttribute("style","display: none;"),i&&i.setAttribute("style","")}else{if((c=a.left+a.width-2)+s.width-10>n.innerWidth)return e.setAttribute("style","display: none;"),this.m_bNoSpace=!0,void(this.props.onNoSpace&&this.props.onNoSpace());(r=o)&&o.setAttribute("style",""),i&&i.setAttribute("style","display: none;")}var d=0;if(a.height<48&&(d=Math.floor(a.height/2)-24),l=a.top-15+d,a.top+s.height+35>n.innerHeight){var h=s.height+35-(n.innerHeight-a.top),_=null!=e.querySelector(".miniprofile_ingame")?78:24;h=Math.min(s.height-_,h);var f=a.top-h;r&&r.setAttribute("style","top: "+(30+l-f)+"px"),l=f}c!=this.state.x&&this.setState({x:c}),l!=this.state.y&&this.setState({y:l}),this.state.hoverPositionReady||this.setState({hoverPositionReady:!0})}}},R.c([T.a],e.prototype,"bindHover",null),e=R.c([or.observer],e)}(Ee.Component);n("7oej");function cc(e){return Ee.createElement(sc,{target:e.target,className:"friendHover miniProfileHover",visibilityObserver:e.hoverInstance,onNoSpace:e.onNoSpace},Ee.createElement(uc,{hoverInstance:e.hoverInstance}))}var lc=function(o){function e(e){var t=o.call(this,e)||this,n=t.props.broadcastAccountID&&D.a.InitFromAccountID(t.props.broadcastAccountID);return t.state={broadcastInfo:n&&lo.StartInfo(n.ConvertTo64BitString())},t}return R.d(e,o),e.prototype.componentDidUpdate=function(e){if(this.props.broadcastAccountID!==e.broadcastAccountID){this.state.broadcastInfo&&lo.StopInfo(this.state.broadcastInfo);var t=this.props.broadcastAccountID&&D.a.InitFromAccountID(this.props.broadcastAccountID);this.setState({broadcastInfo:t&&lo.StartInfo(t.ConvertTo64BitString())})}},e.prototype.componentWillUnmount=function(){this.state.broadcastInfo&&lo.StopInfo(this.state.broadcastInfo)},e.prototype.render=function(){return this.state.broadcastInfo?Ee.createElement(Ls,{src:this.state.broadcastInfo.m_strThumbnailUrl}):null},e=R.c([or.observer],e)}(Ee.Component),pc=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return R.d(t,e),t.prototype.render=function(){var e=ci.FriendStore.FriendGroupStore.incoming_invites_group.map_steamid_to_mutual_friends.get(this.props.friend.steamid64);if(null==e)return Ee.createElement("div",null);for(var t=Ee.createElement("div",{className:"mutualFriendTitle"}," ",Object($.b)("#FriendGroup_MutualFriends_Title")," "),n=[],o=Array.from(e),i=0;i<o.length&&i<10;i++){var r=ci.FriendStore.GetFriend(o[i]);n.push(Ee.createElement("div",{className:"mutualFriend",key:r.steamid64},Ee.createElement("img",{className:"mutualFriendAvatar",src:r.persona.avatar_url_medium}),Ee.createElement("div",{className:"mutualFriendLabel"},r.display_name)))}return 10<=o.length&&n.push(Ee.createElement("div",{className:"mutualFriend"},Ee.createElement("div",{className:"mutualFriendLabel plusOthersLabel"},Object($.c)("#FriendGroup_MutualFriends_Others",o.length-10)))),Ee.createElement("div",{className:"mutualFriendsContainer"}," ",t," ",Ee.createElement("div",null," ",n," ")," ")},t}(Ee.Component),uc=function(t){function e(e){return t.call(this,e)||this}return R.d(e,t),e.prototype.render=function(){var e=this.props.hoverInstance.hover,t=e.persona,n={className:"miniProfileHoverInner",persona:e.persona,community_data_ready:e.community_data_ready};e.community_data_ready&&(n.community_data=e.community_data),t.is_watchingbroadcast&&(n.broadcast_description=e.friend.GetBroadcastDescription(),n.broadcast_thumbnail=Ee.createElement("div",{className:"watchingbroadcastThumbnail"},Ee.createElement(lc,{broadcastAccountID:t.m_broadcastAccountId}))),e.friend.has_nickname&&(n.nickname=e.friend.nickname),n.is_friend=e.friend.is_friend||e.friend==ci.FriendStore.self,n.is_blocked=e.friend.is_blocked,n.friend_relationship=e.friend.efriendrelationship;var o=Ee.createElement("div",null),i=this.props.hoverInstance.context;return i&&i.friendGroup&&i.friendGroup.m_eDisplayType==ut.eIncomingInvites&&(o=Ee.createElement(pc,{friend:e.friend})),n.mutual_friends=o,Ee.createElement(ic,R.a({},n))},e=R.c([or.observer],e)}(Ee.Component),mc=function(i){function e(e,t,n){var o=i.call(this,{target:e,visibilityObserver:t,className:"friendHover miniProfileHover"},n)||this;return o.m_instance=t,o}return R.d(e,i),e.prototype.OnLoad=function(){},e.prototype.OnResize=function(){},e.prototype.OnClose=function(){},e.prototype.InternalRender=function(){return Ee.createElement(uc,{hoverInstance:this.m_instance})},e}(function(o){function e(e,t){var n=o.call(this,"hoverpopup",{title:"hover",html_class:"HoverPopup client_chat_frame",body_class:"HoverPopupBody Hover"+e.className,replace_existing_popup:!0,target_browser:t,eCreationFlags:rr.c.Tooltip})||this;return n.m_hoverProps=e,n}return R.d(e,o),e.prototype.UpdateParamsBeforeShow=function(e){var t=Ci.h(this.m_hoverProps.target.ownerDocument.defaultView,this.m_hoverProps.target.getBoundingClientRect());return e.dimensions={left:t.right,top:t.top,width:1,height:1},e.availscreenwidth=this.m_hoverProps.target.ownerDocument.defaultView.screen.availWidth,e.availscreenheight=this.m_hoverProps.target.ownerDocument.defaultView.screen.availHeight,e},e.prototype.Render=function(e,t){var n=this.InternalRender();W.render(Ee.createElement(dc,R.a({},this.m_hoverProps,{popup:e}),n),t)},e}(rr.a)),dc=function(n){function e(e){var t=n.call(this,e)||this;return t.m_bNoSpace=!1,t.state={x:void 0,y:void 0,width:void 0,height:void 0,hoverPositionReady:!1},t}return R.d(e,n),e.prototype.bindHover=function(e){this.m_elHover=e||void 0,this.positionHover()},e.prototype.componentDidUpdate=function(){this.positionHover()},e.prototype.componentWillReceiveProps=function(e){this.setState({hoverPositionReady:!1})},e.prototype.render=function(){var o=this,e=!this.props.visibilityObserver||this.props.visibilityObserver.visible;this.props.className,e&&this.state.hoverPositionReady,this.m_bNoSpace;return void 0!==this.state.x&&this.props.target.ownerDocument.defaultView.SteamClient.Window.GetWindowRestoreDetails(function(e){var t=o.state.x-o.props.target.ownerDocument.defaultView.screenX,n=o.state.y-o.props.target.ownerDocument.defaultView.screenY;try{o.props.popup.SteamClient.Window.PositionWindowRelative(e,t,n,o.state.width,o.state.height)}catch(e){console.error(e)}}),Ee.createElement("div",{className:"HoverPositionPopup",ref:this.bindHover},this.props.children)},e.prototype.positionHover=function(){var e=this.m_elHover,t=this.props.target;if(e&&t&&(!this.state.hoverPositionReady||!this.props.visibilityObserver||this.props.visibilityObserver.visible)){var n=this.props.popup,o=t.ownerDocument.defaultView;if(n&&!n.closed){var i=Ci.h(o,t.getBoundingClientRect()),r=Ci.h(n,e.getBoundingClientRect()),a=i.left,s=i.top,c=n.screen,l=0;c.availLeft&&(l=c.availLeft);var p=i.right+r.width+2,u=n.screen.availWidth+l-p,m=i.left-r.width-l;a=u<2&&u<m?i.left-r.width-3+3:i.left+i.width- -3;var d=0;i.height<48&&(d=Math.floor(i.height/2)-24),s=i.top-15+d;if(i.top+r.height+0>n.screen.availHeight){var h=r.height+0-(n.screen.availHeight-i.top),_=null!=e.querySelector(".miniprofile_ingame")?78:24;h=Math.min(r.height-_,h),s=i.top-h}a=Math.floor(a),s=Math.floor(s);var f=Math.ceil(r.width),g=Math.ceil(r.height);a!=this.state.x&&this.setState({x:a}),s!=this.state.y&&this.setState({y:s}),f!=this.state.width&&this.setState({width:f}),g!=this.state.height&&this.setState({height:g}),this.state.hoverPositionReady||this.setState({hoverPositionReady:!0})}}},R.c([T.a],e.prototype,"bindHover",null),e=R.c([or.observer],e)}(Ee.Component),hc=function(){function e(){this.m_mapHovers=new WeakMap}return e.prototype.GetHover=function(e){var t=this.m_mapHovers.get(e);return t||(t=new fc(e),this.m_mapHovers.set(e,t)),t},e}(),_c=function(){function e(){}return R.c([d.observable],e.prototype,"visible",void 0),e}(),fc=function(n){function p(e){var t=n.call(this,e.accountid)||this;return t.m_friend=e,t}return R.d(p,n),Object.defineProperty(p.prototype,"friend",{get:function(){return this.m_friend},enumerable:!0,configurable:!0}),Object.defineProperty(p.prototype,"persona",{get:function(){return this.m_friend.persona},enumerable:!0,configurable:!0}),p.prototype.GetInstance=function(e,t){if(void 0===t&&(t=!1),this.m_rgInstances)for(var n=0,o=this.m_rgInstances;n<o.length;n++){if((i=o[n]).m_OwningElement==e)return i}var i;return t?((i=new _c).m_OwningElement=e,i.visible=!1,(i.hover=this).m_rgInstances?this.m_rgInstances.push(i):this.m_rgInstances=[i],i):null},p.prototype.ShowPopup=function(e,t,n){var o=this;t.visible=!0,t.m_OwningElement.ownerDocument.defaultView.setTimeout(function(){t.visible&&(t.popupWindow||(t.popupWindow=new mc(e,t,n)),t.popupWindow.Show())},250),t.m_BlurHandler=function(){o.HideByElement(t.m_OwningElement)},t.m_OwningElement.ownerDocument.defaultView.addEventListener("blur",t.m_BlurHandler),t.m_VisibilityHandler=function(e){"hidden"===e.target.visibilityState&&o.HideByElement(t.m_OwningElement)},t.m_OwningElement.ownerDocument.addEventListener("visibilitychange",t.m_VisibilityHandler)},p.prototype.Show=function(e,t){var n=this,o=e.currentTarget.ownerDocument.defaultView.innerWidth<500;if((!o||G.a.IN_CLIENT)&&!_d.DragDropManager.BInDrag()){this.EnsureCommunityDataLoaded();var i=e.currentTarget,r=cd(null,e),a=this.GetInstance(i,!0);a.context=t;var s=!1;if(G.a.IN_CLIENT){var c=ci.UIStore.GetPerContextChatData(r);s=c.BUsePopups()}if(o&&s)this.ShowPopup(i,a,r);else{var l=Ee.createElement(cc,{hoverInstance:a,target:i,onNoSpace:function(){s&&n.ShowPopup(i,a,r)}});p.m_embeddedElements.ShowElementDelayed(i.ownerDocument,250,l,a).then(function(){a.visible=!0})}}},p.prototype.Hide=function(e){this.HideByElement(e.currentTarget)},p.prototype.HideByElement=function(e){var t=this.GetInstance(e);if(t){if(t.visible=!1,t.m_BlurHandler&&(e.ownerDocument.defaultView.removeEventListener("blur",t.m_BlurHandler),t.m_BlurHandler=null),t.m_VisibilityHandler&&(e.ownerDocument.removeEventListener("visibilitychange",t.m_VisibilityHandler),t.m_VisibilityHandler=null),t.popupWindow&&!t.popupWindow.BIsClosed()){var n=t.popupWindow,o=function(){n.BIsClosed()||n.Close()};e.ownerDocument.defaultView.addEventListener("unload",o),e.ownerDocument.defaultView.setTimeout(function(){e.ownerDocument.defaultView.removeEventListener("unload",o),o()},100)}else p.m_embeddedElements.HideElement(t.m_OwningElement.ownerDocument,t,500);M.d(this.m_rgInstances,t)}},p.prototype.OnContextMenu=function(e,t){var n=Jr(cd(null,t),e,this.m_friend,t);return this.Hide(t),n},p.prototype.HideAllInstances=function(){for(var e=0,t=this.m_rgInstances.slice();e<t.length;e++){var n=t[e];this.HideByElement(n.m_OwningElement)}},p.m_embeddedElements=new di.a("CFriendHoverContainer"),R.c([T.a],p.prototype,"Show",null),R.c([T.a],p.prototype,"Hide",null),R.c([T.a],p.prototype,"OnContextMenu",null),p}($s);Ee.Component;var gc=function(n){function e(e){var t=n.call(this,e)||this;return t.m_rgSelectOptions=[{label:"Option #1",data:1},{label:"Option #2",data:2},{label:Ee.createElement("span",null,"Option ",Ee.createElement("u",null,"#3")),data:3}],t.state={inputText:"Input text",checkboxChecked:!0,selectedOption:void 0},t}return R.d(e,n),e.prototype.OKToSwitchAway=function(){return!0},e.prototype.OnInputChanged=function(e){this.setState({inputText:e.currentTarget.value})},e.prototype.OnToggled=function(e){this.setState({checkboxChecked:e})},e.prototype.OnSelectDropDownChanged=function(e){this.setState({selectedOption:e.data})},e.prototype.OnSubmit=function(){alert(JSON.stringify(this.state))},e.prototype.render=function(){return Ee.createElement(Ee.Fragment,null,Ee.createElement(Bi,{className:"DialogBody",onSubmit:this.OnSubmit},Ee.createElement("div",{className:"_FixedHeight"},Ee.createElement(Ti,null,"Text input"),Ee.createElement(Wi,{label:"INPUT TITLE",value:this.state.inputText,onChange:this.OnInputChanged}),Ee.createElement(Wi,{label:"READ ONLY",value:"You can't change this",disabled:!0}),Ee.createElement(Qi,{label:"Drop down",rgOptions:this.m_rgSelectOptions,strDefaultLabel:"Select one...",selectedOption:this.state.selectedOption,onChange:this.OnSelectDropDownChanged}),Ee.createElement(Ji,{label:"On Off Toggle",checked:this.state.checkboxChecked,onChange:this.OnToggled}),Ee.createElement("div",{style:{marginBottom:"20px"}},Ee.createElement("span",null,"Checkbox:"),Ee.createElement("div",{style:{display:"inline-block",marginLeft:"20px",verticalAlign:"middle"}},Ee.createElement(Ki,null))),Ee.createElement("div",{style:{marginBottom:"20px"}},Ee.createElement("span",null,"Round checkbox:"),Ee.createElement("div",{style:{display:"inline-block",marginLeft:"20px",verticalAlign:"middle"}},Ee.createElement(Yi,null))),Ee.createElement(Xi,{min:0,max:100,value:25}),Ee.createElement("div",{style:{marginBottom:"20px"}},Ee.createElement(ki,null,Ee.createElement(Vi,null,"PrimaryButton"),Ee.createElement(Ui,null,"TextButton"),Ee.createElement(xi,{svgicon:ui.j},"Button w/ Icon"))),Ee.createElement(Li,null,Ee.createElement(Wi,{label:"Left input",placeholder:"Placeholder"}),Ee.createElement(Wi,{label:"Right input",placeholder:"Placeholder"})),Ee.createElement(Ji,{label:"Another toggle",description:"This one has a longer description with more details."}))),Ee.createElement(Mi,null,Ee.createElement(Hi,{onCancel:this.props.onCancel})))},R.c([T.a],e.prototype,"OnInputChanged",null),R.c([T.a],e.prototype,"OnToggled",null),R.c([T.a],e.prototype,"OnSelectDropDownChanged",null),R.c([T.a],e.prototype,"OnSubmit",null),e}($i),bc=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.rgDragDropOptions=[Ee.createElement(hi,{key:"key1",id:"key1"},Ee.createElement(Ji,{label:"Draggable toggle #1"})),Ee.createElement(hi,{key:"key2",id:"key2"},Ee.createElement(Ji,{ref:e.RefTest,label:"Draggable toggle #2"})),Ee.createElement(hi,{key:"key3",id:"key3"},Ee.createElement(Ji,{label:"Draggable toggle #3"})),Ee.createElement(hi,{key:"keyz",id:"keyz"},Ee.createElement(vc,null)),Ee.createElement(hi,{key:"key4",id:"key4"},Ee.createElement(Ji,{label:"Draggable toggle #4"}))],e}return R.d(e,t),e.prototype.OKToSwitchAway=function(){return!0},e.prototype.OnSubmit=function(){alert(JSON.stringify(this.state))},e.prototype.RefTest=function(e){console.log("Got ref",e)},e.prototype.OnListReordered=function(e,t){M.f(this.rgDragDropOptions,e,t),this.forceUpdate()},e.prototype.render=function(){return Ee.createElement(Bi,{className:"DialogBody",onSubmit:this.OnSubmit},Ee.createElement(_i,{onReorder:this.OnListReordered},this.rgDragDropOptions))},R.c([T.a],e.prototype,"OnSubmit",null),R.c([T.a],e.prototype,"RefTest",null),R.c([T.a],e.prototype,"OnListReordered",null),e}($i),vc=function(n){function e(e){var t=n.call(this,e)||this;return t.state={cSeconds:0},t}return R.d(e,n),e.prototype.componentDidMount=function(){var e=this;this.m_iInterval=window.setInterval(function(){e.setState(function(e){return{cSeconds:e.cSeconds+1}})},1e3)},e.prototype.componentWillUnmount=function(){window.clearInterval(this.m_iInterval)},e.prototype.render=function(){return Ee.createElement(Wi,{value:this.state.cSeconds,disabled:!0,label:"COUNTER"})},e}(Ee.Component),Sc=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return R.d(t,e),t.prototype.OnCMToggled=function(e){e?window.localStorage.setItem(P,"true"):window.localStorage.removeItem(P),this.forceUpdate()},t.prototype.OnStickyContextMenuToggle=function(e){Object(ir.j)(e),this.forceUpdate()},t.prototype.OnMobxDevToolsToggle=function(e){!function(e){e?window.sessionStorage.setItem(Eu,"true"):window.sessionStorage.removeItem(Eu);Ou.bEnabled=e}(e),this.forceUpdate()},t.prototype.OKToSwitchAway=function(){return!0},t.prototype.render=function(){return Ee.createElement(Ee.Fragment,null,Ee.createElement(Gi,null,Ee.createElement(Ji,{label:'"Sticky" Context Menus',description:"Context menus will stay open to allow inspecting CSS",checked:Object(ir.h)(),onChange:this.OnStickyContextMenuToggle}),Ee.createElement(Ji,{label:"Enable Mobx Dev Tools",description:"Display mobx devtools in the top right of each window",checked:Ou.bEnabled,onChange:this.OnMobxDevToolsToggle}),Ee.createElement(Ji,{label:"Log all CM Traffic",description:"All messages to and from the steam servers will be logged to the browser console (F12)",checked:window.localStorage&&"true"==window.localStorage.getItem(P),onChange:this.OnCMToggled})))},R.c([T.a],t.prototype,"OnCMToggled",null),R.c([T.a],t.prototype,"OnStickyContextMenuToggle",null),R.c([T.a],t.prototype,"OnMobxDevToolsToggle",null),t}($i),yc=function(n){function e(e){var t=n.call(this,e)||this;return t.state={searchString:""},t}return R.d(e,n),e.prototype.OKToSwitchAway=function(){return!0},e.prototype.OnSearchInput=function(e){e.currentTarget.value!=this.state.searchString&&this.setState({searchString:e.currentTarget.value})},e.prototype.render=function(){var e,t=new _c;e=""==this.state.searchString?ci.FriendStore.self.steamid.GetAccountID():this.state.searchString;var n=new fc(ci.FriendStore.GetPlayer(+e));return t.hover=n,t.visible=!0,n.EnsureCommunityDataLoaded(),Ee.createElement(Bi,{className:"DialogBody"},Ee.createElement(Li,null,Ee.createElement("div",{style:{flex:1}},Ee.createElement(Di,null,"Old Throbber"),Ee.createElement("div",{className:"LoadingWrapper"},Ee.createElement("div",{className:"LoadingThrobber"},Ee.createElement("div",{className:"Bar Bar1"}),Ee.createElement("div",{className:"Bar Bar2"}),Ee.createElement("div",{className:"Bar Bar3"})),Ee.createElement("div",{className:"LoadingText"}))),Ee.createElement("div",{style:{flex:2}},Ee.createElement(Di,null,"New Throbber (W.I.P.)"),Ee.createElement("div",{className:"displayRow"},Ee.createElement(Xa,{size:"xlarge",string:"X-Large"}),Ee.createElement(Xa,{size:"large",string:"Large"}),Ee.createElement(Xa,{size:"medium",string:"Medium"}),Ee.createElement(Xa,{size:"small",string:"Small"})))),Ee.createElement(Gi,null,Ee.createElement(Di,null,"Miniprofile Tester:"),Ee.createElement("form",null,Ee.createElement("input",{className:"friendSearchInput",type:"text",name:"memberlistSearch",placeholder:"Enter SteamID",value:this.state.searchString,onInput:this.OnSearchInput,autoComplete:"off"})),Ee.createElement("div",{className:"fakeMiniProfile"},Ee.createElement(uc,{hoverInstance:t})),Ee.createElement(zc,{friend:ci.FriendStore.GetPlayer(+e),context:null})))},R.c([T.a],e.prototype,"OnSearchInput",null),e}($i);var Cc=function(t){function e(e){return t.call(this,e)||this}return R.d(e,t),e.prototype.PostDate=function(e){return ci.RTime32ToDate(e).toLocaleDateString($.a.GetPreferredLocales(),{weekday:"long",year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"numeric"})},e.prototype.render=function(){return Ee.createElement(Ee.Fragment,null,Ee.createElement("div",{className:"changeLogTitle"},Object($.b)("#changeLog_GenericUpdateTitle")),Ee.createElement("div",{className:"changeLogDate"},this.PostDate(1532044800)),Ee.createElement("div",{className:"changeLogDescription"},Ee.createElement("div",{className:"changeLogItem"},Object($.d)("#changeLog_UpdateItem71",Ee.createElement("b",null,Object($.b)("#changeLog_Note"))))),Ee.createElement("div",{className:"changeLogTitle"},Object($.b)("#changeLog_GenericUpdateTitle")),Ee.createElement("div",{className:"changeLogDate"},this.PostDate(1531443600)),Ee.createElement("div",{className:"changeLogDescription"},Ee.createElement("div",{className:"changeLogItem"},Object($.b)("#changeLog_UpdateItem68")),Ee.createElement("div",{className:"changeLogItem"},Object($.b)("#changeLog_UpdateItem69")),Ee.createElement("div",{className:"changeLogItem"},Object($.b)("#changeLog_UpdateItem70"))),Ee.createElement("div",{className:"changeLogTitle"},Object($.b)("#changeLog_GenericUpdateTitle")),Ee.createElement("div",{className:"changeLogDate"},this.PostDate(1531263600)),Ee.createElement("div",{className:"changeLogDescription"},Ee.createElement("div",{className:"changeLogItem"},Object($.b)("#changeLog_UpdateItem47")),Ee.createElement("div",{className:"changeLogItem"},Object($.b)("#changeLog_UpdateItem58")),Ee.createElement("div",{className:"changeLogItem"},Object($.b)("#changeLog_UpdateItem59")),Ee.createElement("div",{className:"changeLogItem"},Object($.b)("#changeLog_UpdateItem60")),Ee.createElement("div",{className:"changeLogItem"},Object($.b)("#changeLog_UpdateItem48")),Ee.createElement("div",{className:"changeLogItem"},Object($.b)("#changeLog_UpdateItem49")),Ee.createElement("div",{className:"changeLogItem"},Object($.b)("#changeLog_UpdateItem63")),Ee.createElement("div",{className:"changeLogItem"},Object($.b)("#changeLog_UpdateItem50")),Ee.createElement("div",{className:"changeLogItem"},Object($.b)("#changeLog_UpdateItem51")),Ee.createElement("div",{className:"changeLogItem"},Object($.b)("#changeLog_UpdateItem53")),Ee.createElement("div",{className:"changeLogItem"},Object($.b)("#changeLog_UpdateItem52")),Ee.createElement("div",{className:"changeLogItem"},Object($.b)("#changeLog_UpdateItem61")),Ee.createElement("div",{className:"changeLogItem"},Object($.b)("#changeLog_UpdateItem62")),Ee.createElement("div",{className:"changeLogItem"},Object($.b)("#changeLog_UpdateItem64")),Ee.createElement("div",{className:"changeLogItem"},Object($.b)("#changeLog_UpdateItem65")),Ee.createElement("div",{className:"changeLogItem"},Object($.b)("#changeLog_UpdateItem66")),Ee.createElement("div",{className:"changeLogItem"},Object($.b)("#changeLog_UpdateItem67"))),Ee.createElement("div",{className:"changeLogTitle"},Object($.b)("#changeLog_GenericUpdateTitle")),Ee.createElement("div",{className:"changeLogDate"},this.PostDate(1531162800)),Ee.createElement("div",{className:"changeLogDescription"},Ee.createElement("div",{className:"changeLogItem"},Object($.b)("#changeLog_UpdateItem54")),Ee.createElement("div",{className:"changeLogItem"},Object($.b)("#changeLog_UpdateItem55"))),Ee.createElement("div",{className:"changeLogTitle"},Object($.b)("#changeLog_GenericUpdateTitle")),Ee.createElement("div",{className:"changeLogDate"},this.PostDate(1530298800)),Ee.createElement("div",{className:"changeLogDescription"},Ee.createElement("div",{className:"changeLogItem"},Object($.b)("#changeLog_UpdateItem56")),Ee.createElement("div",{className:"changeLogItem"},Object($.b)("#changeLog_UpdateItem57"))),Ee.createElement("div",{className:"changeLogTitle"},Object($.b)("#changeLog_GenericUpdateTitle")),Ee.createElement("div",{className:"changeLogDate"},this.PostDate(1530126e3)),Ee.createElement("div",{className:"changeLogDescription"},Ee.createElement("div",{className:"changeLogItemSubHeader"},Object($.b)("#changeLog_UpdateItem_Permissions")),Ee.createElement("div",{className:"changeLogItem"},Object($.b)("#changeLog_UpdateItem39")),Ee.createElement("div",{className:"changeLogItem"},Object($.b)("#changeLog_UpdateItem40")),Ee.createElement("div",{className:"changeLogItem"},Object($.b)("#changeLog_UpdateItem41")),Ee.createElement("div",{className:"changeLogItemSubHeader"},Object($.b)("#changeLog_UpdateSubHeader_General")),Ee.createElement("div",{className:"changeLogItem"},Object($.b)("#changeLog_UpdateItem45")),Ee.createElement("div",{className:"changeLogItem"},Object($.b)("#changeLog_UpdateItem30"),Ee.createElement("div",{style:{marginTop:"4px"}},Ee.createElement("span",{style:{fontWeight:"bold",fontStyle:"italic"}},Object($.b)("#changeLog_Note")),Ee.createElement("span",{style:{fontStyle:"italic"}},Object($.b)("#changeLog_UpdateItem30_Note")))),Ee.createElement("div",{className:"changeLogItem"},Object($.b)("#changeLog_UpdateItem29")),Ee.createElement("div",{className:"changeLogItem"},Object($.b)("#changeLog_UpdateItem25")),Ee.createElement("div",{className:"changeLogItem"},Object($.b)("#changeLog_UpdateItem26")),Ee.createElement("div",{className:"changeLogItem"},Object($.b)("#changeLog_UpdateItem38")),Ee.createElement("div",{className:"changeLogItem"},Object($.b)("#changeLog_UpdateItem31")),Ee.createElement("div",{className:"changeLogItem"},Object($.b)("#changeLog_UpdateItem42")),Ee.createElement("div",{className:"changeLogItem"},Object($.b)("#changeLog_UpdateItem28")),Ee.createElement("div",{className:"changeLogItem"},Object($.b)("#changeLog_UpdateItem27")),Ee.createElement("div",{className:"changeLogItem"},Object($.b)("#changeLog_UpdateItem33")),Ee.createElement("div",{className:"changeLogItem"},Object($.b)("#changeLog_UpdateItem32")),Ee.createElement("div",{className:"changeLogItem"},Object($.b)("#changeLog_UpdateItem34"),Ee.createElement("div",{style:{marginTop:"4px"}},Ee.createElement("span",{style:{fontWeight:"bold",fontStyle:"italic"}},Object($.b)("#changeLog_Note")),Ee.createElement("span",{style:{fontStyle:"italic"}},Object($.b)("#changeLog_UpdateItem34_Note")))),Ee.createElement("div",{className:"changeLogItem"},Object($.b)("#changeLog_UpdateItem35")),Ee.createElement("div",{className:"changeLogItem"},Object($.b)("#changeLog_UpdateItem36")),Ee.createElement("div",{className:"changeLogItem"},Object($.b)("#changeLog_UpdateItem37")),Ee.createElement("div",{className:"changeLogItem"},Object($.b)("#changeLog_UpdateItem43")),Ee.createElement("div",{className:"changeLogItem"},Object($.b)("#changeLog_UpdateItem44"))),Ee.createElement("div",{className:"changeLogTitle"},Object($.b)("#changeLog_GenericUpdateTitle")),Ee.createElement("div",{className:"changeLogDate"},this.PostDate(1529528400)),Ee.createElement("div",{className:"changeLogDescription"},Ee.createElement("div",{className:"changeLogItem"},Object($.b)("#changeLog_UpdateItem20")),Ee.createElement("div",{className:"changeLogItem"},Object($.b)("#changeLog_UpdateItem21")),Ee.createElement("div",{className:"changeLogItem"},Object($.b)("#changeLog_UpdateItem22")),Ee.createElement("div",{className:"changeLogItem"},Object($.b)("#changeLog_UpdateItem23")),Ee.createElement("div",{className:"changeLogItem"},Object($.b)("#changeLog_UpdateItem24"))),Ee.createElement("div",{className:"changeLogTitle"},Object($.b)("#changeLog_GenericUpdateTitle")),Ee.createElement("div",{className:"changeLogDate"},this.PostDate(1529456400)),Ee.createElement("div",{className:"changeLogDescription"},Ee.createElement("div",{className:"changeLogItem"},Object($.b)("#changeLog_UpdateItem17")),Ee.createElement("div",{className:"changeLogItem"},Object($.b)("#changeLog_UpdateItem18")),Ee.createElement("div",{className:"changeLogItem"},Object($.b)("#changeLog_UpdateItem15")),Ee.createElement("div",{className:"changeLogItem"},Object($.b)("#changeLog_UpdateItem16")),Ee.createElement("div",{className:"changeLogItem"},Object($.b)("#changeLog_UpdateItem12")),Ee.createElement("div",{className:"changeLogItem"},Object($.b)("#changeLog_UpdateItem13")),Ee.createElement("div",{className:"changeLogItem"},Object($.b)("#changeLog_UpdateItem14")),Ee.createElement("div",{className:"changeLogItem"},Object($.b)("#changeLog_UpdateItem19"))),Ee.createElement("div",{className:"changeLogTitle"},Object($.b)("#changeLog_GenericUpdateTitle")),Ee.createElement("div",{className:"changeLogDate"},this.PostDate(1529017200)),Ee.createElement("div",{className:"changeLogDescription"},Ee.createElement("div",{className:"changeLogItemSubHeader"},Object($.b)("#changeLog_UpdateSubHeader_General")),Ee.createElement("div",{className:"changeLogItem"},Object($.b)("#changeLog_UpdateItem11")),Ee.createElement("div",{className:"changeLogItemSubHeader"},Object($.b)("#changeLog_UpdateSubHeader_Linux")),Ee.createElement("div",{className:"changeLogItem"},Object($.b)("#changeLog_UpdateItem10")),Ee.createElement("div",{className:"changeLogItem"},Object($.b)("#changeLog_UpdateItem09"))),Ee.createElement("div",{className:"changeLogTitle"},Object($.b)("#changeLog_GenericUpdateTitle")," - #2"),Ee.createElement("div",{className:"changeLogDate"},this.PostDate(1528938e3)),Ee.createElement("div",{className:"changeLogExtra"},Object($.b)("#changeLog_UpdateExtraInfo01")),Ee.createElement("div",{className:"changeLogDescription"},Ee.createElement("div",{className:"changeLogItem"},Object($.b)("#changeLog_UpdateItem02")),Ee.createElement("div",{className:"changeLogItem"},Object($.b)("#changeLog_UpdateItem03")),Ee.createElement("div",{className:"changeLogItem"},Object($.b)("#changeLog_UpdateItem04")),Ee.createElement("div",{className:"changeLogItem"},Object($.b)("#changeLog_UpdateItem05")),Ee.createElement("div",{className:"changeLogItem"},Object($.b)("#changeLog_UpdateItem06")),Ee.createElement("div",{className:"changeLogItem"},Object($.b)("#changeLog_UpdateItem07")),Ee.createElement("div",{className:"changeLogItem"},Object($.b)("#changeLog_UpdateItem08"))),Ee.createElement("div",{className:"changeLogTitle"},Object($.b)("#changeLog_GenericUpdateTitle")),Ee.createElement("div",{className:"changeLogDate"},this.PostDate(1528923600)),Ee.createElement("div",{className:"changeLogDescription"},Ee.createElement("div",{className:"changeLogItem"},Object($.b)("#changeLog_UpdateItem01"))))},R.c([T.a],e.prototype,"PostDate",null),e}(Ee.Component),Ic=function(t){function e(e){return t.call(this,e)||this}return R.d(e,t),e.prototype.render=function(){return Ee.createElement(sr,{onEscKeypress:this.props.closeModal},Ee.createElement(Ai,{className:"changeLogPage"},Ee.createElement(wi,null,Object($.b)("#changeLog_Title")),Ee.createElement(Gi,null,Ee.createElement(Ti,null,Object($.b)("#changeLog_SubTitle")),Ee.createElement(Ri,{className:"changeLogDetails"},Ee.createElement(Cc,null))),Ee.createElement(Mi,null,Ee.createElement(Vi,{onClick:this.props.closeModal},Object($.b)("#Button_Close")))))},e}(Ee.Component),Ec=(n("dBNU"),function(t){function e(e){return t.call(this,e)||this}return R.d(e,t),e.prototype.render=function(){var e=this.props.chat.VoiceChatStore.HasBeenAttemptingOverTwoSeconds(),t=this.props.chat.VoiceChatStore.IsAttemptingReconnect();return Ee.createElement("div",{className:"connectionStatusLabels"},e&&Ee.createElement("div",{className:"connectionStatus"},Ee.createElement("a",{title:Object($.b)("#VoiceChatConnectingHelp"),className:"connectionStatus",target:"_blank",href:"https://support.steampowered.com/kb_article.php?ref=2598-RTZB-6114"},Object($.b)("#VoiceChatConnecting"))),t&&Ee.createElement("div",{className:"connectionStatus"},Ee.createElement("a",{className:"connectionStatus",target:"_blank",href:"https://support.steampowered.com/kb_article.php?ref=2598-RTZB-6114"},Object($.b)("#VoiceChatReconnecting"))))},e=R.c([or.observer],e)}(Ee.Component)),Oc=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return R.d(t,e),t.prototype.render=function(){var e=this.props.chats.GetActiveVoiceChat();return this.props.chats.VoiceChat.IsAnyVoiceActive()&&e?Ee.createElement(wc,{chat:e,name:this.props.chats.GetActiveVoiceChannelName(),nostatus:!1}):Ee.createElement("div",{className:"activeVoiceControls"},Ee.createElement("div",{className:"buttonsContainer"},Ee.createElement("div",{className:"activeVoiceFlexBox"},Ee.createElement("div",{className:"activeVoiceLabels"},Ee.createElement("div",{className:"activeVoiceHeader"},Object($.b)("#ActiveVoiceChat")),Ee.createElement("div",{className:"activeVoiceName"})),Ee.createElement("div",{className:"activeVoiceButtons"},Ee.createElement(Mc,null),Ee.createElement(Dc,null),Ee.createElement("div",{className:"activeVoiceButtonsSpacer"}),Ee.createElement(Tc,null),Ee.createElement("div",{className:"activeVoiceButtonsSpacerAfter"})))))},t=R.c([or.observer],t)}(Ee.Component),wc=function(t){function e(e){return t.call(this,e)||this}return R.d(e,t),e.prototype.ActivateActiveVoiceChat=function(e){if(this.props.chat instanceof kt){var t=ci.ChatStore.GetChatRoomGroup(this.props.chat.GetParentGroupID());if(t)return void ci.UIStore.ShowAndOrActivateChatRoomGroup(cd(this,e),t,!0)}ci.UIStore.ShowAndOrActivateChat(cd(this,e),this.props.chat,!0)},e.prototype.render=function(){var e=ci.VoiceStore.GetPushToTalkEnabled(),t=ci.VoiceStore.GetPushToMuteEnabled(),n=ci.VoiceStore.GetPushToTalkVoiceStateEnabled(),o=ci.VoiceStore.GetPushToTalkHotKeyDisplayString(),i="";return(e||t)&&(i+=" pushToTalkEnabled"),n&&(i+=" pushToTalkKeyDown"),Ee.createElement("div",{className:"activeVoiceControls"+i},Ee.createElement("div",{className:"buttonsContainer"},Ee.createElement("div",{className:"activeVoiceFlexBox"},Ee.createElement("div",{className:"activeVoiceLabels"},Ee.createElement("div",{className:"activeVoiceHeader"},Object($.b)("#ActiveVoiceChat")),Ee.createElement("div",{className:"activeVoiceName",onClick:this.ActivateActiveVoiceChat},this.props.name)),Ee.createElement("div",{className:"activeVoiceButtons"},Ee.createElement(Mc,null),Ee.createElement(Dc,null),Ee.createElement("div",{className:"activeVoiceButtonsSpacer"}),Ee.createElement(Tc,null),Ee.createElement("div",{className:"activeVoiceButtonsSpacerAfter"}))),!this.props.nostatus&&Ee.createElement(Ec,{chat:this.props.chat})),(e||t)&&Ee.createElement("div",{className:"activeVoicePushToTalk"+i},Object($.b)(t?"#ActiveVoicePushToMute":"#ActiveVoicePushToTalk",o)))},R.c([T.a],e.prototype,"ActivateActiveVoiceChat",null),e=R.c([or.observer],e)}(Ee.Component),Mc=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return R.d(t,e),t.prototype.ToggleMicrophone=function(e){ci.VoiceStore.IsMicMuted()&&ci.VoiceStore.IsOutputMuted()&&ci.VoiceStore.ToggleOutputMuting(),ci.VoiceStore.ToggleMicMuting(),e.stopPropagation()},t.prototype.render=function(){var e=ci.VoiceStore.BNoMicAvailableForSession(),t=ci.VoiceStore.BHasSampleRateTooHighInBrowser(),n=ci.VoiceStore.IsMicMuted(),o="VoiceControlPanelButton ToggleMicrophoneButton",i="";return i=n?Object($.b)("#VoiceChat_UnmuteMic"):Object($.b)("#VoiceChat_MuteMic"),e&&(o+=" NoMicrophone",i=t?Object($.b)("#VoiceChat_ChromeSampleRateTooHighMicExplainer"):Object($.b)("#VoiceChat_DeniedMicrophoneAccess")),n&&(o+=" disabled"),Ee.createElement("button",{className:o,onClick:this.ToggleMicrophone,title:i},Ee.createElement(ui.D,null),Ee.createElement(ui.D,{className:"SVGIcon_Shadow"}))},R.c([T.a],t.prototype,"ToggleMicrophone",null),t=R.c([or.observer],t)}(Ee.Component),Dc=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return R.d(t,e),t.prototype.ToggleVoiceOutput=function(e){ci.VoiceStore.IsOutputMuted()==ci.VoiceStore.IsMicMuted()&&ci.VoiceStore.ToggleMicMuting(),ci.VoiceStore.ToggleOutputMuting(),e.stopPropagation()},t.prototype.render=function(){var e=ci.VoiceStore.IsOutputMuted(),t="VoiceControlPanelButton ToggleVoiceOutputButton";e&&(t+=" disabled");var n="";return n=e?Object($.b)("#VoiceChat_UnmuteSpeaker"):Object($.b)("#VoiceChat_MuteSpeaker"),Ee.createElement("button",{className:t,onClick:this.ToggleVoiceOutput,title:n},Ee.createElement(ui.u,null),Ee.createElement(ui.u,{className:"SVGIcon_Shadow"}))},R.c([T.a],t.prototype,"ToggleVoiceOutput",null),t=R.c([or.observer],t)}(Ee.Component),Tc=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return R.d(t,e),t.prototype.EndVoiceChat=function(e){ci.VoiceStore.OnUserEndVoiceChat(),e.stopPropagation()},t.prototype.render=function(){return Ee.createElement("button",{className:"VoiceControlPanelButton chatEndVoiceChat",onClick:this.EndVoiceChat,title:Object($.b)("#VoiceChat_Leave")},Ee.createElement(ui.gb,null))},R.c([T.a],t.prototype,"EndVoiceChat",null),t=R.c([or.observer],t)}(Ee.Component),Gc=function(n){function e(e){var t=n.call(this,e)||this;return t.state={searchString:"",bFriendTabSearch:!1,bViewingIncomingInvites:!1,tabLabelWidth:0},t.m_tabLabelWidth=-1,t}return R.d(e,n),e.prototype.OnSearchInputRef=function(e){this.m_refSearchInput=e},e.prototype.StartSearchOnKeyPress=function(e){var t=this.state.bFriendTabSearch;this.setState({bFriendTabSearch:!0}),t&&this.m_refSearchInput&&this.m_refSearchInput.focus()},e.prototype.OnSearchInput=function(e){e.currentTarget.value!=this.state.searchString&&this.setState({searchString:e.currentTarget.value})},e.prototype.OnSearchSubmit=function(e){e.preventDefault();var t=this.GetNormalizedSearchString();if(t&&t.length){var n=this.props.friends.FriendGroupStore.all_friends.GetMembersMatchingSearch(t);n.length&&n[0].OpenChatDialog(cd(this,e))}this.setState({searchString:""})},e.prototype.OnSearchSelection=function(){this.setState({searchString:""})},e.prototype.OnSearchKeyDown=function(e){27==e.keyCode&&(this.setState({searchString:""}),e.preventDefault(),e.currentTarget.blur(),this.setState({bFriendTabSearch:!1}),this.CollapseTabLabel())},e.prototype.OnClearSearch=function(){this.setState({searchString:""}),this.OnTabSearchClick()},e.prototype.OnSettingsClick=function(e){ws(cd(this,e),e.currentTarget.ownerDocument.defaultView)},e.prototype.ToggleCollapseExpand=function(e){ci.UIStore.SetFriendsListCollapsed(cd(this,e),!this.props.collapsed)},e.prototype.OnDoFriendsListUpdate=function(e){var t=e.currentTarget.ownerDocument.defaultView,n=_d.GetSecondsOutOfDate(),o=Object($.e)(n,!0);vr(t,Object($.b)("#Friends_ConfirmUpdate_Title"),Object($.b)("#Friends_ConfirmUpdate_Body",o),Object($.b)("#Friends_ConfirmUpdate_Ok")).then(function(){_d.PerformFriendsUIUpdate()}).catch(function(){})},e.prototype.BindTabLabel=function(e){this.m_elTabLabel=e,this.UpdateWindowIcon()},e.prototype.UpdateWindowIcon=function(){if(this.m_elTabLabel&&void 0!==this.m_elTabLabel.ownerDocument.defaultView.SteamClient){var e=!1;this.props.chats.VoiceChat.IsAnyVoiceActive()&&(e=!0);var t=0<this.props.chats.FriendChatStore.GetFriendsWithUnreadMessages(this.props.browserContext).length;try{this.m_elTabLabel&&null!=this.m_elTabLabel.ownerDocument.defaultView.SteamClient.Window.SetWindowIcon&&(e?this.m_elTabLabel.ownerDocument.defaultView.SteamClient.Window.SetWindowIcon("voice"):t?this.m_elTabLabel.ownerDocument.defaultView.SteamClient.Window.SetWindowIcon("messages"):this.m_elTabLabel.ownerDocument.defaultView.SteamClient.Window.SetWindowIcon("steam"))}catch(e){}}},e.prototype.CollapseTabLabel=function(){var e=this;if(this.m_animationTabLabelCollapse&&this.m_animationTabLabelCollapse.Cancel(),this.state.bFriendTabSearch){n=1;var t=this.m_tabLabelWidth;this.setState({tabLabelWidth:n},function(){e.m_animationTabLabelCollapse=new Oi(e,{tabLabelWidth:t},{msDuration:300,timing:"sine"}),e.m_animationTabLabelCollapse.Start()})}else{var n=this.m_tabLabelWidth;this.setState({tabLabelWidth:n},function(){e.m_animationTabLabelCollapse=new Oi(e,{tabLabelWidth:1},{msDuration:300,timing:"sine"}),e.m_animationTabLabelCollapse.Start()})}},e.prototype.OnTabSearchClick=function(){this.m_tabLabelWidth<0&&(this.m_tabLabelWidth=this.m_elTabLabel.clientWidth),this.setState({bFriendTabSearch:!this.state.bFriendTabSearch}),this.CollapseTabLabel()},e.prototype.GetNormalizedSearchString=function(){return this.state.searchString&&this.state.searchString.trim().toLocaleLowerCase()},e.prototype.ToggleViewingIncomingInvites=function(){var e=this;this.setState({bViewingIncomingInvites:!this.state.bViewingIncomingInvites},function(){e.state.bViewingIncomingInvites&&(ci.FriendStore.FriendGroupStore.EnsureMutualFriendsForIncomingInvites(),ci.FriendStore.ClanStore.EnsureInitialStateForClanInvites())})},e.prototype.componentWillUpdate=function(){var e=0<ci.FriendStore.FriendGroupStore.incoming_invites_group.member_count,t=0<ci.FriendStore.ClanStore.clan_invites.length,n=0<ci.FriendStore.FriendGroupStore.outgoing_invites_group.member_count;e||t||n||!this.state.bViewingIncomingInvites||this.setState({bViewingIncomingInvites:!1})},e.prototype.render=function(){var e=this.props.friends.self,t=this.GetNormalizedSearchString(),n=0<ci.FriendStore.FriendGroupStore.incoming_invites_group.member_count,o=0<ci.FriendStore.ClanStore.clan_invites.length,i=0<ci.FriendStore.FriendGroupStore.outgoing_invites_group.member_count,r=ci.FriendStore.FriendGroupStore.incoming_invites_group.member_count+ci.FriendStore.ClanStore.clan_invites.length,a="friendRequestButton";this.state.bViewingIncomingInvites&&(a+=" friendRequestViewActive"),i&&0==r&&(a+=" friendRequestOutgoingOnly");var s=this.state.bFriendTabSearch,c="friendTab socialListTab activeTab";s&&(c+=" TabSearchActive");var l={};0<this.state.tabLabelWidth&&(l.width=this.state.tabLabelWidth+"px");var p=!1;this.props.popup&&(p=ld(this.props.popup)!=ai);var u=!1,m=0,d=!1,h="friendListButton friendSettingsButton friendsListNeedsUpdate no-drag";null!=_d&&(u=_d.BNeedsUpdate(),(m=_d.GetSecondsOutOfDate())<432e3?u=!1:604800<m&&(h+=" friendsListVeryOutOfDate",d=!0));var _=this.props.chats.GetActiveVoiceChat(),f=!1;(this.props.chats.VoiceChat.IsAnyVoiceActive()||_)&&(f=!0),this.UpdateWindowIcon();var g=ci.SettingsStore.FriendsSettings.bCompactFriendsList,b=this.props.collapsed,v="friendlist";return g&&(v+=" compactView"),u&&(v+=" needsUpdate"),b&&this.props.collapsible&&(v+=" collapsed"),Ee.createElement("div",{className:v},Ee.createElement("div",{className:"friendListHeaderContainer titleBarContainer"},this.props.popup&&G.a.IN_CLIENT&&Ee.createElement(dr,{hideMinMax:p,popup:this.props.popup}),this.props.collapsible&&Ee.createElement("div",{className:"friendListCollapse no-drag"},Ee.createElement("div",{className:"friendListButton friendCollapseButton no-drag "+(b?"Collapsed":""),onClick:this.ToggleCollapseExpand},Ee.createElement(ui.m,null))),Ee.createElement(kc,{popup:this.props.popup&&this.props.popup,currentUser:e}),Ee.createElement("div",{className:"friendListButtons"},u&&Ee.createElement("div",{className:h,onClick:this.OnDoFriendsListUpdate,title:d?Object($.b)("#Tooltip_FriendsListUpdate_VeryOld"):Object($.b)("#Tooltip_FriendsListUpdate")},Ee.createElement(ui.M,null)),Ee.createElement("div",{className:"friendListButton friendSettingsButton no-drag",onClick:this.OnSettingsClick,title:Object($.b)("#Tooltip_Settings")},Ee.createElement(ui.S,null))),Ee.createElement(pi,null,f&&Ee.createElement(li,{key:"activeVoiceControls1",classNames:"activevoice-anim",timeout:500},Ee.createElement(Oc,{chats:this.props.chats}))),Ee.createElement(Us,{FavoritesStore:this.props.friends.FavoritesStore}),Ee.createElement("div",{className:"socialTabSearchContainer"},Ee.createElement("div",{className:"socialTabContainer"},Ee.createElement("div",{className:c},Ee.createElement("div",{className:"tabLabel",style:l,ref:this.BindTabLabel},Object($.b)("#tab_friends")),Ee.createElement("div",{className:"friendsTabButtonsContainer"},Ee.createElement("div",{className:"TabSearchButton",onClick:s?null:this.OnTabSearchClick},Ee.createElement(pi,{className:"tabSearchTransitionGroup"},s&&Ee.createElement(li,{className:"tabSearchTransition",key:"tabSearch",classNames:"tab-search-anim",timeout:500},Ee.createElement("div",{className:"socialSearchContainer"},Ee.createElement("form",{className:"socialInputContainer"+(s?" SearchActive":""),name:"friendSearchForm",onSubmit:this.OnSearchSubmit},Ee.createElement("div",{className:"inputContainer no-drag"},Ee.createElement("input",{id:"friendSearchInputID",className:"friendSearchInput",autoFocus:!0,type:"text",name:"friendSearch",placeholder:Object($.b)("#SearchFriends"),value:this.state.searchString,onInput:this.OnSearchInput,onKeyDown:this.OnSearchKeyDown,autoComplete:"off",ref:this.OnSearchInputRef}),Ee.createElement("div",{className:"friendSearchClear",onClick:this.OnClearSearch},Ee.createElement(ui.jb,null))))))),Ee.createElement("div",{className:"searchIconButton",onClick:this.OnTabSearchClick,title:Object($.b)("#Tooltip_SearchFriends")},Ee.createElement(ui.A,null))),(n||o||i)&&Ee.createElement("div",{className:a,onClick:this.ToggleViewingIncomingInvites,title:Object($.c)("#Tooltip_FriendRequest",r)},Ee.createElement(ui.r,null),0<r&&Ee.createElement("div",{className:"requestsNumber"},r)),Ee.createElement(Ar,{href:G.a.COMMUNITY_BASE_URL+"friends/add"},Ee.createElement("div",{className:"friendListButton addFriendButton no-drag",title:Object($.b)("#Tooltip_AddFriend")},Ee.createElement(ui.a,null))))))),Ee.createElement("div",{className:"disconnectBlocker"})),Ee.createElement(Pc,{friends:this.props.friends,chats:this.props.chats,searchString:t,fnOnSearchSelection:this.OnSearchSelection,onStartSearch:this.StartSearchOnKeyPress,browserContext:this.props.browserContext,bViewingIncomingInvites:this.state.bViewingIncomingInvites,onClose:this.ToggleViewingIncomingInvites}),Ee.createElement("div",{className:"friendListFooter"},Ee.createElement(Lc,null)))},R.c([T.a],e.prototype,"OnSearchInputRef",null),R.c([T.a],e.prototype,"StartSearchOnKeyPress",null),R.c([T.a],e.prototype,"OnSearchInput",null),R.c([T.a],e.prototype,"OnSearchSubmit",null),R.c([T.a],e.prototype,"OnSearchSelection",null),R.c([T.a],e.prototype,"OnSearchKeyDown",null),R.c([T.a],e.prototype,"OnClearSearch",null),R.c([T.a],e.prototype,"OnSettingsClick",null),R.c([T.a],e.prototype,"ToggleCollapseExpand",null),R.c([T.a],e.prototype,"OnDoFriendsListUpdate",null),R.c([T.a],e.prototype,"BindTabLabel",null),R.c([T.a],e.prototype,"CollapseTabLabel",null),R.c([T.a],e.prototype,"OnTabSearchClick",null),R.c([T.a],e.prototype,"ToggleViewingIncomingInvites",null),e=R.c([or.observer],e)}(Ee.Component),Rc=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return R.d(t,e),t.prototype.render=function(){var e=G.a.COMMUNITY_BASE_URL+"groups/SteamClientBeta/discussions/3/";return ci.IsInBeta()?Ee.createElement("div",{className:"betaFeedbackLabel"},Object($.d)("#GiveFeedbackToSteam_Desc",Ee.createElement(Ar,{href:e,className:"betaFeedbackAnchor"}," ",Object($.b)("#GiveFeedbackToSteam_URL")," "))):null},t}(Ee.Component),Nc=function(n){function e(e){var t=n.call(this,e)||this;return t.m_bChangeLogVersion=8,t.state={bShowChangeLogViolator:_d.UIDisplayPrefs.nChangeLogDismissed<t.m_bChangeLogVersion},t}return R.d(e,n),e.prototype.OpenChangeLog=function(e){var t;_d.SetUIDisplayPref("nChangeLogDismissed",this.m_bChangeLogVersion),this.setState({bShowChangeLogViolator:!1}),t=e.currentTarget.ownerDocument.defaultView,fr(Ee.createElement(Ic,null),t,"ChangeLog",{strTitle:Object($.b)("#changeLog_Title"),popupWidth:640,popupHeight:680},pd(t))},e.prototype.render=function(){if(!ci.IsInBeta())return null;var e=this.state.bShowChangeLogViolator,t=0;return e&&(t=this.m_bChangeLogVersion-(_d.UIDisplayPrefs.nChangeLogDismissed||7)),Ee.createElement("div",{className:"changeLog"+(e?" showViolator":""),onClick:this.OpenChangeLog,title:e?Object($.b)("#changeLog_Value_Button",t):Object($.b)("#changeLog_Button")},Ee.createElement(ui.R,null),e&&Ee.createElement("div",{className:"changeLogViolator"},t))},R.c([T.a],e.prototype,"OpenChangeLog",null),e}(Ee.Component),Lc=function(t){function e(e){return t.call(this,e)||this}return R.d(e,t),e.prototype.OnSettingsZooClick=function(e){0},e.prototype.render=function(){return Ee.createElement(Ee.Fragment,null,Ee.createElement("div",{className:"flexRowCentered"},!1,Ee.createElement(Rc,null),Ee.createElement(Nc,null)))},R.c([T.a],e.prototype,"OnSettingsZooClick",null),e=R.c([or.observer],e)}(Ee.Component),kc=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return R.d(t,e),t.prototype.OnShowContextMenu=function(e){return t=cd(this,e),n=e,Object(mi.a)(Ee.createElement(ca,{browserContext:t,ownerWindow:n.currentTarget.ownerDocument.defaultView}),n);var t,n},t.prototype.ToggleSingleWindowToggle=function(){_d.ToggleSingleWindowToggle(this.props.popup)},t.prototype.ShowCurrentUserProfile=function(e){Ur(e,this.props.currentUser.GetCommunityProfileURL()),e.stopPropagation()},t.prototype.render=function(){var e=this.props.currentUser,t="currentUserContainer "+ne(e.persona);ci.FriendStore.GetUserDoNotDisturb()&&(t+=" userDoNotDisturb");var n=null;ci.FriendStore.BIsInvisibleMode()&&(n=function(){return Object($.b)("#PersonaStateInvisible")});var o=!1;this.props.popup&&(o=ld(this.props.popup)!=ai);return Ee.createElement("div",{className:t},Ee.createElement("svg",{className:"statusHeaderGlow",width:"100%",height:"132",xmlns:"http://www.w3.org/2000/svg"},Ee.createElement("defs",null,Ee.createElement("radialGradient",{id:"exampleGradient",cx:"50%",cy:"50%",r:"50%",fx:"35%",fy:"30%"},Ee.createElement("stop",{offset:"10%",stopColor:"gold"}),Ee.createElement("stop",{offset:"95%",stopColor:"green"}))),Ee.createElement("ellipse",{cx:"5%",cy:"28%",rx:"65%",ry:"60%",fill:"url(#exampleGradient)"})),Ee.createElement("div",{className:"AvatarAndUser",onContextMenu:this.OnShowContextMenu},Ee.createElement(Wc,{friend:e,context:{chatContext:"friendslist"},onContextMenu:this.OnShowContextMenu},Ee.createElement("img",{className:"currentUserAvatar",src:e.persona.avatar_url_medium,onClick:this.ShowCurrentUserProfile})),Ee.createElement(vs,{className:"labelHolder",persona:e.persona,bIsSelf:!0,eFriendRelationship:e.efriendrelationship,strNickname:e.nickname,bParenthesizeNicknames:ci.SettingsStore.CommunityPreferences.bParenthesizeNicknames,bCompactView:ci.SettingsStore.FriendsSettings.bCompactFriendsList,bHideSnooze:!0,renderStatus:n,onContextMenu:this.OnShowContextMenu,bDNDSet:ci.FriendStore.GetUserDoNotDisturb()})),this.props.popup&&G.a.IN_CLIENT&&Ee.createElement("div",{className:"title-area-icon singleWindowToggle"+(o?" inOverlay":""),title:Object($.b)("#FriendsList_TitleArea_SingleWindowButton"),onClick:this.ToggleSingleWindowToggle},Ee.createElement(ui.U,null)))},R.c([T.a],t.prototype,"OnShowContextMenu",null),R.c([T.a],t.prototype,"ToggleSingleWindowToggle",null),R.c([T.a],t.prototype,"ShowCurrentUserProfile",null),t=R.c([or.observer],t)}(Ee.Component),Pc=function(n){function e(e){var t=n.call(this,e)||this;return t.state={bScrolledFromTop:!1},t}return R.d(e,n),Object.defineProperty(e.prototype,"frame",{get:function(){return this.m_elFriendsListContent},enumerable:!0,configurable:!0}),e.prototype.OnContextMenu=function(e){var t=this.props.searchString&&0<this.props.searchString.length;this.props.bViewingIncomingInvites||t||aa(cd(this,e),null,e)},e.prototype.BindFriendsListContent=function(e){this.m_elFriendsListContent=e},e.prototype.OnFriendsListKeyDown=function(e){e.ctrlKey||e.altKey||e.metaKey||1<e.key.length||this.props.onStartSearch(e)},e.prototype.OnFriendsListScrollRef=function(e){this.m_elFriendsListScroll=e},e.prototype.ScrollToTop=function(){this.m_elFriendsListScroll&&(this.m_elFriendsListScroll.scrollTop=0)},e.prototype.OnScrollFriendsList=function(e){var t=10<e.currentTarget.scrollTop;t!=this.state.bScrolledFromTop&&this.setState({bScrolledFromTop:t})},e.prototype.OnAcceptClanInvite=function(e,t){var n=e.currentTarget.ownerDocument.defaultView;ci.FriendStore.ClanStore.RespondToClanInvite(t,!0).then(function(e){e||yr(n,Object($.b)("#Friend_AcceptClanInvite"),Object($.b)("#Friend_AcceptClanInvite_Error"))})},e.prototype.OnDeclineClanInvite=function(e,t){var n=e.currentTarget.ownerDocument.defaultView;ci.FriendStore.ClanStore.RespondToClanInvite(t,!1).then(function(e){e||yr(n,Object($.b)("#Friend_DeclineClanInvite"),Object($.b)("#Friend_DeclineClanInvite_Error"))})},e.prototype.render=function(){var e,o=this,t=this.props.searchString&&0<this.props.searchString.length,n=this.props.bViewingIncomingInvites,i={searchString:this.props.searchString,fnOnSearchSelection:this.props.fnOnSearchSelection};if(this.props.friends.self.is_ready)if(n){var r=ci.FriendStore.ClanStore.clan_invites.length,a=(D.a.InitFromAccountID(ci.FriendStore.self.accountid),[]);if(r)for(var s=function(e){var t=e.steamid,n=void 0;n=e.BIsOGG()?G.a.COMMUNITY_BASE_URL+"app/"+e.GetOGGAppID():G.a.COMMUNITY_BASE_URL+"gid/"+t.ConvertTo64BitString(),a.push(Ee.createElement("div",{className:"clanInviteContainer",key:"clan_invite_"+t.GetAccountID()},Ee.createElement(Ar,{href:n},Ee.createElement("div",{className:"clanAvatar"},Ee.createElement("img",{className:"clanAvatarIcon",src:e.avatar_url_medium})),Ee.createElement("div",{className:"clanName"},e.name,Ee.createElement("div",{className:"clanDetails displayRow"},Ee.createElement("div",{className:"displayRow statMembersTotal"},Ee.createElement("div",{className:"statCircle"}),e.member_count," Members"),0<e.users_online&&Ee.createElement("div",{className:"displayRow statMembersOnline",title:Object($.c)("#Chat_Members_Online_Tooltip",e.users_online)},Ee.createElement("div",{className:"statCircle"}),e.users_online),0<e.users_ingame&&Ee.createElement("div",{className:"displayRow statMembersInGame",title:Object($.c)("#Chat_Members_InGame_Tooltip",e.users_ingame)},Ee.createElement("div",{className:"statCircle"}),e.users_ingame)))),Ee.createElement("div",{className:"clanActionButtons"},Ee.createElement("div",{className:"displayColumn",title:Object($.b)("#FriendGroup_Tip_Accept_Invite")},Ee.createElement(Ui,{onClick:function(e){o.OnAcceptClanInvite(e,t)}},Object($.b)("#Button_Accept"))),Ee.createElement("div",{className:"displayColumn",title:Object($.b)("#FriendGroup_Tip_Decline_Invite")},Ee.createElement(Ui,{onClick:function(e){o.OnDeclineClanInvite(e,t)}},Object($.b)("#Button_Decline"))))))},c=0,l=ci.FriendStore.ClanStore.clan_invites;c<l.length;c++){s(l[c])}e=Ee.createElement(Ee.Fragment,null,0<r&&!t&&Ee.createElement(Ee.Fragment,null,Ee.createElement("div",{className:"clanInvitesGroupContainer"},Ee.createElement("div",{className:"clanInviteTitle"},Object($.b)("#Friend_PendingClanInvites")),a)),Ee.createElement(Vc,R.a({group:this.props.friends.FriendGroupStore.incoming_invites_group,collapsed:!1},i,{onClose:this.props.onClose})),Ee.createElement(Vc,R.a({group:this.props.friends.FriendGroupStore.outgoing_invites_group,collapsed:!1},i,{onClose:this.props.onClose})))}else if(t)e=Ee.createElement(Vc,R.a({group:this.props.friends.FriendGroupStore.all_friends,collapsed:!1},i));else{var p=this.props.friends.FriendGroupStore.user_groups.map(function(e){return Ee.createElement(Vc,R.a({group:e,key:e.id,groupDisplayPrefs:o.props.friends.FriendGroupStore.groupDisplayPrefs},i))}),u=this.props.friends.FriendGroupStore.default_groups.map(function(e){return Ee.createElement(Vc,R.a({group:e,key:e.id,groupDisplayPrefs:o.props.friends.FriendGroupStore.groupDisplayPrefs},i))}),m=!1;this.props.chats.FriendChatStore.GetFriendsWithUnreadMessages(this.props.browserContext).length&&(m=!0),e=Ee.createElement(Ee.Fragment,null,m&&Ee.createElement("div",{className:"recentChatsGroup unreadChatsGroup"},Ee.createElement(Jc,{friendChatStore:this.props.chats.FriendChatStore,browserContext:this.props.browserContext}),!1),Ee.createElement(Fc,null),p,u)}else e=void 0;var d=ci.SettingsStore.FriendsSettings.bCompactFriendsList;return Ee.createElement("div",{className:"FriendsListContent"+(d?" CompactFriendsList":""),ref:this.BindFriendsListContent},Ee.createElement("div",{className:"friendsListInsetShadowCtn"},Ee.createElement("div",{className:"friendListInsetShadowTop"})),Ee.createElement(Yc,{browserContext:this.props.browserContext,bScrolledFromTop:this.state.bScrolledFromTop&&!t,onClick:this.ScrollToTop}),Ee.createElement("div",{className:"friendlistListContainer",onContextMenu:this.OnContextMenu,tabIndex:0,onKeyDown:this.OnFriendsListKeyDown,ref:this.OnFriendsListScrollRef,onScroll:this.OnScrollFriendsList},Ee.createElement("div",{className:"listContentContainer"},e,Ee.createElement("div",{className:"disconnectBlocker"}))),Ee.createElement("div",{className:"friendsListInsetShadowCtn"},Ee.createElement("div",{className:"friendListInsetShadowBottom"})),Ee.createElement(Ac,{friends:this.props.friends,chats:this.props.chats,parent:this}))},R.c([T.a],e.prototype,"OnContextMenu",null),R.c([T.a],e.prototype,"BindFriendsListContent",null),R.c([T.a],e.prototype,"OnFriendsListKeyDown",null),R.c([T.a],e.prototype,"OnFriendsListScrollRef",null),R.c([T.a],e.prototype,"ScrollToTop",null),R.c([T.a],e.prototype,"OnScrollFriendsList",null),e=R.c([or.observer],e)}(Ee.Component),Ac=function(n){function e(e){var t=n.call(this,e)||this;return t.m_bMouseOver=!1,t.state={nChatRoomListContainerHeight:_d.UIDisplayPrefs.nChatRoomListHeightPx,nChatRoomListContainerMaxHeight:_d.UIDisplayPrefs.nChatRoomListHeightPx,bChatRoomListCollapsed:_d.UIDisplayPrefs.bChatRoomListCollapsed,nChatRoomListPreCollapseHeight:_d.UIDisplayPrefs.nChatRoomListHeightPx,bChatRoomListResizing:!1},t}return R.d(e,n),e.prototype.UpdateChatSectionSize=function(){var e=this;if(Object(I.a)(this.m_elChatSection,"m_elChatRoomListContainer not set"),this.m_bMouseOver)return this.m_iTimeoutUpdateChatSectionSize&&this.m_window.clearTimeout(this.m_iTimeoutUpdateChatSectionSize),void(this.m_iTimeoutUpdateChatSectionSize=this.m_window.setTimeout(function(){e.m_iTimeoutUpdateChatSectionSize=void 0,e.UpdateChatSectionSize()},500));var t=this.m_elChatSection.maximumHeight,n=this.m_elChatSection.minimumHeight;if(this.m_elChatRoomListContainer.style.minHeight=n+"px",this.state.nChatRoomListContainerMaxHeight>t){this.m_animationChatSectionShrink&&this.m_animationChatSectionShrink.Cancel();var o=this.state.nChatRoomListContainerMaxHeight,i=t;this.setState({nChatRoomListContainerMaxHeight:o},function(){e.m_animationChatSectionShrink=new Oi(e,{nChatRoomListContainerHeight:Object(_n.a)(e.state.nChatRoomListContainerHeight,n,t),nChatRoomListContainerMaxHeight:i},{msDuration:300,timing:"sine"}),e.m_animationChatSectionShrink.Start()})}else this.setState({nChatRoomListContainerMaxHeight:t})},e.prototype.OnChatSectionMutation=function(e,t){var n=this;this.m_iTimeoutUpdateChatSectionSize&&this.m_window.clearTimeout(this.m_iTimeoutUpdateChatSectionSize),this.m_iTimeoutUpdateChatSectionSize=this.m_window.setTimeout(function(){n.m_iTimeoutUpdateChatSectionSize=void 0,n.UpdateChatSectionSize()},1e3)},e.prototype.BindChatRoomTitleContainer=function(e){this.m_elChatRoomTitleContainer=e},e.prototype.BindChatRoomListContainer=function(e){e&&(this.m_elChatRoomListContainer=e,this.UpdateChatSectionSize())},e.prototype.BindChatSection=function(e){this.m_observerChatSection&&(this.m_observerChatSection.disconnect(),this.m_observerChatSection=null),e&&(this.m_elChatSection=e,this.m_window=e.div.ownerDocument.defaultView,this.m_observerChatSection=new MutationObserver(this.OnChatSectionMutation),this.m_observerChatSection.observe(e.div,{childList:!0,subtree:!0}))},e.prototype.OnGrabberMouseDown=function(e){var t=e.currentTarget.ownerDocument.defaultView;this.m_iGrabberBarInitialGrabOffset=e.clientY-this.m_elChatRoomTitleContainer.getBoundingClientRect().top,this.setState({nChatRoomListPreCollapseHeight:_d.UIDisplayPrefs.nChatRoomListHeightPx}),t.addEventListener("mousemove",this.HandleMouseMove),t.addEventListener("mouseup",this.UnregisterChatRoomListDragEvents)},e.prototype.OnGrabberTouchStart=function(e){var t=e.currentTarget.ownerDocument.defaultView;this.m_iGrabberBarInitialGrabOffset=e.touches[0].clientY-this.m_elChatRoomTitleContainer.getBoundingClientRect().top,t.addEventListener("touchmove",this.HandleTouchMove),t.addEventListener("touchend",this.UnregisterChatRoomListDragEvents)},e.prototype.HandleTouchMove=function(e){1<=e.touches.length&&this.InternalAdjustChatRoomListContainerOnDrag(e.touches[0].clientY)},e.prototype.HandleMouseMove=function(e){this.InternalAdjustChatRoomListContainerOnDrag(e.clientY)},e.prototype.OnMouseEnter=function(e){this.m_bMouseOver=!0},e.prototype.OnMouseLeave=function(e){this.m_bMouseOver=!1},e.prototype.InternalAdjustChatRoomListContainerOnDrag=function(e){if(this.props.parent&&this.props.parent.frame){var t=this.props.parent.frame.getBoundingClientRect(),n=t.top,o=this.m_iGrabberBarInitialGrabOffset,i=t.height-(this.m_elChatRoomTitleContainer.getBoundingClientRect().height-o),r=e-n;r<0?r=0:i<r&&(r=i);var a=i-r;a=Object(_n.a)(a,this.m_elChatSection.minimumHeight,this.m_elChatSection.maximumHeight),this.setState({nChatRoomListContainerHeight:a}),this.setState({bChatRoomListCollapsed:!(0<this.state.nChatRoomListContainerHeight)}),_d.SetUIDisplayPref("bChatRoomListCollapsed",!(0<this.state.nChatRoomListContainerHeight)),this.setState({bChatRoomListResizing:!0})}},e.prototype.ToggleChatsList=function(){this.state.bChatRoomListCollapsed&&this.setState({nChatRoomListContainerHeight:this.state.nChatRoomListPreCollapseHeight}),this.setState({bChatRoomListCollapsed:!this.state.bChatRoomListCollapsed}),_d.SetUIDisplayPref("bChatRoomListCollapsed",!this.state.bChatRoomListCollapsed)},e.prototype.UnregisterChatRoomListDragEvents=function(e){e.view.removeEventListener("mousemove",this.HandleMouseMove),e.view.removeEventListener("touchmove",this.HandleTouchMove),e.view.removeEventListener("mouseup",this.UnregisterChatRoomListDragEvents),e.view.removeEventListener("touchend",this.UnregisterChatRoomListDragEvents),this.state.nChatRoomListContainerHeight<1?_d.SetUIDisplayPref("nChatRoomListHeightPx",this.state.nChatRoomListPreCollapseHeight):(this.setState({nChatRoomListPreCollapseHeight:this.state.nChatRoomListContainerHeight}),_d.SetUIDisplayPref("nChatRoomListHeightPx",this.state.nChatRoomListContainerHeight)),this.m_iGrabberBarInitialGrabOffset=null,this.setState({bChatRoomListResizing:!1})},e.prototype.OnCreateChatRoom=function(e){qs(cd(this,e),e.currentTarget.ownerDocument.defaultView)},e.prototype.render=function(){var e={height:this.state.bChatRoomListCollapsed?0:this.state.nChatRoomListContainerHeight+"px",maxHeight:this.state.bChatRoomListCollapsed?0:this.state.nChatRoomListContainerMaxHeight+"px"},t=this.props.chats.currentChatRoomGroups,n=!1,o="FriendsListChatSection ChatRoomListContainerParent";if(this.props.chats.chat_group_list_ready)for(var i=0,r=t;i<r.length;i++){r[i].HasUnreadChatMessage&&(0,n=!0)}return this.state.bChatRoomListCollapsed&&(o+=" Collapsed"),this.state.bChatRoomListResizing&&(o+=" ChatListResizing"),n&&(o+=" HasUnreadChats"),Ee.createElement("div",{className:o,onMouseEnter:this.OnMouseEnter,onMouseLeave:this.OnMouseLeave},Ee.createElement("div",{className:"friendsListSectionTitle chatSectionTitle",ref:this.BindChatRoomTitleContainer},this.state.bChatRoomListCollapsed&&n&&Ee.createElement(wa,null),Ee.createElement("div",{className:"ToggleGroupChatList",onClick:this.ToggleChatsList,title:this.state.bChatRoomListCollapsed?Object($.b)("#Tooltip_ChatsExpand"):Object($.b)("#Tooltip_ChatsCollapse")},Ee.createElement(ui.m,{angle:-90})),Ee.createElement("div",{className:"voiceRoomDragBar",onMouseDown:this.OnGrabberMouseDown,onTouchStart:this.OnGrabberTouchStart},Ee.createElement("div",{className:"groupChatSectionTitle"},Object($.b)("#tab_chats"))),Ee.createElement("button",{className:"createChatRoomButton",onClick:this.OnCreateChatRoom,title:Object($.b)("#Tooltip_CreateGroupChat")},Ee.createElement(ui.G,null)),Ee.createElement("div",{className:"disconnectBlocker"})),Ee.createElement("div",{className:"friendsListInsetShadowCtn"},Ee.createElement("div",{className:"friendListInsetShadowTop"})),Ee.createElement("div",{className:"chatRoomListContainer",style:e,ref:this.BindChatRoomListContainer},Ee.createElement(Ea,{friends:this.props.friends,chats:this.props.chats,ref:this.BindChatSection})),Ee.createElement("div",{className:"friendsListInsetShadowCtn"},Ee.createElement("div",{className:"friendListInsetShadowBottom"})))},R.c([T.a],e.prototype,"UpdateChatSectionSize",null),R.c([T.a],e.prototype,"OnChatSectionMutation",null),R.c([T.a],e.prototype,"BindChatRoomTitleContainer",null),R.c([T.a],e.prototype,"BindChatRoomListContainer",null),R.c([T.a],e.prototype,"BindChatSection",null),R.c([T.a],e.prototype,"OnGrabberMouseDown",null),R.c([T.a],e.prototype,"OnGrabberTouchStart",null),R.c([T.a],e.prototype,"HandleTouchMove",null),R.c([T.a],e.prototype,"HandleMouseMove",null),R.c([T.a],e.prototype,"OnMouseEnter",null),R.c([T.a],e.prototype,"OnMouseLeave",null),R.c([T.a],e.prototype,"ToggleChatsList",null),R.c([T.a],e.prototype,"UnregisterChatRoomListDragEvents",null),R.c([T.a],e.prototype,"OnCreateChatRoom",null),e=R.c([or.observer],e)}(Ee.Component),Bc=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return R.d(t,e),t.prototype.GetDragDropProps=function(e){void 0===e&&(e=!0);var t={rgAcceptedTypes:[]};return e&&(t.fnDragEnter=this.OnDragEnter,t.fnDragLeave=this.OnDragLeave,t.fnDrop=this.OnDrop,t.rgAcceptedTypes=["friend"]),t.onDragStart=this.OnDragStart,t.onDragEnd=this.OnDragEnd,t},t.prototype.OnDragStart=function(e){var t=_d.DragDropManager.GetDragData();if(t&&"friend"==t.type){var n=t;n.group=this.GetGroup(),this.setState({friendDraggedOut:n.friend})}},t.prototype.OnDragEnd=function(e){this.state.friendDraggedOut&&this.setState({friendDraggedOut:null})},t.prototype.OnDragEnter=function(e,t){Object(I.a)(e&&"friend"==e.type,"Invalid data type passed to FriendGroupDragDrop.OnDragEnter");var n=e,o=n.friend,i=n.group,r=this.GetGroup();return(!r||i==r||!this.GetGroup().HasMember(o.accountid)||n.is_favorite||this.GetGroup().accepts_group_removals&&i.modifiable)&&o.is_friend&&this.state.friendDrag!=o&&this.setState({friendDrag:o}),!0},t.prototype.ResetDragState=function(){this.setState({friendDrag:null})},t.prototype.OnDragLeave=function(){this.state.friendDrag&&this.ResetDragState()},t.prototype.OnDrop=function(e,t){var n=this;Object(I.a)(e&&"friend"==e.type,"Invalid data type passed to FriendGroupDragDrop.OnDrop");var o=e;if(o.group==this.GetGroup())this.setState({friendDraggedOut:null});else{var i=this.state.friendDrag,r=function(){n.state.friendDrag&&n.state.friendDrag==i&&n.ResetDragState()};this.PerformDropAction(o).then(r).catch(r)}},R.c([T.a],t.prototype,"OnDragStart",null),R.c([T.a],t.prototype,"OnDragEnd",null),R.c([T.a],t.prototype,"OnDragEnter",null),R.c([T.a],t.prototype,"OnDragLeave",null),R.c([T.a],t.prototype,"OnDrop",null),t}(Ee.Component),Fc=Object(or.observer)(function(e){if(!ci.SettingsStore.FriendsSettings.bCategorizeInGameFriendsByGame)return null;var t=ci.FriendStore.FriendGroupStore.game_groups,n=t.map(function(e){return Ee.createElement(jc,{key:e.id,group:e,bSingletonGroup:!1,bOtherGroups:!0,groupDisplayPrefs:ci.FriendStore.FriendGroupStore.groupDisplayPrefs})}),o=ci.FriendStore.FriendGroupStore.singleton_game_group;return o&&n.push(Ee.createElement(jc,{key:"singleton",group:o,bSingletonGroup:!0,bOtherGroups:0<t.length,groupDisplayPrefs:ci.FriendStore.FriendGroupStore.groupDisplayPrefs})),Ee.createElement(Ee.Fragment,null,n)}),Vc=function(n){function e(e){var t=n.call(this,e)||this;return t.m_actions=d.observable.map(),t.state={bLocalCollapsed:t.props.collapsed,bSortOfflineByRecent:!1},t}return R.d(e,n),e.prototype.GetGroup=function(){return this.props.group},e.prototype.PerformDropAction=function(e){var t=e.friend,n=e.group,o=this.props.group;return e.is_favorite||_d.DragDropManager.SetDropConsumed(),ci.FriendStore.FriendGroupStore.TransferFriendFromToGroup(t,n,o)},e.prototype.ToggleCollapsed=function(){this.props.groupDisplayPrefs?this.props.groupDisplayPrefs.ToggleUserGroupCollapsed(this.props.group.unique_id):this.setState({bLocalCollapsed:!this.state.bLocalCollapsed})},e.prototype.IsCollapsed=function(){return this.props.groupDisplayPrefs?this.props.groupDisplayPrefs.GetUserGroupCollapsed(this.props.group.unique_id):this.state.bLocalCollapsed},e.prototype.IsInviteGroup=function(){return this.props.group.m_eDisplayType==ut.eIncomingInvites},e.prototype.OnContextMenu=function(e){(this.props.group.modifiable||this.props.group.accepts_group_removals)&&aa(cd(this,e),this.props.group,e)},e.prototype.OnFriendSelected=function(e){this.props.friendSelectAction?this.props.friendSelectAction(e):(e.OpenChatDialog(cd(this)),this.props.fnOnSearchSelection&&this.props.fnOnSearchSelection())},e.prototype.OnAcceptInvite=function(e,t){Object(I.a)(this.IsInviteGroup(),"accept invite on non-invite group");var n=this.m_actions.get(t.accountid);n&&"accept"==n.action?this.m_actions.delete(t.accountid):this.m_actions.set(t.accountid,{friend:t,action:"accept"})},e.prototype.OnDeclineInvite=function(e,t){Object(I.a)(this.IsInviteGroup(),"decline invite on non-invite group");var n=this.m_actions.get(t.accountid);!n||"decline"!=n.action&&"block"!=n.action?this.m_actions.set(t.accountid,{friend:t,action:"decline"}):this.m_actions.delete(t.accountid)},e.prototype.OnBlockInvite=function(e,t){Object(I.a)(this.IsInviteGroup(),"block invite on non-invite group"),e?this.m_actions.set(t.accountid,{friend:t,action:"block"}):this.m_actions.set(t.accountid,{friend:t,action:"decline"})},e.prototype.AcceptInvite=function(t,n){ci.FriendStore.SendFriendInvite(n).then(function(e){3!=e&&yr(t,Object($.b)("#Friend_Menu_AddToFriendsList"),Object($.b)("#Friend_InviteError",n.display_name))})},e.prototype.DeclineInvite=function(t,n){ci.FriendStore.RemoveFriend(n).then(function(e){1!=e&&yr(t,Object($.b)("#Friend_Menu_IgnoreIncomingInvite"),Object($.b)("#Friend_IgnoreIncomingInvite_Error",n.display_name))})},e.prototype.BlockInvite=function(t,n){ci.FriendStore.BlockPlayer(n).then(function(e){5!=e&&yr(t,Object($.b)("#Friend_Menu_BlockIncomingInvite"),Object($.b)("#Friend_BlockIncomingInvite_Error",n.display_name))})},e.prototype.OnConfirmChanges=function(e){var t=this;Object(I.a)(this.IsInviteGroup(),"confirm changes on non-invite group");var n=e.currentTarget.ownerDocument.defaultView;this.m_actions.forEach(function(e){"accept"==e.action?t.AcceptInvite(n,e.friend):"decline"==e.action?t.DeclineInvite(n,e.friend):"block"==e.action?t.BlockInvite(n,e.friend):console.log("unknown action "+e.action)})},e.prototype.OnIgnoreAllInvites=function(e){var o=this;Object(I.a)(this.IsInviteGroup(),"ignore all invites on non-invite group");var i=e.currentTarget.ownerDocument.defaultView;vr(i,Object($.b)("#FriendGroup_ConfirmAllIgnore_Title"),Object($.b)("#FriendGroup_ConfirmAllIgnore_Body"),Object($.b)("#FriendGroup_ConfirmAllIgnore_OK")).then(function(){for(var e=0,t=o.props.group.member_list;e<t.length;e++){var n=t[e];o.DeclineInvite(i,n)}}).catch(function(){})},e.prototype.OnCloseInvites=function(){Object(I.a)(this.IsInviteGroup(),"close invites on non-invite group"),this.props.onClose()},e.prototype.ToggleOfflineSortMethod=function(){this.setState({bSortOfflineByRecent:!this.state.bSortOfflineByRecent})},e.prototype.GetFriendRenderContext=function(){return this.m_FriendRenderContext&&this.m_FriendRenderContext.friendGroup==this.props.group||(this.m_FriendRenderContext={friendGroup:this.props.group,chatContext:"friendslist"}),this.m_FriendRenderContext},e.prototype.render=function(){var s=this,e=this.props.searchString&&0<this.props.searchString.length,t=e,n=this.IsCollapsed()&&!e&&!this.state.friendDrag,c=[],l=this.IsInviteGroup(),o=this.props.group.m_eDisplayType==ut.eOfflineOnly,i=!1;if(!n){var p=!1,r=void 0;if(r=this.props.searchString&&this.props.searchString.length?this.props.group.GetMembersMatchingSearch(this.props.searchString):this.props.group.member_list,this.state.friendDrag&&(this.props.group.HasMember(this.state.friendDrag.accountid)?p=!0:r=r.concat(this.state.friendDrag).sort(ft.DefaultFriendSortComparator)),o&&this.state.bSortOfflineByRecent&&(r=this.props.group.member_list_unsorted.slice().sort(ft.FriendSortByLastSeenComparator),i=!0),l){var a=ci.FriendStore.FriendGroupStore.incoming_invites_group;r=r.slice().sort(function(e,t){var n=a.map_steamid_to_mutual_friends.get(e.steamid64),o=a.map_steamid_to_mutual_friends.get(t.steamid64),i=(n?n.size:0)-(o?o.size:0);return 0<i||0==i&&e.accountid>t.accountid?-1:1})}var u=null;!e&&this.props.group.should_filter_categorized_friends&&(u=ci.FriendStore.FriendGroupStore.categorized_friend_set);for(var m=function(t){if(d.props.setExcludedFriends&&d.props.setExcludedFriends.has(t.accountid))return"continue";if(u&&u.has(t.accountid))return"continue";var e=4==t.efriendrelationship,n=d.state.friendDrag!=t||p?"":"dropGhost";d.state.friendDraggedOut==t&&d.state.friendDrag!=t&&(n+=" dragOriginGhost");var o=void 0,i=void 0,r=void 0;if(l){var a=d.m_actions.get(t.accountid);o=a&&"accept"==a.action?"bright":"dim",i=!a||"decline"!=a.action&&"block"!=a.action?"dim":"bright",r=!a||"decline"!=a.action&&"block"!=a.action?"":" declined",a&&"accept"==a.action?n+="bright":!a||"decline"!=a.action&&"block"!=a.action||(n+="dim")}c.push(Ee.createElement(li,{className:l?"friendInviteContainer"+r:"friendCategoryContainer",key:t.accountid,classNames:"friend-anim",timeout:320},Ee.createElement("div",null,Ee.createElement(zc,R.a({friend:t,key:t.accountid,className:n,context:d.GetFriendRenderContext(),action:e?function(){}:d.OnFriendSelected},d.props.friendProps,{bFriendsListEntry:!0})),l&&Ee.createElement("div",{className:"friendInviteButtons"},Ee.createElement("div",{className:"friendInviteButton acceptFriendInvite "+o,onClick:function(e){return s.OnAcceptInvite(e,t)},title:Object($.b)("#FriendGroup_Tip_Accept")},Ee.createElement(ui.h,null)),Ee.createElement("div",{className:"friendInviteButton declineFriendInvite "+i,onClick:function(e){return s.OnDeclineInvite(e,t)},title:Object($.b)("#FriendGroup_Tip_Decline")},Ee.createElement(ui.jb,null))),l&&Ee.createElement("div",{className:"friendInviteBlockContainer"},Ee.createElement(Ki,{onChange:function(e){return s.OnBlockInvite(e,t)}}),Ee.createElement("div",{className:"displayColumn"},Ee.createElement("div",{className:"blockCommunicationLabel"},Object($.b)("#FriendGroup_IncomingInvites_Block")),Ee.createElement("div",{className:"blockCommunicationLabel subtitle"},Object($.b)("#FriendGroup_IncomingInvites_Block_desc")))))))},d=this,h=0,_=r;h<_.length;h++){m(_[h])}}var f="friendGroup",g=!1,b=!1;if(t&&(f+=" noTransitions"),this.props.group.modifiable?(f+=" taggedGroup ",g=!0):this.props.group.m_eDisplayType==ut.eOnlineOnlyNotInGame?(f+=" onlineFriends ",!0):this.props.group.m_eDisplayType==ut.eOfflineOnly?(f+=" offlineFriends ",b=!0):this.IsInviteGroup()&&(f+=" friendRequests "),e&&(!c||!c.length))return Ee.createElement("div",{className:"friendSearchNoResultsContainer"},Ee.createElement("div",null,Object($.b)("#FriendGroup_Search_NoResults",this.props.searchString)),Ee.createElement("div",{className:"searchSteamSuggestion"},Object($.b)("#FriendGroup_Search_CantFind")),Ee.createElement(Ar,{href:G.a.COMMUNITY_BASE_URL+"search/users"},Object($.b)("#FriendGroup_Search_Link")));if(0==c.length&&!this.IsCollapsed())return null;var v=0!=this.m_actions.size,S="SortByRecent";return i&&(S+=" Recent"),n&&(S+=" Collapsed"),Ee.createElement(nr,R.a({className:f},this.GetDragDropProps(this.props.group.modifiable||this.props.group.accepts_group_removals)),Ee.createElement("div",{className:"groupHeaderContainer"},!e&&Ee.createElement("div",{className:"groupName"+(n?" Collapsed":""),onClick:this.ToggleCollapsed,onContextMenu:this.OnContextMenu},Ee.createElement("div",{className:"ExpandPlusMinus"},Ee.createElement(ui.K,null)),this.props.group.icon_url&&Ee.createElement("img",{className:"groupIcon",src:this.props.group.icon_url}),this.props.group.name,!e&&Ee.createElement("span",{className:this.IsCollapsed()?"groupCount collapsed":"groupCount"},"(",this.props.group.member_count,")"),g&&Ee.createElement("hr",null)),b&&Ee.createElement("div",{className:S,onClick:this.ToggleOfflineSortMethod,title:i?Object($.b)("#FriendGroup_Tip_SortByRecent"):Object($.b)("#FriendGroup_Tip_SortByAlphabet")},Ee.createElement(ui.V,null))),Ee.createElement(pi,{className:"groupList",enter:!t,exit:!t},c,l&&Ee.createElement(li,{key:"inviteButtons",classNames:"opacityfade-anim",timeout:320},Ee.createElement("div",{className:"confirmInviteRequestContainer"},Ee.createElement("div",{className:"confirmInviteRequestActions"},v?Ee.createElement("div",{className:"confirmInviteButton confirmInvites",onClick:this.OnConfirmChanges},Object($.b)("#FriendGroup_ConfirmInvites")):Ee.createElement("div",{className:"confirmInviteButton confirmInvites dim"},Object($.b)("#FriendGroup_ConfirmInvites")),Ee.createElement("div",{className:"confirmInviteButton ignoreAllRequests",onClick:this.OnIgnoreAllInvites},Object($.b)("#FriendGroup_AllIgnore"))),Ee.createElement("div",{className:"cancelAddFriends",onClick:this.OnCloseInvites,title:Object($.b)("#FriendGroup_Close")},Ee.createElement(ui.b,{angle:-90}))))),g&&Ee.createElement("div",{className:"dropTargetBox"}))},R.c([T.a],e.prototype,"ToggleCollapsed",null),R.c([T.a],e.prototype,"OnContextMenu",null),R.c([T.a],e.prototype,"OnFriendSelected",null),R.c([T.a],e.prototype,"OnAcceptInvite",null),R.c([T.a],e.prototype,"OnDeclineInvite",null),R.c([T.a],e.prototype,"OnBlockInvite",null),R.c([T.a],e.prototype,"OnConfirmChanges",null),R.c([T.a],e.prototype,"OnIgnoreAllInvites",null),R.c([T.a],e.prototype,"OnCloseInvites",null),R.c([T.a],e.prototype,"ToggleOfflineSortMethod",null),e=R.c([or.observer],e)}(Bc);function xc(e,t,n){return Object(mi.a)(Ee.createElement(Uc,{browserContext:e,appid:t,ownerWindow:n.currentTarget.ownerDocument.defaultView}),n)}var Uc=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return R.d(t,e),t.prototype.render=function(){return Ee.createElement(ir.c,null,Ee.createElement(ia,{unAppID:this.props.appid,bShowLargeHeader:!0}))},t}(Ee.PureComponent),jc=function(n){function e(e){var t=n.call(this,e)||this;return t.state={bLocalCollapsed:t.props.collapsed},t}return R.d(e,n),e.prototype.GetGroup=function(){return this.props.group},e.prototype.PerformDropAction=function(e){return Promise.reject("FriendGameGroups do not accept drops")},e.prototype.ToggleCollapsed=function(){this.props.groupDisplayPrefs?this.props.groupDisplayPrefs.ToggleUserGroupCollapsed(this.props.group.unique_id):this.setState({bLocalCollapsed:!this.state.bLocalCollapsed})},e.prototype.IsCollapsed=function(){return this.props.groupDisplayPrefs?this.props.groupDisplayPrefs.GetUserGroupCollapsed(this.props.group.unique_id):this.state.bLocalCollapsed},e.prototype.GetFriendRenderContext=function(){return this.m_FriendRenderContext&&this.m_FriendRenderContext.friendGroup==this.props.group||(this.m_FriendRenderContext={friendGroup:this.props.group,chatContext:"friendslist"}),this.m_FriendRenderContext},e.prototype.OnShowHeaderContextMenu=function(e){var t=this.props.group.id;t&&(ci.AppInfoStore.GetAppInfo(t).is_valid&&xc(cd(this,e),t,e))},e.prototype.render=function(){if(this.props.bSingletonGroup&&0==this.props.group.unfiltered_count)return null;var e=[];if(!this.IsCollapsed()){var t=this.props.group.member_list,n=new Map,o=new Map,i=new Map;if(!this.props.bSingletonGroup){for(var r="",a=null,s=0,c=t;s<c.length;s++){var l=c[s];a&&l.persona.player_group!=r&&n.set(a.accountid,"lastInGroup"),l.persona.player_group&&(i.set(l.persona.player_group,l.persona.player_group_size),o.has(l.persona.player_group)?o.set(l.persona.player_group,o.get(l.persona.player_group)+1):o.set(l.persona.player_group,1),a=(l.persona.player_group!=r?(n.set(l.accountid,"firstInGroup"),r=l.persona.player_group):n.set(l.accountid,"inGroup"),l))}a&&n.set(a.accountid,"lastInGroup")}for(var p=!this.props.bSingletonGroup&&this.props.group.id!=St,u=null,m=0,d=t;m<d.length;m++){l=d[m];var h="";this.state.friendDraggedOut==l&&this.state.friendDrag!=l&&(h+=" dragOriginGhost");var _=!1;if(n.has(l.accountid)){_=!0;var f=n.get(l.accountid);if("lastInGroup"==f){var g=o.get(l.persona.player_group),b=i.get(l.persona.player_group);if(b<=1&&1==g)f="";else if(b&&g<b){var v=!1;ci.FriendStore.self.persona.player_group==l.persona.player_group&&(v=!0);var S=b-g,y=b-g-(v?1:0),C="oneDigit";10<=S&&S<100?C="twoDigits":100<=S&&(C="manyDigits");var I=1==y?"#FriendGroup_PlayerGroupFooter_Label_Singular":"#FriendGroup_PlayerGroupFooter_Label";v&&(I=0==y?"#FriendGroup_PlayerGroupFooter_Label_PlusYouOnly":1==y?"#FriendGroup_PlayerGroupFooter_Label_PlusYou_Singular":"#FriendGroup_PlayerGroupFooter_Label_PlusYou"),f=1==g?"firstInGroup":"inGroup",u=Ee.createElement(li,{key:l.persona.player_group+"_footer",classNames:"friend-anim",timeout:320},Ee.createElement("div",{className:"SteamPlayerGroupFooter lastInGroup",draggable:!1},Ee.createElement("div",{className:"SteamPlayerGroupLines"}),Ee.createElement("div",{className:"SteamPlayerGroupFooterCount "+C},Ee.createElement("div",{className:"count"},"+",S)),Ee.createElement("div",{className:"SteamPlayerGroupFooterLabel"},Object($.b)(I,y))))}}h+=" "+f}var E=void 0;this.props.bSingletonGroup&&(E=Ee.createElement(Hc,{appid:l.persona.m_unGamePlayedAppID})),h+=" "+ps.hoverClass,e.push(Ee.createElement(li,{key:l.accountid,classNames:"friend-anim",timeout:320},Ee.createElement(zc,{friend:l,key:l.accountid,bHideGameName:p,className:h,context:this.GetFriendRenderContext(),bInGroup:_,bFriendsListEntry:!0,listStatusIndicatorLeft:E}))),u&&e.push(u)}}var O="friendGroup gameGroup",w=this.props.group.name,M=null;return this.props.bSingletonGroup&&(O+=" OtherGamesGroup",M=this.props.bOtherGroups?Object($.b)("#FriendGroup_InGame_Others"):Object($.b)("#FriendGroup_InGame")),Ee.createElement(nr,R.a({className:O},this.GetDragDropProps(this.props.group.modifiable||this.props.group.accepts_group_removals)),Ee.createElement("div",{className:"groupName"+(this.IsCollapsed()?" Collapsed":""),onClick:this.ToggleCollapsed,onContextMenu:this.OnShowHeaderContextMenu},Ee.createElement("div",{className:"gameGroupContainer"},Ee.createElement("div",{className:"ExpandPlusMinus"},Ee.createElement(ui.K,null)),M,this.props.group.icon_url&&Ee.createElement("img",{className:"groupIcon",src:this.props.group.icon_url})),w,Ee.createElement("span",{className:this.IsCollapsed()?"groupCount collapsed":"groupCount"},"(",this.props.group.member_count,")"),Ee.createElement("hr",null)),Ee.createElement(pi,{className:this.IsCollapsed()?"friendsContainer groupCollapsed":"friendsContainer"},e))},R.c([T.a],e.prototype,"ToggleCollapsed",null),R.c([T.a],e.prototype,"OnShowHeaderContextMenu",null),e=R.c([or.observer],e)}(Bc),Hc=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return R.d(t,e),t.prototype.OnShowGameIconContextMenu=function(e){xc(cd(this,e),this.props.appid,e)},t.prototype.render=function(){var e=ci.AppInfoStore.GetAppInfo(this.props.appid);return e.is_valid?Ee.createElement("div",{className:"FriendInGameIcon",onContextMenu:this.OnShowGameIconContextMenu},Ee.createElement("img",{className:"gameIcon",alt:"",src:e.icon_url})):Ee.createElement("div",{className:"FriendInGameIcon"},Ee.createElement("div",{className:"FriendInGameIcon_NA"},"N/A"))},R.c([T.a],t.prototype,"OnShowGameIconContextMenu",null),t=R.c([or.observer],t)}(Ee.Component),Wc=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return R.d(t,e),t.prototype.OnContextMenu=function(e){if(!this.props.disableContextMenu){var t=void 0;if(this.props.onContextMenu)t=this.props.onContextMenu(e);else t=_d.FriendHoverStore.GetHover(this.props.friend).OnContextMenu(this.props.context,e);t&&this.props.onContextMenuShown&&this.props.onContextMenuShown(t)}},t.prototype.componentWillUnmount=function(){_d.FriendHoverStore.GetHover(this.props.friend).HideByElement(W.findDOMNode(this))},t.prototype.render=function(){var e=Ee.Children.only(this.props.children);if(e){var t=this.props,n=_d.FriendHoverStore.GetHover(t.friend);return Ee.cloneElement(e,{onMouseEnter:function(e){return n.Show(e,t.context)},onMouseLeave:n.Hide,onContextMenu:this.OnContextMenu})}return this.props.children},R.c([T.a],t.prototype,"OnContextMenu",null),t}(Ee.Component),zc=function(n){function e(e){var t=n.call(this,e)||this;return t.state={bActive:!1},t}return R.d(e,n),e.prototype.OnDoubleClick=function(e){this.RunAction(!0,e)},e.prototype.OnClick=function(e){this.RunAction(!1,e)},e.prototype.RunAction=function(e,t){!this.props.bSingleClickActivate==e&&(this.props.action?this.props.action(this.props.friend):this.props.noActions||this.props.friend.OpenChatDialog(cd(this,t)))},e.prototype.OnDragStart=function(e){e.dataTransfer.setData("text/plain",this.props.friend.persona.m_strPlayerName),e.dataTransfer.setData("text/steamid",this.props.friend.persona.m_steamid.ConvertTo64BitString()),this.props.friend.is_friend?_d.DragDropManager.StartDrag({type:"friend",source:this.props.context.chatContext,friend:this.props.friend,sourceContext:this.props.context}):_d.DragDropManager.StartDrag({type:"nonfriend",source:this.props.context.chatContext,friend:this.props.friend,sourceContext:this.props.context}),_d.FriendHoverStore.GetHover(this.props.friend).HideAllInstances()},e.prototype.OnDragEnd=function(e){_d.DragDropManager.EndDrag()},e.prototype.OnShowContextMenu=function(e){var t=Jr(cd(this,e),this.props.context,this.props.friend,e);t&&this.OnContextMenuShown(t)},e.prototype.OnContextMenuShown=function(e){var t=this;this.setState({bActive:!0}),e.SetOnHideCallback(function(){t.setState({bActive:!1})})},e.prototype.render=function(){var e=this.props.friend;if(e.LoadIfNecessary(),!e.is_ready)return Ee.createElement("div",null);var t=ci.CMInterface.steamid.GetAccountID()==e.accountid,n=null,o=0;this.props.showVoiceLevel&&(o=ci.VoiceStore.get_volume(e.accountid));var i,r={className:"friend "+ne(e.persona)};if(this.props.className&&(r.className+=" "+this.props.className),this.props.bFriendsListEntry&&(r.className+=" friendStatusHover"),t){var a=ci.VoiceStore.IsAttemptingInitialConnection(),s=ci.VoiceStore.HasBeenAttemptingOverTwoSeconds(),c=ci.VoiceStore.IsAttemptingReconnect(),l=Object($.b)("#VoiceChatConnectingHelp"),p=null;s?p=Object($.b)("#VoiceChatConnecting"):c&&(p=Object($.b)("#VoiceChatReconnecting")),p&&(n=t?function(){return Ee.createElement("a",{target:"_blank",title:l,href:"https://support.steampowered.com/kb_article.php?ref=2598-RTZB-6114"},p)}:function(){return p});var u="";a&&(u+=" connecting"),s&&(u+=" slowconnecting"),c&&(u+=" reconnecting"),r.className+=u}if(this.props.noActions&&!this.props.action||(r.onDoubleClick=this.OnDoubleClick,r.onClick=this.OnClick),this.props.noActions||this.props.disableContextMenu||(r.onContextMenu=this.OnShowContextMenu),this.props.noActions||this.props.notDraggable||(r.onDragStart=this.OnDragStart,r.onDragEnd=this.OnDragEnd,r.draggable=!0),this.props.children)i=Ee.createElement("div",R.a({},r),this.props.children);else{var m={};if(this.props.showVoiceLevel&&1!=o){var d=Math.min(3.2*o,1),h=Math.max(0,100*d);h=Math.round(10*h)/10,m.height=h+"%",m.top="auto",1<h&&(r.className+=" speaking")}0;var _=void 0;this.props.context&&this.props.context.group&&(_=this.props.context.group.GetMemberPartyBeacon(e.accountid))&&(r.className+=" partyBeacon"),this.state.bActive&&(r.className+=" Friend_ContextMenuActive");var f=ci.VoiceStore.GetPerUserMuting(e.accountid),g=Ee.createElement(qr,{persona:e.persona,size:this.props.avatarQualityFull?"Large":"Medium",statusStyle:m},this.props.bInVoiceList&&f&&Ee.createElement(ui.hb,null));this.props.noActions||(g=Ee.createElement(Wc,{friend:e,context:this.props.context,disableContextMenu:this.props.disableContextMenu,onContextMenuShown:this.OnContextMenuShown},g));var b=this.props.context&&"chatmemberlist"==this.props.context.chatContext,v="";if(2==e.efriendrelationship&&!b){var S,y,C=ci.FriendStore.FriendGroupStore.incoming_invites_group.map_steamid_to_mutual_friends.get(e.steamid64);void 0===C?(ci.FriendStore.FriendGroupStore.EnsureMutualFriendsForIncomingInvites(),y=Object($.b)("#FriendGroup_NoMutualFriends"),v="noMutualFriends"):(y=Object($.c)("#FriendGroup_YesMutualFriends",C.size),S=C.size),n=function(){return Ee.createElement("span",{className:"inviteLabel"},Ee.createElement("span",{className:"mutualFriendNumber"},S&&S+" "),y)}}var I=null;e.persona.m_broadcastAccountId&&(I=function(){return e.GetBroadcastDescription()}),i=Ee.createElement("div",R.a({},r),this.props.bInGroup&&Ee.createElement("div",{className:"SteamPlayerGroupLines"}),this.props.bInVoiceList&&Ee.createElement(qc,{friend:e}),this.props.listStatusIndicatorLeft,g,Ee.createElement(vs,{className:hr("labelHolder",v),persona:e.persona,eFriendRelationship:e.efriendrelationship,bIsSelf:ci.FriendStore.self==e,strNickname:e.nickname,bParenthesizeNicknames:ci.SettingsStore.CommunityPreferences.bParenthesizeNicknames,renderStatus:n,renderRichPresence:I,bHideGameName:this.props.bHideGameName,bHideEnhancedRichPresenceLabel:this.props.bHideEnhancedRichPresenceLabel,bHidePersona:this.props.bHidePersona,bCompactView:ci.SettingsStore.FriendsSettings.bCompactFriendsList,onContextMenu:this.props.noActions||this.props.disableContextMenu?void 0:this.OnShowContextMenu,bHasPartyBeacon:void 0!==_}),null,this.props.listStatusIndicator)}return i},R.c([T.a],e.prototype,"OnDoubleClick",null),R.c([T.a],e.prototype,"OnClick",null),R.c([T.a],e.prototype,"OnDragStart",null),R.c([T.a],e.prototype,"OnDragEnd",null),R.c([T.a],e.prototype,"OnShowContextMenu",null),R.c([T.a],e.prototype,"OnContextMenuShown",null),e=R.c([or.observer],e)}(Ee.Component),qc=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return R.d(t,e),t.prototype.render=function(){var e=this.props.friend,t=ci.CMInterface.steamid.GetAccountID()==e.accountid,n="voiceStatusIconsContainer",o="",i="",r=!1,a=!1,s=!1,c=ci.VoiceStore.GetPerUserMuting(e.accountid),l=ci.VoiceStore.GetUserMutedRemotely(e.accountid),p=ci.VoiceStore.GetOutputMutedRemotely(e.accountid);return t?(r=ci.VoiceStore.IsMicMuted(),a=ci.VoiceStore.IsOutputMuted(),s=ci.VoiceStore.BNoMicAvailableForSession(),r&&(n+=" mic_muted_self"),a&&(n+=" output_muted_self")):s=ci.VoiceStore.GetUserHasNoMicForSession(e.accountid),c&&(n+=" muted_locally"),l&&(n+=" mic_muted_remotely"),p&&(n+=" output_muted_remotely"),s&&(n+=" no_mic_for_session"),s?o=Object($.b)("#Tooltip_MicStatus_NoMic"):l?o=Object($.b)("#Tooltip_RemoteMicStatus_Muted"):r&&(o=Object($.b)("#Tooltip_YourMicStatus_Muted")),p?i=Object($.b)("#Tooltip_RemoteOutputStatus_Muted"):a&&(i=Object($.b)("#Tooltip_YourOutputStatus_Muted")),Ee.createElement("div",{className:n},Ee.createElement("div",{className:"voicestatusIcon voiceStatusMic disabled",title:o},Ee.createElement(ui.D,null)),Ee.createElement("div",{className:"voicestatusIcon voiceStatusOutput disabled",title:i},Ee.createElement(ui.u,null)))},t=R.c([or.observer],t)}(Ee.Component),Kc=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return R.d(t,e),t.prototype.render=function(){var e=this.props.friend,t=Ee.createElement(Kr,{persona:e.persona,size:this.props.bLarge?"Large":"Medium",className:this.props.className},this.props.children);return Ee.createElement(Wc,{friend:e,context:this.props.context},t)},t=R.c([or.observer],t)}(Ee.Component),Yc=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return R.d(t,e),t.prototype.render=function(){var e,t=ci.ChatStore.FriendChatStore.GetUnreadFriendMessageCount(this.props.browserContext);return this.props.bScrolledFromTop&&0<t&&(e=Ee.createElement(li,{classNames:"unread-messages-anim",timeout:320},Ee.createElement("div",{className:"unreadMessageViolator",onClick:this.props.onClick},1==t&&Object($.b)("#FriendGroup_UnreadMessagesViolator"),1<t&&Object($.b)("#FriendGroup_UnreadMessagesViolatorPlural",t)))),Ee.createElement(pi,null,e)},t=R.c([or.observer],t)}(Ee.Component),Jc=function(n){function e(e){var t=n.call(this,e)||this;return t.state={collapsed:!1},t}return R.d(e,n),e.prototype.OnHeaderClick=function(e){this.setState({collapsed:!this.state.collapsed})},e.prototype.render=function(){var e=this.props.friendChatStore.GetFriendsWithUnreadMessages(this.props.browserContext);if(!e.length)return null;var t=this.state.collapsed,n=t?null:e.map(function(e){var t=e.unread_message_count,n=e.chat_partner,o=Ee.createElement("div",{className:"FriendMessageCount"},t);return Ee.createElement(li,{key:n.accountid,classNames:"friend-anim",timeout:320},Ee.createElement("div",{className:"unreadFriend"},Ee.createElement(zc,{friend:n,key:n.accountid,context:{chat:e},bFriendsListEntry:!0}),o))});return Ee.createElement("div",{className:"friendGroup"},Ee.createElement("div",{className:"groupName"+(t?" Collapsed":""),onClick:this.OnHeaderClick},Ee.createElement("div",{className:"ExpandPlusMinus"},Ee.createElement(ui.K,null)),Object($.b)("#FriendGroup_UnreadMessages"),Ee.createElement("span",{className:"groupCount"},"(",e.length,")"),Ee.createElement("hr",null)),Ee.createElement(pi,null,n))},R.c([T.a],e.prototype,"OnHeaderClick",null),e=R.c([or.observer],e)}(Ee.Component);Ee.Component;var Xc=function(t){function e(e){return t.call(this,e)||this}return R.d(e,t),e.prototype.render=function(){if(null==this.props.text)return Ee.createElement(Ee.Fragment,null,this.props.children);var e;if(e=this.props.text instanceof Array?this.props.text.map(function(e){return e?e.toString():""}).filter(function(e){return 0<e.length}).join("\n"):this.props.text.toString(),1!=Ee.Children.count(this.props.children))return console.log("Error: CopyableText must be the parent of exactly one child:\n\tcopystyle="+this.props.style+" copytext="+e),Ee.createElement(Ee.Fragment,null,this.props.children);var t=Ee.Children.only(this.props.children);return Ee.cloneElement(t,{"data-copystyle":this.props.style,"data-copytext":e})},e.defaultProps={text:""},e}(Ee.Component),Qc=n("HVDT"),Zc=n.n(Qc),$c=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return R.d(n,e),n.OnMouseEnter=function(e){_d.EmoticonHoverStore.GetEmoticonHover(e.currentTarget.getAttribute("data-emoticon")).Show(e)},n.OnMouseLeave=function(e){_d.EmoticonHoverStore.GetEmoticonHover(e.currentTarget.getAttribute("data-emoticon")).Hide(e)},n.prototype.render=function(){var e="emoticon";this.props.large&&(e+=" large");var t=":"+this.props.emoticon+":";return Ee.createElement(Xc,{text:t,style:"merge-adjacent"},Ee.createElement("img",{src:qt.GetEmoticonURL(this.props.emoticon,this.props.large),alt:t,className:e,"data-emoticon":this.props.emoticon,onMouseEnter:n.OnMouseEnter,onMouseLeave:n.OnMouseLeave}))},n}(Ee.PureComponent),el=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return R.d(t,e),t.prototype.render=function(){return Ee.createElement(sc,{visibilityObserver:this.props.hover,target:this.props.target,style:{zIndex:500}},Ee.createElement("div",{className:"emoticon_hover_content",dangerouslySetInnerHTML:{__html:this.props.hover.emoticon_html}}),Ee.createElement("div",{className:"hover_arrow left emoticon_hover_arrow"}),Ee.createElement("div",{className:"hover_arrow right emoticon_hover_arrow"}))},t=R.c([or.observer],t)}(Ee.Component),tl=function(o){function e(e){var t=o.call(this,e)||this;t.m_ScrollCoordinator=new Ci.f(40),t.state={strSearchText:""};var n=ci.ChatStore.EmoticonStore;return n.is_initialized||(n.UpdateEmoticonList(),t.m_disposeEmoticonStore=Object(d.when)(function(){return n.is_initialized},function(){return t.forceUpdate()})),t}return R.d(e,o),e.prototype.componentWillUnmount=function(){this.m_disposeEmoticonStore&&this.m_disposeEmoticonStore()},e.prototype.OnClick=function(e){var t=e.currentTarget.getAttribute("data-emoticon");this.props.OnSelected(t,e.shiftKey),_d.EmoticonHoverStore.GetEmoticonHover(t).Hide(e)},e.prototype.OnSearchInput=function(e){var t=e.currentTarget.value;this.setState({strSearchText:t})},e.prototype.OnSubmit=function(e){e.preventDefault(),this.m_strFirstEmoticon&&this.props.OnSelected(this.m_strFirstEmoticon,!1)},e.prototype.RenderEmoticon=function(e,t){var n=t.name;return e&&(n=e+t.name),Ee.createElement(ol,{key:n,emoticon:t,onClick:this.OnClick,coordinator:this.m_ScrollCoordinator})},e.prototype.OnScrollRef=function(e){this.m_ScrollCoordinator.SetParent(e)},e.prototype.OnScroll=function(e){this.m_ScrollCoordinator.RecomputeVisibility()},e.prototype.componentDidUpdate=function(){this.m_ScrollCoordinator.InvalidateOffsetsAndRecompute()},e.prototype.render=function(){var e=ci.ChatStore.EmoticonStore,t=[],n=[],o=!1;if(e.is_initialized){var i=this.state.strSearchText.trim();if(0<i.length)o=!0,n=(t=e.SearchEmoticons(i,50,!1)).map(this.RenderEmoticon.bind(this,"")),this.m_strFirstEmoticon=t.length?t[0].name:null;else if(this.props.nFlairGroupID)n=e.GetFlairListByGroupID(this.props.nFlairGroupID).map(this.RenderEmoticon.bind(this,"")),this.m_strFirstEmoticon=null;else{var r=e.recent_emoticons,a=e.emoticon_list,s=Math.ceil(a.length/9);if(s<=2)r=[];else{var c=Math.floor(s/2);9<(r=r.slice(0,9*c)).length&&r.length%9<=2&&(r=r.slice(0,9*Math.floor(r.length/9)))}r.length&&(n=r.map(this.RenderEmoticon.bind(this,"recent_"))).push(Ee.createElement("div",{key:"__recent_all_separator",className:"EmoticonSelector_Separator"},Ee.createElement("div",{className:"EmoticonSelector_SeparatorBackground"}))),1e3<a.length&&(a=a.slice(0,1e3)),32<=a.length&&(o=!0),n.push.apply(n,a.map(this.RenderEmoticon.bind(this,""))),this.m_strFirstEmoticon=null}}return Ee.createElement(ir.c,null,Ee.createElement("div",{className:"EmoticonSelector"},Ee.createElement("div",{className:"EmoticonSelector_Emoticons",ref:this.OnScrollRef,onScroll:this.OnScroll},n),o&&Ee.createElement("div",{className:"EmoticonSelector_Controls"},Ee.createElement("form",{onSubmit:this.OnSubmit},Ee.createElement("input",{type:"text",placeholder:Object($.b)("#Emoticon_Search"),value:this.state.strSearchText,onChange:this.OnSearchInput,className:"ContextMenuAutoFocus friendSearchInput"})))))},R.c([T.a],e.prototype,"OnClick",null),R.c([T.a],e.prototype,"OnSearchInput",null),R.c([T.a],e.prototype,"OnSubmit",null),R.c([T.a],e.prototype,"OnScrollRef",null),R.c([T.a],e.prototype,"OnScroll",null),e}(Ee.Component);function nl(){return Ee.createElement("div",{className:Zc.a.NewEmoticonIndicator},Ee.createElement("div",{className:Zc.a.NewEmoticonCircle}))}var ol=function(n){function e(e){var t=n.call(this,e)||this;return t.state={visible:!1},t}return R.d(e,n),e.prototype.SetVisible=function(e){e&&!this.state.visible&&this.setState({visible:!0})},e.prototype.componentDidMount=function(){this.props.coordinator.RegisterChild(W.findDOMNode(this),this.SetVisible)},e.prototype.componentWillUnmount=function(){this.props.coordinator.UnregisterChild(W.findDOMNode(this))},e.prototype.render=function(){var e=this.props.emoticon,t="EmoticonSelector_Item",n=!1;return!e.last_used&&e.time_received&&(t+=" EmoticonSelector_Item_New",n=!0),Ee.createElement("div",{className:t,"data-emoticon":e.name,onClick:this.props.onClick},this.state.visible&&Ee.createElement($c,{emoticon:e.name,large:!0}),n&&Ee.createElement(nl,null))},R.c([T.a],e.prototype,"SetVisible",null),e}(Ee.Component),il=n("bf/M"),rl=n.n(il),al=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return R.d(t,e),t.prototype.OnEmoticonClick=function(e){var t=this.props,n=t.emoticonStore,o=t.SetUIDisplayPref;Object(mi.a)(Oe.a.createElement(tl,{nFlairGroupID:this.props.nFlairGroupID,OnSelected:this.props.OnEmoticonSelected}),e.currentTarget,{bOverlapHorizontal:!0,bPreferPopLeft:!0,bPreferPopTop:!0}),this.BHaveUnseenEmoticons()&&o&&o("rtLastAckedNewEmoticons",n.GetTimeReceivedNewestEmoticon())},t.prototype.BHaveUnseenEmoticons=function(){var e=this.props,t=e.emoticonStore,n=e.rtLastAckedNewEmoticons,o=t.GetTimeReceivedNewestEmoticon();return o&&(!n||n<o)},t.prototype.render=function(){var e=this.props.disabled,t="chatSubmitButton EmoticonPickerButton",n=!1;return e?t+=" disabled":this.BHaveUnseenEmoticons()&&(t+=" "+rl.a.EmoticonButton_NewEmoticons,n=!0),Oe.a.createElement("button",{className:t,type:"button",onClick:this.OnEmoticonClick,title:this.props.title||Object($.b)("#ChatEntryButton_Emoticon"),disabled:e},this.props.buttonIcon||Oe.a.createElement(ui.o,null),n&&Oe.a.createElement(nl,null))},R.c([T.a],t.prototype,"OnEmoticonClick",null),t=R.c([or.observer],t)}(Oe.a.Component),sl=function(n){function e(e){var t=n.call(this,e)||this;return t.m_rgCurrentMatches=[],t.m_mapMatchByKey=new Map,t.state={selectedIndex:void 0},t}return R.d(e,n),e.prototype.OnKeyDown=function(e){this.BHandleKeyPress(e.keyCode)&&e.preventDefault()},e.prototype.BHandleKeyPress=function(e){switch(e){case 38:this.SetSelectedIndexDelta(-1);break;case 40:this.SetSelectedIndexDelta(1);break;case 36:this.SetSelectedIndex(0);break;case 33:this.SetSelectedIndexDelta(-this.GetPageSize());break;case 35:this.SetSelectedIndex(-1);break;case 34:this.SetSelectedIndexDelta(this.GetPageSize());break;case 13:case 9:if(void 0===this.state.selectedIndex)return this.props.onSuggestionSelected(this.props.strSearch),!1;this.ChooseSuggestion(this.m_rgCurrentMatches[this.state.selectedIndex]);break;case 27:this.props.onSuggestionSelected(this.props.strSearch);break;default:return!1}return!0},e.prototype.GetPageSize=function(){var e=W.findDOMNode(this),t=e&&e.firstElementChild,n=this.m_rgCurrentMatches.length;if(n>this.getMaxMatches()&&(n=this.getMaxMatches()),t&&n){var o=t.scrollHeight/n,i=t.clientHeight/o;return Math.max(1,Math.floor(i))}return 5},e.prototype.ChooseSuggestion=function(e){this.props.onSuggestionSelected(this.props.strSearch,e?this.getSelection(e):void 0)},e.prototype.SetSelectedIndexDelta=function(e){void 0!==this.state.selectedIndex?this.SetSelectedIndex(this.state.selectedIndex+e):this.SetSelectedIndex(e)},e.prototype.SetSelectedIndex=function(e){if(this.m_rgCurrentMatches.length){var t=this.m_rgCurrentMatches.length;t>this.getMaxMatches()&&(t=this.getMaxMatches()),(e%=t)<0&&(e+=t),this.setState({selectedIndex:e})}},e.prototype.FindKeyIndex=function(e){if(!this.m_mapMatchByKey.size&&this.m_rgCurrentMatches.length)for(var t=0;t<this.m_rgCurrentMatches.length;t++)this.m_mapMatchByKey.set(this.getKey(this.m_rgCurrentMatches[t]),t);return this.m_mapMatchByKey.get(e)},e.prototype.OnClickSuggestion=function(e){var t=this.FindKeyIndex(e);void 0!==t&&this.ChooseSuggestion(this.m_rgCurrentMatches[t])},e.prototype.OnMouseOverSuggestion=function(e){var t=this.FindKeyIndex(e);void 0!==t&&this.SetSelectedIndex(t)},e.prototype.BindSelectedElement=function(e){var t=W.findDOMNode(this),n=W.findDOMNode(e),o=t&&t.firstElementChild;n&&o&&(o.scrollTop+o.clientHeight<n.offsetTop||n.offsetTop<o.scrollTop)&&n.scrollIntoView()},e.prototype.UpdateSearchResults=function(e){this.m_rgCurrentMatches=this.performSearch(e),this.m_strLastSearch=e,this.m_mapMatchByKey.clear(),this.m_rgCurrentMatches.length?this.state&&void 0!==this.state.selectedIndex?this.state.selectedIndex>=this.m_rgCurrentMatches.length&&this.setState({selectedIndex:0}):(void 0===this.props.nMinimumSearchLengthBeforeAutoSelection||e.length>=this.props.nMinimumSearchLengthBeforeAutoSelection)&&this.setState({selectedIndex:0}):this.state&&void 0!==this.state.selectedIndex&&this.setState({selectedIndex:void 0})},e.prototype.componentWillUnmount=function(){this.m_hMobxSearchDisposer&&(this.m_hMobxSearchDisposer(),this.m_hMobxSearchDisposer=void 0)},e.prototype.componentWillMount=function(){var e=this;this.m_hMobxSearchDisposer=Object(d.autorun)(function(){e.UpdateSearchResults(e.props.strSearch),e.forceUpdate()})},e.prototype.componentWillUpdate=function(e){this.m_strLastSearch!=e.strSearch&&this.UpdateSearchResults(e.strSearch)},e.prototype.render=function(){var e=[];if(this.m_rgCurrentMatches.length){for(var t=this.getMaxMatches(),n=0;n<Math.min(t,this.m_rgCurrentMatches.length);n++){var o=this.m_rgCurrentMatches[n],i=this.getKey(o),r=n===this.state.selectedIndex;e.push(Oe.a.createElement(cl,{key:i,matchKey:i,fnOnClick:this.OnClickSuggestion,fnOnMouseOver:this.OnMouseOverSuggestion,bIsSelected:r,ref:r?this.BindSelectedElement:void 0},this.renderMatch(o)))}this.m_rgCurrentMatches.length>t&&e.push(this.renderTooManyMatchesMessage(this.m_rgCurrentMatches.length-t))}else{var a=this.renderNoMatchMessage();if(!a)return null;e.push(a)}return Oe.a.createElement("div",{className:"mentionDialogPosition"},Oe.a.createElement("div",{className:"mentionDialog",tabIndex:0,onKeyDown:this.OnKeyDown},this.renderHeader(),e))},R.c([T.a],e.prototype,"OnKeyDown",null),R.c([T.a],e.prototype,"OnClickSuggestion",null),R.c([T.a],e.prototype,"OnMouseOverSuggestion",null),R.c([T.a],e.prototype,"BindSelectedElement",null),e}(Oe.a.Component),cl=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return R.d(t,e),t.prototype.OnMouseOver=function(e){this.props.fnOnMouseOver(this.props.matchKey)},t.prototype.OnClick=function(e){this.props.fnOnClick(this.props.matchKey)},t.prototype.render=function(){return Oe.a.createElement("div",{className:"suggestOption mentionSearchOption"+(this.props.bIsSelected?" selected":""),onMouseEnter:this.OnMouseOver,onClick:this.OnClick},this.props.children)},R.c([T.a],t.prototype,"OnMouseOver",null),R.c([T.a],t.prototype,"OnClick",null),t}(Oe.a.PureComponent),ll=sl,pl=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return R.d(t,e),t.prototype.performSearch=function(e){return this.props.emoticonStore.SearchEmoticons(e,10)},t.prototype.getSelection=function(e){return e.name},t.prototype.getKey=function(e){return e.name},t.prototype.renderMatch=function(e){return Oe.a.createElement("div",{className:"EmoticonSuggestion"+(e.recent?" Recent":"")},Oe.a.createElement("div",{className:"EmoticonSuggestion_Emoticon"},Oe.a.createElement($c,{emoticon:e.name}),e.new&&Oe.a.createElement(nl,null)),":",e.name,":")},t.prototype.renderNoMatchMessage=function(){return null},t.prototype.renderTooManyMatchesMessage=function(e){return null},t.prototype.renderHeader=function(){return null},t.prototype.getMaxMatches=function(){return Number.MAX_VALUE},t}(ll),ul=n("UDpV"),ml=n.n(ul),dl=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return R.d(t,e),t.prototype.render=function(){var e=this.props.fileUploadManager,t=e.file_upload_props.eUploadState;return 1==t?Ee.createElement(hl,{fileUploadManager:e}):3==t||5==t||4==t?Ee.createElement(fl,{fileUploadManager:e}):0!=t?Ee.createElement(_l,{fileUploadManager:e}):null},t=R.c([or.observer],t)}(Ee.Component),hl=function(n){function e(e){var t=n.call(this,e)||this;return t.state={bSpoilerChecked:!1},t}return R.d(e,n),e.prototype.OnCancelClick=function(e){this.props.fileUploadManager.CancelFileUpload()},e.prototype.OnUploadClick=function(){this.props.fileUploadManager.BeginFileUpload({bSpoiler:this.state.bSpoilerChecked})},e.prototype.OnDialogChecked=function(){this.setState({bSpoilerChecked:!this.state.bSpoilerChecked})},e.prototype.render=function(){var e=void 0,t=this.props.fileUploadManager.file;return-1!=t.type.indexOf("image")?e=Ee.createElement("img",{className:"chatFileUploadPreview",src:this.props.fileUploadManager.file_upload_data_url}):-1!=t.type.indexOf("video")&&(e=Ee.createElement(ui.eb,null)),Ee.createElement("div",{className:"chatFileUploadPreviewContainer"},e,Ee.createElement("div",{className:"chatFileUploadFileName"},"'",t.name,"'"),Ee.createElement("div",{className:"chatFileUploadCancel",onClick:this.OnCancelClick},Ee.createElement(ui.jb,null)),Ee.createElement("button",{className:"DialogButton Primary chatFileUploadBtn",type:"button",onClick:this.OnUploadClick},Object($.b)("#Chat_Upload")),Ee.createElement(Ki,{classname:"spoilerCheckBox",label:"Tag as Spoiler",checked:this.state.bSpoilerChecked,onChange:this.OnDialogChecked}))},R.c([T.a],e.prototype,"OnCancelClick",null),R.c([T.a],e.prototype,"OnUploadClick",null),R.c([T.a],e.prototype,"OnDialogChecked",null),e}(Ee.Component),_l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return R.d(t,e),t.prototype.render=function(){var e=this.props.fileUploadManager.file_upload_props,t=e.file?Object($.b)("#Chat_Uploading",e.displayFileName):"",n={width:e.uploadProgress+"%"};return Ee.createElement("div",{className:"chatFileUploadProgressContainer"},Ee.createElement("div",{className:"chatFileUploadProgressName"},t),Ee.createElement("div",{className:"chatFileUploadProgressBarContainer DialogProgressBar_ProgressBarContainer"},Ee.createElement("div",{className:"DialogProgressBar_Value",style:n})))},t=R.c([or.observer],t)}(Ee.Component),fl=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return R.d(t,e),t.prototype.ClearErrorState=function(){this.props.fileUploadManager.ClearFileUploadError()},t.prototype.OnRetryClick=function(){this.props.fileUploadManager.RetryFileUpload()},t.prototype.render=function(){var e=this.props.fileUploadManager.file_upload_props,t=e.displayFileName?Object($.b)("#Chat_Uploading",e.displayFileName):"",n=e.strErrorDescription||Object($.b)("#Chat_Settings_Error_Unknown"),o=void 0;return 3==e.eUploadState&&(o=Ee.createElement(Vi,{onClick:this.OnRetryClick},Object($.b)("#Chat_Upload_ErrorAction_Retry"))),Ee.createElement("div",{className:"chatFileUploadProgressContainer"},Ee.createElement("div",{className:"chatFileUploadProgressName"},t),Ee.createElement("div",{className:"chatFileUploadErrorDescription"},n),Ee.createElement("div",{className:"chatFileUploadActions"},Ee.createElement(Li,{className:"DialogLayout_NoMinWidth"},o,Ee.createElement(xi,{onClick:this.ClearErrorState},Object($.b)("#Chat_Upload_ErrorAction_Close")))))},R.c([T.a],t.prototype,"ClearErrorState",null),R.c([T.a],t.prototype,"OnRetryClick",null),t=R.c([or.observer],t)}(Ee.Component),gl=function(n){function e(e){var t=n.call(this,e)||this;return t.m_refTextInput=Ee.createRef(),t.m_refFileInput=Ee.createRef(),t.m_textFocusCallback=null,t.state={messageInput:"",submitEnabled:!1,mentionSearch:void 0,activeSuggestSearchType:void 0},t}return R.d(e,n),e.prototype.BindMentionDialog=function(e){this.m_MentionDialog=e},e.prototype.SetMessageInput=function(e,t){this.setState({messageInput:e,submitEnabled:0<e.trim().length},t),(this.props.chatView.text_entry=e)&&e.length&&this.props.chatView.chat.OnTyping()},e.prototype.OnSubmit=function(e){e&&e.preventDefault(),this.props.chatView&&this.props.chatView.file_upload_manager.file&&this.props.chatView.UploadFile(),this.state.messageInput.trim().length&&this.props.chatView&&this.props.chatView.chat.SendChatMessage(this.state.messageInput)&&(this.m_iMentionSearchCancelledOffset=void 0,this.ClearMentionSearchState(),this.setState({submitEnabled:!1}),this.SetMessageInput(""),this.props.chatView.is_scrolled_to_bottom=!0,this.FocusTextInput())},e.prototype.OnTextAreaChange=function(e){this.SetMessageInput(e.target.value)},e.prototype.OnFocus=function(e){this.UpdateMentionSearchState()},e.prototype.OnBlur=function(e){if(!e.relatedTarget||!Ci.e(W.findDOMNode(this),e.relatedTarget)){if(Object(ir.h)())return;this.m_iMentionSearchCancelledOffset=void 0,this.ClearMentionSearchState()}},e.prototype.OnKeyDown=function(e){this.state.activeSuggestSearchType&&this.m_MentionDialog&&!e.shiftKey&&!e.ctrlKey&&this.m_MentionDialog.BHandleKeyPress(e.keyCode)?e.preventDefault():8==e.keyCode||46==e.keyCode?this.m_iMentionSearchCancelledOffset=void 0:13!=e.keyCode||e.shiftKey||e.ctrlKey?13==e.keyCode&&e.ctrlKey&&(e.preventDefault(),this.InsertAtCursor("\n")):(e.preventDefault(),this.OnSubmit())},e.prototype.OnPaste=function(e){if(e&&(0!=e.clipboardData.files.length&&!e.clipboardData.types.some(function(e){return"text"==e||e.startsWith("text/")}))){var t=e.clipboardData.files[0];this.props.chatView.SetFileToUpload(t),e.preventDefault(),e.stopPropagation()}},e.prototype.OnFileInputChange=function(e){var t=e.currentTarget;t.files.length&&(this.props.chatView.SetFileToUpload(t.files[0]),t.value="")},e.prototype.OnEmbedClick=function(e){Object(mi.a)(Ee.createElement(yl,{chatView:this.props.chatView,refFileInput:this.m_refFileInput.current,fnInsertText:this.InsertAtCursor.bind(this)}),e.currentTarget,{bOverlapHorizontal:!0,bPreferPopLeft:!0,bPreferPopTop:!0})},e.prototype.OnEmoticonSelected=function(e,t){void 0===t&&(t=!1),t||this.m_refTextInput.current.focus(),this.InsertAtCursor(":"+e+":")},e.prototype.InsertAtCursor=function(e){var t=this.m_refTextInput.current,n=t.value,o=n.substr(0,t.selectionStart)+e+n.substr(t.selectionEnd),i=t.selectionStart+e.length;this.SetMessageInput(o,function(){t.selectionStart=t.selectionEnd=i})},e.prototype.OnKeyPress=function(e){this.UpdateMentionSearchState()},e.prototype.OnClick=function(e){this.UpdateMentionSearchState()},e.prototype.OnContextMenu=function(e){G.a.IN_CLIENT||e.stopPropagation()},e.prototype.ClearMentionSearchState=function(){this.m_iMentionSearchStartOffset=void 0,this.state.activeSuggestSearchType&&this.setState({activeSuggestSearchType:void 0,mentionSearch:void 0})},e.prototype.FindMatchOpener=function(e,t,n){for(var o=n-1;0<=o;o--){if(t[o]==e)return o;if(" "==t[o])break}},e.prototype.UpdateMentionSearchState=function(){var e=this.m_refTextInput.current;if(e){var t=(this.props.chatView&&this.props.chatView.chat)instanceof kt;if(e.selectionStart==e.selectionEnd&&e.selectionStart){for(var n=e.selectionStart,o=e.value,i=void 0,r=void 0,a=n-1;0<=a;a--){var s=0<a?o[a-1]:void 0;if(("@"==o[a]||"＠"==o[a])&&t){s&&" "!=s&&"\n"!=s||(i=a,r="Mention");break}if(":"==o[a]){s&&" "!=s&&"\n"!=s&&":"!=s||(i=a,r="Emoticon");break}if("/"==o[a]&&0==a){i=a,r="SlashCommand";break}if(" "==o[a]||"\n"==o[a])break}if(void 0!==i&&i!==this.m_iMentionSearchCancelledOffset){var c=o.substr(i+1,n-i-1);this.m_iMentionSearchStartOffset=i,this.setState({activeSuggestSearchType:r,mentionSearch:c})}else this.ClearMentionSearchState()}else this.ClearMentionSearchState()}},e.prototype.ReplaceSuggestedText=function(e,t,n){var o=this.m_refTextInput.current.selectionStart,i=this.m_refTextInput.current.value,r=this.FindMatchOpener(e,i,o);if(void 0===r&&"@"==e&&(r=this.FindMatchOpener("＠",i,o)),void 0!==r){var a=i.substr(0,r);a+=t,(o>=i.length||" "!=i[o])&&(a+=" ");var s=a.length;a+=i.substr(o),this.SetMessageInput(a,n),this.m_refTextInput.current.value=a,this.m_refTextInput.current.selectionStart=this.m_refTextInput.current.selectionEnd=s,this.FocusTextInput()}},e.prototype.OnMentionSuggestionSelected=function(e,t){var n;if(t instanceof ft?n=t.persona.m_strPlayerName:t&&(n=t),!n)return this.m_iMentionSearchCancelledOffset=this.m_iMentionSearchStartOffset,void this.ClearMentionSearchState();var o=n;-1!==o.lastIndexOf("#")&&(o=o.substr(0,o.lastIndexOf("#"))),1<this.props.chatView.chat.SearchMembers(o,2,!0).length&&(n+=t instanceof ft?"#"+t.accountid.toString(36):"#0"),this.ReplaceSuggestedText("@","@"+n),this.ClearMentionSearchState()},e.prototype.OnEmoticonSuggestionSelected=function(e,t){if(!t)return this.m_iMentionSearchCancelledOffset=this.m_iMentionSearchStartOffset,void this.ClearMentionSearchState();this.ReplaceSuggestedText(":",":"+t+":"),this.ClearMentionSearchState()},e.prototype.OnSlashCommandSuggestionSelected=function(e,t){var n=this;if(!t)return this.m_iMentionSearchCancelledOffset=this.m_iMentionSearchStartOffset,void this.ClearMentionSearchState();this.ReplaceSuggestedText("/",t,function(){0===Ke(t).unExpectedArguments&&n.OnSubmit()}),this.ClearMentionSearchState()},e.prototype.FocusTextInput=function(){this.m_refTextInput.current&&this.m_refTextInput.current.focus()},e.prototype.InitForChatView=function(e){this.m_textFocusCallback&&(this.m_textFocusCallback.Unregister(),this.m_textFocusCallback=null);var t=e.text_entry;t!=this.state.messageInput&&this.setState({messageInput:t}),this.m_textFocusCallback=e.RegisterForTextEntryFocus(this.FocusTextInput)},e.prototype.componentWillMount=function(){this.InitForChatView(this.props.chatView)},e.prototype.componentDidMount=function(){this.FocusTextInput()},e.prototype.componentWillUnmount=function(){this.m_textFocusCallback&&this.m_textFocusCallback.Unregister(),this.m_textFocusCallback=null},e.prototype.componentWillReceiveProps=function(e){var t=this;e.chatView!=this.props.chatView&&this.InitForChatView(e.chatView),e.isActive&&!this.props.isActive&&setTimeout(function(){t.FocusTextInput()},0)},e.prototype.render=function(){var e=this.props,t=e.chatView,n=e.disabled,o=t&&t.chat,i=void 0;switch(this.state.activeSuggestSearchType){case"Mention":i=Ee.createElement(vl,{chat:o,strSearch:this.state.mentionSearch,onSuggestionSelected:this.OnMentionSuggestionSelected,ref:this.BindMentionDialog});break;case"Emoticon":i=Ee.createElement(pl,{emoticonStore:ci.ChatStore.EmoticonStore,strSearch:this.state.mentionSearch,nMinimumSearchLengthBeforeAutoSelection:2,onSuggestionSelected:this.OnEmoticonSuggestionSelected,ref:this.BindMentionDialog});break;case"SlashCommand":i=Ee.createElement(Sl,{strSearch:this.state.mentionSearch,onSuggestionSelected:this.OnSlashCommandSuggestionSelected,ref:this.BindMentionDialog})}var r=ci.SettingsStore.FriendsSettings.bCompactFriendsList,a=ci.SettingsStore.FriendsSettings.nChatFontSize,s="";return a==gs.k_EChatFontSizeSmall?s=" smallChatFont":a==gs.k_EChatFontSizeLarge&&(s=" largeChatFont"),Ee.createElement("div",{className:"chatEntry"+(r?" compactView":"")+s},Ee.createElement(dl,{fileUploadManager:t.file_upload_manager}),Ee.createElement("form",{className:ml.a.chatEntryControls+" compactableHeight",onSubmit:this.OnSubmit,onBlur:this.OnBlur},i,Ee.createElement("textarea",{className:ml.a.chatTextarea,value:this.state.messageInput,onPaste:this.OnPaste,onContextMenu:this.OnContextMenu,ref:this.m_refTextInput,onChange:this.OnTextAreaChange,onKeyDown:this.OnKeyDown,onKeyUp:this.OnKeyPress,onClick:this.OnClick,onFocus:this.OnFocus,disabled:n||ci.CMInterface.BDisconnected(),maxLength:5e3,spellCheck:!0}),Ee.createElement("button",{className:"chatSubmitButton"+(this.state.submitEnabled?"":" disabled"),type:"submit",disabled:!this.state.submitEnabled,title:Object($.b)("#ChatEntryButton_Submit")},Ee.createElement(ui.X,null)),Ee.createElement("input",{type:"file",style:{display:"none"},name:"fileupload",ref:this.m_refFileInput,onChange:this.OnFileInputChange})),Ee.createElement("div",{className:ml.a.chatEntryActionsContainer+" compactableHeight"},Ee.createElement("div",{className:ml.a.chatEntryActionsGroup},Ee.createElement(al,{disabled:n,OnEmoticonSelected:this.OnEmoticonSelected,emoticonStore:ci.ChatStore.EmoticonStore,rtLastAckedNewEmoticons:_d.UIDisplayPrefs.rtLastAckedNewEmoticons,SetUIDisplayPref:_d.SetUIDisplayPref}),Ee.createElement("button",{className:"chatSubmitButton EmbedButton"+(n?" disabled":""),type:"button",onClick:this.OnEmbedClick,title:Object($.b)("#ChatEntryButton_SendEmbed"),disabled:n},Ee.createElement(ui.H,null))),Ee.createElement(bl,{chat:o})),Ee.createElement("div",{className:"disconnectBlocker compactableHeight"}))},R.c([T.a],e.prototype,"BindMentionDialog",null),R.c([T.a],e.prototype,"OnSubmit",null),R.c([T.a],e.prototype,"OnTextAreaChange",null),R.c([T.a],e.prototype,"OnFocus",null),R.c([T.a],e.prototype,"OnBlur",null),R.c([T.a],e.prototype,"OnKeyDown",null),R.c([T.a],e.prototype,"OnPaste",null),R.c([T.a],e.prototype,"OnFileInputChange",null),R.c([T.a],e.prototype,"OnEmbedClick",null),R.c([T.a],e.prototype,"OnEmoticonSelected",null),R.c([T.a],e.prototype,"OnKeyPress",null),R.c([T.a],e.prototype,"OnClick",null),R.c([T.a],e.prototype,"OnContextMenu",null),R.c([T.a],e.prototype,"OnMentionSuggestionSelected",null),R.c([T.a],e.prototype,"OnEmoticonSuggestionSelected",null),R.c([T.a],e.prototype,"OnSlashCommandSuggestionSelected",null),R.c([T.a],e.prototype,"FocusTextInput",null),e=R.c([or.observer],e)}(Ee.Component),bl=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return R.d(t,e),t.prototype.HandleStartVoice=function(e){var t=this.props.chat;if(t instanceof Jt)t.ToggleVoiceChat();else if(this.IsVoiceActiveForButton())ci.VoiceStore.OnUserEndVoiceChat();else if(t instanceof kt){var n=t.GetGroup();if(n){var o=n.voiceRoomList;if(0!=o.length)if(1!=o.length){var i=Ee.createElement(Cl,{group:n});Object(mi.a)(i,e.currentTarget,{bOverlapHorizontal:!0,bPreferPopLeft:!0,bPreferPopTop:!0})}else{var r=o[0];ci.VoiceStore.InitiateRoomChat(n.GetGroupID(),r.GetRoomID())}else n.CreateAndJoinTempVoiceRoom()}}},t.prototype.IsVoiceActiveForButton=function(){var e=this.props.chat,t=!1;if(e instanceof Jt)t=e.BVoiceActive();else if(e instanceof kt){var n=e.GetGroup();t=ci.VoiceStore.IsVoiceActiveForGroup(n.GetGroupID())}return t},t.prototype.render=function(){var e=this.IsVoiceActiveForButton(),t=["VoiceToggle"],n="",o=this.props.chat;e?(t.push("Active"),ci.VoiceStore.BNoMicAvailableForSession()&&t.push("NoMicrophone"),ci.VoiceStore.IsMicMuted()&&t.push("MicMuted")):t.push(" Inactive");var i=!o.BIsVoiceAllowed();if(i)t.push(" Disabled"),n=o.GetVoiceNotAllowedReason();else if(o instanceof Jt)n=e?"#Tooltip_VoiceControlButton_1v1_active":"#Tooltip_VoiceControlButton_1v1_inactive";else if(o instanceof kt)if(this.IsVoiceActiveForButton())n="#Tooltip_VoiceControlButton_group_leave";else{var r=o.GetGroup();r&&0==r.voiceRoomList.length?n="#Tooltip_VoiceControlButton_group_create":r&&1==r.voiceRoomList.length?n="#Tooltip_VoiceControlButton_group_joinsingle":r&&(n="#Tooltip_VoiceControlButton_group_joinmultiple")}var a=ci.VoiceStore.GetPushToTalkEnabled(),s=ci.VoiceStore.GetPushToMuteEnabled(),c=ci.VoiceStore.GetPushToTalkVoiceStateEnabled(),l=ci.VoiceStore.GetPushToTalkHotKeyDisplayString(),p="";return(a||s)&&(p+=" pushToTalkEnabled"),c&&(p+=" pushToTalkKeyDown"),Ee.createElement("div",{className:"ChatMessageEntryVoice"+p+(e?" Active":" Inactive")+(i?" Disabled":"")},Ee.createElement("div",{className:"buttonsContainer"},Ee.createElement("button",{disabled:i,className:t.join(" "),onClick:this.HandleStartVoice,title:Object($.b)(n)},Ee.createElement("div",{className:"VoiceToggleIconCtn"},Ee.createElement(ui.gb,null))),Ee.createElement("div",{className:"activeVoiceControls"},Ee.createElement("div",{className:"activeVoiceFlexBox"},Ee.createElement("div",{className:"activeVoiceButtons"},Ee.createElement(Mc,null),Ee.createElement(Dc,null))))),(a||s)&&this.IsVoiceActiveForButton()&&Ee.createElement("div",{className:"activeVoicePushToTalk"+p,title:Object($.b)(s?"#ActiveVoicePushToMute":"#ActiveVoicePushToTalk",l)},l))},R.c([T.a],t.prototype,"HandleStartVoice",null),t=R.c([or.observer],t)}(Ee.Component),vl=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return R.d(e,t),e.prototype.performSearch=function(e){return this.props.chat.SearchMembers(e,Number.MAX_VALUE)},e.prototype.ChooseSuggestion=function(e){e&&e.strNotSelectable||t.prototype.ChooseSuggestion.call(this,e)},e.prototype.getSelection=function(e){return e.friend?e.friend:e.meta_mention},e.prototype.getKey=function(e){return""+(e.friend?e.friend.accountid:e.meta_mention)},e.prototype.renderMatch=function(e){var t,n,o=e.friend,i=e.iMatchOffset,r=e.bNicknameMatch,a=this.props.strSearch.length,s=null;return o?(t=o.persona.m_strPlayerName,n=o.has_nickname&&o.nickname,o.persona.avatar_url_medium&&(s=o.persona.avatar_url_medium)):(t="@"+e.meta_mention,n=null,i++),r?Ee.createElement("span",{className:"mentionSuggestion"},s&&Ee.createElement("img",{className:"mentionAvatar",src:o.persona.avatar_url_medium,draggable:!1}),t,Ee.createElement("span",{className:"nickname"}," (",n.substr(0,i).replace(/ /g," "),Ee.createElement("span",{className:"mentionSearchMatch"},n.substr(i,a).replace(/ /g," ")),n.substr(i+a).replace(/ /g," "),")")):Ee.createElement("span",{className:"mentionSuggestion"},t.substr(0,i).replace(/ /g," "),s&&Ee.createElement("img",{className:"mentionAvatar",src:o.persona.avatar_url_medium,draggable:!1}),Ee.createElement("span",{className:"mentionSearchMatch"},t.substr(i,a).replace(/ /g," ")),t.substr(i+a).replace(/ /g," "),e.strNotSelectable&&Ee.createElement("span",{className:"notSelectable"}," ",": "+e.strNotSelectable," "),n&&Ee.createElement("span",{className:"nickname"}," (",n,")"))},e.prototype.renderNoMatchMessage=function(){return Ee.createElement("div",{key:"nomatches",className:"suggestOption mentionSearchOption noMatches"},Object($.b)("#ChatMentionSuggest_NoMatches"))},e.prototype.renderTooManyMatchesMessage=function(e){var t=e<=1?"#ChatMentionSuggest_ManyMatches":"#ChatMentionSuggest_ManyMatchesPlural";return Ee.createElement("div",{key:"manymatches",className:"suggestOption mentionSearchOption manyMatches"},Object($.b)(t,e))},e.prototype.renderHeader=function(){return Ee.createElement("div",{className:"mentionSearchText"},Object($.b)("#ChatMentionSuggest_MembersMatching",this.props.strSearch))},e.prototype.getMaxMatches=function(){return e.nMaxMatches},e.nMaxMatches=12,e}(ll),Sl=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return R.d(t,e),t.prototype.performSearch=function(e){var t="/"+e;return Object.keys(qe).filter(function(e){return e.startsWith(t)})},t.prototype.getSelection=function(e){return e},t.prototype.getKey=function(e){return e},t.prototype.renderMatch=function(e){var t=Ke(e);if(!t)return null;var n=Object($.b)(t.strDescriptionToken);return Ee.createElement("span",{className:"SlashCommandSuggestion"},Ee.createElement("span",{className:"SlashCommandSuggestion_SlashCommand"},e),": ",Ee.createElement("span",{className:"SlashCommandSuggestion_SlashCommandDescription"},n))},t.prototype.renderNoMatchMessage=function(){return null},t.prototype.renderTooManyMatchesMessage=function(e){return null},t.prototype.renderHeader=function(){return null},t.prototype.getMaxMatches=function(){return Number.MAX_VALUE},t}(ll);function yl(t){var e=[];t.refFileInput&&e.push(Ee.createElement(ir.d,{key:"upload",onSelected:function(){t.refFileInput.click()}},Object($.b)("#ChatEntry_UploadImage")));return e.push(Ee.createElement(ir.d,{key:"tradeoffer",onSelected:function(){ci.EconomyStore.GetTradeOfferURL().then(function(e){t.fnInsertText(e)})}},Object($.b)("#ChatEntry_SendTradeURL"))),Ee.createElement(ir.c,null,e)}function Cl(e){var t=e.group.GetGroupID(),n=e.group.voiceRoomList.map(function(e){return Ee.createElement(ir.d,{key:e.GetRoomID(),onSelected:function(){ci.VoiceStore.InitiateRoomChat(t,e.GetRoomID())}},e.name)});return Ee.createElement(ir.c,null,n)}var Il=function(n){function e(e){var t=n.call(this,e)||this;return t.state={nCalculatedHeightPx:void 0,bLeftSliderVisible:!1,bRightSliderVisible:!1},t}return R.d(e,n),e.prototype.OnRef=function(e){this.UnbindWindowHandlers(),e&&((this.m_elScroll=e).ownerDocument.defaultView&&this.m_elScroll.ownerDocument.defaultView.addEventListener("resize",this.CheckScrollPosition),this.CheckScrollPosition())},e.prototype.CheckScrollPosition=function(){if(!(!this.m_elScroll||this.m_animation&&this.m_animation.BIsActive())){for(var e=0,t=this.m_elScroll.firstElementChild;t;t=t.nextElementSibling)e=Math.max(e,t.getBoundingClientRect().height);e!=this.state.nCalculatedHeightPx&&this.setState({nCalculatedHeightPx:e}),this.UpdateSliderControlsForScrollOffset(this.m_elScroll.scrollLeft)}},e.prototype.UpdateSliderControlsForScrollOffset=function(e){var t=1<e,n=e+this.m_elScroll.getBoundingClientRect().width<this.m_elScroll.scrollWidth-1;t!=this.state.bLeftSliderVisible&&this.setState({bLeftSliderVisible:t}),n!=this.state.bRightSliderVisible&&this.setState({bRightSliderVisible:n})},e.prototype.AnimateScrollLeftTo=function(e){this.m_animation&&this.m_animation.Cancel(),this.m_animation=new Ei(this.m_elScroll,{scrollLeft:e},{msDuration:500,onComplete:this.CheckScrollPosition,timing:"cubic-in-out"}),this.m_animation.Start(),this.UpdateSliderControlsForScrollOffset(e)},e.prototype.OnSlideLeftClick=function(){this.m_animation&&this.m_animation.BIsActive()||this.m_elScroll&&this.AnimateScrollLeftTo(Math.max(0,this.m_elScroll.scrollLeft-this.m_elScroll.getBoundingClientRect().width))},e.prototype.OnSlideRightClick=function(){this.m_animation&&this.m_animation.BIsActive()||this.m_elScroll&&this.AnimateScrollLeftTo(Math.min(this.m_elScroll.scrollWidth-this.m_elScroll.getBoundingClientRect().width,this.m_elScroll.scrollLeft+this.m_elScroll.getBoundingClientRect().width))},e.prototype.OnWheel=function(e){e&&e.nativeEvent&&(e.nativeEvent.deltaY<0?this.OnSlideLeftClick():this.OnSlideRightClick())},e.prototype.GetScrollRef=function(){return this.m_elScroll},e.prototype.componentWillUnmount=function(){this.UnbindWindowHandlers(),this.m_animation&&this.m_animation.Cancel()},e.prototype.componentDidUpdate=function(){this.CheckScrollPosition()},e.prototype.UnbindWindowHandlers=function(){this.m_elScroll&&(this.m_elScroll.ownerDocument.defaultView&&this.m_elScroll.ownerDocument.defaultView.removeEventListener("resize",this.CheckScrollPosition),this.m_elScroll=void 0)},e.prototype.render=function(){var e="auto";return this.state.nCalculatedHeightPx&&(e=this.state.nCalculatedHeightPx+"px"),Ee.createElement("div",{onWheel:this.OnWheel,className:"HorizontalMiniSlider",style:{height:e}},Ee.createElement("div",{onClick:this.OnSlideLeftClick,className:"HorizontalMiniSliderArrow Left"+(this.state.bLeftSliderVisible?" Visible":"")},Ee.createElement(ui.m,null)),Ee.createElement("div",{onClick:this.OnSlideRightClick,className:"HorizontalMiniSliderArrow Right"+(this.state.bRightSliderVisible?" Visible":"")},Ee.createElement(ui.m,null)),Ee.createElement("div",{className:"HorizontalMiniSliderScroll "+this.props.className,onScroll:this.CheckScrollPosition,ref:this.OnRef},this.props.children))},R.c([T.a],e.prototype,"OnRef",null),R.c([T.a],e.prototype,"CheckScrollPosition",null),R.c([T.a],e.prototype,"OnSlideLeftClick",null),R.c([T.a],e.prototype,"OnSlideRightClick",null),R.c([T.a],e.prototype,"OnWheel",null),e}(Ee.Component),El=function(n){function e(e){var t=n.call(this,e)||this;return t.m_mapTabs=new Map,t.m_rgOrderedRenderedTabs=[],t.m_bUsePopups=!1,t.m_nInitialTabDragOffset=-1,t.m_nTheaterTopHoverHeight=12,t.m_fnUnregisterDropComplete=void 0,t.state={tabDrag:void 0,iDragIndex:0,windowWidth:0,bTheaterModeTopHovered:!1},t}return R.d(e,n),e.prototype.componentDidUpdate=function(){this.FixScrollLocation()},e.prototype.componentDidMount=function(){var e=this.props.popup?this.props.popup.window:window;e&&e.addEventListener("resize",this.OnWindowResizeEvent),this.m_elchatTabDiv&&(this.setState({windowWidth:this.m_elchatTabDiv.clientWidth}),this.UpdateWindowIcon())},e.prototype.componentWillUnmount=function(){var e=this.props.popup?this.props.popup.window:window;e&&e.removeEventListener("resize",this.OnWindowResizeEvent)},e.prototype.OnWindowResizeEvent=function(){this.m_elchatTabDiv&&this.setState({windowWidth:this.m_elchatTabDiv.clientWidth})},e.prototype.SetDragTab=function(e){void 0!==e?this.m_fnUnregisterDropComplete=_d.DragDropManager.RegisterForDropComplete(this.HandleDropComplete):this.m_fnUnregisterDropComplete&&(this.m_fnUnregisterDropComplete.Unregister(),this.m_fnUnregisterDropComplete=void 0),this.setState({tabDrag:e}),this.m_nInitialTabDragOffset=-1},e.prototype.GetDragTab=function(){return this.state.tabDrag},e.prototype.HandleDropComplete=function(e){this.m_fnUnregisterDropComplete=void 0,this.setState({tabDrag:void 0})},e.prototype.FixScrollLocation=function(){if(this.m_elScroll&&this.props.activeTab){var e=this.m_mapTabs.get(this.props.activeTab.GetUniqueID());if(e){var t=e.GetChatTabRef();if(t){var n=t.offsetLeft,o=t.offsetLeft+t.scrollWidth,i=this.m_elScroll.scrollLeft+this.m_elScroll.clientWidth;if(n<i&&i<o){var r=n-this.m_elScroll.clientWidth+t.scrollWidth+40;this.SetScrollLeft(r)}else if(n<this.m_elScroll.scrollLeft+40||o>this.m_elScroll.scrollLeft+this.m_elScroll.clientWidth){0!=(r=n)&&(r-=40),this.SetScrollLeft(r)}}}}},e.prototype.SetScrollLeft=function(e){this.m_elScroll.scrollLeft!=e&&(this.m_animation&&this.m_animation.Cancel(),this.m_animation=new Ei(this.m_elScroll,{scrollLeft:e},{msDuration:300,timing:"sine",onComplete:function(){}}),this.m_animation.Start())},e.prototype.UpdateDragOffset=function(e){var t,n=e.clientX;for(t=0;t<this.m_rgOrderedRenderedTabs.length;t++){var o=this.m_rgOrderedRenderedTabs[t],i=this.m_mapTabs.get(o.GetUniqueID()),r=i&&i.GetBoundingClientRect();if(i&&r&&(n-r.left<r.width&&(this.m_nInitialTabDragOffset<0&&(this.m_nInitialTabDragOffset=n-r.left),n-this.m_nInitialTabDragOffset<r.left+r.width/2)))break}this.state.iDragIndex!=t&&this.setState({iDragIndex:t})},e.prototype.OnTabRef=function(e,t){t?this.m_mapTabs.set(e,t):this.m_mapTabs.delete(e),this.UpdateWindowIcon()},e.prototype.OnScrollRef=function(e){this.m_elScroll=e?e.GetScrollRef():null},e.prototype.SelectTab=function(e){this.props.tabSet.ActivateTab(e)},e.prototype.OnDragStart=function(e){var t=_d.DragDropManager.GetDragData();t&&"chattab"==t.type&&(t.tabSet=this.props.tabSet)},e.prototype.OnChatTabContianerRef=function(e){this.m_elchatTabDiv=e},e.prototype.OnDragEnd=function(){this.setState({tabDrag:void 0})},e.prototype.OnBackClick=function(e){this.props.ResponsiveWindowState.SetActiveView(po.FriendsList)},e.prototype.ToggleSingleWindowToggle=function(){_d.ToggleSingleWindowToggle(this.props.popup)},e.prototype.ShowFriendsList=function(e){ci.UIStore.SetTheaterMode(!1),ci.UIStore.SetFriendsListCollapsed(cd(this,e),!1)},e.prototype.StartTopbarEventListener=function(){this.m_elchatTabDiv.ownerDocument.defaultView.addEventListener("mousemove",this.OnTopbarHovered)},e.prototype.OnTopbarHovered=function(e){var t=e.clientY;ci.UIStore.GetTheaterMode()||this.m_elchatTabDiv.ownerDocument.defaultView.removeEventListener("mousemove",this.OnTopbarHovered),t>this.m_nTheaterTopHoverHeight?this.state.bTheaterModeTopHovered&&(this.setState({bTheaterModeTopHovered:!1}),this.m_nTheaterTopHoverHeight=12):this.state.bTheaterModeTopHovered||(this.m_nTheaterTopHoverHeight=50,this.setState({bTheaterModeTopHovered:!0}))},e.prototype.OnTabSelectorClick=function(e){var t=33*this.m_mapTabs.size+(e.currentTarget.offsetTop+e.currentTarget.clientHeight)+16>e.currentTarget.ownerDocument.defaultView.innerHeight;Object(mi.a)(Ee.createElement(this.ChatTabSelectorContextMenu,null),e.currentTarget,{bOverlapHorizontal:!0,bPreferPopLeft:!1,bPreferPopTop:!1,bForcePopup:t})},e.prototype.ChatTabSelectorContextMenu=function(){for(var e=[],t=0,n=this.props.tabSet.tabs;t<n.length;t++){var o=n[t],i=Ee.createElement(Ol,{tab:o,active:!0,selectTab:this.SelectTab,fnOnDragEnd:null,bDisableContextMenu:!0});e.push(Ee.createElement(ir.d,{key:o.GetUniqueID(),onSelected:null},i))}return Ee.createElement(ir.c,{className:"ChatTabs compactView CompactFriendsList"},e)},e.prototype.UpdateWindowIcon=function(){try{if(this.props.popup&&this.props.popup.window&&void 0!==this.props.popup.window.SteamClient){for(var e=!1,t=!1,n=this.props.tabSet.tabs,o=0,i=n;o<i.length;o++){var r=i[o];0<r.GetUnreadMessageCount()&&(e=!0),r.IsVoiceActive()&&(t=!0)}t?this.props.popup.window.SteamClient.Window.SetWindowIcon("voice"):e?this.props.popup.window.SteamClient.Window.SetWindowIcon("messages"):this.props.popup.window.SteamClient.Window.SetWindowIcon("steam")}}catch(e){}},e.prototype.render=function(){var o=this,e=ci.UIStore.GetTheaterMode();if(this.UpdateWindowIcon(),this.props.tabSet.tabCount<=0&&!this.props.popup)return null;var t,n=this.props.tabSet.tabs,i=this.props.activeTab,r=!1,a=!1;i instanceof xt?r=i.isBroadcastShown:i instanceof _o&&(r=!0);for(var s=0,c=n;s<c.length;s++){if(0<c[s].GetUnreadMessageCount()){a=!0;break}}if(this.state.tabDrag){var l=n.indexOf(this.state.tabDrag);-1!=l?l!=this.state.iDragIndex&&(t=n.slice(),Object(M.f)(t,l,Math.min(this.state.iDragIndex,n.length-1))):this.state.iDragIndex<n.length?(t=n.slice()).splice(this.state.iDragIndex,0,this.state.tabDrag):t=n.concat(this.state.tabDrag)}n=t||n,this.m_rgOrderedRenderedTabs=n;var p,u="ChatTabs titleBarContainer";this.props.popup&&(u+=" HasWindowControls"),1==n.length?u+=" OneTab":this.state.windowWidth<180*n.length+180&&(u+=" HasTabs"),ci.SettingsStore.FriendsSettings.bCompactFriendsList&&(u+=" compactView"),this.state.bTheaterModeTopHovered&&(u+=" TheaterTopHovered"),this.props.ResponsiveWindowState&&(p=Ee.createElement("div",{className:"ChatTabsBackButton",onClick:this.OnBackClick},"<<")),r&&(u+=" activeTabHasBroadcast");var m,d=!1,h=!0;this.props.popup&&(m=ld(this.props.popup),h=ci.UIStore.BIsFriendsListSingleWindow(m),d=m!=ai),e&&this.m_elchatTabDiv&&this.StartTopbarEventListener();var _=this.m_elchatTabDiv&&180*this.props.tabSet.tabCount+(G.a.IN_CLIENT?168:48)>this.m_elchatTabDiv.clientWidth||!1;return Ee.createElement("div",{className:u,onDragStart:this.OnDragStart,ref:this.OnChatTabContianerRef},this.props.popup&&Ee.createElement(dr,{hideMinMax:d,popup:this.props.popup}," "),p,(e&&h||this.props.showOpenFriendsList)&&Ee.createElement("div",{className:"chatTabOpenFriendsList",onClick:this.ShowFriendsList},Ee.createElement(ui.t,null),Object($.b)("#FriendsList_ExpandButton")),0<this.props.tabSet.tabCount&&Ee.createElement("div",{className:"chatTabSetContainer"+(_?" showTabSelector":"")},Ee.createElement(Il,{className:"chatTabList",ref:this.OnScrollRef},Ee.createElement(pi,{className:"chatTabTransitionGroup"},n.map(function(t,e){var n=o.props.activeTab==t;return Ee.createElement(li,{className:"ChatTabTranstionContainer",classNames:"ChatTabTransiton",key:t.GetUniqueID(),timeout:350},Ee.createElement(Ol,{tab:t,active:n,selectTab:o.SelectTab,ref:function(e){return o.OnTabRef(t.GetUniqueID(),e)},fnOnDragEnd:o.OnDragEnd}))}))),_&&Ee.createElement("div",{className:"chatTabSelector"+(a?" UnreadMessages":""),onClick:this.OnTabSelectorClick},Ee.createElement(ui.n,null),a&&Ee.createElement("div",{className:"ChatUnreadMessageIndicator"})),G.a.IN_CLIENT&&Ee.createElement(Ee.Fragment,null,Ee.createElement("div",{className:"chatTabDraggableSpace"}),Ee.createElement("div",{className:"chatTabDraggableSpace ChromeClearance"}))),this.props.popup&&G.a.IN_CLIENT&&Ee.createElement("div",{className:"title-area-icon singleWindowToggle"+(d?" inOverlay":""),title:Object($.b)("#FriendsList_TitleArea_SingleWindowButton"),onClick:this.ToggleSingleWindowToggle},Ee.createElement(ui.U,null)),Ee.createElement("div",{className:"dropTargetBox"}),e&&Ee.createElement("div",{className:"theaterModeHoverSpace"+(a?" hasUnreadMessages":"")},a&&Ee.createElement("div",{className:"ChatUnreadMessageIndicator"},Ee.createElement("div",{className:"chatUnreadCircle"}))))},R.c([d.observable],e.prototype,"m_nTheaterTopHoverHeight",void 0),R.c([T.a],e.prototype,"OnWindowResizeEvent",null),R.c([T.a],e.prototype,"HandleDropComplete",null),R.c([T.a],e.prototype,"OnTabRef",null),R.c([T.a],e.prototype,"OnScrollRef",null),R.c([T.a],e.prototype,"SelectTab",null),R.c([T.a],e.prototype,"OnDragStart",null),R.c([T.a],e.prototype,"OnChatTabContianerRef",null),R.c([T.a],e.prototype,"OnDragEnd",null),R.c([T.a],e.prototype,"OnBackClick",null),R.c([T.a],e.prototype,"ToggleSingleWindowToggle",null),R.c([T.a],e.prototype,"ShowFriendsList",null),R.c([T.a],e.prototype,"StartTopbarEventListener",null),R.c([T.a],e.prototype,"OnTopbarHovered",null),R.c([T.a],e.prototype,"OnTabSelectorClick",null),R.c([T.a],e.prototype,"ChatTabSelectorContextMenu",null),e=R.c([or.observer],e)}(Ee.Component),Ol=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.m_bMiddleMouseDown=!1,e}return R.d(e,t),e.prototype.BindChatTab=function(e){this.m_elChatTab=e},e.prototype.GetBoundingClientRect=function(){return this.m_elChatTab?this.m_elChatTab.getBoundingClientRect():void 0},e.prototype.GetChatTabRef=function(){return this.m_elChatTab},e.prototype.OnDragStart=function(e){var t=e.clientX-e.currentTarget.getBoundingClientRect().left,n=e.clientY-e.currentTarget.getBoundingClientRect().top;_d.DragDropManager.StartDrag({type:"chattab",tab:this.props.tab,offsetX:t,offsetY:n})},e.prototype.OnDragEnd=function(e){var t=_d.DragDropManager.GetDragData();if(t&&"chattab"==t.type){var n=t,o=!1;if(n.tabSet)o=ci.UIStore.GetPerContextChatData(n.tabSet.GetBrowserContext()).BUsePopups();if(!_d.DragDropManager.BWasDropConsumed()&&n.tabSet&&1<n.tabSet.tabCount&&o){var i=e.currentTarget.getBoundingClientRect(),r=i.left-e.clientX,a=i.top-e.clientY;if(1e4<r*r+a*a){var s=e.currentTarget.ownerDocument.defaultView,c={left:Math.max(0,e.screenX-n.offsetX),top:Math.max(0,e.screenY-n.offsetY),width:s.innerWidth,height:s.innerHeight};if(this.props.fnOnDragEnd(),o){var l=cd(this,e);e.currentTarget.ownerDocument.defaultView.SteamClient.Window.GetMousePositionDetails(function(e){e&&(c.left=-n.offsetX,c.top=-n.offsetY),ci.UIStore.MoveTabToNewPopup(l,n.tab,c,e)})}else ci.UIStore.MoveTabToNewPopup(cd(this,e),n.tab,c)}}}_d.DragDropManager.EndDrag()},e.prototype.OnMouseDown=function(e){0==e.button?this.props.selectTab(this.props.tab):1==e.button&&(e.preventDefault(),this.m_bMiddleMouseDown=!0)},e.prototype.OnMouseUp=function(e){1==e.button&&this.m_bMiddleMouseDown&&(ci.UIStore.CloseTab(cd(this,e),this.props.tab),e.preventDefault(),this.m_bMiddleMouseDown=!1)},e.prototype.OnMouseLeave=function(e){this.m_bMiddleMouseDown=!1},e.prototype.OnCloseClick=function(e){ci.UIStore.CloseTab(cd(this,e),this.props.tab),e.stopPropagation()},e.prototype.OnContextMenu=function(e){if(!this.props.bDisableContextMenu){var t=this.props.tab;if(t.IsChatRoom()){if(t instanceof xt){ba(e,(n=t).GetGroup(),{tab:t})}}else{var n=this.props.tab.GetChatView();Jr(cd(this,e),{tab:this.props.tab},n.chat.chat_partner,e)}}},e.prototype.render=function(){var e=this.props.tab,t="chatTab no-drag";return this.props.active&&(t+=" active"),e.IsChatRoom()&&(t+=" chatRoom"),e.IsVoiceActive()&&(t+=" VoiceActive",ci.ChatStore.VoiceChat.IsMicMuted()&&(t+=" MicMuted")),Ee.createElement("div",{className:t,ref:this.BindChatTab,draggable:!0,onMouseDown:this.OnMouseDown,onMouseUp:this.OnMouseUp,onMouseLeave:this.OnMouseLeave,onDragStart:this.OnDragStart,onDragEnd:this.OnDragEnd,onContextMenu:this.OnContextMenu},Ee.createElement("div",{className:"chatTabHighlight"}),e.IsVoiceActive()&&Ee.createElement("div",{className:"MicStatus",title:ci.ChatStore.VoiceChat.IsMicMuted()?Object($.b)("#Tooltip_MicStatus_Muted"):Object($.b)("#Tooltip_MicStatus_Active")},Ee.createElement(ui.D,null)),Ee.createElement(ar,null,Ee.createElement(Ml,{tab:this.props.tab})),Ee.createElement("div",{className:"TabRightContainer"},Ee.createElement("div",{title:Object($.b)("#Chat_CloseTooltip"),className:"chatTabClose closeButton",onClick:this.OnCloseClick},Ee.createElement(ui.jb,null)),Ee.createElement(wl,{tab:this.props.tab})))},R.c([T.a],e.prototype,"BindChatTab",null),R.c([T.a],e.prototype,"OnDragStart",null),R.c([T.a],e.prototype,"OnDragEnd",null),R.c([T.a],e.prototype,"OnMouseDown",null),R.c([T.a],e.prototype,"OnMouseUp",null),R.c([T.a],e.prototype,"OnMouseLeave",null),R.c([T.a],e.prototype,"OnCloseClick",null),R.c([T.a],e.prototype,"OnContextMenu",null),e=R.c([or.observer],e)}(Ee.Component),wl=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return R.d(t,e),t.prototype.render=function(){var e=this.props.tab;if(e.IsChatRoom()&&e instanceof xt){var t=e;return t.GetGroup().HasUnreadChatMessage?Ee.createElement(Ee.Fragment,null,Ee.createElement(wa,{group:t.GetGroup(),className:"ChatTabUnread"}),Ee.createElement("div",{className:"UnreadGlow"})):null}return e.GetUnreadMessageCount()?Ee.createElement(Ee.Fragment,null,Ee.createElement("div",{className:"chatTabUnreadBadge"},e.GetUnreadMessageCount()),Ee.createElement("div",{className:"UnreadGlow"})):null},t=R.c([or.observer],t)}(Ee.Component),Ml=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return R.d(t,e),t.prototype.render=function(){var e=this.props.tab.GetChatView();if(e&&e.chat instanceof Jt)return Ee.createElement("div",{className:"ChatTabContent"},Ee.createElement(zc,{friend:e.chat.chat_partner,noActions:!0,context:{chat:e.chat}}));if(e&&e.chat instanceof kt){var t=this.props.tab.GetGroup();return Ee.createElement("div",{className:"ChatTabContent ChatRoom"},Ee.createElement(xs,{group:t,small:!0}),Ee.createElement("div",{className:"chatTabGroupName"},this.props.tab.GetTabName()))}if(this.props.tab instanceof _o){var n=this.props.tab.GetTabName(),o=G.a.CHAT_BASE_URL+Q.tabIcon;return Ee.createElement("div",{className:"ChatTabContent ChatRoom"},Ee.createElement("div",{className:"ChatRoomGroupAvatar HasAvatar Small"},Ee.createElement("img",{className:"ChatRoomGroupAvatar_Avatar",src:o})),Ee.createElement("div",{className:"chatTabGroupName"},n))}return null},t=R.c([or.observer],t)}(Ee.Component);var Dl=function(n){function e(e){var t=n.call(this,e)||this;return t.state={bDontShowChecked:!1,strChatName:""},t.m_strChannelName="",t}return R.d(e,n),e.prototype.DismissDialog=function(){this.props.closeModal()},e.prototype.OnSubmit=function(){_d.SetUIDisplayPref("bDontShowVoiceAlert",this.state.bDontShowChecked),this.props.closeModal()},e.prototype.OnDialogChecked=function(){this.setState({bDontShowChecked:!this.state.bDontShowChecked})},e.prototype.OnManualVoiceChatExit=function(){ci.VoiceStore.OnUserEndVoiceChat(),this.OnSubmit()},e.prototype.componentDidMount=function(){this.setState({strChatName:ci.ChatStore.GetActiveVoiceChat().name})},e.prototype.render=function(){return Ee.createElement(sr,{onEscKeypress:this.DismissDialog},Ee.createElement(Fi,{classNameContent:"CloseActiveVoiceWindowConfirmation",onSubmit:this.OnSubmit},Ee.createElement(wi,null,Ee.createElement("div",null,Object($.b)("#Chat_StillInVoiceDialog_Title"))),Ee.createElement(Gi,null,Ee.createElement("div",{className:"activeVoiceDetails"},Object($.b)("#Chat_StillInVoiceDialog_Desc1")),Ee.createElement("div",{className:"activeVoiceDetails"},Object($.b)("#Chat_StillInVoiceDialog_Desc2")),Ee.createElement("div",{className:"voiceControlsExample"},Ee.createElement(wc,{name:this.state.strChatName,chat:ci.ChatStore.GetActiveVoiceChat(),nostatus:!0}),Ee.createElement("div",{className:"circleHighlight voiceExit"})),!1),Ee.createElement(Mi,null,Ee.createElement("div",{className:"_DialogColLayout"},Ee.createElement(Vi,{onClick:this.OnSubmit},Object($.b)("#Chat_StillInVoiceDialog_KeepChatting"))),Ee.createElement("div",{className:"dontShowConfirmation",onClick:this.OnDialogChecked},Ee.createElement(Ki,{checked:this.state.bDontShowChecked,onChange:this.OnDialogChecked}),Object($.b)("#Dialog_DontShowMeAgain")))))},R.c([T.a],e.prototype,"DismissDialog",null),R.c([T.a],e.prototype,"OnSubmit",null),R.c([T.a],e.prototype,"OnDialogChecked",null),R.c([T.a],e.prototype,"OnManualVoiceChatExit",null),e=R.c([or.observer],e)}(Ee.Component),Tl=function(t){function e(e){return t.call(this,e)||this}return R.d(e,t),e.prototype.HideStats=function(){this.props.closeStats&&this.props.closeStats()},e.prototype.render=function(){var e=this.props.stats;return Ee.createElement("div",{className:"dash_video_stats"},Ee.createElement("button",{className:"dash_stat_close_button",onClick:this.HideStats},Ee.createElement(ui.jb,null)),Ee.createElement("div",null,Object($.b)("#DASHPlayerStats_BufferingResolution")," ",Ee.createElement("span",{className:"videoStatsValue"},e.GetBufferingResolutionToDisplay())),Ee.createElement("div",null,Object($.b)("#DASHPlayerStats_PlaybackResolution")," ",Ee.createElement("span",{className:"videoStatsValue"},e.GetPlaybackResolutionToDisplay())),Ee.createElement("div",null,Object($.b)("#DASHPlayerStats_HtmlResolution")," ",Ee.createElement("span",{className:"videoStatsValue"},e.GetHTMLVideoResolutionToDisplay())),Ee.createElement("div",null,Object($.b)("#DASHPlayerStats_ContentServer")," ",Ee.createElement("span",{className:"videoStatsValue"},e.GetContentServerToDisplay())),Ee.createElement("div",null,Object($.b)("#DASHPlayerStats_StallEvents")," ",Ee.createElement("span",{className:"videoStatsValue"},e.GetStalledEventsToDisplay())),Ee.createElement("div",null,Object($.b)("#DASHPlayerStats_FailedDownloads")," ",Ee.createElement("span",{className:"videoStatsValue"},e.GetFailedDownloadsToDisplay())),Ee.createElement("div",null,Object($.b)("#DASHPlayerStats_TimeToFirstFrame")," ",Ee.createElement("span",{className:"videoStatsValue"},e.GetTimeToFirstFrameToDisplay())),Ee.createElement("div",null,Object($.b)("#DASHPlayerStats_PlaybackRate")," ",Ee.createElement("span",{className:"videoStatsValue"},e.GetPlaybackRateForDisplay())),Ee.createElement(Gl,{stats:e}))},R.c([T.a],e.prototype,"HideStats",null),e=R.c([or.observer],e)}(Ee.Component),Gl=function(t){function e(e){return t.call(this,e)||this}return R.d(e,t),e.prototype.createBufferedRange=function(e){var t=this.props.stats,n=[],o=e?"vidbuf":"audbuf",i=e?t.GetNumBufferedVideoRanges():t.GetNumBufferedAudioRanges();if(0<i)for(var r=0;r<i;++r){var a=Object($.b)(e?"#DASHPlayerStats_VideoBufferRange":"#DASHPlayerStats_AudioBufferRange",r),s=e?t.GetBufferedVideoSegmentForDisplay(r):t.GetBufferedAudioSegmentForDisplay(r);n.push(Ee.createElement("div",{key:o+r},a," ",Ee.createElement("span",{className:"videoStatsValue"},s)))}else{a=Object($.b)(e?"#DASHPlayerStats_VideoNoRangeInformation":"#DASHPlayerStats_AudioNoRangeInformation");n.push(Ee.createElement("div",{key:o+"none"},a))}return n},e.prototype.render=function(){var e=this.props.stats;return Ee.createElement("div",{className:"dash_video_quick_stats"},Ee.createElement("div",null,Object($.b)("#DASHPlayerStats_BytesReceived")," ",Ee.createElement("span",{className:"videoStatsValue"},e.GetBytesReceivedToDisplay())),this.props.stats.BHasFrameInformation()&&Ee.createElement("div",null,Object($.b)("#DASHPlayerStats_DroppedFrames")," ",Ee.createElement("span",{className:"videoStatsValue"},e.GetDroppedFramesToDisplay())),Ee.createElement("div",null,Object($.b)("#DASHPlayerStats_VideoBuffered")," ",Ee.createElement("span",{className:"videoStatsValue"},e.GetVideoBufferedToDisplay()," ")),Ee.createElement("div",null,Object($.b)("#DASHPlayerStats_AudioBuffered")," ",Ee.createElement("span",{className:"videoStatsValue"},e.GetAudioBufferedToDisplay()," ")),this.createBufferedRange(!0),this.createBufferedRange(!1),Ee.createElement("div",null,Object($.b)("#DASHPlayerStats_BandwidthRequired")," ",Ee.createElement("span",{className:"videoStatsValue"},e.GetBandwidthRequiredToDisplay())),Ee.createElement("div",null,Object($.b)("#DASHPlayerStats_BandwidthVideo")," ",Ee.createElement("span",{className:"videoStatsValue"},e.GetBandwithVideoToDisplay())),Ee.createElement("div",null,Object($.b)("#DASHPlayerStats_BandwidthNums")," ",Ee.createElement("span",{className:"videoStatsValue"},e.GetBandwidthStatsToDisplay())),Ee.createElement("div",null,Object($.b)("#DASHPlayerStats_DownloadNums")," ",Ee.createElement("span",{className:"videoStatsValue"},e.GetDownloadTimeStatsToDisplay())),Ee.createElement("div",null,Object($.b)("#DASHPlayerStats_ActiveDownloads")," ",Ee.createElement("span",{className:"videoStatsValue"},e.GetActiveDownloadsToDisplay())),Ee.createElement("div",null,Object($.b)("#DASHPlayerStats_VideoDownloadProgress")," ",Ee.createElement("span",{className:"videoStatsValue"},e.GetVideoDownloadProgressToDisplay())),Ee.createElement("div",null,Object($.b)("#DASHPlayerStats_DroppingFrames")," ",Ee.createElement("span",{className:"videoStatsValue"},e.GetPersistentFrameDropsForDisplay())),Ee.createElement("div",null,Object($.b)("#DASHPlayerStats_CurrentFPS")," ",Ee.createElement("span",{className:"videoStatsValue"},e.GetCurrentFPSForDisplay())))},e=R.c([or.observer],e)}(Ee.Component);n("FuJV");function Rl(e,t){var n;n="currentTarget"in e?e.currentTarget.ownerDocument.defaultView:e,0==t.indexOf("steam://")?n.location.href=t:n.open(t,null,"menubar,location,resizable,scrollbars,status,noopener")}var Nl=function(){function e(e){this.m_bLoaded=!1,this.m_appid=e,this.m_bLoaded=!1,this.m_appStoreData={appid:e,success:2,title:"",screenshot:"",age_safe_screenshot:!1,capsule_link:_.b.STORE_BASE_URL+"app/"+e}}return e.prototype.GetAppStoreData=function(){return this.m_appStoreData},e.prototype.HintLoadBroadcastAppData=function(i){return void 0===i&&(i="steamtv"),R.b(this,void 0,void 0,function(){var t,n,o;return R.e(this,function(e){switch(e.label){case 0:if(this.m_bLoaded)return[3,5];(t=new FormData).append("appid",""+this.m_appid),t.append("feature",i),n=null,o=_.b.STORE_BASE_URL+"broadcast/ajaxgetappinfoforcap",e.label=1;case 1:return e.trys.push([1,3,,4]),[4,C.a.post(o,t)];case 2:return n=e.sent(),[3,4];case 3:return e.sent(),[3,4];case 4:if(!n||200!=n.status||!n.data||1!=n.data.success)return console.log("AMS - failed to load store info about appid: "+this.m_appid),this.m_appStoreData.success=n.data?n.data.success:2,[2];this.m_appStoreData.success=1,this.m_appStoreData.capsule_link=n.data.capsule_link,this.m_appStoreData.price=n.data.price,this.m_appStoreData.subid=n.data.subid,this.m_appStoreData.button_action=n.data.button_action,this.m_appStoreData.cart_url=n.data.cart_url,this.m_appStoreData.add_to_cart_url=n.data.add_to_cart_url,this.m_appStoreData.title=n.data.title,this.m_appStoreData.release=n.data.release,this.m_appStoreData.short_desc=n.data.short_desc,this.m_appStoreData.capsule=n.data.capsule,this.m_appStoreData.tiny_capsule=n.data.tiny_capsule,this.m_appStoreData.screenshot=n.data.screenshot,this.m_appStoreData.age_safe_screenshot=n.data.age_safe_screenshot,e.label=5;case 5:return[2]}})})},R.c([d.observable],e.prototype,"m_appStoreData",void 0),R.c([d.action],e.prototype,"HintLoadBroadcastAppData",null),e}(),Ll=function(n){function e(e){var t=n.call(this,e)||this;return t.state={appInfo:new Nl(e.appid)},t}return R.d(e,n),e.prototype.componentDidMount=function(){this.HintLoadBroadcastAppData()},e.prototype.HintLoadBroadcastAppData=function(){this.state.appInfo.HintLoadBroadcastAppData()},e.prototype.render=function(){var t=this.state.appInfo.GetAppStoreData(),e=this.props.bColumn,n=this.props.bMiniColumn,o="StoreSaleWidgetContainer",i="StoreSaleWidgetImage",r="StoreSaleImage",a="StoreSaleWidgetShortDesc";return n?(o+="_mini",i+="_mini",r+="_mini",a+="_mini"):e&&(o+="_column",i+="_column",r+="_column",a+="_column"),t?Ee.createElement("div",{className:o},Ee.createElement("div",{className:"Actions"},Ee.createElement("div",{className:i,onClick:function(e){return Rl(e,t.capsule_link)}},Ee.createElement("img",{className:r,src:n?t.tiny_capsule:t.capsule}))),Ee.createElement("div",{className:"StoreSaleWidgetRight"},Ee.createElement("div",{className:"Actions"},Ee.createElement("div",{className:"StoreSaleWidgetTitle",onClick:function(e){return Rl(e,t.capsule_link)}},t.title)),Ee.createElement("div",{className:"StoreSaleWidgetRelease"},t.release),Ee.createElement("div",{className:a},t.short_desc),!!t.subid&&Ee.createElement(kl,{price:t.price,subid:t.subid,button_action:t.button_action,cart_url:t.cart_url,add_to_cart_url:t.add_to_cart_url,capsule_link:t.capsule_link}),this.props.extraLink&&Ee.createElement("a",{className:"StoreSaleWidgetExtraLink",href:this.props.extraLink.url,target:"_blank"},this.props.extraLink.name))):Ee.createElement("div",{className:"StoreSaleWidgetEmptyContainer"})},e=R.c([or.observer],e)}(Ee.Component);var kl=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return R.d(t,e),t.prototype.handleOnClick=function(e){!function(e,t){var n=new FormData;n.append("action","add_to_cart"),n.append("subid",""+t.subid);var o=_.e.authwgtoken;n.append("authwgtoken",o),n.append("quantity","1");var i=t.add_to_cart_url;try{C.a.post(i,n);var r=t.cart_url;e.preventDefault(),setTimeout(function(){Rl(window,r)},500)}catch(e){console.log("HandleOnAddToCart"),console.log(e)}}(e,this.props)},t.prototype.render=function(){return Ee.createElement("div",{className:"StoreSalePriceActionWidgetContainer"},Ee.createElement("div",{className:"StoreSalePriceBox"},this.props.price),Ee.createElement("button",{className:"StoreSalePriceButton",onClick:this.handleOnClick},this.props.button_action))},R.c([T.a],t.prototype,"handleOnClick",null),t=R.c([or.observer],t)}(Ee.Component),Pl=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.m_schUpdate=new L,e.m_bSetupComplete=!1,e}return R.d(e,t),e.prototype.componentWillUnmount=function(){this.m_schUpdate.Cancel()},e.prototype.componentDidUpdate=function(){this.updateCanvas()},e.prototype.BindCanvasRef=function(e){this.m_elCanvas=e},e.prototype.updateCanvas=function(){var e=this;if(null!=this.props.elementRef&&null!=this.m_elCanvas&&!this.m_bSetupComplete){var t=this.props.elementRef,n=this.props.updateRate;this.m_Context=this.m_elCanvas.getContext("2d");var o=Math.floor(this.m_elCanvas.clientWidth/this.props.reductionFactor),i=Math.floor(this.m_elCanvas.clientHeight/this.props.reductionFactor);this.m_elCanvas.width=o,this.m_elCanvas.height=i,0<this.props.blurAmount&&(this.m_Context.filter="blur("+this.props.blurAmount+"px)");var r=function(){e.m_Context.drawImage(t,0,0,o,i),e.m_schUpdate.Schedule(n,r)};r(),this.m_bSetupComplete=!0}},e.prototype.render=function(){return Ee.createElement("canvas",{id:this.props.id,className:this.props.className,ref:this.BindCanvasRef,width:this.props.width,height:this.props.height})},R.c([T.a],e.prototype,"BindCanvasRef",null),R.c([T.a],e.prototype,"updateCanvas",null),e}(Ee.Component),Al="broadcastplayercontextmenu",Bl=function(n){function e(e){var t=n.call(this,e)||this;return t.m_schHideControls=new L,t.m_schUnmountControls=new L,t.m_elBroadcastPlayer=null,t.m_bMouseDown=!1,t.m_elMouseDown=null,t.m_listeners=new k,t.m_strContextMenuLeft="0px",t.m_strContextMenuTop="0px",console.log(t.props.steamID),t.state={bMountControls:!1,bControlsVisible:!1,bShowStats:!1,video:null,nResizedHeight:null,bFullscreen:!1,bShowContextMenu:!1},t}return R.d(e,n),e.prototype.StopVideo=function(){var e=this.state.video;e&&(lo.StopVideo(e),this.setState({video:null}))},e.prototype.componentWillUnmount=function(){this.m_listeners.Unregister(),this.m_schHideControls.Cancel(),this.m_schUnmountControls.Cancel(),this.StopVideo()},e.prototype.BindBroadcastPlayerRef=function(e){this.m_listeners.Unregister(),(this.m_elBroadcastPlayer=e)&&(this.m_listeners.AddEventListener(e,"fullscreenchange",this.OnFullscreenChange),this.m_listeners.AddEventListener(e,"mozfullscreenchange",this.OnFullscreenChange),this.m_listeners.AddEventListener(e,"webkitfullscreenchange",this.OnFullscreenChange),this.m_listeners.AddEventListener(e,"msfullscreenchange",this.OnFullscreenChange))},e.prototype.BindVideoRef=function(e){if(this.props.steamID&&(this.StopVideo(),e)){var t=lo.StartVideo(e,this.props.steamID,this.props.watchLocation,this.props.bWebRTC);this.setState({video:t})}this.m_elVideo=e},e.prototype.OnMouseDown=function(e){this.m_bMouseDown=!0,this.m_elMouseDown=e.currentTarget,this.m_elMouseDown.ownerDocument.defaultView.addEventListener("mouseup",this.OnMouseUp)},e.prototype.OnMouseUp=function(e){this.m_bMouseDown=!1,this.m_elMouseDown.ownerDocument.defaultView.removeEventListener("mouseup",this.OnMouseUp),this.m_schHideControls.Schedule(3200,this.HideControls),!this.state.bShowContextMenu||e.srcElement&&e.srcElement.parentElement&&e.srcElement.parentElement.id==Al||this.setState({bShowContextMenu:!1})},e.prototype.OnMouseMove=function(e){this.m_schHideControls.Cancel(),this.m_schUnmountControls.Cancel(),this.state.bMountControls?this.state.bControlsVisible||this.setState({bControlsVisible:!0}):this.setState({bMountControls:!0}),this.m_schHideControls.Schedule(3200,this.HideControls)},e.prototype.OnMouseLeave=function(e){this.HideControls()},e.prototype.HideControls=function(){this.state.bControlsVisible&&!this.m_bMouseDown&&this.setState({bControlsVisible:!1,bShowContextMenu:!1})},e.prototype.UmountControls=function(){this.setState(function(e){if(!e.bControlsVisible&&e.bMountControls)return{bMountControls:!1}})},e.prototype.componentDidUpdate=function(e,t){var n=this;!t.bMountControls&&this.state.bMountControls?setTimeout(function(){n.setState(function(e){return{bControlsVisible:e.bMountControls}})},15):t.bControlsVisible&&!this.state.bControlsVisible&&this.m_schUnmountControls.Schedule(2e3,this.UmountControls),this.props.steamID!==e.steamID&&this.BindVideoRef(this.m_elVideo)},e.prototype.ShowStatsView=function(){var e=this.state.video;e&&(this.state.bShowStats||(this.setState({bShowStats:!0}),e.SetStatsViewIsVisible(!0)))},e.prototype.OnContextMenu=function(e){if(!this.state.bShowContextMenu){var t=this.m_elVideo.parentElement.getBoundingClientRect();this.m_strContextMenuLeft=e.clientX-t.left+"px",this.m_strContextMenuTop=e.clientY-t.top+"px",this.setState({bShowContextMenu:!0})}e.preventDefault()},e.prototype.ToggleStatsView=function(e){var t=!this.state.bShowStats;this.setState({bShowStats:t});var n=this.state.video;n&&n.SetStatsViewIsVisible(t)},e.prototype.ShowStorePage=function(e){var t=this.state.video;if(t&&this.props.onOpenLinkInNewWindow){var n=t.GetBroadcastInfo();if(n){var o=_.b.STORE_BASE_URL+"app/"+n.m_strAppId;this.props.onOpenLinkInNewWindow(e,o),e.stopPropagation()}}},e.prototype.GetContextMenuItems=function(){var t=this,e=[],n=this.state.video;if(!n)return e;var o=n.GetBroadcastInfo();return e.push(Ee.createElement(ir.b,{key:"togglestats",bChecked:this.state.bShowStats,onSelected:function(e){t.ToggleStatsView(e),t.setState({bShowContextMenu:!1})}},Object($.b)("#Broadcast_VideoContext_ToggleStats"))),o&&"0"!=o.m_strAppId&&"7"!=o.m_strAppId&&e.push(Ee.createElement(ir.d,{key:"visitstore",onSelected:function(e){t.ShowStorePage(e),t.setState({bShowContextMenu:!1})}},Object($.b)("#Broadcast_VideoContext_OpenStore"))),e},e.prototype.CloseStats=function(){var e=this.state.video;e&&this.state.bShowStats&&(this.setState({bShowStats:!1}),e.SetStatsViewIsVisible(!1))},e.prototype.OnToggleFullscreen=function(){this.m_elBroadcastPlayer&&(Object(Ci.b)(this.m_elBroadcastPlayer)?Object(Ci.g)(this.m_elBroadcastPlayer):Object(Ci.n)(this.m_elBroadcastPlayer))},e.prototype.OnFullscreenChange=function(e){if(this.m_elBroadcastPlayer){var t=Object(Ci.b)(this.m_elBroadcastPlayer);this.setState({bFullscreen:t})}},e.prototype.BHideVideoControls=function(){var e=this.state.video;return!e||(!!e.GetUserInputNeeded()||lo.GetBroadcastState(e.GetBroadcastSteamID())==eo.Error)},e.prototype.render=function(){var e=this.state.video,t=e&&e.BHasDASHStats()&&this.state.bShowStats,n=this.state.bMountControls,o=this.state.bControlsVisible,i=e&&e.GetUserInputNeeded(),r=(e&&e.GetBroadcastInfo(),"videoContainer");o||(r+=" HidePlayerControls"),this.state.bFullscreen&&(r+=" fullscreenVideo");var a=[];!this.state.bFullscreen&&this.props.actions&&(a=a.concat(this.props.actions)),this.state.bFullscreen||a.push(Ee.createElement("div",{key:"ChatPosToggle ChatTheaterToggle",onClick:this.props.onTheaterMode,title:Object($.b)("#Broadcast_View_Theater"),className:"BroadcastTheaterToggle"})),a.push(Ee.createElement("div",{key:"FullscreenToggle",title:Object($.b)("#Broadcast_View_Fullscreen"),onClick:this.OnToggleFullscreen,className:"BroadcastFullscreenToggle"}));var s=this.state.bShowContextMenu,c=n&&!this.BHideVideoControls(),l=n&&!this.state.bFullscreen;return Ee.createElement("div",{ref:this.BindBroadcastPlayerRef,className:r,onMouseMove:this.OnMouseMove,onClick:this.OnMouseMove,onMouseLeave:this.OnMouseLeave,onContextMenu:this.OnContextMenu,onMouseDown:this.OnMouseDown},this.props.showVideoBackgroundBlur&&Ee.createElement(Pl,{className:"videoBlur",elementRef:this.m_elVideo,updateRate:33,width:320,height:180,reductionFactor:10,blurAmount:5}),Ee.createElement("video",{className:"videoSrc",ref:this.BindVideoRef,muted:!0,autoPlay:!0,playsInline:!0,controls:!1}),c&&Ee.createElement(xl,{video:e,actions:a,linkElement:this.props.linkElement,onOpenLinkInNewWindow:this.props.onOpenLinkInNewWindow}),l&&Ee.createElement(Ul,{onClick:this.props.onRequestClose}),t&&Ee.createElement(Tl,{stats:e.GetDASHPlayerStats(),closeStats:this.CloseStats}),Ee.createElement(Fl,{video:e}),i&&Ee.createElement(Vl,{video:e}),s&&Ee.createElement("div",{className:"STV_BroadcastContextMenuPanel",style:{left:this.m_strContextMenuLeft,top:this.m_strContextMenuTop}},Ee.createElement("div",{id:Al,className:"STV_BroadcastSettingsMenuItems"},this.GetContextMenuItems())))},R.c([T.a],e.prototype,"BindBroadcastPlayerRef",null),R.c([T.a],e.prototype,"BindVideoRef",null),R.c([T.a],e.prototype,"OnMouseDown",null),R.c([T.a],e.prototype,"OnMouseUp",null),R.c([T.a],e.prototype,"OnMouseMove",null),R.c([T.a],e.prototype,"OnMouseLeave",null),R.c([T.a],e.prototype,"HideControls",null),R.c([T.a],e.prototype,"UmountControls",null),R.c([T.a],e.prototype,"ShowStatsView",null),R.c([T.a],e.prototype,"OnContextMenu",null),R.c([T.a],e.prototype,"ToggleStatsView",null),R.c([T.a],e.prototype,"ShowStorePage",null),R.c([T.a],e.prototype,"CloseStats",null),R.c([T.a],e.prototype,"OnToggleFullscreen",null),R.c([T.a],e.prototype,"OnFullscreenChange",null),e=R.c([or.observer],e)}(Ee.Component),Fl=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return R.d(t,e),t.prototype.render=function(){var e=this.props.video;if(e&&e.GetUserInputNeeded())return null;var t=eo.Loading,n="";if(e){t=lo.GetBroadcastState(e.GetBroadcastSteamID()),n=lo.GetBroadcastStateDescription(e.GetBroadcastSteamID());var o=e.IsBuffering();t==eo.Ready&&o&&(t=eo.Loading,n="")}if(t==eo.Ready)return null;var i=t==eo.Loading;return Ee.createElement("div",{className:"BroadcastVideoWatchState"},i&&Ee.createElement(Xa,null),!i&&Ee.createElement("div",{className:"BroadcastVideoWatchState_Text"},n))},t=R.c([or.observer],t)}(Ee.Component),Vl=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return R.d(t,e),t.prototype.OnClick=function(){lo.UserInputClickVideo(this.props.video)},t.prototype.render=function(){return Ee.createElement("div",{className:"BroadcastVideoUserInputNeeded",onClick:this.OnClick},Ee.createElement(ui.J,null),Ee.createElement("span",null,Object($.b)("#DASHPlayerControls_ClickToPlay")))},R.c([T.a],t.prototype,"OnClick",null),t}(Ee.Component),xl=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return R.d(t,e),t.prototype.render=function(){var e=this.props.video;if(!e)return null;var t=e.has_segments;return Ee.createElement("div",{className:"videoControls"},this.props.linkElement,Ee.createElement($l,{steamID:this.props.video.GetBroadcastSteamID(),bHideThumbnail:!0,bVerticalBroadcastChat:!0,onOpenLinkInNewWindow:this.props.onOpenLinkInNewWindow}),Ee.createElement("div",{className:"videoControlsBottom"+(t?"":" noSegments")},Ee.createElement(Zl,{video:e}),Ee.createElement("div",{className:"STV_BroadcastController"},Ee.createElement("div",{className:"videoControlsButtons LeftSpacer"}),Ee.createElement(jl,{video:e}),Ee.createElement(Hl,{video:e}),Ee.createElement(Kl,{video:e,actions:this.props.actions}))))},t=R.c([or.observer],t)}(Ee.Component),Ul=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return R.d(t,e),t.prototype.render=function(){return this.props.onClick?Ee.createElement("div",{className:"STV_BroadcastClose",onClick:this.props.onClick},Ee.createElement(ui.jb,null)):null},t}(Ee.PureComponent),jl=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return R.d(t,e),t.prototype.OnJumpBackward=function(){this.props.video.JumpTime(-15)},t.prototype.OnJumpForward=function(){this.props.video.JumpTime(15)},t.prototype.render=function(){var e=this.props.video,t=e.CanSeek();return Ee.createElement("div",{className:"videoControlsButtons PlayControls"},Ee.createElement(zl,{video:e}),t&&Ee.createElement("div",{className:"videoControlButton videoControlJump controlFlip",onClick:this.OnJumpBackward},Ee.createElement(ui.C,{bHidePostArrow:!0,bHidePreArrow:!0,bShowJumpAheadBox:!0,bFlipHorizontal:!0}),Ee.createElement("div",{className:"jumpAheadValue"},15)),Ee.createElement(Wl,{video:e}),t&&Ee.createElement("div",{className:"videoControlButton videoControlJump",onClick:this.OnJumpForward},Ee.createElement(ui.C,{bHidePostArrow:!0,bHidePreArrow:!0,bShowJumpAheadBox:!0,bFlipHorizontal:!1}),Ee.createElement("div",{className:"jumpAheadValue"},15)),t&&Ee.createElement(ql,{video:e}))},R.c([T.a],t.prototype,"OnJumpBackward",null),R.c([T.a],t.prototype,"OnJumpForward",null),t}(Ee.Component),Hl=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return R.d(t,e),t.prototype.OnGoLiveClicked=function(e){this.props.video.JumpToLiveEdge()},t.prototype.render=function(){var e=this.props.video.IsOnLiveEdge();return Ee.createElement("div",{className:"videoControlsButtons GoLive"},Ee.createElement("div",{className:"videoControlButton videoControlGoLive"+(e?" isLiveEdge":""),onClick:e?null:this.OnGoLiveClicked},Ee.createElement(ui.C,{bHidePreArrow:!0,bHidePostArrow:!0,bFlipHorizontal:!1}),Ee.createElement("div",{className:"jumpGoLive"},e?Object($.b)("#DASHPlayerControls_IsLive"):Object($.b)("#DASHPlayerControls_GoLive"))))},R.c([T.a],t.prototype,"OnGoLiveClicked",null),t=R.c([or.observer],t)}(Ee.Component),Wl=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return R.d(t,e),t.prototype.OnTogglePlayPause=function(){this.props.video.TogglePlayPause()},t.prototype.render=function(){var e=this.props.video.IsPaused();return Ee.createElement("div",{className:"videoControlButton buttonPlayPause",onClick:this.OnTogglePlayPause},e?Ee.createElement(ui.J,null):Ee.createElement(ui.I,null))},R.c([T.a],t.prototype,"OnTogglePlayPause",null),t=R.c([or.observer],t)}(Ee.Component),zl=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return R.d(t,e),Object.defineProperty(t.prototype,"has_previous_marker",{get:function(){return void 0!==this.GetPreviousMarkerTime()},enumerable:!0,configurable:!0}),t.prototype.GetPreviousMarkerTime=function(){if(this.props.video.has_markers)for(var e=this.props.video.GetTimelineMarkers(),t=this.props.video.GetPlaybackTime(),n=e.length-1;0<=n;n--)if(!(e[n].nTime>=t))return e[n].nTime},t.prototype.OnJumpToPreviousMarkerClicked=function(e){var t=this.GetPreviousMarkerTime();void 0!==t&&this.props.video.Seek(t-.2)},t.prototype.render=function(){var e=this.props.video.BHasMarkersOrSegments();return Ee.createElement("div",{className:"videoControlButton jumpToMarker controlFlip"+(e?"":" noMarkersOrSegments")+(this.has_previous_marker?"":" noMarkersInDirection"),onClick:this.OnJumpToPreviousMarkerClicked},Ee.createElement(ui.C,{bHidePostArrow:!0,bFlipHorizontal:!0}))},R.c([d.computed],t.prototype,"has_previous_marker",null),R.c([T.a],t.prototype,"OnJumpToPreviousMarkerClicked",null),t=R.c([or.observer],t)}(Ee.Component),ql=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return R.d(t,e),Object.defineProperty(t.prototype,"has_next_marker",{get:function(){return void 0!==this.GetNextMarkerTime()},enumerable:!0,configurable:!0}),t.prototype.GetNextMarkerTime=function(){if(this.props.video.has_markers)for(var e=this.props.video.GetTimelineMarkers(),t=this.props.video.GetPlaybackTime(),n=0;n<e.length;n++)if(!(e[n].nTime<=t))return e[n].nTime},t.prototype.OnJumpToNextMarkerClicked=function(e){var t=this.GetNextMarkerTime();void 0!==t&&this.props.video.Seek(t)},t.prototype.render=function(){var e=this.props.video.BHasMarkersOrSegments();return Ee.createElement("div",{className:"videoControlButton jumpToMarker"+(e?"":" noMarkersOrSegments")+(this.has_next_marker?"":" noMarkersInDirection"),onClick:this.OnJumpToNextMarkerClicked},Ee.createElement(ui.C,{bHidePostArrow:!0,bFlipHorizontal:!1}))},R.c([d.computed],t.prototype,"has_next_marker",null),R.c([T.a],t.prototype,"OnJumpToNextMarkerClicked",null),t=R.c([or.observer],t)}(Ee.Component),Kl=function(n){function e(e){var t=n.call(this,e)||this;return t.m_elSubtitlesButton=Ee.createRef(),t.m_elSubtitlesPanel=Ee.createRef(),t.state={bSettingsOpen:!1,bSubtitlesOpen:!1},t}return R.d(e,n),e.prototype.OnVideoControlClick=function(e){this.setState({bSettingsOpen:!this.state.bSettingsOpen}),this.m_SettingsButtonPos=[this.m_elSettingsButton.offsetLeft,this.m_elSettingsButton.offsetTop],this.m_elClickListener=e.currentTarget.ownerDocument.defaultView,this.m_elClickListener.addEventListener("mouseup",this.OnMouseUp,!0)},e.prototype.OnSubtitlesClick=function(e){this.setState({bSubtitlesOpen:!this.state.bSubtitlesOpen}),this.m_SubtitlesButtonPos=[this.m_elSubtitlesButton.current.offsetLeft,this.m_elSubtitlesButton.current.offsetTop],this.m_elClickListener=e.currentTarget.ownerDocument.defaultView,this.m_elClickListener.addEventListener("mouseup",this.OnMouseUp,!0)},e.prototype.OnMouseUp=function(e){this.m_elClickListener.removeEventListener("mouseup",this.OnMouseUp,!0),Object(Ci.e)(this.m_elSettingsPanel,e.target)||this.setState({bSettingsOpen:!1}),Object(Ci.e)(this.m_elSubtitlesPanel.current,e.target)||this.setState({bSubtitlesOpen:!1})},e.prototype.bindSettingsButton=function(e){this.m_elSettingsButton=e},e.prototype.BindSettingsPanel=function(e){this.m_elSettingsPanel=e},e.prototype.render=function(){var e,n,o=this,t=!1,i=!1,r=this.props,a=r.video,s=r.actions,c=0;if(this.state.bSettingsOpen){t=!0,e=this.props.video.GetVideoRepresentations();var l=21,p=32;c=0-((n=e.map(function(e){return Ee.createElement(ir.b,{key:e.id,onSelected:function(){o.props.video.SetVideoRepresentation(e),o.setState({bSettingsOpen:!o.state.bSettingsOpen})},bChecked:e.selected},e.displayName)})).length*l+p)}if(this.state.bSubtitlesOpen){i=!0,n=[];for(var u=function(e){var t=m.props.video.ListSubtitles()[e];n.push(Ee.createElement(ir.b,{key:t.language,onSelected:function(){o.props.video.SetSubtitles(t.language),o.setState({bSubtitlesOpen:!o.state.bSubtitlesOpen})},bChecked:"showing"===t.mode},t.language))},m=this,d=0;d<this.props.video.ListSubtitles().length;d++)u(d);l=21,p=32;c=0-(n.length*l+p)}return Ee.createElement("div",{className:"STV_BroadcastSettings"},this.props.video.ListSubtitles().length?Ee.createElement("button",{onClick:this.OnSubtitlesClick,ref:this.m_elSubtitlesButton},"CC"):null,Ee.createElement("div",{className:"videoControlButton"+(t?" VideoSettingsOpen":""),onClick:this.OnVideoControlClick,ref:this.bindSettingsButton},Ee.createElement(ui.S,null)),Ee.createElement(Yl,{video:a}),s&&s.map(function(e){return Ee.createElement("div",{key:e.key,className:"videoControlButton"},e)}),t&&Ee.createElement("div",{ref:this.BindSettingsPanel,className:"STV_BroadcastSettingsPanel",style:{left:this.m_SettingsButtonPos[0],top:this.m_SettingsButtonPos[1],marginTop:c}},Ee.createElement("div",{className:"STV_BroadcastSettingsMenuItems"},n)),i&&Ee.createElement("div",{ref:this.m_elSubtitlesPanel,className:"STV_BroadcastSettingsPanel",style:{left:this.m_SubtitlesButtonPos[0],top:this.m_SubtitlesButtonPos[1],marginTop:c}},Ee.createElement("div",{className:"STV_BroadcastSettingsMenuItems"},n)))},R.c([T.a],e.prototype,"OnVideoControlClick",null),R.c([T.a],e.prototype,"OnSubtitlesClick",null),R.c([T.a],e.prototype,"OnMouseUp",null),R.c([T.a],e.prototype,"bindSettingsButton",null),R.c([T.a],e.prototype,"BindSettingsPanel",null),e}(Ee.Component),Yl=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.k_nHideSliderTimeout=1500,e.m_bShowSlider=!0,e.m_schHideSlider=new L,e.m_bChildDragging=!1,e.m_bMouseOver=!1,e}return R.d(e,t),e.prototype.componentWillUnmount=function(){this.m_schHideSlider.Cancel()},e.prototype.ToggleMute=function(){var e=this.props.video,t=e.IsMuted();e.SetMute(!t),e.GetVolume()<.01&&e.SetVolume(.5)},e.prototype.OnMouseEnter=function(e){this.m_bShowSlider=!0,this.m_bMouseOver=!0,this.m_schHideSlider.Cancel()},e.prototype.OnMouseLeave=function(e){this.m_bMouseOver=!1,this.ScheduleHide()},e.prototype.OnChildDrag=function(e){this.m_bChildDragging=e,this.ScheduleHide()},e.prototype.ScheduleHide=function(){var e=this;this.m_bMouseOver||this.m_bChildDragging||this.m_schHideSlider.Schedule(this.k_nHideSliderTimeout,function(){return e.m_bShowSlider=!0})},e.prototype.render=function(){var e=this.props.video,t=e.IsMuted(),n=100*e.GetVolume(),o="videoControlButton";65<n?o+=" HighestVolume":45<n?o+=" HighVolume":n<46&&24<n?o+=" MedVolume":n<25&&(o+=" LowVolume");var i="BroadcastVolumeControl";return this.m_bShowSlider&&(i+=" ShowVolumeSlider"),t&&(i+=" muted"),Ee.createElement("div",{className:i,onMouseEnter:this.OnMouseEnter,onMouseLeave:this.OnMouseLeave},Ee.createElement("div",{className:"BroadcastVolumeControl_FixedLayout"},Ee.createElement("div",{className:o,onClick:this.ToggleMute},Ee.createElement(ui.hb,null)),Ee.createElement(Jl,{video:e,onDrag:this.OnChildDrag})))},R.c([d.observable],e.prototype,"m_bShowSlider",void 0),R.c([T.a],e.prototype,"ToggleMute",null),R.c([T.a],e.prototype,"OnMouseEnter",null),R.c([T.a],e.prototype,"OnMouseLeave",null),R.c([T.a],e.prototype,"OnChildDrag",null),e=R.c([or.observer],e)}(Ee.Component),Jl=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.m_elSlider=null,e.m_nVolumeStartOfDrag=0,e}return R.d(e,t),e.prototype.OnMouseDown=function(e){var t=e.currentTarget;this.m_elSlider=t,this.m_nVolumeStartOfDrag=this.props.video.GetVolume(),this.SetVolumeWithCoord(t,e.clientX),t.ownerDocument.defaultView.addEventListener("mousemove",this.OnMouseMove),t.ownerDocument.defaultView.addEventListener("mouseup",this.OnMouseUp),this.props.onDrag(!0)},e.prototype.OnMouseMove=function(e){this.m_elSlider&&this.SetVolumeWithCoord(this.m_elSlider,e.clientX)},e.prototype.OnMouseUp=function(e){if(this.m_elSlider){this.SetVolumeWithCoord(this.m_elSlider,e.clientX);var t=this.props.video;t.IsMuted()&&t.SetVolume(this.m_nVolumeStartOfDrag),this.m_elSlider.ownerDocument.defaultView.removeEventListener("mousemove",this.OnMouseMove),this.m_elSlider.ownerDocument.defaultView.removeEventListener("mouseup",this.OnMouseUp),this.m_nVolumeStartOfDrag=0,this.m_elSlider=null,this.props.onDrag(!1)}},e.prototype.SetVolumeWithCoord=function(e,t){var n=e.getBoundingClientRect(),o=_n.c(t,n.left,n.right,0,1),i=_n.a(o,0,1),r=this.props.video;r.SetMute(o<.01),r.SetVolume(i)},e.prototype.render=function(){var e=this.props.video,t=100*e.GetVolume();e.IsMuted()&&(t=0);var n={left:t+"%"},o={width:t+"%"};return Ee.createElement("div",{className:"BroadcastVolumeSlider",onMouseDown:this.OnMouseDown},Ee.createElement("div",{className:"BroadcastVolumeSlider_Track"}),Ee.createElement("div",{className:"BroadcastVolumeSlider_Fill",style:o}),Ee.createElement("div",{className:"BroadcastVolumeSlider_Thumb",style:n}))},R.c([T.a],e.prototype,"OnMouseDown",null),R.c([T.a],e.prototype,"OnMouseMove",null),R.c([T.a],e.prototype,"OnMouseUp",null),R.c([d.action],e.prototype,"SetVolumeWithCoord",null),e=R.c([or.observer],e)}(Ee.Component);function Xl(e){return Ee.createElement("div",{className:"timelineMarker",title:e.label,style:{left:e.pos+"%"},onMouseEnter:function(){return e.onMouseEnter(e.pos)},onMouseLeave:e.onMouseLeave},Ee.createElement("div",{className:"timelineMarkerIcon"},Ee.createElement(ui.Q,null)))}function Ql(e){var t=e.startPos,n=e.endPos,o="",i=1;return t<0&&(i=(n-t)/10,t=0,o=" hideFront"),Ee.createElement("div",{className:"STV_timelineSegment"+o,style:{left:t+"%",width:n-t+"%",opacity:i},onClick:e.onClick},Ee.createElement("div",{className:"STV_timelineSegmentFrontFill",style:{borderColor:"rgb("+e.color+")"}}),Ee.createElement("div",{className:"STV_timelineSegmentLabel",style:{color:"rgb("+e.color+")"}},e.label),Ee.createElement("div",{className:"STV_timelineSegmentBackFill",style:{borderColor:"rgb("+e.color+")"}}))}var Zl=function(n){function e(e){var t=n.call(this,e)||this;return t.state={nGrabberMouseDownTime:0,bGrabberMouseDown:!1,nHoverValue:void 0},t}return R.d(e,n),e.prototype.OnMouseDown=function(e){this.m_elSlider=e.currentTarget,this.m_rectSlider=this.m_elSlider.getBoundingClientRect(),this.AdjustSliderForClientX(e.clientX),this.setState({bGrabberMouseDown:!0}),this.m_elSlider.ownerDocument.defaultView.addEventListener("mousemove",this.OnMouseMove),this.m_elSlider.ownerDocument.defaultView.addEventListener("mouseup",this.OnMouseUp)},e.prototype.OnMouseMove=function(e){this.AdjustSliderForClientX(e.clientX)},e.prototype.OnMouseUp=function(e){this.props.video.Seek(this.state.nGrabberMouseDownTime),this.setState({bGrabberMouseDown:!1,nHoverValue:void 0,nGrabberMouseDownTime:0}),this.m_elSlider.ownerDocument.defaultView.removeEventListener("mousemove",this.OnMouseMove),this.m_elSlider.ownerDocument.defaultView.removeEventListener("mouseup",this.OnMouseUp)},e.prototype.OnKeyDown=function(e){},e.prototype.AdjustSliderForClientX=function(e){var t=this.props.video,n=t.GetTimelineStartPos(),o=t.GetTimelineStartPos()+t.GetTimelineDuration(),i=t.GetTimeAtMousePosition(e,this.m_rectSlider,n,o);i!=this.state.nGrabberMouseDownTime&&this.setState({nGrabberMouseDownTime:i,nHoverValue:i})},e.prototype.OnSegmentClick=function(e){this.props.video.Seek(e)},e.prototype.OnMarkerMouseEnter=function(e){this.setState({nHoverValue:e})},e.prototype.OnMarkerMouseLeave=function(){this.setState({nHoverValue:void 0})},e.prototype.render=function(){var i=this,r=this.props.video,e=this.state.bGrabberMouseDown,t=void 0!==this.state.nHoverValue,n=r.GetPercentOffsetFromTime(this.state.nGrabberMouseDownTime,no.Timeline),o=r.GetPercentOffsetFromTime(r.GetPlaybackTime(),no.Timeline),a=r.GetPercentOffsetFromTime(r.GetVideoAvailableStartTime(),no.Timeline);a<.05&&(a=0);var s=_n.a(n,0,100).toFixed(1)+"%",c=_n.a(o,0,100).toFixed(1)+"%",l=_n.a(a,0,100).toFixed(1)+"%",p={},u={},m={},d={},h={};e?(d.left=s,p.width=s,u.width=c,m.width=l,h.left=s):(d.left=c,u.width=c,m.width=l,t&&(h.left=this.state.nHoverValue+"%"));var _=gn(r.GetPlaybackTime()),f=gn(this.state.nGrabberMouseDownTime);e||(f=_);var g="STV_timelineContainer";this.state.bGrabberMouseDown&&(g+=" grabberDown"),r.IsTimelineMapActive()&&(g+=" minimapActive");var b="";100<(n=e?n:o)?b=" grabberOffScreenRight grabberOffscreen":n<0&&(b=" grabberOffScreenLeft grabberOffscreen");var v=[];r.GetTimelineMarkers().forEach(function(e,t){var n=r.GetPercentOffsetFromTime(e.nTime,no.Timeline);n<0||100<n||v.push(Ee.createElement(Xl,{key:t,pos:n,label:e.strLabel,onMouseEnter:i.OnMarkerMouseEnter,onMouseLeave:i.OnMarkerMouseLeave}))});var S=[];return r.GetTimelineSegments().forEach(function(t,e){var n=r.GetPercentOffsetFromTime(t.nTimeStart,no.Timeline);if(!(100<n)){var o=r.GetPercentOffsetFromTime(t.nTimeEnd,no.Timeline);o<0||S.push(Ee.createElement(Ql,{key:e,startPos:n,endPos:o,label:t.strLabel,color:t.color,onClick:function(e){return i.OnSegmentClick(t.nTimeStart)}}))}}),Ee.createElement("div",{className:"videoTimelineMain"},Ee.createElement("div",{className:g,onKeyDown:this.OnKeyDown},Ee.createElement("div",{className:"DialogLabel"},_),Ee.createElement("div",{className:"STV_timelineSegmentsContainer"},S),Ee.createElement("div",{className:"DialogSlider_SliderContainer",onMouseDown:this.OnMouseDown},Ee.createElement("div",{className:"DialogSlider_Slider"},Ee.createElement("div",{className:"STV_timelineValue",style:p}),Ee.createElement("div",{className:"STV_timelineGhostValue",style:u}),Ee.createElement("div",{className:"STV_timelineNoVideo",style:m}),v,Ee.createElement("div",{className:"STV_timelineGrabber_Wrapper",style:d},Ee.createElement("div",{className:"STV_timelineGrabber"+b},Ee.createElement("div",{key:"grabbertime",className:"STV_timelineGrabberValue"},f),Ee.createElement("div",{className:"STV_timelineGrabberArrow"},Ee.createElement(ui.P,null))))))))},R.c([T.a],e.prototype,"OnMouseDown",null),R.c([T.a],e.prototype,"OnMouseMove",null),R.c([T.a],e.prototype,"OnMouseUp",null),R.c([T.a],e.prototype,"OnKeyDown",null),R.c([T.a],e.prototype,"OnSegmentClick",null),R.c([T.a],e.prototype,"OnMarkerMouseEnter",null),R.c([T.a],e.prototype,"OnMarkerMouseLeave",null),e=R.c([or.observer],e)}(Ee.Component);var $l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.state={info:null},e}return R.d(e,t),e.getDerivedStateFromProps=function(e,t){return t.info&&t.info.m_steamIDBroadcast===e.steamID?null:(t.info&&lo.StopInfo(t.info),{info:lo.StartInfo(e.steamID)})},e.prototype.componentWillUnmount=function(){this.state.info&&lo.StopInfo(this.state.info)},e.prototype.RenderStreamSwitcher=function(){return null},e.prototype.render=function(){var t=this,e=this.state.info,n="";e&&e.m_nViewerCount&&(n=e.m_nViewerCount.toLocaleString());var o=!this.props.bHideThumbnail&&this.props.bVerticalBroadcastChat&&(0<parseInt(e.m_strAppId)||Q.bValid);return Ee.createElement("div",{className:"BroadcastDetails"},!this.props.bHideThumbnail&&Ee.createElement(Ls,{className:"broadcastDetailsThumbBlur",src:e.m_strThumbnailUrl,draggable:!1,duration:2500}),Ee.createElement("div",{className:"BroadcastDetailsHeader"},Ee.createElement("div",{className:"displayColumn"},Ee.createElement("div",{className:"Info"},Ee.createElement("span",{className:"AppTitle"},e.m_strAppTitle),e.m_strTitle&&Ee.createElement("span",{className:"BroadcastTitle"}," - ",e.m_strTitle),this.props.onLocalStreamChange&&this.RenderStreamSwitcher()),n&&Ee.createElement("div",{className:"BroadcastDetailsHeader_ViewerCount"},Ee.createElement(ui.fb,null),Object($.b)("#Broadcast_ViewerCount",n))),Q.bValid&&this.props.onOpenLinkInNewWindow&&Ee.createElement("div",{className:"Actions"},Ee.createElement("div",{onClick:function(e){return t.props.onOpenLinkInNewWindow(e,Q.link)},className:"BroadcastLink"},Q.linkName))),o&&Ee.createElement(Ll,{appid:Q.bValid?Q.appID:parseInt(e.m_strAppId)}))},e=R.c([or.observer],e)}(Ee.Component),ep=(Ee.Component,n("dcQ8")),tp=n.n(ep);function np(){window.sessionStorage.setItem("oFriendsUIStartupParam",JSON.stringify({command:{command:"ShowWatchBroadcast",steamid:_.a.steamid}}))}var op=function(){function e(){this.m_iTimeoutLogin=void 0,this.m_eLogonState=0,this.m_bLogonDialogVisisible=!1}return e.prototype.Init=function(e){var t=this;this.m_fnLaunchChat=e,this.m_steamID=_.a.steamid,window.addEventListener("message",this.HandlePostMessage),W.render(Ee.createElement(dp,{app:this}),document.getElementById("friendslist-container")),this.m_iTimeoutLogin=SetBackgroundTimeout(function(){0==t.m_eLogonState&&(t.m_eLogonState=1)},2500)},e.prototype.LaunchChat=function(){W.unmountComponentAtNode(document.getElementById("friendslist-container")),window.removeEventListener("message",this.HandlePostMessage),window.clearTimeout(this.m_iTimeoutLogin),np(),this.m_fnLaunchChat()},e.prototype.GetLoginURL=function(){return _.b.STORE_BASE_URL+"login/?steamtv"},e.prototype.BIsPerformingLogonCheck=function(){return 0==this.m_eLogonState||1==this.m_eLogonState},e.prototype.BIsLogonDialogVisible=function(){return this.m_bLogonDialogVisisible},e.prototype.ShowLogonDialog=function(){this.m_bLogonDialogVisisible=!0},e.prototype.BReadyToRender=function(){return 0!=this.m_eLogonState},e.prototype.DismissLogonDialog=function(){this.m_bLogonDialogVisisible=!1},e.prototype.GetSteamIDWatched=function(){return this.m_steamID},e.prototype.ExtractOrigin=function(e){return e.replace(/^(https?:\/\/[^/]*).*$/,"$1")},e.prototype.HandlePostMessage=function(e){if(e.origin==this.ExtractOrigin(_.b.STORE_BASE_URL)||e.origin==this.ExtractOrigin(_.b.CHAT_BASE_URL)){var t=e.data;if(t)if("OnLoginButtonClicked"==t.msg)console.log("Login button clicked"),this.m_bLogonDialogVisisible=!0;else if("LoginNeeded"==t.command)this.m_eLogonState=2;else if("LogonComplete"==t.command)return void this.LaunchChat()}else console.warn('Ignoring message from untrusted domain "'+e.origin+'"')},R.c([d.observable],e.prototype,"m_eLogonState",void 0),R.c([d.observable],e.prototype,"m_bLogonDialogVisisible",void 0),R.c([d.observable],e.prototype,"m_steamID",void 0),R.c([d.action],e.prototype,"LaunchChat",null),R.c([d.action.bound],e.prototype,"HandlePostMessage",null),e}(),ip=new RegExp("ː([^ː]*)ː","g"),rp=new RegExp("(https?://[^ '\"<>]*)","gi"),ap=new RegExp("^https?://(?:[^/?#]+?\\.)?(?:valvesoftware|steamcommunity|steampowered)\\.com(?:/?#|$)","i"),sp=function(n){function e(e){var t=n.call(this,e)||this;return t.m_chat=null,t.m_rgChatMessages=[],t.m_bAutoScroll=!0,t.messagesContainer=Ee.createRef(),t.textInput=Ee.createRef(),t.state={message:""},t}return R.d(e,n),e.prototype.componentDidMount=function(){this.BindChatRef(null)},e.prototype.componentDidUpdate=function(e){this.m_bAutoScroll&&this.ScrollToBottom(),this.props.steamID===e.steamID&&this.props.broadcastChannelID===e.broadcastChannelID||this.BindChatRef(null)},e.prototype.componentWillUnmount=function(){this.StopChat()},e.prototype.StopChat=function(){this.m_chat&&(this.props.broadcastChannelID&&this.m_chat?this.m_chat.Stop():lo.StopChat(this.m_chat),this.m_chat=null)},e.prototype.BindChatRef=function(e){this.StopChat(),this.props.broadcastChannelID?(this.m_chat=new co,this.m_chat.StartForChannel(this.props.broadcastChannelID),this.m_rgChatMessages=this.m_chat.m_rgChatMessages):(this.m_chat=lo.StartChat(null,this.props.steamID,this.props.watchLocation),this.m_rgChatMessages=this.m_chat.m_rgChatMessages,this.ScrollToBottom())},e.prototype.ChatBoxChange=function(e){this.setState({message:e.target.value})},e.prototype.ChatBoxKeypress=function(e){!!e.shiftKey||13!==e.charCode||(this.SendMessage(),e.preventDefault())},e.prototype.SendMessage=function(e){this.m_chat.m_bRateLimited||(this.m_chat.SendMessage(this.state.message),this.setState({message:""}),e&&e.preventDefault())},e.prototype.IsTrustedDomain=function(e){return!!e.match(ap)},e.prototype.AddLinksEmoticons=function(e,t){t&&this.m_chat.GetUserEmoticons();for(var n=e.split(ip),o=[],i=0;i<n.length;i+=1)if(i%2==1)o.push(Ee.createElement($c,{key:i,emoticon:n[i],large:!1}));else{for(var r=n[i].split(rp),a=1;a<r.length;a+=2)this.IsTrustedDomain(r[a])?r[a]=Ee.createElement("a",{target:"_blank",key:a,href:r[a]},r[a]):r[a]=Ee.createElement("a",{target:"_blank",key:a,href:_.b.COMMUNITY_BASE_URL+"linkfilter/?url="+r[a]},r[a]);o.push.apply(o,r)}return o},e.prototype.HandleScroll=function(e){var t=e.currentTarget.scrollTop+e.currentTarget.clientHeight>=e.currentTarget.scrollHeight-6;this.m_bAutoScroll=t},e.prototype.ScrollToBottom=function(){this.messagesContainer&&this.messagesContainer.current&&(this.messagesContainer.current.scrollTop=this.messagesContainer.current.scrollHeight)},e.prototype.OnContextMenu=function(e,t){var n=this;if(t.type!==F.Chat)return null;var o=[];return this.m_chat.IsUserBroadcaster(this.m_chat.GetUserSteamID())||this.m_chat.IsUserChannelModerator(this.m_chat.GetUserSteamID())?o.push(Ee.createElement(ir.d,{key:"remove",onSelected:function(){return n.m_chat.RemoveUserMessagesServer(t.steamid,t.persona_name)}},Object($.b)("#BroadcastChat_RemoveMessages")),Ee.createElement(ir.d,{key:"updatebanh",onSelected:function(){return n.m_chat.UpdateUserChatBan(t.steamid,1,12,!1,t.persona_name)}},Object($.b)("#BroadcastChat_half_Mute")),Ee.createElement(ir.d,{key:"updateband",onSelected:function(){return n.m_chat.UpdateUserChatBan(t.steamid,1,24,!1,t.persona_name)}},Object($.b)("#BroadcastChat_day_Mute")),Ee.createElement(ir.d,{key:"updatebanw",onSelected:function(){return n.m_chat.UpdateUserChatBan(t.steamid,1,168,!1,t.persona_name)}},Object($.b)("#BroadcastChat_week_Mute")),Ee.createElement(ir.d,{key:"updatebanp",onSelected:function(){return n.m_chat.UpdateUserChatBan(t.steamid,1,0,!0,t.persona_name)}},Object($.b)("#BroadcastChat_perm_Mute")),Ee.createElement(ir.d,{key:"removeban",onSelected:function(){return n.m_chat.UpdateUserChatBan(t.steamid,0,0,!1,t.persona_name,!0)}},Object($.b)("#BroadcastChat_Unmute"))):this.m_chat.IsUserMutedLocally(t.steamid)?o.push(Ee.createElement(ir.d,{key:"unmuteuser",onSelected:function(){return n.m_chat.UnmuteUserForSession(t.steamid,t.persona_name)}},Object($.b)("#BroadcastChat_UnmuteLocal"))):o.push(Ee.createElement(ir.d,{key:"muteuser",onSelected:function(){return n.m_chat.MuteUserForSession(t.steamid,t.persona_name)}},Object($.b)("#BroadcastChat_MuteLocal"))),this.m_chat.IsUserBroadcaster(this.m_chat.GetUserSteamID())&&o.push(Ee.createElement(ir.d,{key:"addmod",onSelected:function(){return n.m_chat.UpdateBroadcastChatModerator(t.steamid,!0,t.persona_name)}},Object($.b)("#BroadcastChat_Add_Moderator")),Ee.createElement(ir.d,{key:"removemod",onSelected:function(){return n.m_chat.UpdateBroadcastChatModerator(t.steamid,!1,t.persona_name)}},Object($.b)("#BroadcastChat_Remove_Moderator"))),o.length?Object(mi.a)(Ee.createElement(ir.c,null,o),e):null},e.prototype.OnEmoticonSelected=function(e,t){void 0===t&&(t=!1),this.setState({message:this.state.message+"ː"+e+"ː"}),this.textInput&&this.textInput.current&&this.textInput.current.focus()},e.prototype.OnFlairSelected=function(e){this.m_chat.UpdateChatMessageFlair(e),this.textInput&&this.textInput.current&&this.textInput.current.focus()},e.prototype.GetTypeClassName=function(e){return e.type===F.Notification?tp.a.MessageNotification:e.type===F.Error?tp.a.MessageError:tp.a.MessageChat},e.prototype.render=function(){var n=this;var e=new op,t=Ee.createElement("div",null,Ee.createElement("a",{onClick:function(){return e.ShowLogonDialog()},className:tp.a.ChatLoginButton,href:"javascript:void(0);"},Object($.b)("#BroadcastChat_Login")),Ee.createElement(yp,{app:e}));return Ee.createElement("div",{className:tp.a.ChatPanel,style:this.props.hidden?{display:"none"}:void 0},Ee.createElement("div",{className:"friendsListInsetShadowCtn"},Ee.createElement("div",{className:"friendListInsetShadowTop"})),Ee.createElement("div",{className:tp.a.ChatMessages+" "+ml.a.minHeightZero,onScroll:this.HandleScroll,ref:this.messagesContainer},this.m_rgChatMessages.map(function(t,e){return Ee.createElement("div",{key:t.instance_id+"_"+t.client_ts+"_"+e,className:n.GetTypeClassName(t),onContextMenu:function(e){return n.OnContextMenu(e,t)}},t.flair&&Ee.createElement("span",{className:tp.a.FlairContainer}," ",n.AddLinksEmoticons(t.flair,!1)),t.type===F.Chat&&Ee.createElement("span",null,Ee.createElement("a",{className:tp.a.MessageName,href:_.b.COMMUNITY_BASE_URL+"profiles/"+t.steamid,target:"_blank"},t.persona_name)),t.type===F.Chat&&n.m_chat.GetBroadcastSteamID()===t.steamid&&Ee.createElement("span",{className:tp.a.MessageNotification+" "+tp.a.MessageContents}," ("+Object($.b)("#BroadcastChat_Broadcaster")+")"),t.type===F.Chat&&n.m_chat.m_mapChannelModeratorUsers.get(t.steamid)&&Ee.createElement("span",{className:tp.a.MessageNotification+" "+tp.a.MessageContents}," ("+Object($.b)("#BroadcastChat_Moderator")+")"),Ee.createElement("span",{className:tp.a.MessageContents},t.type===F.Chat?" : ":"",t.type===F.Chat?n.AddLinksEmoticons(t.msg,!1):t.msg))})),Ee.createElement("div",{className:"friendsListInsetShadowCtn"},Ee.createElement("div",{className:"friendListInsetShadowBottom"})),_.e&&_.e.logged_in&&this.m_chat?Ee.createElement("div",null,Ee.createElement("div",{className:tp.a.ChatEntry},Ee.createElement("form",{className:""+ml.a.chatEntryControls},Ee.createElement("textarea",{className:ml.a.chatTextarea,placeholder:Object($.b)("#BroadcastChat_EnterResponse"),onKeyPress:this.ChatBoxKeypress,onChange:this.ChatBoxChange,value:this.state.message,ref:this.textInput}),this.m_chat.m_bRateLimited&&Ee.createElement(cp,{nSeconds:this.m_chat.m_nRateLimitSeconds,bRateLimited:this.m_chat.m_bRateLimited}),Ee.createElement("button",{className:"chatSubmitButton EmbedButton",title:Object($.b)("#ChatEntryButton_Submit"),onClick:this.SendMessage},Ee.createElement(ui.X,null))),Ee.createElement("div",{className:ml.a.chatEntryActionsContainer+" "+ml.a.compactableHeight},Ee.createElement("div",{className:ml.a.chatEntryActionsGroup},Ee.createElement(al,{disabled:!1,OnEmoticonSelected:this.OnEmoticonSelected,emoticonStore:ci.ChatStore.EmoticonStore,rtLastAckedNewEmoticons:_d.UIDisplayPrefs.rtLastAckedNewEmoticons}),this.m_chat.m_nFlairGroupID&&ci.ChatStore.EmoticonStore.GetFlairListByGroupID(this.m_chat.m_nFlairGroupID).length?Ee.createElement(al,{disabled:!1,OnEmoticonSelected:this.OnFlairSelected,emoticonStore:ci.ChatStore.EmoticonStore,rtLastAckedNewEmoticons:Number.MAX_VALUE,nFlairGroupID:this.m_chat.m_nFlairGroupID,title:Object($.b)("#ChatEntryButton_Flair"),buttonIcon:Ee.createElement(ui.e,null)}):null)))):t)},R.c([d.observable],e.prototype,"m_rgChatMessages",void 0),R.c([T.a],e.prototype,"BindChatRef",null),R.c([T.a],e.prototype,"ChatBoxChange",null),R.c([T.a],e.prototype,"ChatBoxKeypress",null),R.c([T.a],e.prototype,"SendMessage",null),R.c([T.a],e.prototype,"HandleScroll",null),R.c([T.a],e.prototype,"OnContextMenu",null),R.c([T.a],e.prototype,"OnEmoticonSelected",null),R.c([T.a],e.prototype,"OnFlairSelected",null),e=R.c([or.observer],e)}(Ee.Component),cp=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return R.d(t,e),t.prototype.render=function(){return Ee.createElement("div",{className:tp.a.TimedProgressBarContainer},Ee.createElement("div",{className:tp.a.wrapper},Ee.createElement("div",{className:tp.a.spinner+" "+tp.a.pie,style:{animationDuration:(this.props.nSeconds||0)+"s"}}),Ee.createElement("div",{className:tp.a.filler+" "+tp.a.pie,style:{animationDuration:(this.props.nSeconds||0)+"s"}}),Ee.createElement("div",{className:tp.a.mask,style:{animationDuration:(this.props.nSeconds||0)+"s"}})))},t}(Ee.Component),lp=function(e){var t=e.group,n=e.onClick,o=t.watching_broadcast_steamid;return Oe.a.createElement("button",{className:"ChatRoomListGroupItem NoChannels WatchPartyGroup DialogButton watchHowButton",onClick:n},Oe.a.createElement("div",{className:"ChatRoomListGroupItem_header"},Oe.a.createElement(xs,{group:t,small:!0}),Oe.a.createElement("div",{className:"groupNameStatusContainer"},Oe.a.createElement("div",{className:"chatRoomName"},t.name),o&&Oe.a.createElement("div",{className:"chatRoomDetails"},Object($.b)("#Broadcast_WatchParty_Viewers_NoneActive")))))},pp=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return R.d(t,e),t.prototype.CreateWatchParty=function(e){void 0===e&&(e=!1);var t=this.props,n=t.browserContext,o=t.ownerWindow,i=t.broadcastAccountId,r=t.initialFriend;this.Close();var a,s,c,l,p=e&&r?[r.accountid]:[];a=n,s=o||window,c=i,l=p,fr(Oe.a.createElement(Ys,{browserContext:a,bHideChatNameEntry:!1,vecInvitePlayers:l,chatViewToReplace:void 0,creationOptions:{unBroadcastAccountId:c},strTitle:Object($.b)("#Broadcast_CreateWatchParty")}),s,"CreateChatDialog",{strTitle:Object($.b)("#Broadcast_CreateWatchParty"),popupWidth:450,popupHeight:600},pd(s))},t.prototype.WatchAlone=function(){this.Close()},t.prototype.JoinExisting=function(e){var t=this.props,n=t.broadcastTabId,o=t.browserContext;this.Close();var i=ci.UIStore.ShowAndOrActivateChatRoomGroup(o,e,!0);ci.UIStore.CloseTabByID(n),i.ShowBroadcast()},t.prototype.UpgradeExisting=function(e){var t=this.props,n=t.broadcastAccountId,o=t.browserContext;this.Close(),e.SetChatRoomGroupWatchingBroadcast(n),ci.UIStore.ShowAndOrActivateChatRoomGroup(o,e,!0).ShowBroadcast()},t.prototype.Close=function(){var e=this.props.closeModal;e&&e()},t.prototype.render=function(){var t=this,e=this.props,n=e.closeModal,o=e.initialFriend,i=ci.ChatStore.currentChatRoomGroups,r=i.filter(function(e){return e.watching_broadcast_steamid}),a=i.filter(function(e){return e.BCanIAssociateBroadcast()&&!e.watching_broadcast_steamid}),s=o;return Oe.a.createElement("div",{className:"chatModalCover"},Oe.a.createElement(sr,{onEscKeypress:n},Oe.a.createElement(Ai,{className:"watchPartyDialog"},Oe.a.createElement(Gi,null,Oe.a.createElement("div",{className:"watchPartyPrompt"},Object($.b)("#Broadcast_WatchPrompt")),Oe.a.createElement(Ri,null,Oe.a.createElement(xi,{svgicon:ui.r,className:"watchHowButton",onClick:this.WatchAlone},Object($.b)("#Broadcast_WatchAlone")),s&&Oe.a.createElement(xi,{className:"watchHowButton",onClick:function(){return t.CreateWatchParty(!0)}},Oe.a.createElement(Kc,{friend:s,context:null,bLarge:!1}),Object($.d)("#Broadcast_WatchWith",Oe.a.createElement("span",{className:"highlight"}," ",s.display_name))),0!==r.length&&Oe.a.createElement(Oe.a.Fragment,null,Oe.a.createElement(Di,null,Object($.b)("#Broadcast_WatchWithExistingWatchParty")),r.map(function(e){return Oe.a.createElement(lp,{key:e.unique_id,group:e,onClick:function(){return t.JoinExisting(e)}})})),0!==a.length&&Oe.a.createElement(Oe.a.Fragment,null,Oe.a.createElement(Di,null,Object($.b)("#Broadcast_LinkBroadcastToGroup")),a.map(function(e){return Oe.a.createElement(lp,{key:e.unique_id,group:e,onClick:function(){return t.UpgradeExisting(e)}})})),Oe.a.createElement(xi,{className:"watchHowButton newWatchGroup",svgicon:ui.G,onClick:function(){return t.CreateWatchParty(!1)}},Object($.b)("#Broadcast_LinkBroadcastToGroup_New")))),Oe.a.createElement(Mi,null))))},R.c([T.a],t.prototype,"WatchAlone",null),R.c([T.a],t.prototype,"Close",null),t}(Oe.a.Component);function up(){return _.b.STEAM_TV?1:3}var mp=function(o){function e(e){var t=o.call(this,e)||this;t.m_broadcastInfo=null;var n=t.props.broadcastView.GetSteamID().ConvertTo64BitString();return t.m_broadcastInfo=lo.StartInfo(n),t.state={bChatCollapsed:!1},t}return R.d(e,o),e.prototype.componentWillUnmount=function(){this.m_broadcastInfo&&(lo.StopInfo(this.m_broadcastInfo),this.m_broadcastInfo=null)},e.prototype.OnWatchWithFriends=function(){this.props.broadcastView.ShowWatchPromptDialog()},e.prototype.ToggleChat=function(){this.setState({bChatCollapsed:!this.state.bChatCollapsed})},e.prototype.ToggleTheaterMode=function(){ci.UIStore.SetTheaterMode(!ci.UIStore.GetTheaterMode())},e.prototype.render=function(){var e=this.props,t=e.broadcastView,n=e.popup,o=e.style,i=t.GetSteamID().ConvertTo64BitString(),r=up(),a=t.m_bShowWatchPromptDialog?Oe.a.createElement(pp,{closeModal:function(){return t.HideWatchPromptDialog()},broadcastAccountId:t.GetSteamID().GetAccountID(),broadcastTabId:t.GetUniqueID(),initialFriend:t.m_watchPromptInitialFriend,browserContext:ai,ownerWindow:n}):null;return Oe.a.createElement("div",{className:"BroadcastTab",style:o},Oe.a.createElement(Ls,{className:"FullpageBroadcastBackdrop",src:this.m_broadcastInfo.m_strThumbnailUrl,draggable:!1,duration:2500}),Oe.a.createElement("div",{className:"BroadcastTab_OverBackground"},Oe.a.createElement("div",{className:"BroadcastTabHeaderContainer"},Oe.a.createElement("div",{className:"BroadcastTab_HeaderRow"+(this.state.bChatCollapsed?" ChatCollapsed":"")},Oe.a.createElement(hp,{onClick:this.OnWatchWithFriends}),Oe.a.createElement(_p,{onClick:this.ToggleChat,hideIcon:this.state.bChatCollapsed}))),Oe.a.createElement(gp,{steamID:i,watchLocation:r,bHideChat:this.state.bChatCollapsed,onTheaterMode:this.ToggleTheaterMode},a)))},R.c([T.a],e.prototype,"OnWatchWithFriends",null),R.c([T.a],e.prototype,"ToggleChat",null),R.c([T.a],e.prototype,"ToggleTheaterMode",null),e=R.c([or.observer],e)}(Oe.a.Component),dp=function(n){function e(e){var t=n.call(this,e)||this;return t.m_broadcastInfo=null,t.m_broadcastInfo=lo.StartInfo(t.props.app.GetSteamIDWatched()),t.state={bChatCollapsed:!1,bTheaterMode:!1},t}return R.d(e,n),e.prototype.componentWillUnmount=function(){this.m_broadcastInfo&&(lo.StopInfo(this.m_broadcastInfo),this.m_broadcastInfo=null)},e.prototype.OnShowLogin=function(){this.props.app.ShowLogonDialog()},e.prototype.ToggleChat=function(){this.setState({bChatCollapsed:!this.state.bChatCollapsed})},e.prototype.ToggleTheaterMode=function(){this.setState({bTheaterMode:!this.state.bTheaterMode})},e.prototype.render=function(){var e=this.props.app,t=this.m_broadcastInfo,n=up();return Oe.a.createElement(Oe.a.Fragment,null,e.BReadyToRender()&&Oe.a.createElement("div",{className:"StandalonePlayer"+(this.state.bTheaterMode?" TheaterMode":"")},Oe.a.createElement(Ls,{className:"FullpageBroadcastBackdrop",src:t.m_strThumbnailUrl,draggable:!1,duration:2500}),Oe.a.createElement("div",{className:"StandalonePlayerHeader"},Oe.a.createElement("div",{className:"STV_Logo"},Oe.a.createElement(ui.W,null)),Oe.a.createElement("div",{className:"BroadcastTab_HeaderRow"+(this.state.bChatCollapsed?" ChatCollapsed":"")},Oe.a.createElement(hp,{onClick:this.OnShowLogin}),Oe.a.createElement(_p,{onClick:this.ToggleChat,hideIcon:this.state.bChatCollapsed}))),Oe.a.createElement(gp,{steamID:e.GetSteamIDWatched(),watchLocation:n,bHideChat:this.state.bChatCollapsed,onTheaterMode:this.ToggleTheaterMode},Oe.a.createElement(yp,{app:e}))),Oe.a.createElement(fp,{app:e}))},R.c([T.a],e.prototype,"OnShowLogin",null),R.c([T.a],e.prototype,"ToggleChat",null),R.c([T.a],e.prototype,"ToggleTheaterMode",null),e=R.c([or.observer],e)}(Oe.a.Component);function hp(e){return Oe.a.createElement("div",{className:"BroadcastButton WatchWithFriends",onClick:e.onClick},Oe.a.createElement(ui.fb,null),Object($.b)("#Broadcast_WatchWithFriends"))}function _p(e){return Oe.a.createElement("div",{className:"ToggleBroadcastChat",title:Object($.b)("#Broadcast_ToggleChat"),onClick:e.onClick},Oe.a.createElement(ui.v,{showChat:e.hideIcon}))}var fp=Object(or.observer)(function(e){var t=e.app;return t.BIsPerformingLogonCheck()?Oe.a.createElement("div",null,Oe.a.createElement("iframe",{style:{display:"none"},src:t.GetLoginURL()})):null}),gp=function(n){function e(e){var t=n.call(this,e)||this;return t.m_strLocalSteamID="",t.m_refBroadcastContainer=Oe.a.createRef(),t.state={info:null},t}return R.d(e,n),e.getDerivedStateFromProps=function(e,t){return t.info&&t.info.m_steamIDBroadcast===e.steamID?null:(t.info&&lo.StopInfo(t.info),{info:lo.StartInfo(e.steamID)})},e.prototype.componentWillUnmount=function(){this.state.info&&lo.StopInfo(this.state.info)},e.prototype.OnLocalStreamChange=function(e){this.m_strLocalSteamID=e},e.prototype.SetMainContentRef=function(e){this.m_elMainContent=e},e.prototype.CalculateBroadcastSectionStyles=function(e){if(this.props.bHideChat)return{width:"100%",height:"100%"};var t,n;_d&&(t=_d.UIDisplayPrefs.nWatchPartyBroadcastHeightPercentage,n=_d.UIDisplayPrefs.nWatchPartyBroadcastWidthPercentage);var o={};if(e){var i=t||66;if(o.height=i+"%",this.m_elMainContent){var r=this.m_elMainContent,a=r.clientWidth,s=r.clientHeight,c=9/16*a+50,l=Object(_n.a)(i,1,c/s*100);o.height=l+"%"}}else o.width=n?n+"%":"66%",o.maxWidth="calc( 100% - 316px )",o.overflowY="auto";return o},e.prototype.OnGrabberMouseDown=function(e){var t=e.currentTarget.ownerDocument.defaultView;t.addEventListener("mousemove",this.HandleMouseMove),t.addEventListener("mouseup",this.UnregisterDragEvents),this.setState({bDraggingChatGrabber:!0})},e.prototype.HandleMouseMove=function(e){e.preventDefault(),e.stopPropagation();var t=this.m_refBroadcastContainer.current.getBoundingClientRect(),n=this.m_refBroadcastContainer.current.parentElement.getBoundingClientRect(),o=t.left,i=e.clientX,r=n.width,a=Object(_n.a)((i-o)/r*100,1,100);_d.SetUIDisplayPref("nWatchPartyBroadcastWidthPercentage",a)},e.prototype.UnregisterDragEvents=function(e){e.view.removeEventListener("mousemove",this.HandleMouseMove),e.view.removeEventListener("mouseup",this.UnregisterDragEvents),this.setState({bDraggingChatGrabber:!1})},e.prototype.render=function(){var e=this.props,t=e.steamID,n=e.children,o=this.m_strLocalSteamID||t,i=this.state.info.m_bIsOnline,r=null,a=this.CalculateBroadcastSectionStyles(!1);if(Q.bValid)switch(Q.appID){case 730:r=Oe.a.createElement(bp,null);break;case 583950:r=Oe.a.createElement(vp,null);break;default:r=Oe.a.createElement("div",{className:Q.offlineClassName})}return Oe.a.createElement("div",{className:"BroadcastContainer"},Oe.a.createElement("div",{className:"BroadcastContainerSection",ref:this.m_refBroadcastContainer,style:a},Oe.a.createElement("div",{className:"BroadcastContainerSectionVideoContainer"},i&&Oe.a.createElement(Bl,{key:o,steamID:o,watchLocation:this.props.watchLocation,onTheaterMode:this.props.onTheaterMode}),!i&&r,Oe.a.createElement("div",{className:"videoContainerSizer"})),n,Oe.a.createElement("div",{className:"BroadcastDetailsSection"},Oe.a.createElement($l,{steamID:o,onLocalStreamChange:this.OnLocalStreamChange,bVerticalBroadcastChat:!0}))),!this.props.bHideChat&&Oe.a.createElement("div",{className:"BroadcastChatDivider horizontal",onMouseDown:this.OnGrabberMouseDown}),Oe.a.createElement("div",{style:{display:"flex",flexDirection:"row",width:"100%",minWidth:"300px"}},Oe.a.createElement(sp,{steamID:t,watchLocation:this.props.watchLocation,hidden:this.props.bHideChat})))},R.c([d.observable],e.prototype,"m_strLocalSteamID",void 0),R.c([T.a],e.prototype,"OnLocalStreamChange",null),R.c([T.a],e.prototype,"SetMainContentRef",null),R.c([T.a],e.prototype,"OnGrabberMouseDown",null),R.c([T.a],e.prototype,"HandleMouseMove",null),R.c([T.a],e.prototype,"UnregisterDragEvents",null),e=R.c([or.observer],e)}(Oe.a.Component);function bp(e){return Oe.a.createElement("div",{className:"BroadcastCSGOLondonOffline"},Oe.a.createElement("div",{className:"BroadcastCSGOLondonOffline_Schedule"},Oe.a.createElement("div",{className:"BroadcastCSGOLondonOffline_Prelims"},"CHALLENGERS STAGE – SEPTEMBER 5-9"),Oe.a.createElement("div",{className:"BroadcastCSGOLondonOffline_Group"},"LEGENDS STAGE – SEPTEMBER 12-16"),Oe.a.createElement("div",{className:"BroadcastCSGOLondonOffline_Playoffs"},"CHAMPIONS STAGE – SEPTEMBER 20-23")))}function vp(e){return Oe.a.createElement("div",{className:"BroadcastArtifactOffline"},Oe.a.createElement("div",{className:"BroadcastArtifactOffline_Schedule"}))}var Sp=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return R.d(t,e),t.prototype.Dismiss=function(){this.props.app.DismissLogonDialog()},t.prototype.render=function(){return Oe.a.createElement(sr,{onEscKeypress:this.Dismiss},Oe.a.createElement(Ai,{className:"SteamTVLoginDialog"},Oe.a.createElement("iframe",{className:"steamTVLogin",src:this.props.app.GetLoginURL()})))},R.c([T.a],t.prototype,"Dismiss",null),t}(Oe.a.Component),yp=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return R.d(t,e),t.prototype.render=function(){if(!this.props.app.BIsLogonDialogVisible())return null;var e=Oe.a.createElement(Sp,{app:this.props.app});return Oe.a.createElement("div",{className:"chat_full_modaloverlay"},Oe.a.createElement("div",{className:"chat_modal_position chat_modal_background"}),Oe.a.createElement("div",{className:"chat_modal_position active"},e))},t=R.c([or.observer],t)}(Oe.a.Component);var Cp=n("v5rQ"),Ip=n.n(Cp);function Ep(e){return Ee.createElement("div",{className:"msg"},Ee.createElement("div",{className:"msgText MessageFromBlockedUser"},Object($.b)("#Friend_Chat_Blocked")))}var Op=Object(or.observer)(function(e){return Ee.createElement(Wc,{friend:e.player,context:e.context},Ee.createElement("span",null,e.player.display_name))}),wp=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return R.d(t,e),t.prototype.render=function(){var e=this.props.messages,t=this.props.friendRenderContext;if(0==e.length)return null;for(var n=[],o=[],i=!0,r=0,a=e;r<a.length;r++){var s=a[r];if(-1==o.indexOf(s.unServerMsgParamAccountID)){0<n.length&&n.push(", ");var c=ci.FriendStore.GetPlayer(s.unServerMsgParamAccountID);n.push(Ee.createElement(Op,{context:t,player:c})),o.push(s.unServerMsgParamAccountID),c.is_ready||(c.LoadIfNecessary(),i=!1)}}var l=ci.FriendStore.GetPlayer(e[0].unAccountID);l.is_ready||(l.LoadIfNecessary(),i=!1);var p=Ee.createElement(Op,{context:t,player:l}),u="";if(1<n.length){var m=Ee.createElement.apply(Ee,[Ee.Fragment,null].concat(n));u=Object($.d)("#ChatRoom_ServerMessage_Invited_Multiple",m,p)}else u=Object($.d)("#ChatRoom_ServerMessage_Invited",n[0],p);return Ee.createElement(Xc,{style:"server"},Ee.createElement("div",{className:"msg serverMsg"},Ee.createElement("div",{className:"msgText"},i?u:" ")))},t=R.c([or.observer],t)}(Ee.Component),Mp=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return R.d(t,e),t.prototype.render=function(){var e=this.props.messages,t=this.props.friendRenderContext;if(0==e.length)return null;for(var n=[],o=[],i=!0,r=0,a=e;r<a.length;r++){var s=a[r];if(-1==o.indexOf(s.unServerMsgParamAccountID)){0<n.length&&n.push(Object($.b)("#ChatRoom_ServerMessageMultiple_Separator"));var c=ci.FriendStore.GetPlayer(s.unServerMsgParamAccountID);n.push(Ee.createElement(Op,{context:t,player:c})),o.push(s.unServerMsgParamAccountID),c.is_ready||(c.LoadIfNecessary(),i=!1)}}var l="";if(1<n.length){var p=n.pop();2==n.length&&n.pop();var u=Ee.createElement.apply(Ee,[Ee.Fragment,null].concat(n));l=Object($.d)(this.props.tokenPrefix+"_Multiple",u,p)}else l=Object($.d)(this.props.tokenPrefix,n[0]);return Ee.createElement(Xc,{style:"server"},Ee.createElement("div",{className:"msg serverMsg"},Ee.createElement("div",{className:"msgText"},i?l:" ")))},t=R.c([or.observer],t)}(Ee.Component),Dp=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return R.d(t,e),t.prototype.BIsEmoticonsOnly=function(e){if(e.startsWith("[emoticon")){var t=e.match(/^(?:\[emoticon\][^\[]+\[\/emoticon\]\s*)+$/);if(t&&t.length){var n=e.match(/\[emoticon\][^\[]+\[\/emoticon\]/g);return n&&n.length<=6}}return!1},t.prototype.OnAnimationStart=function(){this.m_nAnimationsInFlight||(this.m_nAnimationsInFlight=0),this.m_nAnimationsInFlight++},t.prototype.OnAnimationEnd=function(){this.m_nAnimationsInFlight&&this.m_nAnimationsInFlight--,this.m_nAnimationsInFlight||this.props.msg.OnAnimationEnd()},t.prototype.CopyMessage=function(){Ci.i(window.getSelection().toString())},t.prototype.OnMessageContextMenu=function(e){var t,n=this,o=this.props.msg.unAccountID;this.props.chatView.chat instanceof kt&&(t=this.props.chatView.chat);var i=[];return window.getSelection().toString().length&&i.push(Ee.createElement(ir.d,{key:"copy",onSelected:this.CopyMessage},Object($.b)("#Chat_Copy_Clipboard"))),t&&t.BCanDeleteMemberMessages(o)&&i.push(Ee.createElement(ir.d,{key:"delete",onSelected:function(){t.DeleteChatMessges([n.props.msg])}},Object($.b)("#Chat_Actions_Delete"))),i.length?Object(mi.a)(Ee.createElement(ir.c,null,i),e):null},t.prototype.render=function(){var e,t,n=this.props,o=n.msg,i=n.speakerWidth,r=n.chatView,a=n.onUpdate,s=n.children,c=n.extraClassName,l=r.chat,p=o.strMessage,u=this.props.hideTimeStamp||r.IsChatRoom(),m=!u&&ci.FriendStore.GetPlayer(o.unAccountID);if(o.eErrorSending!=We.None)switch(o.eErrorSending){case We.NotFriends:t="ChatMessageErrorSending",e=Ee.createElement("div",{className:"ChatMessageErrorSendingAlert"},Object($.b)("#Chat_ErrorSending_NotFriends"));break;case We.RateLimitExceeded:t="ChatMessageErrorSending",e=Ee.createElement("div",{className:"ChatMessageErrorSendingAlert"},Object($.b)("#Chat_ErrorSending_RateLimitExceeded"));break;case We.NoChatPermissionInGroup:t="ChatMessageErrorSendingPermissionDenied",e=Ee.createElement("div",{className:"ChatMessageErrorPermissionDeniedAlert"},Ee.createElement(ui.z,null),Object($.b)("#Chat_ErrorPermissionDenied"));break;case We.Generic:default:t="ChatMessageErrorSending",e=Ee.createElement("div",{className:"ChatMessageErrorSendingAlert"},Object($.b)("#Chat_ErrorSending"))}var d=hr("msg",c,t,{isCurrentUser:l.self.accountid===o.unAccountID,HasTimeStamp:!u,EmojiOnly:Nn(p)}),h={width:i?i+"px":void 0},_={chat:l,unAccountIDSender:o.unAccountID,rtTimestamp:o.rtTimestamp,key:o.UniqueKey(),onLoad:a,bUseLargeEmoticons:this.BIsEmoticonsOnly(p),bAnimate:o.eAnimationState===je.Animating,onAnimationStart:this.OnAnimationStart,onAnimationEnd:this.OnAnimationEnd},f=s||Ee.createElement(Me,{bbcode:p,context:_,parser:l.GetBBCodeParser()}),g=hr("msgText",{MsgNoUserContent:!o.HasUserContent()});return Ee.createElement("div",{className:d},!u&&Ee.createElement(Tp,{className:"FriendChatTimeStamp",friend:m,style:h},Ee.createElement(jr,{rtime:o.rtTimestamp,bTimeOnly:!0})),e,Ee.createElement(Xc,null,Ee.createElement("div",{className:g,onContextMenu:this.OnMessageContextMenu},f)))},R.c([T.a],t.prototype,"OnAnimationStart",null),R.c([T.a],t.prototype,"OnAnimationEnd",null),R.c([T.a],t.prototype,"CopyMessage",null),R.c([T.a],t.prototype,"OnMessageContextMenu",null),t=R.c([or.observer],t)}(Ee.Component),Tp=Object(or.observer)(function(e){var t=e.friend.persona,n=!1;t.m_broadcastAccountId&&(n=!0);var o=hr(e.className,(t.is_golden&&t.is_online?"golden":t.is_ingame&&"ingame")||t.is_online&&"online"||"offline",{away:t.is_awayOrSnooze,watchingbroadcast:n});return Ee.createElement("div",{className:o,style:e.style},e.children)}),Gp=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return R.d(t,e),t.prototype.GetChatRoomSpeakerClass=function(e){var t=e.persona;return t.is_golden&&t.is_online?Ip.a.SpeakerName_Golden:t.is_ingame?Ip.a.SpeakerName_InGame:t.m_broadcastAccountId?Ip.a.SpeakerName_WatchingBroadcast:t.is_online?Ip.a.SpeakerName_Online:Ip.a.SpeakerName_Default},t.prototype.render=function(){var e,t,n=this.props.friend,o="";if(this.props.chatView.IsChatRoom()){var i=this.props.chatView.chat,r=void 0;switch(i.GetMember(n.accountid)&&(r=i.GetGroup().GetMemberRank(n.accountid)),r){default:break;case 30:o="Moderator";break;case 40:o="Officer";break;case 50:o="Owner",i.GetGroup().BIsClanChatRoom()||(t=Ee.createElement("div",{className:"rankIcon rankOwner"},Ee.createElement(ui.j,null)))}i.GetGroup().BIsClanChatRoom()&&(40<=r?t=Ee.createElement("div",{className:"rankIcon rankOwner"},Ee.createElement("img",{src:G.a.COMMUNITY_CDN_URL+"public/images/skin_1/comment_modindicator_officer.png"})):30<=r&&(t=Ee.createElement("div",{className:"rankIcon rankOwner"},Ee.createElement("img",{src:G.a.COMMUNITY_CDN_URL+"public/images/skin_1/comment_modindicator_moderator.png"}))))}else o="";return e="speakerName "+this.GetChatRoomSpeakerClass(n),Ee.createElement(Xc,{style:"speaker allow-embedded-newlines",text:["["+Pr(this.props.msg.rtTimestamp,{bIncludeWeekday:!1})+"]",n.primary_display_name+":"]},Ee.createElement("div",{className:"ChatSpeaker ChatRoomSpeaker SpeakerLineBreak"+(n.accountid==this.props.chatView.chat.self.accountid?" isCurrentUser":"")},Ee.createElement(Tp,{friend:n,className:"speaker"},Ee.createElement(Wc,{friend:n,context:this.props.friendRenderContext},Ee.createElement("div",{className:"speakerHoverArea "+o},t,Ee.createElement("img",{className:"avatar speakerAvatar",src:n.persona.avatar_url}),Ee.createElement("div",{className:"speakerStatus"}),Ee.createElement("div",{className:e},n.primary_display_name,!n.is_display_name_nickname&&n.has_secondary_display_name&&Ee.createElement("span",{className:"playerNickname"}," (",n.secondary_display_name,")"),n.is_display_name_nickname&&Ee.createElement("span",{className:"playerNicknameBracket",title:Object($.b)("#isNickname")},"*")))),Ee.createElement("div",{className:"speakerTimeStamp"},Ee.createElement(jr,{rtime:this.props.msg.rtTimestamp,bTimeOnly:!1})))))},t=R.c([or.observer],t)}(Ee.Component),Rp=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return R.d(t,e),t.prototype.OnUpdate=function(){this.props.onUpdate("ChatMessageSlashEmote "+this.props.msg.UniqueKey())},t.prototype.render=function(){var e=this.props.msg,t=this.props.chatView.chat,n=ci.FriendStore.GetPlayer(e.unAccountID),o=e.strMessage.slice(e.strMessage.search(/\s/g)+1),i=hr("speaker",n.persona.is_ingame?"ingame":n.persona.is_online?"online":"offline"),r={width:this.props.speakerWidth?this.props.speakerWidth+"px":void 0},a=hr("msg","ChatMsgSlashEmote","ChatRoomSlashEmote",{isCurrentUser:t.self.accountid===e.unAccountID,ChatMessageErrorSending:e.eErrorSending!=We.None});return Ee.createElement("div",{className:a},e.eErrorSending!=We.None&&Ee.createElement("div",{className:"ChatMessageErrorSendingAlert"},Object($.b)("#Chat_ErrorSending")),Ee.createElement("div",{className:"SpeakerLineBreak"+(e.unAccountID==t.self.accountid?" isCurrentUser":"")},Ee.createElement("div",{className:i},Ee.createElement(Wc,{friend:n,context:{chat:t,chatContext:"message"}},Ee.createElement(Xc,{style:"speaker allow-embedded-newlines",text:["["+Pr(this.props.msg.rtTimestamp,{bIncludeWeekday:!1})+"]",n.display_name+":"]},Ee.createElement("div",{className:"speakerHoverArea"},Ee.createElement("img",{className:"avatar speakerAvatar",src:n.persona.avatar_url,onLoad:this.OnUpdate}),Ee.createElement("div",{className:"speakerStatus"}),Ee.createElement("div",{className:"speakerName",style:r},n.display_name)))),Ee.createElement(Xc,{style:"force-display append-innertext",text:"/me"},Ee.createElement("div",{className:"msgText"},Ee.createElement(Me,{bbcode:o,context:{chat:t,unAccountIDSender:e.unAccountID,rtTimestamp:e.rtTimestamp,onUpdate:this.props.onUpdate},parser:t.GetBBCodeParser()}))),Ee.createElement("div",{className:"speakerTimeStamp"},Ee.createElement(jr,{rtime:e.rtTimestamp,bTimeOnly:!1})))))},R.c([T.a],t.prototype,"OnUpdate",null),t=R.c([or.observer],t)}(Ee.Component),Np=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return R.d(t,e),t.prototype.render=function(){return Ee.createElement(Dp,R.a({},this.props,{extraClassName:"ChatMessageDeleted"}),Ee.createElement("div",{className:"msgText"},Ee.createElement("span",{className:"filteredURL bb_removedlink"},Object($.b)("#Chat_MessageDeleted"))))},t=R.c([or.observer],t)}(Ee.Component),Lp=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return R.d(t,e),t.prototype.render=function(){var e,t=this.props.msg,n=this.props.friendRenderContext;if(11==t.eServerMsgType){var o={unAccountIDSender:0,chat:n.chat,rtTimestamp:t.rtTimestamp,key:t.UniqueKey(),onLoad:void 0};e=Ee.createElement("div",{className:"msgText"},Ee.createElement(Me,{bbcode:this.props.msg.strServerMsgAppCustomLocalized,context:o,parser:n.chat.GetBBCodeParser()}))}else{var i=function(e){switch(e.eServerMsgType){case 1:var t=ci.FriendStore.GetPlayer(e.unAccountID);return{strToken:"#ChatRoom_ServerMessage_RenameChatRoom",parts:[e.strServerMsgParam,t]};case 2:return{strToken:"#ChatRoom_ServerMessage_Joined",parts:[ci.FriendStore.GetPlayer(e.unServerMsgParamAccountID)]};case 3:return{strToken:"#ChatRoom_ServerMessage_Parted",parts:[ci.FriendStore.GetPlayer(e.unServerMsgParamAccountID)]};case 4:var n=ci.FriendStore.GetPlayer(e.unAccountID);return{strToken:"#ChatRoom_ServerMessage_Kicked",parts:[ci.FriendStore.GetPlayer(e.unServerMsgParamAccountID),n]};case 9:return t=ci.FriendStore.GetPlayer(e.unAccountID),e.strServerMsgParam.length?{strToken:"#ChatRoom_ServerMessage_ChatRoomTaglineChanged",parts:[e.strServerMsgParam,t]}:{strToken:"#ChatRoom_ServerMessage_ChatRoomTaglineRemoved",parts:[t]};case 10:return{strToken:"#ChatRoom_ServerMessage_ChatRoomAvatarChanged",parts:[t=ci.FriendStore.GetPlayer(e.unAccountID)]};case 5:return{strToken:"#ChatRoom_ServerMessage_Invited",parts:[ci.FriendStore.GetPlayer(e.unServerMsgParamAccountID),ci.FriendStore.GetPlayer(e.unAccountID)]};default:return{strToken:"#ChatRoom_ServerMessage_Unhandled",parts:[]}}}(t),r=i.parts.length?function(e,t){for(var n=[],o=2;o<arguments.length;o++)n[o-2]=arguments[o];for(var i=[],r=0,a=n;r<a.length;r++){var s=a[r];s instanceof ft?i.push(Ee.createElement(Op,{context:e,player:s})):i.push(s)}return $.d.apply(void 0,[t].concat(i))}.apply(void 0,[n,i.strToken].concat(i.parts)):Object($.b)(i.strToken);e=Ee.createElement("div",{className:"msgText"},r)}return Ee.createElement(Xc,{style:"server"},Ee.createElement("div",{className:"msg serverMsg"},e))},t=R.c([or.observer],t)}(Ee.Component),kp=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return R.d(t,e),Object.defineProperty(t.prototype,"TradeRequestMsg",{get:function(){return this.props.msg},enumerable:!0,configurable:!0}),t.prototype.AcceptTrade=function(){ci.FriendStore.RespondToTradeRequest(this.TradeRequestMsg.TradeRequestID(),!0)},t.prototype.DeclineTrade=function(){ci.FriendStore.RespondToTradeRequest(this.TradeRequestMsg.TradeRequestID(),!1),this.TradeRequestMsg.MarkAsDeclined()},t.prototype.CancelTradeRequest=function(){ci.FriendStore.CancelTradeRequest(this.TradeRequestMsg.TargetSteamID()),this.TradeRequestMsg.MarkAsCancelled()},t.prototype.ViewAcceptedTrade=function(){ci.FriendStore.OpenTradeWindow(this.TradeRequestMsg.TargetSteamID())},t.prototype.GetLocalizedErrorResponseString=function(){var e=new D.a(this.TradeRequestMsg.TargetSteamID()).GetAccountID(),t=e!=ci.FriendStore.self.accountid?this.props.msg.unAccountID:ci.FriendStore.self.accountid;return function(e,t,n){var o=ci.FriendStore.GetPlayer(n).display_name,i=ci.FriendStore.GetPlayer(t).display_name,r=t==ci.FriendStore.self.accountid;switch(e.result){case 1:return Object($.b)("#friends_trade_declined",o);case 14:return Object($.b)("#friends_trade_you_are_cafe",o);case 15:return Object($.b)("#friends_trade_they_are_cafe",o);case 16:return Object($.b)("#friends_trade_you_are_school",o);case 17:return Object($.b)("#friends_trade_they_are_school",o);case 2:return Object($.b)("#friends_trade_you_are_banned",o);case 3:return Object($.b)("#friends_trade_they_are_banned",o);case 4:return Object($.b)("#friends_trade_they_are_trading",o);case 5:return Object($.b)("#friends_trade_disabled");case 6:return Object($.b)("#friends_trade_not_logged_in",o);case 7:return Object($.b)("#friends_trade_cancelled");case 8:return Object($.b)("#friends_trade_too_soon",o);case 9:return Object($.b)("#friends_trade_too_soon_penalty",o);case 10:return Object($.b)("#friends_trade_connection_failed",o);case 11:return Object($.b)("#friends_trade_you_are_already_trading");case 12:return Object($.b)("#friends_trade_you_are_already_requesting_trade");case 13:return r?Object($.b)("#friends_trade_no_respond",o):Object($.b)("#friends_trade_you_didnt_respond",i);case 18:return Object($.b)("#friends_trade_they_are_blocked",o);case 20:return Object($.b)("#friends_trade_you_need_verified_email");case 21:return Object($.b)("#friends_trade_you_have_steam_guard_disabled");case 22:return Object($.b)("#friends_trade_their_account_cannot_trade",o,o);case 23:return Object($.b)("#friends_trade_you_havent_had_steam_guard_enabled_long_enough",e.steamguard_required_days);case 24:return 0<e.default_password_reset_probation_days&&0<e.password_reset_probation_days?e.password_reset_probation_days>e.default_password_reset_probation_days?Object($.b)("#friends_trade_you_recently_reset_password_long",e.password_reset_probation_days):1==e.password_reset_probation_days?Object($.b)("#friends_trade_you_recently_reset_password_oneday"):Object($.b)("#friends_trade_you_recently_reset_password_short",e.password_reset_probation_days):Object($.b)("#friends_trade_you_recently_reset_password");case 28:return 0<e.email_change_probation_days?1==e.email_change_probation_days?Object($.b)("#friends_trade_you_recently_changed_email_oneday"):Object($.b)("#friends_trade_you_recently_changed_email_days",e.email_change_probation_days):Object($.b)("#friends_trade_you_recently_changed_email");case 25:return Object($.b)("#friends_trade_you_are_using_new_device",e.new_device_cooldown_days);case 30:return Object($.b)("#friends_trade_trade_hold_for_cleared_trades_initiator",o);case 31:return Object($.b)("#friends_trade_would_exceed_max_asset_count");case 32:return Object($.b)("#friends_trade_disabled_in_your_country");case 33:return Object($.b)("#friends_trade_disabled_in_other_country");default:return Object($.b)("#friends_trade_generic_failure",o)}}(this.TradeRequestMsg.m_ErrorDetails,t,e)},t.prototype.render=function(){var e=this.props.msg,t=e.unAccountID==ci.FriendStore.self.accountid,n={};if(this.TradeRequestMsg.m_bAccepted)return Ee.createElement("div",{className:"msg",style:n},Ee.createElement("div",{className:"msgText"},Ee.createElement("div",{className:"msg tradeRequest tradeRequestCancelled"},Ee.createElement("div",{className:"centerBlock"},Ee.createElement("div",null,Object($.b)("#ChatRoom_TradeRequest_Accepted")),this.TradeRequestMsg.m_bPopupBlocked&&Ee.createElement("div",null,Object($.b)("#ChatRoom_TradeRequest_Popup_Blocked")),Ee.createElement(jr,{rtime:e.rtTimestamp,bTimeOnly:!0}),Ee.createElement("div",{className:"tradeRequestButtonContainer"},this.TradeRequestMsg.m_bPopupBlocked&&Ee.createElement("div",{className:"tradeRequestButton",onClick:this.ViewAcceptedTrade},Object($.b)("#ChatRoom_TradeRequest_ViewTrade")))))));if(this.TradeRequestMsg.m_bDeclined){var o=new D.a(this.TradeRequestMsg.TargetSteamID()).GetAccountID(),i=ci.FriendStore.GetPlayer(o).display_name;return Ee.createElement("div",{className:"msg"+(t?" isCurrentUser":""),style:n},Ee.createElement("div",{className:"msgText"},Ee.createElement("div",{className:"tradeInviteDismissed"},Ee.createElement("div",null,Ee.createElement(ui.bb,null),t&&Object($.d)("#ChatRoom_TradeRequest_Recipient_Declined",i),!t&&Object($.d)("#ChatRoom_TradeRequest_Self_Declined",i)))))}if(this.TradeRequestMsg.m_bCancelled)return Ee.createElement("div",{className:"msg"+(t?" isCurrentUser":""),style:n},Ee.createElement("div",{className:"msgText"},Ee.createElement("div",{className:"tradeInviteDismissed"},Ee.createElement("div",null,Ee.createElement(ui.bb,null),this.GetLocalizedErrorResponseString()))));if(t){o=new D.a(this.TradeRequestMsg.TargetSteamID()).GetAccountID();var r=ci.FriendStore.GetPlayer(o).display_name;return Ee.createElement("div",{className:"msg",style:n},Ee.createElement("div",{className:"msgText"},Ee.createElement("div",{className:"msg ChatMessageInvite gameInviteMsg tradeInviteMsg tradeInviteSender"},Ee.createElement("div",{className:"leftInviteContainer"},Ee.createElement(ui.bb,null)),Ee.createElement("div",{className:"rightInviteContainer"},Ee.createElement("div",{className:"centerBlock"},Ee.createElement("div",{className:"inviteLabel"},Object($.d)("#ChatRoom_TradeRequest_Sender_Pending",r))),Ee.createElement("button",{className:"DialogButton Primary",onClick:this.CancelTradeRequest},Object($.b)("#Button_Cancel"))))))}r=ci.FriendStore.GetPlayer(e.unAccountID);return Ee.createElement("div",{className:"msg",style:n},Ee.createElement("div",{className:"msgText"},Ee.createElement("div",{className:"msg ChatMessageInvite gameInviteMsg tradeInviteMsg"},Ee.createElement("div",{className:"leftInviteContainer"},Ee.createElement(ui.bb,null)),Ee.createElement("div",{className:"rightInviteContainer"},Ee.createElement("div",{className:"centerBlock"},Ee.createElement("div",{className:"invitedTimeLabel"},Object($.b)("#ChatRoom_GameInvite_InviteTime"),Ee.createElement(jr,{rtime:e.rtTimestamp,bTimeOnly:!0})),Ee.createElement("div",{className:"inviteLabel"},Object($.b)("#ChatRoom_TradeRequest_Recipient_Pending",r.display_name)),Ee.createElement("div",{className:"productName"},Object($.b)("#bbcode_econ_TradeTitle"))),Ee.createElement("button",{className:"DialogButton Primary",onClick:this.AcceptTrade},Object($.b)("#ChatRoom_TradeRequest_Accept")),Ee.createElement("div",{className:"closeButton",onClick:this.DeclineTrade},Ee.createElement(ui.jb,null))))))},R.c([T.a],t.prototype,"AcceptTrade",null),R.c([T.a],t.prototype,"DeclineTrade",null),R.c([T.a],t.prototype,"CancelTradeRequest",null),R.c([T.a],t.prototype,"ViewAcceptedTrade",null),t=R.c([or.observer],t)}(Ee.Component),Pp=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return R.d(t,e),t.prototype.render=function(){return Ee.createElement(Xc,{style:"invite",text:this.props.msg.strMessage},Ee.createElement("div",{className:"msg"},Ee.createElement("div",{className:"msg voiceChannelInvite"},this.props.msg.strMessage),Ee.createElement("div",{className:"msg voiceChannelInviteClear"})))},t=R.c([or.observer],t)}(Ee.Component),Ap=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return R.d(t,e),t.prototype.componentDidUpdate=function(){this.props.onUpdate("ChatMessageBlocks "+this.props.chatView.GetUniqueID())},t.prototype.renderBlock=function(e){var t,n=this.props,o=this.props.chatView,i=o.chat.chat_message_blocks,r=!o.IsChatRoom()&&i.time_passes_index,a=o.IsChatRoom()?o.chat.first_unread_msg_time:O.e,s=i.message_blocks[e],c=0==e?O.e:i.message_blocks[e-1].GetRTimeLastMessage();if(a&&c<=a&&s.GetRTimeLastMessage()>a){var l=s,p=void 0;a>s.GetRTimeFirstMessage()&&(p=(t=s.CreateVirtualSplitOnTimestamp(a))[0],l=t[1],Object(I.a)(p.messages.length,"No messages in prefix"));var u=a;return Ee.createElement(Ee.Fragment,{key:s.UniqueKey()},p&&Ee.createElement(Bp,R.a({},n,{block:p,bIsInitialBlock:0===e,bShowTimePasses:e===r})),Ee.createElement(Up,{rtTimestamp:u,bUnread:!0}),0<l.messages.length&&Ee.createElement(Bp,R.a({},n,{block:l,bIsInitialBlock:!1,bShowTimePasses:!1})))}return Ee.createElement(Bp,R.a({},n,{key:s.UniqueKey(),block:s,bIsInitialBlock:0===e,bShowTimePasses:e===r}))},t.prototype.render=function(){var n=this;this.props;return this.props.chatView.chat.chat_message_blocks.message_blocks.map(function(e,t){return n.renderBlock(t)})},t=R.c([or.observer],t)}(Ee.Component),Bp=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return R.d(t,e),t.prototype.componentDidUpdate=function(){this.props.block.is_last_block&&this.props.onUpdate("ChatMessageBlock "+this.props.block.UniqueKey())},t.prototype.render=function(){var e,t,n=this.props,o=n.block,i=n.bIsInitialBlock,r=n.bShowTimePasses,a=R.f(n,["block","bIsInitialBlock","bShowTimePasses"]),s=a.friendRenderContext,c=o.messages;if(o.BIsInvite()?e=Ee.createElement(wp,{messages:c,friendRenderContext:s}):o.BIsServerMsg()?e=Ee.createElement(jp,{block:o,friendRenderContext:s}):c.length&&(e=Ee.createElement(Vp,R.a({},a,{messages:c,bLastMessageBlock:o.is_last_block}))),o.is_last_block){var l=ci.GetLocalMidnightInRTime32();o.GetRTimeMidnightBeforeBlock()!=l&&(t=Ee.createElement(Up,{rtTimestamp:l}))}else o.GetRTimeMidnightBeforeBlock()!=o.GetRTimeMidnightBeforeNextBlock()&&(t=Ee.createElement(Up,{rtTimestamp:o.GetRTimeMidnightBeforeNextBlock()}));return Ee.createElement(Ee.Fragment,null,i&&0<c.length&&Ee.createElement(Fp,{msg:c[0]}),r&&Ee.createElement(Up,{rtTimestamp:c[0].rtTimestamp,bTimePassesLine:!0}),e,t)},t=R.c([or.observer],t)}(Ee.Component);function Fp(e){return e.msg.rtTimestamp<ci.GetLocalMidnightInRTime32()?Ee.createElement(Up,{rtTimestamp:e.msg.rtTimestamp}):null}var Vp=function(n){function e(e){var t=n.call(this,e)||this;return t.state={bHoveringDelete:!1},t}return R.d(e,n),e.prototype.OnHoverDelete=function(e){this.setState({bHoveringDelete:e})},e.prototype.render=function(){var e=!0,t=!1,n=this.props.bLastMessageBlock,o=this.props.messages[0].unAccountID,i=ci.FriendStore.GetPlayer(o),r=this.props.chatView.IsChatRoom()?this.props.chatView.chat:null,a=r&&r.BCanDeleteMemberMessages(o),s=a&&this.state.bHoveringDelete,c="ChatMessageBlock",l=[];if(r&&i.is_blocked)l.push(Ee.createElement(Ep,{key:"blocked"})),c+=" ChatMessageBlock_BlockedSender";else{this.props.messages.length&&"/me"===this.props.messages[0].GetSlashCommand()&&(e=!1);for(var p=0,u=!1,m=0;m<this.props.messages.length;m++){var d=this.props.messages[m],h=!0;if(!r){var _=Math.floor(d.rtTimestamp/60);p&&_!=p?t=!(h=!1):n&&t&&m==this.props.messages.length-1&&(h=!1),p=_}var f={msg:d,key:d.UniqueKey(),chatView:this.props.chatView,hideTimeStamp:h,onUpdate:this.props.onUpdate};d.eDeleteState!=xe.Deleting&&d.eDeleteState!=xe.Deleted?(u=!1,"/me"===d.GetSlashCommand()?l.push(Ee.createElement(Rp,R.a({},f))):d instanceof Qe?l.push(Ee.createElement(Xc,null,Ee.createElement(kp,R.a({},f,{speakerWidth:this.props.speakerWidth})))):d instanceof Xe?(e=!1,l.push(Ee.createElement(Pp,R.a({},f)))):l.push(Ee.createElement(Dp,R.a({},f,{speakerWidth:this.props.speakerWidth})))):(u||l.push(Ee.createElement(Np,R.a({},f,{speakerWidth:this.props.speakerWidth}))),u=!0)}}return n&&(c+=" LastMessageBlock",t&&(c+=" HasInternalTimeStamp")),s&&(c+=" ChatMessageBlock_HighlightDelete"),1!=l.length||r||(c+=" SingletonMsg"),Ee.createElement(Xc,null,Ee.createElement("div",{className:c},e&&Ee.createElement(Gp,{friend:i,chatView:this.props.chatView,msg:this.props.messages[0],friendRenderContext:this.props.friendRenderContext,key:"speaker",speakerWidth:this.props.speakerWidth,onUpdate:this.props.onUpdate}),a&&Ee.createElement(xp,{chatRoom:r,messages:this.props.messages,onHover:this.OnHoverDelete}),l))},R.c([T.a],e.prototype,"OnHoverDelete",null),e=R.c([or.observer],e)}(Ee.Component),xp=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return R.d(t,e),t.prototype.OnMouseEnter=function(){this.props.onHover(!0)},t.prototype.OnMouseLeave=function(){this.props.onHover(!1)},t.prototype.OnDeleteMessages=function(e){!function(c,l,p){R.b(this,void 0,void 0,function(){var t,n,o,i,r,a,s;return R.e(this,function(e){switch(e.label){case 0:return 0==p.length?[2]:(t=p[0].unAccountID,n=ci.FriendStore.GetPlayer(t).primary_display_name,o=Object($.b)("#Chat_Actions_DeleteChatMessages"),i=Object($.b)("#Chat_Actions_DeleteChatMessages_Confirm",n),r=Object($.b)("#Chat_Actions_Delete"),[4,Sr(c,o,i,r)]);case 1:return e.sent()?[4,l.DeleteChatMessges(p)]:[2];case 2:return 1==(a=e.sent())||(s=15==a?"#Chat_Actions_DeleteChatMessage_FailAccess":"#Chat_Actions_DeleteChatMessage_Fail",i=Object($.b)(s,n),yr(c,o,i)),[2]}})})}(Object(Ci.m)(e),this.props.chatRoom,this.props.messages)},t.prototype.render=function(){return Ee.createElement("div",{className:"ChatMessageBlockDelete",onMouseEnter:this.OnMouseEnter,onMouseLeave:this.OnMouseLeave,onClick:this.OnDeleteMessages,title:Object($.b)("#Chat_Actions_Delete")},Ee.createElement(ui.cb,null))},R.c([T.a],t.prototype,"OnMouseEnter",null),R.c([T.a],t.prototype,"OnMouseLeave",null),R.c([T.a],t.prototype,"OnDeleteMessages",null),t}(Ee.Component);var Up=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return R.d(t,e),t.prototype.shouldComponentUpdate=function(e){return e.rtTimestamp!==this.props.rtTimestamp||e.bUnread!==this.props.bUnread||e.bTimePassesLine!==this.props.bTimePassesLine},t.prototype.render=function(){var e,t=ci.RTime32ToDate(this.props.rtTimestamp),n=["msg","timeDivision"];if(this.props.bUnread){var o={weekday:"long",year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"numeric"};e=Object($.b)("#ChatRoom_New_Messages",t.toLocaleDateString($.a.GetPreferredLocales(),o)),n.push("new_messages")}else if(this.props.bTimePassesLine)e="",n.push("time_passes");else{o={weekday:"long",year:"numeric",month:"long",day:"numeric"};e=t.toLocaleDateString($.a.GetPreferredLocales(),o)}return Ee.createElement(Xc,{style:"timestamp",text:e},Ee.createElement("div",{className:n.join(" ")},Ee.createElement("div",{className:"preHorizDivider"}),e,Ee.createElement("div",{className:"horizDivider"})))},t}(Ee.Component);function jp(e){var t=e.friendRenderContext,n=[],o=[],i=[],r=function(){o.length&&(n.push(Ee.createElement(Mp,{key:o[0].UniqueKey(),messages:o,friendRenderContext:t,tokenPrefix:"#ChatRoom_ServerMessage_Joined"})),o=[])},a=function(){i.length&&(n.push(Ee.createElement(Mp,{key:i[0].UniqueKey(),messages:i,friendRenderContext:t,tokenPrefix:"#ChatRoom_ServerMessage_Parted"})),i=[])};return e.block.messages.forEach(function(e){2==e.eServerMsgType?(a(),o.push(e),4==o.length&&r()):3==e.eServerMsgType?(r(),i.push(e),4==i.length&&a()):(r(),a(),n.push(Ee.createElement(Lp,{key:e.UniqueKey(),msg:e,friendRenderContext:t})))}),r(),a(),Ee.createElement(Ee.Fragment,null,n)}var Hp=function(n){function e(e){var t=n.call(this,e)||this;return t.m_bInitialized=!1,t.LOG=Ae.create(function(){return t.props.chatView.GetUniqueID()},!1),t.m_bLoadHistoryInProgress=!1,t.m_bLoadingOperationInProgress=!1,t.m_bHasPendedLoadOlder=!1,t.m_nIgnoreScrollUpUntilTime=0,t.state={speakerLabelWidth:-1},e.isActive&&t.InitForChatView(e.chatView),t}return R.d(e,n),e.prototype.InitForChatView=function(e){e.AddOnChatFrameChangedCallback(this.OnFrameChanged),this.m_bInitialized=!0},e.prototype.GetScrollTop=function(){return this.LOG("scrollTop is",this.m_elHistoryScroll.scrollTop,"returning",Math.ceil(this.m_elHistoryScroll.scrollTop)),Math.ceil(this.m_elHistoryScroll.scrollTop)},e.prototype.GetScrollInfo=function(){if(this.m_elHistoryScroll){var e=this.m_elHistoryScroll,t=e.scrollHeight,n=e.clientHeight;return{scrollTop:this.GetScrollTop(),scrollHeight:t,clientHeight:n}}return{scrollTop:0,scrollHeight:0,clientHeight:0}},e.prototype.LogScrollInfo=function(e){},e.prototype.DumpChildSizes=function(){},e.prototype.OnHistoryScrollRef=function(e){this.m_elHistoryScroll&&this.m_window&&this.m_window.removeEventListener("resize",this.OnResize),(this.m_elHistoryScroll=e)&&(this.m_window=e.ownerDocument.defaultView,this.m_window.addEventListener("resize",this.OnResize))},e.prototype.OnScrollEvent=function(e){this.LogScrollInfo("*** OnScrollEvent"),this.OnScroll()},e.prototype.OnScroll=function(){var e=this.props.chatView,t=this.GetScrollInfo(),n=t.scrollTop,o=t.scrollHeight,i=t.clientHeight,r=e.lastScrollTop,a=e.lastScrollHeight,s=e.lastClientHeight;if(this.LogScrollInfo("OnScroll"),0!=i){var c=o-n<=i,l=a-r<=s;Object(I.a)(l==e.is_scrolled_to_bottom,e.GetUniqueID()+": computed and stored at bottom don't match"),this.LOG("bAtBottom",c,"bWasAtBottom",l);var p=n;l&&r-p==1&&(this.LOG("*** Scroll position off by one while pinned, ignoring and setting scrollTop to",r),p=r),c||l&&o!=a||p<r&&l&&Date.now()<this.m_nIgnoreScrollUpUntilTime?(this.LogScrollInfo("At bottom"),p<r&&l&&Date.now()<this.m_nIgnoreScrollUpUntilTime&&this.LOG("**** IGNORING APPARENT SCROLL UP WHILE PINNED TO BOTTOM IN LAYOUT"),p=o-i,Object(I.a)(0<=p,e.GetUniqueID()+": Onscroll client height bigger than scroll height"),e.is_scrolled_to_bottom=!0,p!=n&&(this.LOG("Setting scrollTop to",p),this.m_elHistoryScroll.scrollTop=p)):i<s&&l?(this.LogScrollInfo("Shrinking window while pinned to bottom"),p=o-i,e.is_scrolled_to_bottom=!0,p!=n&&(this.LOG("Setting scrollTop to",p),this.m_elHistoryScroll.scrollTop=p)):p<r?(this.LogScrollInfo("Detected scroll up"),e.is_scrolled_to_bottom=c):p!=r&&(this.LogScrollInfo("Detected scroll down but not to bottom"),e.is_scrolled_to_bottom=!1),e.lastScrollTop=p,e.lastScrollHeight=o,e.lastClientHeight=i;var u=!(e.is_scrolled_to_bottom==e.lastScrollHeight-e.lastScrollTop<=e.lastClientHeight);u&&(Object(I.a)(!u,e.GetUniqueID()+": setting mismatched computed and stored"),this.LOG(e.lastScrollTop,e.lastScrollHeight,e.lastClientHeight,e.is_scrolled_to_bottom)),p<10&&this.LoadOlderMessages()}else this.LOG("Onscroll zero clientHeight, ignoring")},e.prototype.ScrollToBottom=function(){var e=this.GetScrollInfo(),t=e.scrollHeight,n=e.clientHeight;this.LogScrollInfo("ScrollToBottom");var o=t-n;Object(I.a)(0<=o,this.props.chatView.GetUniqueID()+": ScrollToBottom client height bigger than scroll height"),this.m_animation&&this.m_animation.Cancel(),this.m_animation=new Ei(this.m_elHistoryScroll,{scrollTop:o},{msDuration:300,timing:"sine",onComplete:function(){}}),this.m_animation.Start()},e.prototype.LoadOlderMessages=function(){var o=this,i=this.props.chatView,e=i.chat;if(e.IsMoreHistoryAvailable()){if(this.m_bLoadingOperationInProgress)return this.LOG("noting pended load"),void(this.m_bHasPendedLoadOlder=!0);var r=function(){return e.LoadMoreHistory().then(function(e){var t=o.GetScrollInfo().scrollHeight,n=i.lastScrollTop+t-i.lastScrollHeight;return o.LogScrollInfo("LoadOlderMessags"),o.m_elHistoryScroll.scrollTop=n,o.m_bHasPendedLoadOlder?(o.LOG("LoadOlderMessages starting pended"),o.m_bHasPendedLoadOlder=!1,r()):(o.m_bLoadingOperationInProgress=!1,e)})};this.LOG("LoadOlderMessages starting"),this.m_bLoadHistoryInProgress=!0,this.m_bLoadingOperationInProgress=!0,this.DoAndDelay(this.m_window,r,500).then(function(e){o.LOG("loading over"),o.m_bLoadHistoryInProgress=!1})}},e.prototype.DoAndDelay=function(o,e,i){var r=performance.now();return e().then(function(t){var n=performance.now()-r;return n<i?new Promise(function(e){return o.setTimeout(e.bind(null,t),i-n)}):t})},e.prototype.Focus=function(){this.m_elHistoryScroll&&this.m_elHistoryScroll.focus()},e.prototype.componentDidMount=function(){if(this.LOG("ComponentDidMount"),this.m_elHistoryScroll&&this.props.chatView.is_scrolled_to_bottom){var e=this.props.chatView,t=this.GetScrollInfo(),n=t.scrollHeight,o=t.clientHeight;e.lastScrollTop=n-o,e.lastScrollHeight=n,e.lastClientHeight=o,this.m_elHistoryScroll.scrollTop=e.lastScrollTop,Object(I.a)(e.is_scrolled_to_bottom==e.lastScrollHeight-e.lastScrollTop<=e.lastClientHeight,e.GetUniqueID()+": setting mismatched computed and stored")}},e.prototype.componentDidUpdate=function(){var e=this.props.chatView,t=this.GetScrollInfo(),n=t.scrollTop,o=t.scrollHeight,i=t.clientHeight,r=e.lastScrollTop,a=e.lastScrollHeight;if(0!=i){var s=n;o==a?s=r:o-n<=i&&(s=o-i),this.LogScrollInfo("componentDidUpdate"),this.DelayedScrollTo(s)}else this.LOG("componentDidUpdate clientHeight == 0, ignoring")},e.prototype.componentWillUnmount=function(){this.m_window&&(this.m_window.removeEventListener("resize",this.OnResize),this.m_window=void 0),this.props.chatView.RemoveOnChatFrameChangedCallback(this.OnFrameChanged)},e.prototype.componentWillReceiveProps=function(e){e.chatView!=this.props.chatView&&(this.props.chatView.RemoveOnChatFrameChangedCallback(this.OnFrameChanged),this.m_bInitialized=!1),!this.m_bInitialized&&e.isActive&&this.InitForChatView(e.chatView)},e.prototype.GetFriendRenderContext=function(){return this.m_FriendRenderContext&&this.m_FriendRenderContext.chat==this.props.chatView.chat||(this.m_FriendRenderContext={chatContext:"message",chat:this.props.chatView.chat}),this.m_FriendRenderContext},e.prototype.OnFrameChanged=function(){var e,t=this.props.chatView,n=this.GetScrollInfo(),o=n.scrollHeight,i=n.clientHeight,r=t.lastScrollTop,a=t.lastScrollHeight,s=t.lastClientHeight;this.LogScrollInfo("OnFrameChanged"),this.m_nIgnoreScrollUpUntilTime=Date.now()+300,e=t.is_scrolled_to_bottom?(this.LOG("OnFrameChanged scrolling to bottom"),o-i):(this.LOG("OnFrameChanged preserving bottom"),r+s+o-a-i),this.LOG("OnFrameChanged setting scrollTop to",e),this.DelayedScrollTo(e)},e.prototype.DelayedScrollTo=function(e){var t=this;this.LOG("DelayedScrollTo",e),this.m_elHistoryScroll.scrollTop=e,this.m_window.setTimeout(function(){t.LOG("DelayedOnScroll firing",e),t.OnScroll()},30)},e.prototype.OnUpdate=function(e){var t=this.props.chatView,n=this.GetScrollInfo(),o=n.scrollHeight,i=n.clientHeight;if(this.LogScrollInfo("OnUpdate for "+e),this.LOG("Scrolled to bottom is",t.is_scrolled_to_bottom),0==o)this.LOG("OnUpdate zero scroll height");else if(t.is_scrolled_to_bottom){this.LogScrollInfo("OnUpdate currently scrolled to bottom");var r=o-i;this.DelayedScrollTo(r)}else if(t.chat.BIsPrepend){t.chat.ResetPrepended();var a=t.lastScrollTop,s=t.lastScrollHeight,c=t.lastClientHeight;this.LogScrollInfo("OnUpdate prepended messages");r=a+c+o-s-i;this.DelayedScrollTo(r)}else this.LogScrollInfo("OnUpdate content updated, doing nothing")},e.prototype.OnResize=function(){var e=this.GetScrollInfo(),t=e.scrollTop,n=e.scrollHeight,o=e.clientHeight;this.LogScrollInfo("OnResize");var i=t;n-t<=o&&(i=n-o),this.DelayedScrollTo(i)},e.prototype.Swallow=function(e){e.stopPropagation(),e.preventDefault()},e.prototype.render=function(){if(!this.m_bInitialized)return null;var e=this.props,t=e.chatView,n=e.speakerLabelWidth,o=e.blockInteraction,i=t.chat,r=this.GetFriendRenderContext(),a=n&&Math.max(Math.min(n,120),50);this.LOG("Render"),i.LoadChatLogs();var s=null;if(i instanceof kt){var c="currentTextChannelName";i.IsDefaultRoomForGroup()&&(c+=" DefaultChatRoom"),s=Ee.createElement("div",{className:c},"#",i.name)}var l=ci.SettingsStore.FriendsSettings.nChatFontSize,p="ChatHistoryContainer";return l==gs.k_EChatFontSizeSmall?p+=" smallChatFont":l==gs.k_EChatFontSizeLarge&&(p+=" largeChatFont"),Ee.createElement("div",{className:p},o&&Ee.createElement("div",{className:"interactionBlocker",onClick:this.Swallow}),s,Ee.createElement("div",{className:"friendsListInsetShadowCtn"},Ee.createElement("div",{className:"friendListInsetShadowTop"})),Ee.createElement(Wp,{chatHistory:this,chatView:t}),Ee.createElement("div",{className:"chatHistoryScroll",ref:this.OnHistoryScrollRef,onScroll:this.OnScrollEvent,tabIndex:0},Ee.createElement("div",{className:"chatHistory"},Ee.createElement(Ap,{chatView:t,friendRenderContext:r,onUpdate:this.OnUpdate,speakerWidth:a}),Ee.createElement("div",{className:"disconnectBlocker"}))),Ee.createElement(cu,{chatView:t}),Ee.createElement(zp,{chatView:t,action:this.ScrollToBottom}),Ee.createElement("div",{className:"friendsListInsetShadowCtn"},Ee.createElement("div",{className:"friendListInsetShadowBottom"})))},R.c([d.observable],e.prototype,"m_bLoadHistoryInProgress",void 0),R.c([T.a],e.prototype,"DumpChildSizes",null),R.c([T.a],e.prototype,"OnHistoryScrollRef",null),R.c([T.a],e.prototype,"OnScrollEvent",null),R.c([T.a],e.prototype,"OnScroll",null),R.c([T.a],e.prototype,"ScrollToBottom",null),R.c([T.a],e.prototype,"LoadOlderMessages",null),R.c([T.a],e.prototype,"OnFrameChanged",null),R.c([T.a],e.prototype,"OnUpdate",null),R.c([T.a],e.prototype,"OnResize",null),R.c([T.a],e.prototype,"Swallow",null),e=R.c([or.observer],e)}(Ee.Component),Wp=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return R.d(t,e),t.prototype.render=function(){var e="LoadingOlderMessages";return this.props.chatHistory.m_bLoadHistoryInProgress||(e+=" Hidden"),Ee.createElement("div",{className:e},Ee.createElement("span",null,Object($.b)("#Chat_Loading")))},t=R.c([or.observer],t)}(Ee.Component),zp=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return R.d(t,e),t.prototype.render=function(){var e=this.props,t=e.chatView,n=e.action,o="ScrollToBottomButton";t.is_scrolled_to_bottom&&(o+=" Hidden");var i=Object($.b)("#Chat_ScrollToBottom");return 0<t.chat.unread_message_count&&(i=Object($.c)("#Chat_UnreadMessages",t.chat.unread_message_count),o+=" UnreadMessages"),Ee.createElement("div",{className:o,onClick:n},Ee.createElement("span",null,i))},t=R.c([or.observer],t)}(Ee.Component);function qp(e,t){var n;if(n="currentTarget"in e?e.currentTarget.ownerDocument.defaultView:e,"undefined"!=typeof SteamClient&&void 0!==SteamClient.SharedConnection){var o=ld(n);SteamClient.WebChat.OpenURLInClient(t,o.m_unPID)}else 0==t.indexOf("steam://")?n.location.href=t:n.open(t,null,"menubar,location,resizable,scrollbars,status,noopener")}var Kp=function(n){function e(e){var t=n.call(this,e)||this;return t.m_keyEventListener="keydown",t.macUserAgentStrings=/(MacIntel|Macintosh|Mac OS X)/,t.linuxUserAgentStrings=/(Linux|X11)/,-1==navigator.userAgent.search(t.macUserAgentStrings)&&-1==navigator.userAgent.search(t.linuxUserAgentStrings)||(t.m_keyEventListener="keyup"),t.props.popup&&t.props.popup.addEventListener(t.m_keyEventListener,t.OnHTMLKeyEvent),t}return R.d(e,n),e.prototype.componentWillUnmount=function(){this.props.popup&&this.props.popup.removeEventListener(this.m_keyEventListener,this.OnHTMLKeyEvent)},e.prototype.OnCopy=function(e){if(this.props.popup){var t=this.props.popup.getSelection();if(0!=t.rangeCount){for(var n="",o="",i=!1,r=t.getRangeAt(0).cloneContents(),a=(r.querySelector("[data-activechat=true]")||r).querySelectorAll("[data-copytext]"),s=Array.from(a).map(function(e){return e.getAttribute("data-copystyle")||"msg"}),c=0;c<a.length;++c){var l=a[c],p=s[c];if(!(c+1<a.length&&Object(Ci.d)(l,a[c+1]))){var u=l.tagName.toLowerCase(),m=p.includes("block"),d=p.includes("timestamp"),h=p.includes("server"),_=p.includes("invite"),f=p.includes("emote"),g=p.includes("no-prefix"),b=p.includes("no-suffix"),v=p.includes("allow-embedded-newlines"),S=p.includes("block-continue"),y=p.includes("merge-adjacent"),C=p.includes("force-display"),I=p.includes("prepend-innertext"),E=p.includes("append-innertext"),O=p.includes("prepend-newline"),w=p.includes("append-newline"),M=p.includes("speaker");if(!C){var D=null!=u.match(/img|iframe/),T=null!=l.querySelector("img,iframe");if(!l.innerText&&!D&&!T)continue}y&&(0<c&&s[c-1].includes("merge-adjacent")&&(g=!0),c+1<s.length&&s[c+1].includes("merge-adjacent")&&(b=!0)),M&&(i=!0);var G="";d||M||h||_||f?(0!=n.length&&(G+="\n"),(h||_)&&(G+="\t\t")):(i&&(G+="\t"),o.includes("msg")&&m&&(O=!0),o.includes("block")&&!S&&(O=!0));var R=l.getAttribute("data-copytext");0==R.length?R=l.innerText:I&&0<l.innerText.length?R=l.innerText+(p.includes("-with-newline")?"\n":" ")+R:E&&0<l.innerText.length&&(R+=(p.includes("-with-newline")?"\n":" ")+l.innerText),0!=R.length&&(O&&(n+="\n"),g||(n+=G),n+=v?R:R.replace(/\n/g,"\n"+G),b||(n+="\n"),w&&(n+="\n")),o=p}}0!=n.length&&("Win32"===this.props.popup.navigator.platform&&(n=n.replace(/\n/g,"\r\n")),e.clipboardData.setData("text",n),e.preventDefault())}}},e.prototype.OnChatTabRef=function(e){this.m_refChatTabs=e},e.prototype.OnDragEnter=function(e){if(Object(I.a)(e&&("chattab"==e.type||"friend"==e.type||"chatroomgroup"==e.type),"Invalid data type passed to MultiChatDialog.OnDragEnter",e.type),"chattab"==e.type){var t=this.props.tabs,n=e;(n.tabSet!=t||1<t.tabCount)&&(t.Focus(),this.m_refChatTabs&&this.m_refChatTabs.GetDragTab()!=n.tab&&this.m_refChatTabs.SetDragTab(n.tab))}return!0},e.prototype.OnDragLeave=function(){this.m_refChatTabs&&this.m_refChatTabs.SetDragTab(void 0)},e.prototype.OnDragOver=function(e){this.m_refChatTabs&&this.m_refChatTabs.UpdateDragOffset(e)},e.prototype.OnDrop=function(e,t){if(Object(I.a)(e&&("chattab"==e.type||"friend"==e.type||"chatroomgroup"==e.type),"Invalid data type passed to MultiChatDialog.OnDrop",e.type),"chattab"==e.type){var n=e,o=-1;this.m_refChatTabs&&(o=this.m_refChatTabs.state.iDragIndex),_d.DragDropManager.SetDropConsumed(),n.tabSet!=this.props.tabs&&(n.tabSet.RemoveTab(n.tab),this.props.tabs.AddTab(n.tab),_d.DragDropManager.EndDrag()),-1!=o&&this.props.tabs.MoveTabToIndex(n.tab,o),this.props.tabs.ActivateTab(n.tab),this.setState({tabDrag:void 0})}else if("friend"==e.type){_d.DragDropManager.SetDropConsumed(),e.friend.OpenChatDialog(cd(this,t))}else if("chatroomgroup"==e.type){_d.DragDropManager.SetDropConsumed();var i=e;ci.UIStore.ShowAndOrActivateChatRoomGroup(cd(this),i.group,!0)}},e.prototype.OnHTMLKeyEvent=function(e){if(G.a.IN_CLIENT&&e.ctrlKey&&!e.altKey){if(!e.shiftKey&&9==e.keyCode||34==e.keyCode)this.props.tabs.ActivateNextTab();else if(9==e.keyCode||33==e.keyCode)this.props.tabs.ActivatePreviousTab();else{if("W"!=e.key&&"w"!=e.key)return;this.props.tabs.RemoveTab(this.props.tabs.activeTab)}return e.preventDefault(),void e.stopPropagation()}},e.prototype.OnKeyDown=function(e){var t=this.props.tabs.activeTab;if(t&&!(e.ctrlKey||e.altKey||e.metaKey||1<e.key.length)){var n=e.target,o=n&&n.tagName?n.tagName.toLowerCase():"";"input"!=o&&"select"!=o&&"textarea"!=o&&t.GetChatView().FocusTextInput()}},e.prototype.render=function(){var i=this,r=this.props.tabs.activeTab;this.m_refChatTabs&&this.m_refChatTabs.GetDragTab()&&(r=this.m_refChatTabs.GetDragTab());var e=this.props.tabs.tabs.slice();this.m_refChatTabs&&this.m_refChatTabs.GetDragTab()&&-1==e.indexOf(this.m_refChatTabs.GetDragTab())&&e.push(this.m_refChatTabs.GetDragTab()),e.sort(function(e,t){return e.GetUniqueID()<t.GetUniqueID()?1:-1});var t=e.map(function(e){var t=null,n=e instanceof xt&&e,o=e instanceof _o;return t=n?Ee.createElement(eu,{groupView:n,isActive:e==r,popup:i.props.popup}):o?Ee.createElement(ou,{broadcastView:e,isActive:e==r,popup:i.props.popup}):Ee.createElement(Qp,{chatView:e.GetChatView(),isActive:e==r}),Ee.createElement(ar,{key:e.GetUniqueID()},t)});return Ee.createElement(nr,{className:"multiChatDialog",rgAcceptedTypes:["chattab","friend","chatroomgroup"],fnDragEnter:this.OnDragEnter,fnDragOver:this.OnDragOver,fnDragLeave:this.OnDragLeave,fnDrop:this.OnDrop,onKeyDown:this.OnKeyDown,onCopy:this.OnCopy,tabIndex:0},Ee.createElement(El,{tabSet:this.props.tabs,popup:this.props.popup,activeTab:r,ref:this.OnChatTabRef,ResponsiveWindowState:this.props.ResponsiveWindowState,showOpenFriendsList:this.props.showOpenFriendsList}),Ee.createElement("div",{className:"chatDialogs"},0==t.length&&Ee.createElement("div",{className:"emptyChatDialogs"},Object($.b)("#Chat_EmptyDialogsWindowMsg")),t))},R.c([T.a],e.prototype,"OnCopy",null),R.c([T.a],e.prototype,"OnChatTabRef",null),R.c([T.a],e.prototype,"OnDragEnter",null),R.c([T.a],e.prototype,"OnDragLeave",null),R.c([T.a],e.prototype,"OnDragOver",null),R.c([T.a],e.prototype,"OnDrop",null),R.c([T.a],e.prototype,"OnHTMLKeyEvent",null),R.c([T.a],e.prototype,"OnKeyDown",null),e=R.c([or.observer],e)}(Ee.Component),Yp=function(t){function e(e){return t.call(this,e)||this}return R.d(e,t),e.prototype.InitiateVoiceChat=function(){var e=this.props.chatView.chat.accountid_partner;ci.VoiceStore.InitiateFriendChat(e)},e.prototype.VoidOnClick=function(){},e.prototype.EndVoiceChat=function(){ci.VoiceStore.GetActiveOneOnOneVoiceChatAccountID()==this.props.chatView.chat.accountid_partner&&ci.VoiceStore.OnUserEndVoiceChat()},e.prototype.OnCloseClick=function(){ci.VoiceStore.GetActiveOneOnOneVoiceChatAccountID()==this.props.chatView.chat.accountid_partner?ci.VoiceStore.OnUserEndVoiceChat():ci.VoiceStore.OnRejectOneOnOneVoiceChatForPartner(this.props.chatView.chat.accountid_partner)},e.prototype.render=function(){var e=ci.VoiceStore.BInitiatedOneOnOneChat(this.props.chatView.chat.accountid_partner),t=ci.CMInterface.steamid.GetAccountID(),n=this.props.chatView.chat.accountid_partner,o=ci.FriendStore.GetPlayer(t),i=ci.VoiceStore.BSelfHasAcceptedOrInitiatedOneOnOneChat(n),r=ci.VoiceStore.BSelfHadPreviouslyJoinedOneOnOneChat(n),a=this.props.chatView.chat.chat_partner,s=ci.VoiceStore.BPartnerHasAcceptedOrInitiatedOneOnOneChat(n),c=!i&&ci.VoiceStore.BPartnerHasRequestedAndIsInOneOnOneChat(a.accountid),l=void 0;l=e||i?Ee.createElement(li,{key:t,classNames:"friend-anim",timeout:320},Ee.createElement(zc,{friend:o,key:t,showVoiceLevel:!0,context:{chat:this.props.chatView.chat},listStatusIndicator:Ee.createElement("div",{className:"connectionSpinner"})})):Ee.createElement(li,{key:t,classNames:"friend-anim",timeout:320},Ee.createElement("div",{className:"friend emptyFriend",onClick:!i&&this.InitiateVoiceChat},Ee.createElement("div",{className:"avatarHolder"},Ee.createElement("img",{className:"avatar",src:"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA",draggable:!1}))));var p=new Array;e&&p.push(l),s||c?p.push(Ee.createElement(li,{key:n,classNames:"friend-anim",timeout:320},Ee.createElement(zc,{friend:a,key:n,showVoiceLevel:!0,context:{chat:this.props.chatView.chat},listStatusIndicator:Ee.createElement("div",{className:"connectionSpinner"})}))):p.push(Ee.createElement(li,{key:n,classNames:"friend-anim",timeout:320},Ee.createElement("div",{className:"friend emptyFriend",onClick:i?this.VoidOnClick:this.InitiateVoiceChat},Ee.createElement("div",{className:"avatarHolder "},Ee.createElement("img",{className:"avatar",src:"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA",draggable:!1}))))),e||p.push(l);var u=void 0;u=i&&s?Ee.createElement("button",{className:"inviteButton inviteButtonJoinVoice",onClick:this.EndVoiceChat},Object($.b)("#Voice_StopTalking")):i&&!s?Ee.createElement("button",{className:"inviteButton inviteButtonJoinVoice",onClick:this.EndVoiceChat},Object($.b)("#Voice_EndVoice")):Ee.createElement("button",{className:"inviteButton inviteButtonJoinVoice",onClick:this.InitiateVoiceChat},Object($.b)("#Voice_StartTalking"));var m="",d="OneOnOneVoiceRoomControls",h=!1;i&&!s?(m=Object($.b)("#Voice_WaitingForFriendToJoin",a.display_name),d+=" WaitingForPartner"):s&&!i?(r?m=Object($.b)("#Voice_ChannelRejoinAvailable",a.display_name):(m=Object($.b)("#Voice_ChannelAvailable",a.display_name),d+=" WaitingForYouFirstTime"),d+=" WaitingForYou"):(m=Object($.b)("#Voice_ChannelActive",a.display_name),d+=" OneOnOneVoiceActive",h=!0);var _=Ee.createElement("div",{className:"OneOnOneVoiceStatusLabel"},m);return Ee.createElement("div",{className:d},Ee.createElement("div",{className:"VoiceToggleIconCtn"},Ee.createElement(ui.gb,null),Ee.createElement("div",{className:"Sonar"},Ee.createElement("div",{className:"SonarCircle"}))),Ee.createElement("div",{className:"OneOnOneVoiceMembers"},u,p,_),!h&&Ee.createElement("div",{className:"OneOnOneVoiceClose",onClick:this.OnCloseClick,title:i?Object($.b)("#Voice_EndVoice"):Object($.b)("#Tooltip_DismissVoice")},Ee.createElement(ui.jb,null)))},R.c([T.a],e.prototype,"InitiateVoiceChat",null),R.c([T.a],e.prototype,"VoidOnClick",null),R.c([T.a],e.prototype,"EndVoiceChat",null),R.c([T.a],e.prototype,"OnCloseClick",null),e=R.c([or.observer],e)}(Ee.Component);function Jp(e,t,n){var o,i=!1,r=!0;if(e.invitedto instanceof ft)o=300;else if(e.invitedto instanceof Vt){o=340,(a=e.invitedto).BCanInvite()||a.BHasMember(e.invitee.accountid)||(r=!1)}else if(e.invitedto instanceof kt){var a;i=!0,o=340,(a=e.invitedto.GetGroup()).BCanInvite()||a.BHasMember(e.invitee.accountid)||(r=!1)}r?fr(Ee.createElement(Xp,R.a({},e)),n,"InviteDialog",{strTitle:i?Object($.b)("#Chat_Actions_InviteFriend_VoiceChat"):Object($.b)("#Chat_Actions_DropGroupInvite_Title"),popupWidth:650,popupHeight:o},pd(n)):yr(n,Object($.b)("#Chat_Actions_DropGroupInvite_Denied"),Object($.b)("#Chat_Actions_DropGroupInvite_Denied_Description"))}var Xp=function(n){function e(e){var t=n.call(this,e)||this;return t.invitee=t.props.invitee,t}return R.d(e,n),e.prototype.AddMoreFriends=function(e){var t=[],n=e.currentTarget.ownerDocument.defaultView;t.push(this.invitee.accountid),this.props.invitedto instanceof ft?qs(cd(this,e),n,this.props.chatview,!0,t):this.props.invitedto instanceof Vt?ma(cd(this,e),n,this.props.invitedto,void 0,!0,t):this.props.invitedto instanceof kt&&ua(cd(this,e),n,this.props.invitedto.GetGroup(),this.props.invitedto,t),this.props.closeModal()},e.prototype.Cancel=function(){this.props.closeModal()},e.prototype.componentDidMount=function(){var e=W.findDOMNode(this);if(e){var t=e.querySelector("button[type=submit]");t&&t.focus()}},e.prototype.OnInviteClicked=function(e){var t=e.currentTarget.ownerDocument.defaultView;if(this.props.invitedto instanceof ft)this.invitedToPlayer=this.props.invitedto,(n=[]).push(this.invitedToPlayer.persona.m_steamid.ConvertTo64BitString()),n.push(this.invitee.persona.m_steamid.ConvertTo64BitString()),Ks(t,this.props.chatview,n);else if(this.props.invitedto instanceof Vt)this.invitedToGroup=this.props.invitedto,this.invitedToGroup.InviteFriend(this.invitee.accountid);else if(this.props.invitedto instanceof kt){var n;(n=[]).push(this.invitee.accountid),this.invitedToChatRoom=this.props.invitedto,this.invitedToChatRoom.GetGroup().InviteFriend(this.invitee.accountid,this.invitedToChatRoom)}this.props.closeModal()},e.prototype.render=function(){var e,t,n,o=this.props.invitee,i=ci.FriendStore.self,r=!1;this.props.invitedto instanceof ft?e=this.props.invitedto:this.props.invitedto instanceof Vt?t=this.props.invitedto:this.props.invitedto instanceof kt&&(n=this.props.invitedto);var a,s,c=!o.is_in_beta,l=e&&!e.is_in_beta,p="#Chat_Actions_DropGroupInvite_Confirm",u=!1;t?(t.BIsUserGroupMember(o)&&(p="#Chat_Actions_DropGroupInvite_Member_Confirm"),r=!!t.BIsClanChatRoom()&&ci.FriendStore.ClanStore.GetClan(t.GetClanID()).BIsOGG(),a=t.name,s=Ee.createElement(xs,{group:t,name:t.name}),u=t.BIsUserGroupMember(o)):e?(p="#Chat_Actions_DropGroupInvite_1v2_Confirm",a=e.display_name,s=Ee.createElement("div",{className:"displayRow"},Ee.createElement("div",{className:"dropGroupInviteDialog_Friend"},Ee.createElement("img",{src:i.persona.avatar_url_medium})),Ee.createElement("div",{className:"dropGroupInviteDialog_Friend"},Ee.createElement("img",{src:e.persona.avatar_url_medium})))):n&&(p="#Chat_Actions_DropVoiceInvite_Confirm",a=n.name,s=Ee.createElement("div",{className:"displayRow"},Ee.createElement(ui.gb,null)));var m=null,d=!0;return ci.IsInBeta()&&(d=!c&&!l,l&&c?m=Ee.createElement("span",{className:"dropGroupInviteDialog_Desc"},Object($.b)("#Chat_InviteFriend_Unavailable_Short_NoBetas")):c?m=Ee.createElement("span",{className:"dropGroupInviteDialog_Desc"},Object($.d)("#Chat_InviteFriend_Unavailable_Short",Ee.createElement("span",{className:"whiteText"},o.display_name))):l&&(m=Ee.createElement("span",{className:"dropGroupInviteDialog_Desc"},Object($.d)("#Chat_InviteFriend_Unavailable_Short_InvitedTo",Ee.createElement("span",{className:"whiteText"},e.display_name))))),Ee.createElement(sr,{onEscKeypress:this.Cancel},Ee.createElement(Fi,{classNameContent:"GenericConfirmDialog",onSubmit:this.OnInviteClicked,bCenterVertically:!0},Ee.createElement(wi,null,n?Object($.b)("#Chat_Actions_InviteFriend_VoiceChat"):Object($.b)("#Chat_Actions_DropGroupInvite_Title")),Ee.createElement(Gi,null,Ee.createElement("div",{className:"dropGroupInviteDialog displayColumn"+(t||n?" groupInviteHeight":"")},d&&Ee.createElement("span",{className:"dropGroupInviteDialog_Desc"},Object($.d)(p,Ee.createElement("span",{className:"highlight"},o.display_name),Ee.createElement("span",{className:"highlight"},a),e&&Ee.createElement("span",{className:"highlight"},Object($.b)("#Chat_You")))),m,Ee.createElement("div",{className:"dropGroupInviteDialog_Graphic"+(r?" isOGGGroup":"")},Ee.createElement("div",{className:"dropGroupInviteDialog_Friend"},Ee.createElement("img",{src:o.persona.avatar_url_medium})),d?Ee.createElement("div",{className:"movingArrow"},Ee.createElement(ui.b,{angle:90})):Ee.createElement("div",{className:"staticX"},Ee.createElement(ui.jb,null)),s,Ee.createElement("div",{className:"addMoreFriendsButton",onClick:this.AddMoreFriends},Ee.createElement("div",null,Object($.b)("#Chat_Actions_AddMoreFriends")),Ee.createElement("div",{className:"ExpandArrow"}))))),Ee.createElement(Mi,null,Ee.createElement(Li,null,Ee.createElement(Vi,{disabled:c||l,onClick:this.OnInviteClicked},u?Object($.b)("#Chat_SendLink"):Object($.b)("#Chat_Invite")," "),Ee.createElement(xi,{onClick:this.Cancel},Object($.b)("#Button_Cancel"))))))},R.c([T.a],e.prototype,"AddMoreFriends",null),R.c([T.a],e.prototype,"Cancel",null),R.c([T.a],e.prototype,"OnInviteClicked",null),e=R.c([or.observer],e)}(Ee.Component),Qp=function(n){function e(e){var t=n.call(this,e)||this;return t.m_fnUnregisterDropComplete=void 0,t.m_bChatHidden=!1,t.m_refBroadcastContainer=Ee.createRef(),t.state={dropToInviteFriend:void 0,dropGroupToInviteFriend:void 0,dropClanToInvite:void 0,speakerLabelWidth:0},t.m_friendSteamId=D.a.InitFromAccountID(e.chatView.chat.accountid_partner).ConvertTo64BitString(),t}return R.d(e,n),e.prototype.OnDragEnter=function(e,t){if(e?Object(I.a)("friend"==e.type||"chatroomgroup"==e.type||"clan"==e.type,"Invalid data type passed to FriendChatDialog.OnDrop"):Object(I.a)(t,"Invalid data type passed to FriendChatDialog.OnDrop"),!e)return!0;var n="friend"==e.type?e.friend:void 0;if(n&&n.accountid!==this.props.chatView.chat.accountid_partner)return this.m_fnUnregisterDropComplete||(this.m_fnUnregisterDropComplete=_d.DragDropManager.RegisterForDropComplete(this.OnDropComplete)),this.setState({dropToInviteFriend:n}),!0;var o="chatroomgroup"==e.type?e.group:void 0;if(o)return this.m_fnUnregisterDropComplete||(this.m_fnUnregisterDropComplete=_d.DragDropManager.RegisterForDropComplete(this.OnDropComplete)),this.setState({dropGroupToInviteFriend:o}),!0;var i="clan"==e.type?e.clan:void 0;return i&&(this.m_fnUnregisterDropComplete||(this.m_fnUnregisterDropComplete=_d.DragDropManager.RegisterForDropComplete(this.OnDropComplete)),this.setState({dropClanToInvite:i})),!0},e.prototype.OnDragLeave=function(){(this.state.dropToInviteFriend||this.state.dropGroupToInviteFriend||this.state.dropClanToInvite)&&(this.m_fnUnregisterDropComplete.Unregister(),this.m_fnUnregisterDropComplete=void 0,this.setState({dropToInviteFriend:void 0,dropGroupToInviteFriend:void 0,dropClanToInvite:void 0}))},e.prototype.OnDragOver=function(e){e.dataTransfer.dropEffect="move"},e.prototype.OnDrop=function(e,t){e?Object(I.a)("friend"==e.type||"chatroomgroup"==e.type||"clan"==e.type,"Invalid data type passed to FriendChatDialog.OnDrop"):Object(I.a)(0!=t.dataTransfer.files.length,"Invalid data type passed to FriendChatDialog.OnDrop");var n=this.props.chatView;if(e){var o=t.currentTarget.ownerDocument.defaultView,i=n.chat.chat_partner,r="friend"==e.type?e.friend:void 0,a="chatroomgroup"==e.type?e.group:void 0,s="clan"==e.type?e.clan:void 0;if(r){if(i==r)return;this.state.dropToInviteFriend&&(this.m_fnUnregisterDropComplete.Unregister(),this.m_fnUnregisterDropComplete=void 0,this.setState({dropToInviteFriend:void 0})),_d.DragDropManager.SetDropConsumed(),Jp({invitee:r,chatview:n,invitedto:i},cd(this,t),o)}else(a||s)&&((this.state.dropGroupToInviteFriend||this.state.dropClanToInvite)&&(this.m_fnUnregisterDropComplete.Unregister(),this.m_fnUnregisterDropComplete=void 0,this.setState({dropGroupToInviteFriend:void 0,dropClanToInvite:void 0})),_d.DragDropManager.SetDropConsumed(),s&&(a=ci.ChatStore.GetChatRoomGroup(s.GetChatGroupIDIfLoaded())),Jp({invitee:i,invitedto:a},cd(this,t),o))}else if(0!=t.dataTransfer.files.length){var c=t.dataTransfer.files[0];n.SetFileToUpload(c)}},e.prototype.OnDropComplete=function(e){!e&&this.state.dropToInviteFriend&&(this.m_fnUnregisterDropComplete=void 0,this.setState({dropToInviteFriend:void 0}))},e.prototype.OnNameWidthChanged=function(e){this.setState({speakerLabelWidth:e})},e.prototype.componentDidMount=function(){window.addEventListener("resize",this.OnLayoutChange)},e.prototype.componentWillUnmount=function(){window.removeEventListener("resize",this.OnLayoutChange)},e.prototype.CalculateBroadcastSectionStyles=function(e){if(this.m_bChatHidden)return{width:"100%",height:"100%"};var t=_d.UIDisplayPrefs,n=t.nWatchPartyBroadcastHeightPercentage,o=t.nWatchPartyBroadcastWidthPercentage,i={};if(e){var r=n||66;if(i.height=r+"%",this.m_elMainContent){var a=this.m_elMainContent,s=a.clientWidth,c=a.clientHeight,l=9/16*s+50,p=Object(_n.a)(r,1,l/c*100);i.height=p+"%"}}else i.width=o?o+"%":"66%",i.overflowY="auto";return i},e.prototype.ShouldShowVerticalBroadcastChat=function(){return void 0!==this.m_bShowVerticalBroadcastChat?this.m_bShowVerticalBroadcastChat:!!this.m_elMainContent&&this.m_elMainContent.clientHeight/this.m_elMainContent.clientWidth>5/7},e.prototype.OnLayoutChange=function(){this.forceUpdate()},e.prototype.OnGrabberMouseDown=function(e){var t=e.currentTarget.ownerDocument.defaultView;t.addEventListener("mousemove",this.HandleMouseMove),t.addEventListener("mouseup",this.UnregisterDragEvents)},e.prototype.HandleMouseMove=function(e){e.preventDefault(),e.stopPropagation();var t=this.m_refBroadcastContainer.current.getBoundingClientRect(),n=this.m_refBroadcastContainer.current.parentElement.getBoundingClientRect(),o=this.ShouldShowVerticalBroadcastChat(),i=o?t.top:t.left,r=o?e.clientY:e.clientX,a=o?n.height:n.width,s=Object(_n.a)((r-i)/a*100,1,100),c=o?"nWatchPartyBroadcastHeightPercentage":"nWatchPartyBroadcastWidthPercentage";_d.SetUIDisplayPref(c,s)},e.prototype.UnregisterDragEvents=function(e){e.view.removeEventListener("mousemove",this.HandleMouseMove),e.view.removeEventListener("mouseup",this.UnregisterDragEvents)},e.prototype.HideChat=function(){this.SetChatHidden(!0)},e.prototype.ShowChat=function(){this.SetChatHidden(!1)},e.prototype.SetChatHidden=function(e){this.m_bChatHidden=e,this.forceUpdate()},e.prototype.ShowBroadcast=function(){var e=this;ci.UIStore.SetFriendBroadcastVisible(this.m_friendSteamId,!0),SetBackgroundTimeout(function(){e.props.chatView.OnChatFrameChanged()},30)},e.prototype.HideBroadcast=function(){var e=this;ci.UIStore.SetFriendBroadcastVisible(this.m_friendSteamId,!1),ci.UIStore.SetTheaterMode(!1),SetBackgroundTimeout(function(){e.props.chatView.OnChatFrameChanged()},30)},e.prototype.ToggleVerticalBroadcastChat=function(){this.SetVerticalBroadcastChat(!this.ShouldShowVerticalBroadcastChat()),this.SetChatHidden(!1)},e.prototype.ToggleTheaterModeBroadcastChat=function(){ci.UIStore.SetTheaterMode(!ci.UIStore.GetTheaterMode())},e.prototype.SetVerticalBroadcastChat=function(e){this.m_bShowVerticalBroadcastChat=e},e.prototype.SetLocalBroadcastId=function(e){this.m_strLocalBroadcastId=e},e.prototype.SetMainContentRef=function(e){this.m_elMainContent=e,this.OnLayoutChange()},e.prototype.GetTitleBarDragDropProps=function(){var e={rgAcceptedTypes:[],bAcceptsFiles:!0};return e.fnDrop=this.OnDrop,e},e.prototype.GetChatBodyDragDropProps=function(){var e={rgAcceptedTypes:["friend"],bAcceptsFiles:!0};return e.fnDragEnter=this.OnDragEnter,e.fnDragLeave=this.OnDragLeave,e.fnDragOver=this.OnDragOver,e.fnDrop=this.OnDrop,e},e.prototype.RenderInnerChatTabs=function(){return Ee.createElement("div",{className:"ChatBodyControls"},Ee.createElement("div",{className:"Close",onClick:this.HideChat,title:Object($.b)("#Broadcast_View_HideChat")},Ee.createElement(ui.v,{showChat:!1})),Ee.createElement($p,{chatView:this.props.chatView,additionalClasses:"broadcastVisible"}))},e.prototype.render=function(){if(!this.props.chatView)return null;var e,t=this.props.chatView.chat,n=ci.VoiceStore.BPartnerHasRequestedAndIsInOneOnOneChat(t.accountid_partner),o=this.props.chatView.BVoiceActive(),i=ci.UIStore.IsFriendBroadcastVisible(this.m_friendSteamId),r=t.GetShowNonFriendWarning();this.state.dropToInviteFriend?e=Ee.createElement(li,{key:"inviteDrop",classNames:"inviteDrop-anim",timeout:300},Ee.createElement(au,{chatView:this.props.chatView,friend:this.state.dropToInviteFriend})):(this.state.dropGroupToInviteFriend||this.state.dropClanToInvite)&&(e=Ee.createElement(li,{key:"inviteDrop",classNames:"inviteDrop-anim",timeout:300},Ee.createElement(su,{chatView:this.props.chatView,group:this.state.dropGroupToInviteFriend,clan:this.state.dropClanToInvite})));var a=!1,s=null,c=this.ShouldShowVerticalBroadcastChat(),l=this.m_bChatHidden;if(i){var p=_d.UIDisplayPrefs,u=(p.nWatchPartyBroadcastHeightPercentage,p.nWatchPartyBroadcastWidthPercentage,this.CalculateBroadcastSectionStyles(c));s=Ee.createElement(Ee.Fragment,null,Ee.createElement(nu,{ref:this.m_refBroadcastContainer,steamID:D.a.InitFromAccountID(t.accountid_partner).ConvertTo64BitString(),localSteamID:this.m_strLocalBroadcastId,watchLocation:12,bWebRTC:!0,onRequestClose:this.HideBroadcast,onLocalStreamChange:this.SetLocalBroadcastId,actions:[Ee.createElement("div",{key:"ChatPosToggle",onClick:this.ToggleVerticalBroadcastChat,title:""+(c?Object($.b)("#Broadcast_View_Stack_H"):Object($.b)("#Broadcast_View_Stack_V")),className:"BroadcastChatPositionToggle "+(c?"right":"bottom")})],style:u,onTheaterMode:this.ToggleTheaterModeBroadcastChat,bVerticalBroadcastChat:!c}),!l&&Ee.createElement("div",{className:"BroadcastChatDivider "+(c?"vertical":"horizontal"),onMouseDown:this.OnGrabberMouseDown}),l&&Ee.createElement(tu,{onClick:this.ShowChat,edge:c?"bottom":"right"})),a=!0}else a=!1;var m={};this.props.isActive||(m.display="none");var d="chatWindow MultiUserChat";o&&(d+=" VoiceActive",ci.ChatStore.VoiceChat.IsMicMuted()&&(d+=" MicMuted")),n&&(d+=" VoiceRequested"),r&&(d+=" NotAFriendOrApproved");var h="chatBody";(this.state.dropToInviteFriend||this.state.dropGroupToInviteFriend||this.state.dropClanToInvite)&&(h="chatBody chatRoomActiveDrop"),ci.SettingsStore.FriendsSettings.bCompactFriendsList&&(d+=" compactView"),a&&(d+=" broadcastVisible");var _=this.m_bChatHidden&&i?null:Ee.createElement(gl,{key:t.unique_id,chatView:this.props.chatView,isActive:this.props.isActive,disabled:!1}),f=Ee.createElement(nr,R.a({style:m,className:"chatHistoryAndMembers"},this.GetChatBodyDragDropProps()),Ee.createElement(pi,null,e),Ee.createElement("div",{className:"displayColumn fullWidth"},Ee.createElement("div",{className:"displayRow minHeightZero"},r&&Ee.createElement(ru,{chatView:this.props.chatView,friend:t.chat_partner}),Ee.createElement("div",{className:"ChatRoomGroupDialog_history"},Ee.createElement(Hp,{chatView:this.props.chatView,isActive:this.props.isActive,speakerLabelWidth:this.state.speakerLabelWidth,blockInteraction:r})),!i&&Ee.createElement($p,{chatView:this.props.chatView,additionalClasses:void 0}),Ee.createElement("div",{className:"dropTargetBox"})),_)),g="chatStack "+(c?"displayRow":"displayColumn")+" GroupChatVisible";return Ee.createElement(nr,R.a({"data-activechat":this.props.isActive,style:m,className:d},this.GetTitleBarDragDropProps()),Ee.createElement("div",{className:"chatHeader"}),this.props.isActive&&Ee.createElement(Zp,{chatView:this.props.chatView,onNameWidthChanged:this.OnNameWidthChanged}),Ee.createElement(pi,null,(o||n)&&Ee.createElement(li,{key:"OneOnOneVoiceHeader",classNames:"OneOnOneVoice-anim",timeout:300},Ee.createElement("div",null,Ee.createElement(Yp,{chatView:this.props.chatView})))),Ee.createElement("div",{className:"ChatRoomGroupDialog_contents"},Ee.createElement("div",{className:"ChatRoomGroup_MainAndChatEntry displayColumn",ref:this.SetMainContentRef},Ee.createElement("div",{className:"ChatRoomGroup_Main_ContentAndMembers displayRow"},Ee.createElement("div",{className:"ChatRoomGroup_Main_Content "+(c?"Vertical":"Horizontal")+" "+(l?"chatHidden":"")},s,(!this.m_bChatHidden||!i)&&Ee.createElement("div",{className:h},i&&this.RenderInnerChatTabs(),Ee.createElement("div",{className:g},f)))))))},R.c([T.a],e.prototype,"OnDragEnter",null),R.c([T.a],e.prototype,"OnDragLeave",null),R.c([T.a],e.prototype,"OnDragOver",null),R.c([T.a],e.prototype,"OnDrop",null),R.c([T.a],e.prototype,"OnDropComplete",null),R.c([T.a],e.prototype,"OnNameWidthChanged",null),R.c([T.a],e.prototype,"ShouldShowVerticalBroadcastChat",null),R.c([T.a],e.prototype,"OnLayoutChange",null),R.c([T.a],e.prototype,"OnGrabberMouseDown",null),R.c([T.a],e.prototype,"HandleMouseMove",null),R.c([T.a],e.prototype,"UnregisterDragEvents",null),R.c([T.a],e.prototype,"HideChat",null),R.c([T.a],e.prototype,"ShowChat",null),R.c([T.a],e.prototype,"SetChatHidden",null),R.c([T.a],e.prototype,"ShowBroadcast",null),R.c([T.a],e.prototype,"HideBroadcast",null),R.c([T.a],e.prototype,"ToggleVerticalBroadcastChat",null),R.c([T.a],e.prototype,"ToggleTheaterModeBroadcastChat",null),R.c([T.a],e.prototype,"SetVerticalBroadcastChat",null),R.c([T.a],e.prototype,"SetLocalBroadcastId",null),R.c([T.a],e.prototype,"SetMainContentRef",null),e=R.c([or.observer],e)}(Ee.Component),Zp=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return R.d(t,e),t.prototype.SpeakerLabel=function(e){e&&this.props.onNameWidthChanged(e.clientWidth)},t.prototype.render=function(){var e=this.props.chatView.chat,t=ci.SettingsStore.FriendsSettings.nChatFontSize,n="speakerLabelWidthContainer";return t==gs.k_EChatFontSizeSmall?n+=" smallChatFont":t==gs.k_EChatFontSizeLarge&&(n+=" largeChatFont"),e.chat_partner.is_ready&&e.self.is_ready?Ee.createElement("div",{className:n,ref:this.SpeakerLabel},Ee.createElement("div",{className:"nameWidthLabel"},e.self.display_name+":"),Ee.createElement("div",{className:"nameWidthLabel"},e.chat_partner.display_name+":")):null},R.c([T.a],t.prototype,"SpeakerLabel",null),t=R.c([or.observer],t)}(Ee.Component),$p=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return R.d(t,e),t.prototype.AddFriendClick=function(e){this.ContinueCreateChat(cd(this,e),Object(Ci.m)(e))},t.prototype.AddFriendClickNotInBeta=function(o){return R.b(this,void 0,void 0,function(){var t,n;return R.e(this,function(e){switch(e.label){case 0:return t=cd(this,o),n=Object(Ci.m)(o),ci.IsInBeta()?(yr(n,"",Object($.b)("#Chat_InviteFriend_Unavailable",this.props.chatView.chat.chat_partner.display_name)),[3,3]):[3,1];case 1:return[4,Sr(n,"",Object($.b)("#Chat_InviteFriend_Unavailable_Released",this.props.chatView.chat.chat_partner.display_name),Object($.b)("#Chat_StillInVoiceDialog_KeepChatting"))];case 2:e.sent()&&this.ContinueCreateChat(t,n),e.label=3;case 3:return[2]}})})},t.prototype.ContinueCreateChat=function(e,t){qs(e,t,this.props.chatView,!0)},t.prototype.render=function(){var e=this.props.chatView.chat.chat_partner,t="inviteAnotherFriendButton";return this.props.additionalClasses&&(t+=" "+this.props.additionalClasses),Ee.createElement("div",{title:Object($.b)("#Chat_AddFriend_Hint"),className:t,onClick:e.is_in_beta?this.AddFriendClick:this.AddFriendClickNotInBeta},Ee.createElement(ui.y,null))},R.c([T.a],t.prototype,"AddFriendClick",null),R.c([T.a],t.prototype,"AddFriendClickNotInBeta",null),t=R.c([or.observer],t)}(Ee.Component),eu=function(n){function e(e){var t=n.call(this,e)||this;return t.m_msWentInactive=0,t.m_bShownTabIsGroupChat=!0,t.m_keyEventListener="keydown",t.m_refBroadcastContainer=Ee.createRef(),t.state={dropToInviteFriend:void 0,bShowBothChats:!1},t.props.popup&&t.props.popup.addEventListener(t.m_keyEventListener,t.OnHTMLKeyEvent),t}return R.d(e,n),e.prototype.OnDragEnter=function(e,t){if(Object(I.a)(e&&"friend"==e.type||t,"Invalid data type passed to ChatRoomGroupDialog.OnDragEnter"),e){var n=e;n.friend&&n.sourceContext.group!=this.props.groupView.GetGroup()&&this.setState({dropToInviteFriend:n.friend})}return!0},e.prototype.OnDragLeave=function(){this.state.dropToInviteFriend&&this.setState({dropToInviteFriend:void 0})},e.prototype.OnDragOver=function(e){e.dataTransfer.dropEffect="move"},e.prototype.OnDrop=function(e,t){Object(I.a)(e&&"friend"==e.type||0!=t.dataTransfer.files.length,"Invalid data type passed to ChatRoomGroupDialog.OnDrop");var n=this.props.groupView.GetChatView();if(e&&"friend"==e.type){var o=e;if(o.friend){this.state.dropToInviteFriend&&this.setState({dropToInviteFriend:void 0}),_d.DragDropManager.SetDropConsumed();var i=t.currentTarget.ownerDocument.defaultView;o.sourceContext.group!=this.props.groupView.GetGroup()&&Jp({invitee:o.friend,chatview:null,invitedto:this.props.groupView.GetGroup()},cd(this,t),i)}}else if(0!=t.dataTransfer.files.length){var r=t.dataTransfer.files[0];n.SetFileToUpload(r)}},e.prototype.componentWillReceiveProps=function(e){this.props.isActive&&!e.isActive?this.OnBecameInactive():e.isActive&&this.OnBecameActive()},e.prototype.OnBecameInactive=function(){this.m_msWentInactive=performance.now(),this.m_iIntervalInactive=SetBackgroundTimeout(this.forceUpdate.bind(this),10100),this.m_iIntervalVeryInactive=SetBackgroundTimeout(this.forceUpdate.bind(this),60100)},e.prototype.OnBecameActive=function(){this.m_msWentInactive=0,this.ClearIntervals()},e.prototype.GetTitleBarDragDropProps=function(){var e={rgAcceptedTypes:[],bAcceptsFiles:!0};return e.fnDrop=this.OnDrop,e},e.prototype.GetChatBodyDragDropProps=function(){var e={rgAcceptedTypes:["friend"],bAcceptsFiles:!0};return e.fnDragEnter=this.OnDragEnter,e.fnDragLeave=this.OnDragLeave,e.fnDragOver=this.OnDragOver,e.fnDrop=this.OnDrop,e},e.prototype.ClearIntervals=function(){this.m_iIntervalInactive&&(ClearBackgroundTimeout(this.m_iIntervalInactive),this.m_iIntervalInactive=void 0),this.m_iIntervalVeryInactive&&(ClearBackgroundTimeout(this.m_iIntervalVeryInactive),this.m_iIntervalVeryInactive=void 0)},e.prototype.OnHTMLKeyEvent=function(e){if(G.a.IN_CLIENT&&this.props.isActive&&e.altKey&&!e.ctrlKey&&!e.shiftKey){var t=this.props.groupView;if(!t)return;38===e.keyCode&&t.SelectPreviousChannel(),40===e.keyCode&&t.SelectNextChannel()}},e.prototype.componentDidMount=function(){(this.props.popup?this.props.popup:window).addEventListener("resize",this.OnLayoutChange)},e.prototype.componentWillUnmount=function(){this.ClearIntervals(),this.props.popup&&this.props.popup.removeEventListener(this.m_keyEventListener,this.OnHTMLKeyEvent),(this.props.popup?this.props.popup:window).removeEventListener("resize",this.OnLayoutChange)},e.prototype.CalculateBroadcastSectionStyles=function(e){if(this.props.groupView.m_bChatHidden)return{width:"100%",height:"100%"};var t=_d.UIDisplayPrefs,n=t.nWatchPartyBroadcastHeightPercentage,o=t.nWatchPartyBroadcastWidthPercentage,i={};if(e){var r=n||66;if(i.height=r+"%",this.m_elMainContent){var a=this.m_elMainContent,s=a.clientWidth,c=a.clientHeight,l=9/16*s+50,p=Object(_n.a)(r,1,l/c*100);i.height=p+"%"}}else i.width=o?o+"%":"66%",i.overflowY="auto";return i},e.prototype.ShouldShowVerticalBroadcastChat=function(){return void 0!==this.props.groupView.m_bShowVerticalBroadcastChat?this.props.groupView.m_bShowVerticalBroadcastChat:!!this.m_elMainContent&&this.m_elMainContent.clientHeight/this.m_elMainContent.clientWidth>5/7},e.prototype.OnLayoutChange=function(){this.forceUpdate()},e.prototype.OnGrabberMouseDown=function(e){var t=e.currentTarget.ownerDocument.defaultView;t.addEventListener("mousemove",this.HandleMouseMove),t.addEventListener("mouseup",this.UnregisterDragEvents),this.setState({bDraggingChatGrabber:!0})},e.prototype.HandleMouseMove=function(e){e.preventDefault(),e.stopPropagation();var t=this.m_refBroadcastContainer.current.getBoundingClientRect(),n=this.m_refBroadcastContainer.current.parentElement.getBoundingClientRect(),o=this.ShouldShowVerticalBroadcastChat(),i=o?t.top:t.left,r=o?e.clientY:e.clientX,a=o?n.height:n.width,s=Object(_n.a)((r-i)/a*100,1,100),c=o?"nWatchPartyBroadcastHeightPercentage":"nWatchPartyBroadcastWidthPercentage";_d.SetUIDisplayPref(c,s)},e.prototype.UnregisterDragEvents=function(e){e.view.removeEventListener("mousemove",this.HandleMouseMove),e.view.removeEventListener("mouseup",this.UnregisterDragEvents),this.setState({bDraggingChatGrabber:!1})},e.prototype.OnLocalStreamChange=function(e){this.props.groupView.SetLocalBroadcastId(e)},e.prototype.ShowBroadcast=function(){this.props.groupView.ShowBroadcast()},e.prototype.HideChat=function(){this.props.groupView.SetChatHidden(!0)},e.prototype.ShowChat=function(){this.props.groupView.SetChatHidden(!1)},e.prototype.ToggleVerticalBroadcastChat=function(){this.props.groupView.SetVerticalBroadcastChat(!this.ShouldShowVerticalBroadcastChat()),this.props.groupView.SetChatHidden(!1)},e.prototype.SetMainContentRef=function(e){this.m_elMainContent=e,this.OnLayoutChange()},e.prototype.ToggleShowBothChats=function(){this.state.bShowBothChats?this.m_bShownTabIsGroupChat&&this.state.bShowBothChats&&this.props.groupView.SetGlobalBroadcastChatShown(!1):(this.m_bShownTabIsGroupChat=!this.props.groupView.m_bShowGlobalChat,this.props.groupView.SetGlobalBroadcastChatShown(!0)),this.setState({bShowBothChats:!this.state.bShowBothChats})},e.prototype.RenderInnerChatTabs=function(){var e=this.props.groupView,t=e.GetGroup();return Ee.createElement("div",{className:"ChatBodyControls"},Ee.createElement("div",{className:"Close",onClick:this.HideChat,title:Object($.b)("#Broadcast_View_HideChat")},Ee.createElement(ui.v,{showChat:!1})),Ee.createElement("div",{className:"InnerChatTabs"},Ee.createElement("div",{className:hr("InnerChatTab",!e.m_bShowGlobalChat&&"Active"),onClick:function(){return e.SetGlobalBroadcastChatShown(!1)}},Ee.createElement(wa,{group:t}),Ee.createElement(xs,{group:t,micro:!0}),Ee.createElement("span",{className:"InnerChatTabLabel"},Object($.b)("#Broadcast_Chat_GroupChatTab",t.name))),(!this.state.bShowBothChats||this.state.bShowBothChats&&this.ShouldShowVerticalBroadcastChat())&&Ee.createElement("div",{className:hr("InnerChatTab",e.m_bShowGlobalChat&&"Active"),onClick:function(){return e.SetGlobalBroadcastChatShown(!0)}},Ee.createElement(ui.s,null),Ee.createElement("span",{className:"InnerChatTabLabel"},Object($.b)("#Broadcast_Chat_PublicChatTab")))),Ee.createElement("div",{className:"showBothTabs",onClick:this.ToggleShowBothChats,title:Object($.b)(this.state.bShowBothChats?"#Broadcast_View_ShowSingleChats":"#Broadcast_View_ShowBothChats")},Ee.createElement(ui.T,null)))},e.prototype.render=function(){if(!this.props.groupView||!this.props.groupView.GetChatView())return null;var e=this.props.groupView.GetGroup(),t=this.props.groupView,n=t.GetSelectedChatView(),o=t.GetPopoverChatView(),i=n.chat,r=this.state.bShowBothChats&&t.isBroadcastShown,a=t.m_bShowGlobalChat,s=a&&r||!a&&!r,c=r&&t.isBroadcastShown||!r&&a,l=null;this.state.dropToInviteFriend&&(l=Ee.createElement(li,{key:"inviteDrop",classNames:"inviteDrop-anim",timeout:300},Ee.createElement(au,{chatView:n,friend:this.state.dropToInviteFriend})));var p=!1,u=null,m=this.ShouldShowVerticalBroadcastChat(),d=t.m_bChatHidden,h=4;if(G.a.STEAM_TV&&(h=2),e.watching_broadcast_steamid&&t.isBroadcastShown){var _=_d.UIDisplayPrefs,f=(_.nWatchPartyBroadcastHeightPercentage,_.nWatchPartyBroadcastWidthPercentage,this.CalculateBroadcastSectionStyles(m));u=Ee.createElement(Ee.Fragment,null,Ee.createElement(nu,{ref:this.m_refBroadcastContainer,steamID:e.watching_broadcast_steamid.ConvertTo64BitString(),localSteamID:t.m_strLocalBroadcastId,watchLocation:h,bWebRTC:!1,onRequestClose:t.HideBroadcast,onLocalStreamChange:this.OnLocalStreamChange,actions:[Ee.createElement("div",{key:"ChatPosToggle",onClick:this.ToggleVerticalBroadcastChat,title:""+(m?Object($.b)("#Broadcast_View_Stack_H"):Object($.b)("#Broadcast_View_Stack_V")),className:"BroadcastChatPositionToggle "+(m?"right":"bottom")})],style:f,onTheaterMode:t.ToggleTheaterModeBroadcastChat,bVerticalBroadcastChat:!m}),!d&&Ee.createElement("div",{className:"BroadcastChatDivider "+(m?"vertical":"horizontal"),onMouseDown:this.OnGrabberMouseDown}),d&&Ee.createElement(tu,{onClick:this.ShowChat,edge:m?"bottom":"right"})),p=!0}else p=!1;var g=!1,b=!1,v={};if(!this.props.isActive){v.display="none";var S=this.m_msWentInactive?performance.now()-this.m_msWentInactive:6e4;1e4<=S&&(g=!0),6e4<=S&&!u&&(b=!0)}var y="chatWindow MultiUserChat",C="ChatRoomGroupDialog_contents";o&&(C+=" InsetWindowOpen"),r&&(C+=" BothChatsDisplayed"),e.IsNamedGroupChat()&&(y+=" namedGroup");var I="chatBody";this.state.dropToInviteFriend&&(I="chatBody chatRoomActiveDrop"),ci.SettingsStore.FriendsSettings.bCompactFriendsList&&(y+=" compactView"),p&&(y+=" broadcastVisible");var E=null;this.props.bHideMemberList||(E=Ee.createElement(Fa,{groupView:this.props.groupView,inactive:g}));var O,w=t.isBroadcastShown&&(!r&&t.m_bShowGlobalChat||d)?null:Ee.createElement(gl,{key:i.unique_id,chatView:t.GetActiveChatView(),isActive:this.props.isActive,disabled:!1}),M=Ee.createElement(nr,R.a({style:v,className:"chatHistoryAndMembers"},this.GetChatBodyDragDropProps()),Ee.createElement(pi,null,l),Ee.createElement("div",{className:"displayColumn fullWidth"},Ee.createElement("div",{className:"displayRow minHeightZero"},Ee.createElement("div",{className:"ChatRoomGroupDialog_history"},Ee.createElement(Hp,{chatView:n,isActive:this.props.isActive}),Ee.createElement(pi,null,Ee.createElement(iu,{groupView:t}))),Ee.createElement("div",{className:"dropTargetBox"}),E),w));if(e.watching_broadcast_steamid&&t.isBroadcastShown){var D=Ee.createElement(sp,{steamID:e.watching_broadcast_steamid.ConvertTo64BitString(),watchLocation:h,hidden:!t.m_bShowGlobalChat,className:this.state.bDraggingChatGrabber?"avoidEvents":void 0});O=Ee.createElement(Ee.Fragment,null,D)}var T="chatStack "+(m?"displayRow":"displayColumn");return c&&(T+=" GlobalChatVisible"),s&&(T+=" GroupChatVisible"),Ee.createElement(nr,R.a({"data-activechat":this.props.isActive,style:v,className:y},this.GetTitleBarDragDropProps()),!b&&!this.props.bHideHeader&&Ee.createElement("div",{className:"chatHeader titleBarContainer"},Ee.createElement("div",{className:"chatHeaderGradient"}),Ee.createElement(ks,{groupView:t,onBroadcastPreviewClick:this.ShowBroadcast}),Ee.createElement("div",{className:"disconnectBlocker"})),e.readyToRender&&!b&&Ee.createElement("div",{className:C},Ee.createElement(Ba,{groupView:t,inactive:g}),Ee.createElement("div",{className:"ChatRoomGroup_MainAndChatEntry displayColumn",ref:this.SetMainContentRef},Ee.createElement("div",{className:"ChatRoomGroup_Main_ContentAndMembers displayRow"},Ee.createElement("div",{className:"ChatRoomGroup_Main_Content "+(m?"Vertical":"Horizontal")+" "+(d?"chatHidden":"")},u,(!t.m_bChatHidden||!t.isBroadcastShown)&&Ee.createElement("div",{className:I},t.isBroadcastShown&&this.RenderInnerChatTabs(),Ee.createElement("div",{className:T},M,r&&Ee.createElement("div",{className:"BothChatsSeperator"}),r&&!this.ShouldShowVerticalBroadcastChat()&&Ee.createElement("div",{className:"InnerChatTab",onClick:function(){return t.SetGlobalBroadcastChatShown(!0)}},Ee.createElement(ui.s,null),Ee.createElement("span",{className:"InnerChatTabLabel"},Object($.b)("#Broadcast_Chat_PublicChatTab"))),O),!s&&t.isBroadcastShown&&w))))),!e.readyToRender&&!b&&Ee.createElement("div",{className:C},Ee.createElement(Xa,{position:"center",string:Object($.b)("#Chat_ChatRoomGroup_Requesting")})))},R.c([T.a],e.prototype,"OnDragEnter",null),R.c([T.a],e.prototype,"OnDragLeave",null),R.c([T.a],e.prototype,"OnDragOver",null),R.c([T.a],e.prototype,"OnDrop",null),R.c([T.a],e.prototype,"OnHTMLKeyEvent",null),R.c([T.a],e.prototype,"ShouldShowVerticalBroadcastChat",null),R.c([T.a],e.prototype,"OnLayoutChange",null),R.c([T.a],e.prototype,"OnGrabberMouseDown",null),R.c([T.a],e.prototype,"HandleMouseMove",null),R.c([T.a],e.prototype,"UnregisterDragEvents",null),R.c([T.a],e.prototype,"OnLocalStreamChange",null),R.c([T.a],e.prototype,"ShowBroadcast",null),R.c([T.a],e.prototype,"HideChat",null),R.c([T.a],e.prototype,"ShowChat",null),R.c([T.a],e.prototype,"ToggleVerticalBroadcastChat",null),R.c([T.a],e.prototype,"SetMainContentRef",null),R.c([T.a],e.prototype,"ToggleShowBothChats",null),e=R.c([or.observer],e)}(Ee.Component),tu=function(e){var t=e.onClick,n=e.edge;return Ee.createElement("div",{className:hr("BroadcastChatExpander",n),onClick:t,title:Object($.b)("#Broadcast_View_ShowChat")},Ee.createElement(ui.v,{showChat:!0}))},nu=Ee.forwardRef(function(e,t){var n=e.steamID,o=e.localSteamID,i=e.watchLocation,r=e.bWebRTC,a=e.style,s=e.onRequestClose,c=e.actions,l=e.onTheaterMode,p=e.onLocalStreamChange,u=e.bVerticalBroadcastChat,m=o||n;return Ee.createElement("div",{ref:t,style:R.a({display:"flex",flexDirection:"column"},a)},Ee.createElement("div",{className:"BroadcastSection"},Ee.createElement(Bl,{key:m,steamID:m,watchLocation:i,bWebRTC:r,onRequestClose:s,actions:c,onTheaterMode:l,onOpenLinkInNewWindow:qp}),Ee.createElement("div",{className:"videoContainerSizer"})),Ee.createElement("div",{className:"BroadcastDetailsSection"},Ee.createElement($l,{steamID:m,onLocalStreamChange:p,bVerticalBroadcastChat:u})))}),ou=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return R.d(t,e),t.prototype.render=function(){var e=this.props.broadcastView;if(!e)return null;var t={};return this.props.isActive||(t.display="none"),Ee.createElement(mp,{style:t,broadcastView:e,popup:this.props.popup})},t=R.c([or.observer],t)}(Ee.Component),iu=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return R.d(t,e),t.prototype.OnTextChannelCloseClick=function(e){this.props.groupView.ClosePopoverChat()},t.prototype.OnChatHistoryRef=function(e){e&&e.Focus()},t.prototype.render=function(){var e=this.props.groupView.GetPopoverChatView();return e?Ee.createElement(li,{key:"quickChat",classNames:"chatWindow-anim",timeout:320},Ee.createElement("div",{className:"VoiceRoomChatHistory"},Ee.createElement("div",{className:"VoiceRoomChatWindow"},Ee.createElement("div",{className:"VoiceRoomChatTitle"},Ee.createElement("div",{className:"VoiceRoomTitleLabels"},Ee.createElement("div",{className:"VoiceChatTextChannelName"},Object($.b)("#Chat_Scratch_Pad"))),Ee.createElement("div",{className:"MinimizeTextChat",onClick:this.OnTextChannelCloseClick},Ee.createElement(ui.jb,null))),Ee.createElement("div",{className:"VoiceChatTextChannelDesc"},Object($.b)("#Chat_Scratch_Pad_Desc")),Ee.createElement(Hp,{chatView:e,isActive:!0,ref:this.OnChatHistoryRef})))):null},R.c([T.a],t.prototype,"OnTextChannelCloseClick",null),R.c([T.a],t.prototype,"OnChatHistoryRef",null),t=R.c([or.observer],t)}(Ee.Component),ru=function(t){function e(e){return t.call(this,e)||this}return R.d(e,t),e.prototype.OnBlock=function(){ci.FriendStore.BlockPlayer(this.props.friend,!1),ci.UIStore.CloseTabByID(this.props.chatView.GetUniqueID())},e.prototype.OnAllow=function(){ci.FriendStore.SetApprovedNonFriendMessages(this.props.friend.accountid)},e.prototype.render=function(){return Ee.createElement("div",{className:"NotAFriendMessage"},Ee.createElement("div",{className:"NotAFriendBody"},Ee.createElement("div",{className:"Exclamation"},Ee.createElement(ui.f,null)),Ee.createElement("div",{className:"Explanation"},Ee.createElement("div",{className:"ExplanationHeader"},Object($.b)("#DirectMessageFromNonFriend")),Ee.createElement("div",{className:"ExplanationBody"},Object($.b)("#DirectMessageFromNonFriendNote")),Ee.createElement(Ar,{href:"https://support.steampowered.com/kb_article.php?ref=1266-OAFV-8478",className:"ExplanationMoreInfo"},Object($.b)("#Generic_More_Info"))),Ee.createElement("div",{className:"Buttons"},Ee.createElement("button",{className:"NotAFriendActionButton",onClick:this.OnBlock},Object($.b)("#NonFriendAction_Block")),Ee.createElement("button",{className:"NotAFriendActionButton",onClick:this.OnAllow},Object($.b)("#NonFriendAction_Allow")))))},R.c([T.a],e.prototype,"OnBlock",null),R.c([T.a],e.prototype,"OnAllow",null),e=R.c([or.observer],e)}(Ee.Component),au=function(t){function e(e){return t.call(this,e)||this}return R.d(e,t),e.prototype.render=function(){var e=!1;return this.props.chatView.chat instanceof kt&&(e=!0),Ee.createElement("div",{className:"chatModalCover inviteDrop"},Ee.createElement(sr,null,Ee.createElement(wi,null,e?Object($.b)("#Chat_DropToInviteGroup"):Object($.b)("#Chat_DropToInvite")),Ee.createElement(Ai,null,Ee.createElement(Ti,null,Ee.createElement(zc,{friend:this.props.friend,context:null,avatarQualityFull:!0})))))},e=R.c([or.observer],e)}(Ee.Component),su=function(t){function e(e){return t.call(this,e)||this}return R.d(e,t),e.prototype.render=function(){var e="";return this.props.group?e=this.props.group.name:this.props.clan&&(e=this.props.clan.name),Ee.createElement("div",{className:"chatModalCover inviteDrop DropGroupToInviteFriend"},Ee.createElement(sr,null,Ee.createElement(wi,null,Object($.b)("#Chat_DropGroupToInviteFriend")),Ee.createElement(Ai,null,Ee.createElement(Ti,{className:"avatarHolder"},this.props.clan?Ee.createElement(Vs,{clan:this.props.clan,large:!0}):Ee.createElement(xs,{group:this.props.group,large:!0}),Ee.createElement("div",{className:"dropGroupName"},e)))))},e=R.c([or.observer],e)}(Ee.Component),cu=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return R.d(t,e),t.prototype.render=function(){var e=!1;if(!(this.props.chatView.chat instanceof Jt))return null;var t=this.props.chatView.chat;return t.is_friend_typing&&(e=!0),Ee.createElement("div",{className:"FriendChatTypingNotification"+(e?" FriendIsTyping":"")},Object($.b)("#Friend_Chat_Typing",t.chat_partner.display_name))},t=R.c([or.observer],t)}(Ee.Component),lu=function(n){function e(e){var t=n.call(this,e)||this;return t.m_fnExistingPopupInitializer=void 0,t.BindResizeGrip=t.BindResizeGrip.bind(t),t}return R.d(e,n),e.prototype.BindResizeGrip=function(e){var t=0,n=0;if(e){var o=e.getBoundingClientRect(),i=e.ownerDocument.defaultView;o&&i&&(t=Math.ceil(i.innerWidth-o.left),n=Math.ceil(i.innerHeight-o.top))}var r=this.props.popup;r.SteamClient&&r.SteamClient.Window&&r.SteamClient.Window.SetResizeGrip&&r.SteamClient.Window.SetResizeGrip(t,n)},e.prototype.componentWillUnmount=function(){this.props.popup.SteamClient.Window.SetResizeGrip(0,0)},e.prototype.render=function(){return Ee.createElement("div",{className:"window_resize_grip",ref:this.BindResizeGrip})},e}(Ee.PureComponent),pu=function(n){function e(e){var t=n.call(this,e)||this;return t.m_refTextInput=null,t.state={error:1,strPIN:""},t}return R.d(e,n),e.prototype.componentDidMount=function(){this.m_refTextInput.focus()},e.prototype.BindTextInput=function(e){this.m_refTextInput=e},e.prototype.OnPINInput=function(e){this.setState({strPIN:e.target.value})},e.prototype.onOK=function(e){var t=this;return e.preventDefault(),ci.ParentalStore.Unlock(this.state.strPIN).then(function(e){1!=e&&t.setState({error:e})}),!0},e.prototype.render=function(){var e="";switch(this.state.error){case 1:break;case 25:e=Object($.b)("#FamilyView_TooManyAttempts");break;default:e=Object($.b)("#FamilyView_BadPIN")}return Ee.createElement("div",null,Ee.createElement("div",{className:"FamilyViewTitle"},Object($.b)("#FamilyView_Title")),Ee.createElement("div",{className:"FamilyViewInstructions"},Object($.b)("#FamilyView_Unlock_Instructions")),Ee.createElement("form",{onSubmit:this.onOK},Ee.createElement("input",{type:"password",maxLength:4,className:"pinInput",autoComplete:"current-pin",ref:this.BindTextInput,value:this.state.strPIN,onChange:this.OnPINInput}),Ee.createElement("button",{type:"submit"},Object($.b)("#Button_OK"))),e&&Ee.createElement("p",{className:"error_text"},e))},R.c([T.a],e.prototype,"BindTextInput",null),R.c([T.a],e.prototype,"OnPINInput",null),R.c([T.a],e.prototype,"onOK",null),e}(Ee.Component),uu=(n("AAD4"),n("ZsEe")),mu=n.n(uu);var du=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return R.d(t,e),t.prototype.render=function(){var e=this.props,t=e.browserContext,n=e.friends,o=e.chats,i=e.elTarget,r=new od(i.ownerDocument.defaultView),a=null,s=ci.ready_to_render;return s&&(a=ci.UIStore.GetDefaultTabSetForContext(t),ci.UIStore.GetPerContextChatData(t).SetFriendsListWindow(r)),[Ee.createElement(hu,{key:"throbber",fadeOut:s}),ci.ready_to_render?Ee.createElement(gu,{key:"interface",friends:n,chats:o,tabset:a,container:r}):null]},t=R.c([or.observer],t)}(Ee.Component),hu=function(n){function e(e){var t=n.call(this,e)||this;return t.m_refElement=Ee.createRef(),t.state={bFadeOutComplete:!1},t}return R.d(e,n),e.prototype.OnTransitionEnd=function(e){var t=this.m_refElement.current;t&&e.target==t&&this.props.fadeOut&&"opacity"==e.propertyName&&this.setState({bFadeOutComplete:!0})},e.prototype.render=function(){if(this.state.bFadeOutComplete)return null;var e=mu.a.throbberContainer;return this.props.fadeOut&&(e+=" "+mu.a["throbberContainer-exit-active"]),Ee.createElement("div",{className:e,onTransitionEnd:this.OnTransitionEnd,ref:this.m_refElement},Ee.createElement("div",{className:"WaitingForInterFaceReadyContainer"},Ee.createElement("div",{className:"WaitingForInterFaceReadyThrobber"},Ee.createElement(Xa,{className:"Throbber_Blur",size:"xlarge"}),Ee.createElement(Xa,{size:"xlarge"}))))},R.c([T.a],e.prototype,"OnTransitionEnd",null),e}(Ee.Component),_u=function(i){function e(e,t,n,o){return i.call(this,e,t,n,o)||this}return R.d(e,i),e.prototype.GetSavedDimensionsKey=function(){if(this.BIsInOverlay()){var e=ci.UIStore.GetPerContextChatData(this.m_rgParams.target_browser).screen_info;return"Overlay_"+(e&&e.width&&e.height?e.width+"x"+e.height+"_":"")+this.m_strSavedDimensionsKey}return this.m_strSavedDimensionsKey},e}(rr.b),fu=function(s){function e(e,t,n,o){var i=this,r=rr.c.Resizable;o&&(r|=rr.c.Minimized);var a={dimensions:{width:300,height:650},minWidth:226,minHeight:400,title:Object($.b)("#WindowTitle_FriendsList"),html_class:"client_chat_frame fullheight SavedDimensionsPopup",body_class:"fullheight",target_browser:0<n.m_unPID?n:void 0,eCreationFlags:r};return(i=s.call(this,"friendslist","PopupFriendsListDimensions",a,!1)||this).m_friends=e,i.m_chats=t,_d.m_strLoaderWindowRestoreDetails&&(i.SaveWindowPosition(_d.m_strLoaderWindowRestoreDetails),_d.m_strLoaderWindowRestoreDetails=void 0),i}return R.d(e,s),e.prototype.Render=function(e,t){t.setAttribute("class","fullheight popup_chat_frame");var n=new od(e),o=this.browser_info||ai,i=ci.UIStore.GetDefaultTabSetForContext(o);this.m_browserContext=o,W.render(Ee.createElement(gu,{popup:this,friends:this.m_friends,chats:this.m_chats,tabset:i,container:n}),t)},e.prototype.OnResizeComplete=function(e){s.prototype.OnResizeComplete.call(this,e),window.parent.postMessage({message:"FriendsListRestoreDetailsChanged",data:e},"https://steamloopback.host")},e.prototype.OnClose=function(){s.prototype.OnClose.call(this),window.parent.postMessage({message:"FriendsListRestoreDetailsChanged",data:this.m_rgParams.strRestoreDetails},"https://steamloopback.host"),ci.OnFriendsListClosed(this.m_browserContext)},e}(_u),gu=function(o){function e(e){var t=o.call(this,e)||this;t.m_bUsePopups=!1,t.m_nWindowTitleUnreadCycleCount=0,t.m_refChatDialog=Ee.createRef();t.m_browserContext=t.props.popup&&t.props.popup.browser_info?t.props.popup.browser_info:ai;var n=ci.UIStore.GetPerContextChatData(t.m_browserContext);return t.m_bUsePopups=n.BUsePopups(),t.m_bUsePopups?t.m_nInlineChatWidth=640:(t.m_nInlineChatWidth=530,t.m_ResponsiveWindowState=ci.UIStore.GetResponsiveWindowState(t.m_browserContext)),t.state={bIsResizingWindow:!1},t}return R.d(e,o),e.prototype.OnCopy=function(e){this.m_refChatDialog&&this.m_refChatDialog.current&&this.m_refChatDialog.current.OnCopy(e)},e.prototype.OnWindowResizeEvent=function(e){var o=this,i=this.m_bUsePopups?this.props.popup:null;i&&i.IsMinimized().then(function(e){if(!e){var t=i.window;if(!(t.innerWidth<226)){var n=t.innerWidth>=o.m_nInlineChatWidth;ci.UIStore.SetFriendsListSingleWindowMode(o.m_browserContext,n),n&&o.SetFriendsListSingleWindowWidth(_d.UIDisplayPrefs.nFriendsListSingleWindowWidthPx)}}})},e.prototype.BindWindowHandlers=function(){var i=this;this.m_popupActionDisposer=Object(d.autorun)(function(){if(!G.a.IN_CLIENT){var e=ci.ChatStore.FriendChatStore.GetUnfilteredFriendsWithUnreadMessages();e.length&&void 0===i.m_unTimerWindowTitleUnreadCycle?i.m_unTimerWindowTitleUnreadCycle=window.setInterval(function(){i.m_nWindowTitleUnreadCycleCount=(i.m_nWindowTitleUnreadCycleCount+1)%1e3},2e3):e.length||void 0===i.m_unTimerWindowTitleUnreadCycle||(window.clearInterval(i.m_unTimerWindowTitleUnreadCycle),i.m_unTimerWindowTitleUnreadCycle=void 0);var t=1+e.length,n=i.m_nWindowTitleUnreadCycleCount%t;if(0<n){var o=e[n-1];return void(i.props.container.title=Object($.b)("#WindowTitle_UnreadMessage",o.name))}}ci.UIStore.BIsFriendsListSingleWindow(i.m_browserContext)&&i.props.tabset.GetTitle()?G.a.IN_CLIENT?i.props.container.title=Object($.b)("#WindowTitle_FriendsList")+" - "+i.props.tabset.GetTitle():i.props.container.title=i.props.tabset.GetTitle():i.props.container.title=Object($.b)("#WindowTitle_FriendsList")}),this.m_popupFocusDisposer=this.props.container.OnFocus(function(){ci.UIStore.BIsFriendsListSingleWindow(i.m_browserContext)&&i.props.tabset.OnWindowFocus()})},e.prototype.UnbindWindowHandlers=function(){this.m_popupActionDisposer&&(this.m_popupActionDisposer(),this.m_popupActionDisposer=void 0),this.m_popupFocusDisposer&&(this.m_popupFocusDisposer.unregister(),this.m_popupFocusDisposer=void 0)},e.prototype.componentWillMount=function(){var e=this.props.popup?this.props.popup.window:window;e&&e.addEventListener("resize",this.OnWindowResizeEvent),this.BindWindowHandlers()},e.prototype.componentWillUnmount=function(){var e=this.props.popup?this.props.popup.window:window;e&&e.removeEventListener("resize",this.OnWindowResizeEvent),this.UnbindWindowHandlers()},e.prototype.BindFriendsListContainer=function(e){this.m_elFriendsListContainer=e&&e.div},e.prototype.OnGrabberMouseDown=function(e){var t=e.currentTarget.ownerDocument.defaultView;this.setState({bIsResizingWindow:!0}),t.addEventListener("mousemove",this.HandleMouseMove),t.addEventListener("mouseup",this.UnregisterFriendsListDragEvents)},e.prototype.OnGrabberTouchStart=function(e){var t=e.currentTarget.ownerDocument.defaultView;t.addEventListener("touchmove",this.HandleTouchMove),t.addEventListener("touchend",this.UnregisterFriendsListDragEvents)},e.prototype.HandleTouchMove=function(e){1<=e.touches.length&&this.InternalAdjustFriendsListContainerOnDrag(e.touches[0].clientX)},e.prototype.HandleMouseMove=function(e){this.InternalAdjustFriendsListContainerOnDrag(e.clientX)},e.prototype.InternalAdjustFriendsListContainerOnDrag=function(e){if(this.m_elFriendsListContainer){var t=this.m_elFriendsListContainer.getBoundingClientRect().left;this.SetFriendsListSingleWindowWidth(e-t)}},e.prototype.SetFriendsListSingleWindowWidth=function(e){var t=(this.props.popup?this.props.popup.window:window).innerWidth,n=Object(_n.a)(t-400,200,440);e=Object(_n.a)(e,200,n),_d.SetUIDisplayPref("nFriendsListSingleWindowWidthPx",e)},e.prototype.UnregisterFriendsListDragEvents=function(e){this.setState({bIsResizingWindow:!1}),e.view.removeEventListener("mousemove",this.HandleMouseMove),e.view.removeEventListener("touchmove",this.HandleTouchMove),e.view.removeEventListener("mouseup",this.UnregisterFriendsListDragEvents),e.view.removeEventListener("touchend",this.UnregisterFriendsListDragEvents)},e.prototype.render=function(){var e=!0,t=!0,n=!1,o=!1;if(!ci.UIStore.BIsFriendsListSingleWindow(this.m_browserContext))if(this.m_ResponsiveWindowState){var i=this.m_ResponsiveWindowState.GetActiveView();e=i==po.FriendsList,t=i==po.Chat}else t=!1;var r=ci.UIStore.GetTheaterMode(),a=!(G.a.IN_CLIENT||r||G.a.IN_TENFOOT||window.__bHideHeader),s="chat_main fullheight",c=null;e&&t?(0<this.props.tabset.tabCount&&(o=!0,n=ci.UIStore.BIsFriendsListCollapsed(this.m_browserContext)),s+=" singlewindow",c=Ee.createElement("div",{className:"singleWindowDivider"+(n?" friendsListCollapsed":""),onMouseDown:this.OnGrabberMouseDown,onTouchStart:this.OnGrabberTouchStart})):e?s+=" responsive_friends":t&&(s+=" responsive_chats"),this.state.bIsResizingWindow&&(s+=" resizingSingleWindow"),r&&(s+=" TheaterMode"),this.props.popup&&this.props.popup.focused&&(s+=" focused"),ci.CMInterface.BDisconnected()&&(s+=" errorDisconnected");var l=this.props.popup&&this.props.popup.window,p=n?{width:0,transition:"width 0.32s ease-in-out, opacity 0.32s ease-in-out"}:{width:_d.UIDisplayPrefs.nFriendsListSingleWindowWidthPx+"px"};return ci.ParentalStore.BIsFriendsBlocked()?G.a.IN_CLIENT?Ee.createElement("div",{className:s},Ee.createElement(pu,null)):(location.reload(),Ee.createElement("div",null)):Ee.createElement("div",{className:s,onContextMenu:ir.i},Ee.createElement(ar,null,Ee.createElement(Cu,{popup:this.props.popup?this.props.popup.window:void 0})),a&&Ee.createElement(bu,{friends:this.props.friends}),Ee.createElement("div",{className:"chat_main_flex displayRow",onCopy:this.OnCopy},!1,ci.ready_to_render&&Ee.createElement(ar,null,Ee.createElement(lr,{ModalManager:ur(l||window)}),e&&Ee.createElement(nr,{className:"friendsListContainer fullheight "+(n?"collapsed":""),style:t?p:null,ref:this.BindFriendsListContainer,rgAcceptedTypes:[],bAcceptsFiles:!0},Ee.createElement(Gc,{friends:this.props.friends,chats:this.props.chats,popup:l,browserContext:this.m_browserContext,collapsible:o,collapsed:n})),c,t&&Ee.createElement(Kp,{tabs:this.props.tabset,popup:l,ref:this.m_refChatDialog,ResponsiveWindowState:e?null:this.m_ResponsiveWindowState,showOpenFriendsList:o&&n}),this.props.popup&&G.a.IN_CLIENT&&Ee.createElement(lu,{popup:l}),Ee.createElement("div",{className:"singleWindowFocusBar"}))))},R.c([d.observable],e.prototype,"m_nWindowTitleUnreadCycleCount",void 0),R.c([T.a],e.prototype,"OnCopy",null),R.c([T.a],e.prototype,"OnWindowResizeEvent",null),R.c([T.a],e.prototype,"BindFriendsListContainer",null),R.c([T.a],e.prototype,"OnGrabberMouseDown",null),R.c([T.a],e.prototype,"OnGrabberTouchStart",null),R.c([T.a],e.prototype,"HandleTouchMove",null),R.c([T.a],e.prototype,"HandleMouseMove",null),R.c([T.a],e.prototype,"UnregisterFriendsListDragEvents",null),e=R.c([or.observer],e)}(Ee.Component),bu=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return R.d(t,e),t.prototype.render=function(){var e=this.props.friends.self;return Ee.createElement("div",{className:mu.a.SteamPageHeader},Ee.createElement("a",{href:""+G.a.STORE_BASE_URL},Ee.createElement("div",{className:mu.a.SteamPageHeaderShortLogo})),Ee.createElement(vu,{text:"STORE",href:""+G.a.STORE_BASE_URL}),Ee.createElement(vu,{text:"COMMUNITY",href:""+G.a.COMMUNITY_BASE_URL}),Ee.createElement(vu,{text:e.primary_display_name,href:e.GetCommunityProfileURL()}),Ee.createElement(vu,{text:"SUPPORT",href:""+G.a.HELP_BASE_URL}))},t=R.c([or.observer],t)}(Ee.Component);function vu(e){return Ee.createElement("a",{className:mu.a.SteamPageHeaderTopLink,href:e.href},e.text)}var Su=function(c){function e(e,t,n,o,i,r){var a=this,s={title:"",html_class:"client_chat_frame fullheight ChatPopup",body_class:"fullheight",minWidth:400,minHeight:250,strRestoreDetails:o,dimensions:{width:740,height:650},target_browser:0<e.m_unPID?e:void 0,eCreationFlags:rr.c.Resizable};return r&&(s.eCreationFlags|=rr.c.Minimized),i&&(Object.assign(s.dimensions,i),s.bIgnoreSavedDimensions=!0),(a=c.call(this,"chat_"+t,n.GetTabSetIdentifier(),s,!0)||this).m_tabSet=n,a}return R.d(e,c),e.prototype.SetTitle=function(){if(this.m_popup&&this.m_popup.document&&this.m_tabSet){var e=this.m_tabSet.GetTitle();this.m_popup.document.title=e}},e.prototype.OnFocus=function(){this.m_tabSet.OnWindowFocus()},e.prototype.BindWindowHandlers=function(){this.m_popupActionDisposer||(this.m_popupActionDisposer=Object(d.autorun)(this.SetTitle))},e.prototype.UnbindWindowHandlers=function(){this.m_popupActionDisposer&&(this.m_popupActionDisposer(),this.m_popupActionDisposer=void 0)},Object.defineProperty(e.prototype,"tab_set",{get:function(){return this.m_tabSet},enumerable:!0,configurable:!0}),e.prototype.ClearTabSet=function(){this.m_tabSet=void 0},e.prototype.OnResize=function(){ci.UIStore.OnTabSetResized(this.m_tabSet),c.prototype.OnResize.call(this)},e.prototype.OnBeforeUnload=function(){c.prototype.SetSavedDimensionsKey.call(this,this.m_tabSet.GetTabSetIdentifier()),c.prototype.OnBeforeUnload.call(this)},e.prototype.OnClose=function(){if(this.m_tabSet){var e=!1;null!=this.m_popup.window&&this.m_popup.window.SteamClient&&this.m_popup.window.SteamClient.Window&&this.m_popup.window.SteamClient.Window.ProcessShuttingDown&&(e=this.m_popup.window.SteamClient.Window.ProcessShuttingDown()),this.m_tabSet.OnPopupClosed(e)}this.UnbindWindowHandlers()},e.prototype.Render=function(e,t){t.setAttribute("class","fullheight popup_chat_frame"),this.BindWindowHandlers(),W.render(Ee.createElement(yu,{popup:this,chatTabs:this.m_tabSet}),t)},R.c([T.a],e.prototype,"SetTitle",null),e}(_u),yu=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return R.d(t,e),t.prototype.render=function(){var e=this.props.popup.window,t=this.props.chatTabs,n="popup_chat_frame fullheight";return this.props.popup.focused&&(n+=" focused"),ci.UIStore.GetTheaterMode()&&(n+=" TheaterMode"),ci.CMInterface.BDisconnected()&&(n+=" errorDisconnected"),Ee.createElement("div",{className:n,onContextMenu:ir.i},Ee.createElement(Cu,{popup:this.props.popup.window}),!1,Ee.createElement(lr,{ModalManager:ur(e)}),Ee.createElement(Kp,{tabs:t,popup:e,ResponsiveWindowState:null}),G.a.IN_CLIENT&&Ee.createElement(lu,{popup:e}))},t=R.c([or.observer],t)}(Ee.Component),Cu=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return R.d(t,e),t.prototype.OnKeyDown=function(e){e.preventDefault(),e.stopPropagation()},t.prototype.render=function(){if(G.a.IN_CLIENT){if(ci.CMInterface.BDisconnected()){ld(this.props.popup);return Ee.createElement("div",{className:"ConnectionTrouble",tabIndex:0,onKeyDown:this.OnKeyDown},Ee.createElement("div",{className:"ConnectionTroubleContent"},Ee.createElement(dr,{hideMinMax:!0,popup:this.props.popup}),Ee.createElement("div",{className:"ConnectionTroubleMessage"},Object($.b)("#ConnectionTrouble_CurrentlyDisconnected"))))}return null}return Ee.createElement(Iu,null)},R.c([T.a],t.prototype,"OnKeyDown",null),t=R.c([or.observer],t)}(Ee.Component),Iu=function(n){function e(e){var t=n.call(this,e)||this;return t.m_bRequestingNotificationPermission=!1,t.state={bShouldRequestNotificationPermission:!0,bShowStartupDelayMessage:!1,bShowReconnectWaitMessage:!1,cReconnectWaitSeconds:0},t}return R.d(e,n),e.prototype.componentWillMount=function(){var e=this;if(!ci.ready_to_render){var t=performance.now()-ci.GetStartupTime();this.m_iIntervalDelayedStartup=window.setTimeout(function(){e.setState({bShowStartupDelayMessage:!0}),e.m_iIntervalDelayedStartup=void 0},1500-t)}},e.prototype.componentWillUnmount=function(){this.m_iIntervalDelayedStartup&&(window.clearTimeout(this.m_iIntervalDelayedStartup),this.m_iIntervalDelayedStartup=void 0),this.m_iIntervalUpdateReconnectStatus&&(window.clearInterval(this.m_iIntervalUpdateReconnectStatus),this.m_iIntervalUpdateReconnectStatus=void 0)},e.prototype.IntervalUpdateReconnectWaitStatus=function(){var e=_d.WebLogonManager;if(e.BIsWaitingToReconnect()){var t=Math.ceil(e.GetMSUntilNextReconnectAttempt()/1e3);t!=this.state.cReconnectWaitSeconds&&this.setState({bShowReconnectWaitMessage:!0,cReconnectWaitSeconds:t})}else window.clearInterval(this.m_iIntervalUpdateReconnectStatus),this.m_iIntervalUpdateReconnectStatus=void 0,this.setState({bShowReconnectWaitMessage:!1,cReconnectWaitSeconds:0})},e.prototype.StartReconnectUpdateInterval=function(){this.m_iIntervalUpdateReconnectStatus||(this.m_iIntervalUpdateReconnectStatus=window.setInterval(this.IntervalUpdateReconnectWaitStatus,250))},e.prototype.OnReconnectNowClick=function(){_d.WebLogonManager.ReconnectNow()},e.prototype.OnLoginClick=function(){window.location.href=window.location.href},e.prototype.render=function(){var e=this,t=_d.WebLogonManager;if(Object(I.a)(t,"No WebLogonManager in WebConnectionTroubleOverlay"),!t)return null;var n=null,o=t.web_logon_state,i=!ci.NotificationManager.BNotificationsPermitted()&&this.state.bShouldRequestNotificationPermission;if(9!=o||i){var r=void 0,a="",s=!1,c=!1;if(9!=o)if(ci.ready_to_render||this.state.bShowStartupDelayMessage||!t.BIsInInitialConnect())switch(o){case 1:case 3:r=Object($.b)("#ConnectionTrouble_Connecting"),c=!0;break;case 5:case 7:r=Object($.b)("#ConnectionTrouble_LoggingIn"),c=!0;break;case 11:r=Object($.b)("#ConnectionTrouble_RetrievingLogin"),c=!0;break;case 2:case 4:case 12:r=Object($.b)("#ConnectionTrouble_FailedToConnect");break;case 8:case 6:r=Object($.b)("#ConnectionTrouble_FailedToLogIn");break;case 10:r=Object($.b)("#ConnectionTrouble_DisconnectedFinal");break;case 13:r=Object($.b)("#ConnectionTrouble_LoginLost"),s=!0;break;case 14:r=Object($.b)("#ConnectionTrouble_LoginChanged"),s=!0;break;case 15:r=Object($.b)("#ConnectionTrouble_LoggedOnElsewhere");break;default:Object(I.a)(!1,"No message for trouble state "+o)}else a="InitialConnect";else i&&(this.m_bRequestingNotificationPermission||(ci.NotificationManager.RequestNotificationPermission().then(function(){e.m_bRequestingNotificationPermission=!1,e.setState({bShouldRequestNotificationPermission:!1})}),this.m_bRequestingNotificationPermission=!0),a="NotificationBrowserWarning",r=Object($.b)("#NotificationBrowserWarning"));var l=t.BIsWaitingToReconnect(),p=t.BWillAutoReconnect();!this.state.bShowReconnectWaitMessage&&p&&this.StartReconnectUpdateInterval(),!r&&ci.ready_to_render||(n=Ee.createElement(li,{classNames:"modalbg-anim",timeout:300},Ee.createElement("div",{className:"ConnectionTrouble WebConnectionTrouble"+(ci.ready_to_render?"":" NotReadyToRender")},Ee.createElement("div",{className:""+a}),Ee.createElement("div",{className:"ConnectionTroubleContent"},Ee.createElement("div",{className:"ConnectionTroubleMessage "+a},Ee.createElement("div",{className:"errorMessageContainer"},Ee.createElement("div",{className:"connectionThrobber"+(c?" showThrobber":"")},Ee.createElement(Xa,{size:"small"})," "),Ee.createElement("div",null,ci.ready_to_render?r:Object($.b)("#ConnectionTrouble_Connecting"))),l&&p&&Ee.createElement("div",{className:"ReconnectWaitMessage"},Object($.c)("#ConnectionTrouble_ReconnectingInSeconds",Math.ceil(t.GetMSUntilNextReconnectAttempt()/1e3))),l&&Ee.createElement("div",{className:"ConnectionTroubleReconnectMessage"},Ee.createElement("div",{className:"ReconnectNow"},Ee.createElement("button",{type:"button",className:"DialogButton Primary",onClick:this.OnReconnectNowClick},Object($.b)("#ConnectionTrouble_ReconnectNow")))),s&&Ee.createElement("div",{className:"ConnectionTroubleReconnectMessage"},Ee.createElement("div",{className:"ReconnectNow"},Ee.createElement("button",{type:"button",className:"DialogButton Primary",onClick:this.OnLoginClick},Object($.b)(14!=o?"#ConnectionTrouble_LoginAgain":"#ConnectionTrouble_LoginChanged_Reload")))))))))}return Ee.createElement(pi,null,n)},R.c([T.a],e.prototype,"IntervalUpdateReconnectWaitStatus",null),R.c([T.a],e.prototype,"OnReconnectNowClick",null),R.c([T.a],e.prototype,"OnLoginClick",null),e=R.c([or.observer],e)}(Ee.Component),Eu="DEBUG_MobxDevTools",Ou=Object(d.observable)({bEnabled:null});var wu,Mu,Du=ni(function(e,t,n){fr(Ee.createElement(Ru,R.a({},e,{bIsInviteDialog:!0})),n,"InviteDialog",{strTitle:"Invite",popupWidth:540,popupHeight:260},pd(n))}),Tu=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return R.d(t,e),t.prototype.AcceptInvite=function(e){var t=this,n=Ci.m(e);ci.ChatStore.InviteStore.AcceptInvite(this.props.invite,cd(this,e)).then(function(e){t.HandleJoinResult(n,e)})},t.prototype.HandleJoinResult=function(e,t){var n=function(e){if(15!=e.result)return 17==e.result?Object($.b)("#ChatRoom_InviteMessage_Failed_Banned"):42==e.result?Object($.b)("#ChatRoom_InviteMessage_Not_Found"):null;0==e.time&&console.log("no longer valid");var t=ci.RTime32ToDate(e.time).toLocaleString([],{weekday:"long",year:"numeric",month:"numeric",day:"numeric",hour:"numeric",minute:"numeric"});return Object($.b)("#ChatRoom_InviteMessage_Failed_Kicked",t)}(t);n&&yr(e,Object($.b)("#ChatRoom_InviteMessage_Header"),n,Object($.b)("#Button_OK")),this.props.onAccept&&this.props.onAccept()},t.prototype.render=function(){var e=this.props.invite;if(!e||!e.BIsReady())return Ee.createElement("div",{className:"ChatMessageInvite RequestingInfo displayRow"},Ee.createElement(Xa,{size:"small"}),Ee.createElement("div",{className:"postedExpiredInvite"},Object($.b)("#bbcode_invite_requesting_info")));if(!e.BIsValid())return Ee.createElement("div",{className:"ChatMessageInvite InviteExpired"},Ee.createElement("div",{className:"postedExpiredInvite"},Object($.b)("#bbcode_invite_no_longer_valid")));var t=this.props.inviter&&ci.FriendStore.self.accountid==this.props.inviter.accountid,n=ci.ChatStore.GetChatRoomGroup(e.GetChatRoomGroupID()),o=n&&n.BIsCurrentUserAMember(),i=e.BIsExpired(),r=n&&n.name,a="",s="ChatMessageInvite NoBGSplitInvite",c="inviteButton inviteButtonJoinChat";this.props.strClassName&&(s+=" "+this.props.strClassName);var l,p,u=e.BIsInviteLink(),m=e.BIsVoiceChatInvite();if(m){c+=" inviteButtonJoinVoice",s+=" VoiceChannelInvite";var d=n.GetChatRoom(e.GetChatID());d&&(a=d.name)}if(this.props.bIsInviteDialog||(o&&!t&&(s+=" GroupAlreadyJoined"),t&&(s+=" Inviter")),u&&(s+=" InviteLink"),i)s+=" InviteExpired";else if(e.BNeverExpires())l=Ee.createElement("div",{className:"Invite_ExpireTime"},Object($.b)("#bbcode_invite_never_expires"));else{var h=ci.RTime32ToDate(e.time_expires);l=Ee.createElement("div",{className:"Invite_ExpireTime"},Object($.b)("#bbcode_invite_expires",h.toLocaleTimeString(),h.toDateString()))}p=t?m?Object($.b)("#Voice_StartTalking"):Object($.b)("#ChatRoom_Invite_Accept_Inviter"):m?Object($.b)("#Voice_StartTalking"):o?Object($.b)("#ChatRoom_Invite_Accept_Inviter"):Object($.b)("#ChatRoom_Invite_Accept");var _=null,f=!1;if(e.BIsUserBanned())f=!0,_=Ee.createElement("div",null,Object($.b)("#bbcode_invite_banned_forever"));else if(e.GetTimeKickExpires()&&e.GetTimeKickExpires()>ci.GetServerRTime32()){f=!0;var g=(h=ci.RTime32ToDate(e.GetTimeKickExpires())).toLocaleString([],{weekday:"long",year:"numeric",month:"numeric",day:"numeric",hour:"numeric",minute:"numeric"});_=Ee.createElement("div",null,Object($.b)("#bbcode_invite_banned_until",g))}var b=this.props.inviter&&o,v=!b&&!t,S=m?a:r;return Ee.createElement(Xc,{text:[p,S,e.GetURL()]},Ee.createElement("div",{className:s},Ee.createElement("div",{className:"leftInviteContainer"},Ee.createElement(xs,{group:n,small:b,large:v}),m&&Ee.createElement("div",null,Ee.createElement(ui.gb,null))),Ee.createElement("div",{className:"rightInviteContainer"+(o||t?" rightInvite_Horizontal":"")},Ee.createElement("div",{className:"rightInviteContainerContent"},Ee.createElement(Gu,{invite:this.props.invite,inviter:this.props.inviter,invitee:this.props.invitee}),Ee.createElement("div",null,Ee.createElement("div",{className:"groupName"},S)),u&&Ee.createElement(Nu,{url:e.GetURL(),bDisabled:e.BIsExpired()}),_,!t&&o&&!m&&Ee.createElement("div",null,Ee.createElement("span",{className:"groupAlreadyJoined"},Object($.b)("#bbcode_invite_already_group_member")))),!i&&!f&&Ee.createElement("button",{className:c,type:"button",onClick:this.AcceptInvite},p)),(!t&&!o||u)&&l,Ee.createElement("div",{style:{clear:"left"}})))},R.c([T.a],t.prototype,"AcceptInvite",null),t=R.c([or.observer],t)}(Ee.Component),Gu=Object(or.observer)(function(e){var t=e.invite,n=e.inviter,o=e.invitee,i=t.BIsVoiceChatInvite(),r=t.BIsInviteLink(),a=e.inviter&&ci.FriendStore.self.accountid==e.inviter.accountid,s=ci.ChatStore.GetChatRoomGroup(t.GetChatRoomGroupID()).name,c=Object($.b)("#bbcode_invite_youre_invited");return a?c=i?r?Object($.d)("#bbcode_invite_you_shared_voice_link",Ee.createElement("span",{className:"inviteHighlight"},s," ")):Object($.d)("#bbcode_invite_you_invited_friend_voice",Ee.createElement("span",{className:"inviteHighlight"},o.display_name," "),Ee.createElement("span",{className:"inviteHighlight"},s," ")):r?Object($.d)("#bbcode_invite_you_shared_invite_link"):Object($.d)("#bbcode_invite_you_invited_friend",Ee.createElement("span",{className:"inviteHighlight"},o.display_name," ")):n&&(c=i?r?Object($.d)("#bbcode_invite_voice_url_description",Ee.createElement("span",{className:"inviteHighlight"},n.display_name," "),Ee.createElement("span",{className:"inviteHighlight"},s," ")):Object($.d)("#bbcode_invite_voice_description",Ee.createElement("span",{className:"inviteHighlight"},n.display_name," "),Ee.createElement("span",{className:"inviteHighlight"},s," ")):r?Object($.d)("#bbcode_invite_url_description",Ee.createElement("span",{className:"inviteHighlight"},n.display_name," ")):Object($.d)("#bbcode_invite_description",Ee.createElement("span",{className:"inviteHighlight"},n.display_name," "))),Ee.createElement("div",{className:"inviteLabel"},c)}),Ru=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return R.d(t,e),t.prototype.render=function(){var e=this,t=this.props,n=t.closeModal,o=t.onAccept,i=t.strClassName,r=R.f(t,["closeModal","onAccept","strClassName"]);return i="InviteDialog"+(i?" "+i:""),Ee.createElement(sr,{onEscKeypress:n},Ee.createElement(Tu,R.a({},r,{strClassName:i,onAccept:function(){e.props.closeModal&&e.props.closeModal(),o&&o()}})))},t}(Ee.Component),Nu=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return R.d(t,e),t.prototype.CopyToClipboard=function(e){Ci.j(this.props.url)},t.prototype.HandleFocus=function(e){e.currentTarget.select()},t.prototype.render=function(){var e=this.props.strLabel||Object($.b)("#bbcode_invite_url_desc");return Ee.createElement("div",{className:"inviteURLContainer"},Ee.createElement("span",{className:"inviteURLLinkDesc"},e),Ee.createElement("div",{className:"inviteURLAndCopy"},Ee.createElement("input",{className:"inviteURLLink",value:this.props.bDisabled?Object($.b)("#bbcode_invite_link_text_expired"):this.props.url,onFocus:this.HandleFocus,onClick:this.HandleFocus,readOnly:!0}),!this.props.bDisabled&&Ee.createElement("span",{className:"copyInviteLink",onClick:this.CopyToClipboard,title:Object($.b)("#Chat_Copy_Clipboard")},Ee.createElement(ui.i,null))))},R.c([T.a],t.prototype,"CopyToClipboard",null),R.c([T.a],t.prototype,"HandleFocus",null),t}(Ee.Component),Lu=function(t){function e(e){return t.call(this,e)||this}return R.d(e,t),e.prototype.AcceptGameInvite=function(){this.props.gameInvite.AcceptGameInvite()},e.prototype.DismissInvite=function(){this.props.gameInvite.DismissInvite()},e.prototype.OnShowGameContextMenu=function(e){xc(cd(this,e),this.props.gameInvite.appID,e)},e.prototype.render=function(){var e=ci.AppInfoStore.GetAppInfo(this.props.gameInvite.appID);if(!e)return null;if(ci.FriendStore.self==this.props.inviter){var t=this.props.inviteTarget.display_name;return Ee.createElement("div",{className:"gameInviteSelf"},Ee.createElement("div",{onContextMenu:this.OnShowGameContextMenu},Object($.d)("#ChatRoom_GameInvite_YouInvited",t,Ee.createElement("img",{src:e.icon_url,className:"productImage"}),e.name)))}if(this.props.gameInvite.bOld||this.props.gameInvite.bDismissed||this.props.inviter.persona.m_unGamePlayedAppID!=this.props.gameInvite.appID){var n=this.props.inviter.display_name;return Ee.createElement("div",{className:"gameInviteDismissed"},Ee.createElement("div",{onContextMenu:this.OnShowGameContextMenu},Object($.d)("#ChatRoom_GameInvite_Dismissed",n,Ee.createElement("img",{src:e.icon_url,className:"productImage"}),e.name)))}if(this.props.gameInvite.bAccepted)return Ee.createElement("div",{className:"gameInviteAccepted"},Ee.createElement("div",{onContextMenu:this.OnShowGameContextMenu},Object($.d)("#ChatRoom_GameInvite_Accepted",Ee.createElement("img",{src:e.icon_url,className:"productImage"}),e.name)));var o=this.props.inviter,i=null,r=o.persona.player_group_size-1;if(o.persona.m_unGamePlayedAppID==this.props.gameInvite.appID&&0<o.persona.player_group_size){var a=o.persona.player_group;ci.FriendStore.all_friends;i=ci.FriendStore.FriendGroupStore.ingame_group.member_list.map(function(e){return e!=o&&e.persona.player_group==a?(r--,Ee.createElement(Kc,{key:e.accountid,friend:e,context:null})):null})}var s={};this.props.chatGutterWidth&&(s.marginLeft="-"+this.props.chatGutterWidth+"px");var c=Object($.d)("#ChatRoom_GameInvite_Invite",this.props.inviter.display_name);return Ee.createElement("div",{className:"msg ChatMessageInvite gameInviteMsg",style:s},Ee.createElement("div",{className:"leftInviteContainer"},Ee.createElement("img",{src:e.header_image_url,className:"productImage productImageBlur"}),Ee.createElement("img",{src:e.header_image_url,className:"productImage"})),Ee.createElement("div",{className:"rightInviteContainer"},Ee.createElement("div",{className:"centerBlock"},Ee.createElement("div",{className:"invitedTimeLabel"},Object($.b)("#ChatRoom_GameInvite_InviteTime"),Ee.createElement(jr,{rtime:this.props.gameInvite.rtTimestamp,bTimeOnly:!0})),Ee.createElement(Xc,null,Ee.createElement("div",{className:"inviteLabel"},c)),Ee.createElement(Xc,null,Ee.createElement("div",{className:"productName"},e.name)),0<o.persona.player_group_size&&Ee.createElement(Xc,null,Ee.createElement("div",{className:"playingWithBlock"},Ee.createElement("div",null,Object($.b)("#ChatRoom_GameInvite_PlayingWith")),Ee.createElement("div",{className:"playingWithAvatars"},Ee.createElement("div",{className:"playingWithLine"}),i,0<r&&Ee.createElement("div",{className:"playingWithExtraCount"},Object($.b)("#ChatRoom_GameInvite_PartyMore",r)," "))))),Ee.createElement("button",{className:"DialogButton GreenPlay",onClick:this.AcceptGameInvite},Object($.b)("#ChatRoom_GameInvite_Accept")),Ee.createElement("div",{className:"closeButton",onClick:this.DismissInvite},Ee.createElement(ui.jb,null))))},R.c([T.a],e.prototype,"AcceptGameInvite",null),R.c([T.a],e.prototype,"DismissInvite",null),R.c([T.a],e.prototype,"OnShowGameContextMenu",null),e=R.c([or.observer],e)}(Ee.Component),ku=function(n){function e(e){var t=n.call(this,e)||this;return t.state={bSubscribed:!1,bDismissed:!1,bThumbnailLoaded:!1},t}return R.d(e,n),e.prototype.componentDidMount=function(){this.props.broadcaster.accountid!=ci.FriendStore.self.accountid&&this.props.broadcastid&&(ci.BroadcastStore.SubscribeToBroadcastDetails(this.props.broadcastid,this.props.broadcaster.steamid64),this.setState({bSubscribed:!0}))},e.prototype.componentWillUnmount=function(){this.state.bSubscribed&&ci.BroadcastStore.UnsubscribeFromBroadcastDetails(this.props.broadcastid,this.props.broadcaster.steamid64)},e.prototype.OnWatch=function(e){if("undefined"!=typeof SteamClient&&void 0!==SteamClient.WebChat){var t="steam://broadcast/watch/"+this.props.broadcaster.steamid64,n=cd(this,e);SteamClient.WebChat.OpenURLInClient(t,n.m_unPID)}else{Ur(e,G.a.COMMUNITY_BASE_URL+"broadcast/watch/"+this.props.broadcaster.steamid64),e.stopPropagation()}this.OnClose()},e.prototype.OnClose=function(){this.setState({bDismissed:!0})},e.prototype.OnOpen=function(){this.setState({bDismissed:!1})},e.prototype.ShowThumbnail=function(){this.setState({bThumbnailLoaded:!0})},e.prototype.render=function(){var e=ci.AppInfoStore.GetAppInfo(this.props.appid),t=Ee.createElement("span",null,Ee.createElement("img",{src:e.icon_url,className:"productImage"}),Ee.createElement("span",{className:"productName"},e.name));if(this.props.broadcaster.accountid==ci.FriendStore.self.accountid){var n=this.props.viewer.display_name;return Ee.createElement("div",{className:"broadcastInviteSelf"},this.props.appid?Object($.d)("#ChatRoom_BroadcastInvite_YouInvited",n,t):Object($.d)("#ChatRoom_BroadcastInvite_YouInvited_NoAppID",n))}var o=this.props.broadcaster.display_name,i=ci.BroadcastStore.GetBroadcastDetails(this.props.broadcastid,this.props.broadcaster.steamid64)||{strThumbnail:"",bExpired:!1};if(this.state.bDismissed||!this.props.broadcastid||i.bExpired)return Ee.createElement("div",{className:"broadcastInviteDismissed"},this.props.appid?Object($.d)("#ChatRoom_BroadcastInvite_Expired",o,t):Object($.d)("#ChatRoom_BroadcastInvite_Expired_NoAppID",o));var r=G.a.COMMUNITY_CDN_URL+"public/images/broadcast/apphub_default_thumbnail.jpg",a=Object($.d)("#ChatRoom_BroadcastInvite_Invite",o);return Ee.createElement("div",{className:"msg ChatMessageInvite broadcastInviteMsg"},Ee.createElement("div",{className:"leftInviteContainer"},Ee.createElement("img",{src:i.strThumbnail,onLoad:this.ShowThumbnail,className:"broadcastThumbnail"+(this.state.bThumbnailLoaded?" loaded":"")}),Ee.createElement("img",{src:r,className:"broadcastThumbnail broadcastThumbnailFallback"+(this.state.bThumbnailLoaded?"":" loaded")}),Ee.createElement("div",{className:"noisePattern"})),Ee.createElement("div",{className:"rightInviteContainer"},Ee.createElement(Xc,null,Ee.createElement("div",{className:"centerBlock"},Ee.createElement("div",{className:"inviteLabel"},a),Ee.createElement("div",{className:"productName"},e.name))),Ee.createElement("button",{className:"DialogButton Primary inviteButtonWatchBroadcast",onClick:this.OnWatch},Object($.b)("#ChatRoom_BroadcastInvite_Watch")),Ee.createElement("div",{className:"closeButton",onClick:this.OnClose},Ee.createElement(ui.jb,null))))},R.c([T.a],e.prototype,"OnWatch",null),R.c([T.a],e.prototype,"OnClose",null),R.c([T.a],e.prototype,"OnOpen",null),R.c([T.a],e.prototype,"ShowThumbnail",null),e=R.c([or.observer],e)}(Ee.Component),Pu=function(n){function e(e){var t=n.call(this,e)||this;return t.m_pollTimeout=void 0,t.m_broadcastid=void 0,t.m_bExpired=!1,t.state={strThumbnail:"",nUpdateInterval:10,bThumbnailLoaded:!1,nThumbnailUpdateCounter:0},t}return R.d(e,n),e.prototype.OnAccept=function(e){ci.BroadcastStore.ApproveViewerRequest(this.props.viewer.accountid,this.props.requestid)},e.prototype.OnClose=function(){ci.BroadcastStore.RejectViewerRequest(this.props.viewer.accountid,this.props.requestid)},e.prototype.ShowThumbnail=function(){this.setState({bThumbnailLoaded:!0})},e.prototype.render=function(){var e=ci.AppInfoStore.GetAppInfo(this.props.appid),t=Ee.createElement("span",null,Ee.createElement("img",{src:e.icon_url,className:"productImage"}),Ee.createElement("span",{className:"productName"},e.name)),n=this.props.viewer.display_name,o=ci.BroadcastStore.GetRequestState(this.props.viewer.accountid,this.props.requestid),i=void 0!==this.m_broadcastid&&this.m_broadcastid!=ci.BroadcastStore.broadcastid;if(void 0===this.m_broadcastid&&"0"!==ci.BroadcastStore.broadcastid&&(this.m_broadcastid=ci.BroadcastStore.broadcastid),i||o!=mn.k_EPending){var r="#ChatRoom_BroadcastViewRequest_Expired";return o==mn.k_EAccepted?r="#ChatRoom_BroadcastViewRequest_Accepted":o==mn.k_ERejected&&(r="#ChatRoom_BroadcastViewRequest_Dismissed"),Ee.createElement("div",{className:"broadcastViewRequestDismissed"},Object($.d)(r,n,t))}var a=G.a.COMMUNITY_CDN_URL+"public/images/broadcast/apphub_default_thumbnail.jpg",s=(this.state.bThumbnailLoaded,this.state.nThumbnailUpdateCounter),c=Object($.d)("#ChatRoom_BroadcastViewRequest_Invite",n);return Ee.createElement("div",{className:"msg ChatMessageInvite broadcastInviteMsg broadcastViewRequestMsg"},Ee.createElement("div",{className:"leftInviteContainer"},this.state.strThumbnail&&Ee.createElement("img",{src:this.state.strThumbnail+"?n="+s,onLoad:this.ShowThumbnail,className:"broadcastThumbnail"+(this.state.bThumbnailLoaded?" loaded":"")}),Ee.createElement("img",{src:a,className:"broadcastThumbnail broadcastThumbnailFallback"+(this.state.bThumbnailLoaded?"":" loaded")}),Ee.createElement("div",{className:"noisePattern"})),Ee.createElement("div",{className:"rightInviteContainer"},Ee.createElement(Xc,null,Ee.createElement("div",{className:"centerBlock"},Ee.createElement("div",{className:"inviteLabel"},c),Ee.createElement("div",{className:"productName"},e.name))),Ee.createElement("button",{className:"inviteButton inviteButtonWatchBroadcast",onClick:this.OnAccept},Object($.b)("#ChatRoom_BroadcastViewRequest_Accept")),Ee.createElement("div",{className:"closeButton",onClick:this.OnClose})))},R.c([T.a],e.prototype,"OnAccept",null),R.c([T.a],e.prototype,"OnClose",null),R.c([T.a],e.prototype,"ShowThumbnail",null),e=R.c([or.observer],e)}(Ee.Component),Au=function(n){function e(e){var t=n.call(this,e)||this;return t.m_pollTimeout=void 0,t.m_broadcastid=void 0,t.m_bExpired=!1,t.state={strThumbnail:"",nUpdateInterval:10,bThumbnailLoaded:!1,nThumbnailUpdateCounter:0},t}return R.d(e,n),e.prototype.OnWatch=function(e){if("undefined"!=typeof SteamClient&&void 0!==SteamClient.WebChat){var t="steam://broadcast/watch/"+this.props.broadcaster.steamid64,n=cd(this,e);SteamClient.WebChat.OpenURLInClient(t,n.m_unPID)}else{Ur(e,G.a.COMMUNITY_BASE_URL+"broadcast/watch/"+this.props.broadcaster.steamid64),e.stopPropagation()}},e.prototype.ShowThumbnail=function(){this.setState({bThumbnailLoaded:!0})},e.prototype.render=function(){var e=this.props.broadcaster.current_game_name,t=this.props.broadcaster.display_name,n=G.a.COMMUNITY_CDN_URL+"public/images/broadcast/apphub_default_thumbnail.jpg",o=(this.state.bThumbnailLoaded,this.state.nThumbnailUpdateCounter),i=Object($.d)("#ChatRoom_BroadcastInvite_WatchGame",t);return Ee.createElement("div",{className:"msg ChatMessageInvite broadcastInviteMsg"},Ee.createElement("div",{className:"leftInviteContainer"},this.state.strThumbnail&&Ee.createElement("img",{src:this.state.strThumbnail+"?n="+o,onLoad:this.ShowThumbnail,className:"broadcastThumbnail"+(this.state.bThumbnailLoaded?" loaded":"")}),Ee.createElement("img",{src:n,className:"broadcastThumbnail broadcastThumbnailFallback"+(this.state.bThumbnailLoaded?"":" loaded")}),Ee.createElement("div",{className:"noisePattern"})),Ee.createElement("div",{className:"rightInviteContainer"},Ee.createElement(Xc,null,Ee.createElement("div",{className:"centerBlock"},Ee.createElement("div",{className:"inviteLabel"},i),e&&Ee.createElement("div",{className:"productName"},e))),Ee.createElement("button",{className:"DialogButton Primary inviteButtonWatchBroadcast",onClick:this.OnWatch},Object($.b)("#ChatRoom_BroadcastInvite_Watch"))))},R.c([T.a],e.prototype,"OnWatch",null),R.c([T.a],e.prototype,"ShowThumbnail",null),e}(Ee.Component);(Mu=wu||(wu={}))[Mu.NotLoaded=0]="NotLoaded",Mu[Mu.Loading=1]="Loading",Mu[Mu.Loaded=2]="Loaded";var Bu=wu.NotLoaded,Fu=[];function Vu(){Bu=wu.Loaded;for(var e=0,t=Fu;e<t.length;e++){(0,t[e])()}Fu=[]}var xu=function(n){function e(e){var t=n.call(this,e)||this;return t.m_strPlayerID="",t.m_player=null,t.m_playerContainer=null,t.m_bPlayerReady=!1,t.state={bYoutubeLoaded:!1},t}return R.d(e,n),e.prototype.componentWillMount=function(){this.m_strPlayerID="YoutubePlayer_"+e.s_nPlayerIndex++},e.prototype.componentWillUnmount=function(){var e;this.DestroyPlayer(),e=this.OnYoutubeScriptsReady,M.d(Fu,e)},e.prototype.shouldComponentUpdate=function(e,t){if(!this.m_player)return!1;var n=this.props;return n.autoplay!=e.autoplay||n.controls!=e.controls||n.showInfo!=e.showInfo||n.video!=e.video?this.CreatePlayer(e):n.width==e.width&&n.height==e.height||this.m_bPlayerReady&&this.m_player.setSize(e.width,e.height),!1},e.prototype.DestroyPlayer=function(){if(this.m_player)try{this.m_player.stopVideo&&this.m_player.stopVideo(),this.m_player.destroy&&this.m_player.destroy()}catch(e){}finally{this.m_player=null}},e.prototype.BindPlayerContainer=function(e){this.m_playerContainer!=e&&(this.m_playerContainer=e,this.DestroyPlayer(),this.m_playerContainer&&function(t){if(Bu!=wu.Loaded){if(Bu==wu.NotLoaded){var e=document.createElement("script");e.src="https://www.youtube.com/iframe_api";var n=document.getElementsByTagName("script")[0];n.parentNode.insertBefore(e,n),window.onYouTubeIframeAPIReady=Vu}Fu.findIndex(function(e){return t==e})<0&&Fu.push(t)}else t()}(this.OnYoutubeScriptsReady))},e.prototype.OnYoutubeScriptsReady=function(){this.CreatePlayer(this.props)},e.prototype.CreatePlayer=function(e){if(this.DestroyPlayer(),this.m_playerContainer){var t=!1===e.autoplay?0:1,n=!0===e.showInfo?1:0,o=!0===e.controls?1:0,i=!0===e.showFullscreenBtn?1:0,r={width:String(e.width),height:String(e.height),videoId:e.video,playerVars:{autoplay:t,showinfo:n,autohide:1,fs:i,modestbranding:1,rel:0,playsinline:0,iv_load_policy:3,controls:o,start:e.startSeconds},events:{onReady:this.OnPlayerReady,onStateChange:this.OnPlayerStateChange,onError:this.OnError}},a=this.m_playerContainer.firstElementChild;this.m_bPlayerReady=!1,this.m_player=new YT.Player(a,r)}},e.prototype.OnPlayerReady=function(e){if(this.m_bPlayerReady=!0,this.props.onVideoInfoChanged){var t=this.m_player.getVideoData(),n={strAuthor:"",strTitle:"",strVideoID:""};t.author&&(n.strAuthor=t.author),t.title&&(n.strTitle=t.title),t.video_id&&(n.strVideoID=t.video_id),this.props.onVideoInfoChanged(n)}this.m_player.setSize(this.props.width,this.props.height),this.props.onPlayerReady&&this.props.onPlayerReady()},e.prototype.OnPlayerStateChange=function(e){switch(e.data){case YT.PlayerState.UNSTARTED:case YT.PlayerState.PLAYING:case YT.PlayerState.PAUSED:case YT.PlayerState.BUFFERING:break;case YT.PlayerState.ENDED:this.props.onMovieEnd&&this.props.onMovieEnd()}},e.prototype.OnError=function(e){console.log("Youtube: Playback failed",e),this.props.onError&&this.props.onError(e)},e.prototype.render=function(){return Ee.createElement("div",{key:this.m_strPlayerID,ref:this.BindPlayerContainer,className:"YoutubePlayer"},Ee.createElement("div",null,"Loading Youtube..."))},e.s_nPlayerIndex=0,R.c([T.a],e.prototype,"BindPlayerContainer",null),R.c([T.a],e.prototype,"OnYoutubeScriptsReady",null),R.c([T.a],e.prototype,"CreatePlayer",null),R.c([T.a],e.prototype,"OnPlayerReady",null),R.c([T.a],e.prototype,"OnPlayerStateChange",null),R.c([T.a],e.prototype,"OnError",null),e}(Ee.Component);function Uu(e){var t,n,o=(t=e,n=new RegExp("^(steam://openurl(_external)?/)?(f|ht)tps?://([^@/?#]*@)?([^/#?]+)","im"),t.match(n)[5].toString());return o.startsWith("www.")&&(o=o.slice(4)),o}var ju=function(e){var t=e.children;return Oe.a.createElement(Xc,{text:t},Oe.a.createElement("div",{className:"spoilerMsgText"},Oe.a.createElement("div",{className:"spoilerMsg"},t)))},Hu=n("SOfK"),Wu=n.n(Hu),zu=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return R.d(t,e),t.prototype.CheckLoadPrettify=function(){var e=this;if(this.m_preElem){var t=this.m_preElem.ownerDocument.defaultView;if(t&&"object"!=typeof t.PR&&!0!==t.PR){t.PR=!0;var n=t.document.createElement("script");t.document.head.appendChild(n),n.onload=function(){e.TryRunPrettyPrint()},n.src=G.a.COMMUNITY_CDN_ASSET_URL+"prettify/prettify.js"}}},t.prototype.BindRef=function(e){this.m_preElem=e},t.prototype.TryRunPrettyPrint=function(){if(this.CheckLoadPrettify(),this.m_preElem){var e=this.m_preElem.ownerDocument.defaultView;e&&"object"==typeof e.PR&&e.PR.prettyPrint()}},t.prototype.componentDidMount=function(){this.TryRunPrettyPrint()},t.prototype.componentDidUpdate=function(){this.TryRunPrettyPrint()},t.prototype.render=function(){return Oe.a.createElement("div",null,Oe.a.createElement("pre",{className:hr("prettyprint",Wu.a.CodeMessage),ref:this.BindRef},this.props.children))},R.c([T.a],t.prototype,"BindRef",null),t}(Oe.a.Component),qu=function(e){var t=e.children;return Oe.a.createElement("div",null,Oe.a.createElement("pre",{className:Wu.a.PreMessage},t))},Ku=function(e){var t=e.children;return Oe.a.createElement("div",{className:Wu.a.QuoteMessage},t)},Yu=n("MfD9"),Ju=n.n(Yu);function Xu(e){if(e.context.chat instanceof Jt){var t=e.args.appid,n=ci.AppInfoStore.GetAppInfo(parseInt(t)).m_strName;return{title:"",body:Object($.b)("#Friend_Notification_GameInvite",e.context.chat.chat_partner.display_name,n)}}return null}function Qu(e){if(e.context.chat instanceof Jt){var t=e.args.appid,n=ci.AppInfoStore.GetAppInfo(parseInt(t)).m_strName;return{title:"",body:Object($.b)("#Friend_Notification_GameInvite",e.context.chat.chat_partner.display_name,n)}}return null}function Zu(e){return e.context.chat instanceof Jt?null!=e.args.chatid?{title:"",body:Object($.b)("#Friend_Notification_InviteVoice",e.context.chat.chat_partner.display_name,e.args.chatname)}:{title:"",body:Object($.b)("#Friend_Notification_Invite",e.context.chat.chat_partner.display_name,e.args.chatgroupname)}:null}function $u(e){var t=e.context.chat;return t instanceof Jt?{title:Object($.b)("#TradeOffer_FriendSentYou",t.chat_partner.display_name),body:e.text}:null}function em(e){return{body:Object($.b)("#Notification_Spoiler")}}tm("#bbcode_random_description"),tm("#bbcode_flip_description"),tm("#bbcode_video_description"),tm("#bbcode_inviteurl_description"),tm("#bbcode_image_description");function tm(n){return function(e){var t=ci.FriendStore.GetPlayer(e.context.unAccountIDSender);return{body:Object($.b)(n,t.display_name)}}}function nm(){return{url:am,youtube:cm,filteredurl:Bm,emoticon:Vm,img:pm,video:mm,og:_m,tweet:fm,inviteurl:wm,publishedfile:Nm,tradeofferlink:Lm,econitem:Am,steamstore:xm,broadcast:Pm,oembed:gm,spoiler:vm,plusone:Sm,flip:ym,random:Cm,quote:Im,pre:Em,code:Om}}function om(e){if("string"==typeof e)return e;var n="";return Ee.Children.forEach(e,function(e){if("string"!=typeof e){if("object"==typeof e&&e.props){var t=e.props["bbcode-text"];t&&(n+=t)}}else n+=e}),n}var im,rm,am=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return R.d(t,e),t.prototype.render=function(){var e,t,n=this.GetArgument(),o=this.props.children,i=null,r=(e=n,(t=document.createElement("a")).href=e,0<=t.hostname.indexOf("xn--")?t.href:e);return r!=n&&(i=r),o||(i=r),ci.SettingsStore.FriendsSettings.bDisableEmbedInlining&&"string"!=typeof o?Ee.createElement(lm,{href:n},Ee.createElement(ui.w,null),r):Ee.createElement(Xc,{text:n,style:"merge-adjacent"},Ee.createElement(Ar,{href:n},i||o))},t=R.c([or.observer],t)}(we),sm=function(i){function e(e){var t=i.call(this,e)||this,n=ci.ChatStore.EmbedStore.GetCollapsedState(t.props.unAccountIDSender,t.props.msgUniqueKey),o=ci.ChatStore.EmbedStore.GetWidths(t.props.unAccountIDSender,t.props.msgUniqueKey);return t.state={nResizedWidth:n?16:o?o.nDesiredWidth:0,bResized:void 0!==o,bIsResizing:!1,bIsRestoring:!1,bMinimized:n,bIsMinimizing:!1},t.m_frameInitialXPos=-1,t.m_frameInitialYPos=-1,t.m_frameInitialWidth=-1,t.m_frameDefaultWidth=o?o.nDefaultWidth:-1,t.m_frameDesiredWidth=o?o.nDesiredWidth:-1,t}return R.d(e,i),e.prototype.BindContainer=function(e){this.m_elContainer=e,this.m_elContainer&&450<this.props.height&&this.HandleTallImages()},e.prototype.handleCollapse=function(e){var t=this;this.state.bMinimized||(this.m_frameDesiredWidth=this.m_elContainer.clientWidth),this.m_animationCollapse&&this.m_animationCollapse.Cancel();var n=!this.state.bMinimized,o=n?this.m_frameDesiredWidth:16,i=n?16:this.m_frameDesiredWidth;this.setState({nResizedWidth:o,bMinimized:!1,bIsMinimizing:!0},function(){t.m_animationCollapse=new Oi(t,{nResizedWidth:i},{msDuration:300,timing:"sine",setStateOnComplete:{bMinimized:n,bIsMinimizing:!1},onComplete:t.OnSizeChanged}),t.m_animationCollapse.Start()}),ci.ChatStore.EmbedStore.SetCollapsedState(this.props.unAccountIDSender,this.props.msgUniqueKey,n)},e.prototype.OnSizeChanged=function(){this.props.onSizeChanged("BBCodeResizableComponent "+this.props.msgUniqueKey+this.state.bResized+this.state.bMinimized)},e.prototype.handleRestore=function(e){var t=this;this.state.bResized&&(this.m_animationCollapse&&this.m_animationCollapse.Cancel(),this.setState({bIsRestoring:!0},function(){t.m_animationCollapse=new Oi(t,{nResizedWidth:t.m_frameDefaultWidth},{msDuration:300,timing:"sine",setStateOnComplete:{bMinimized:!1,bIsRestoring:!1,bResized:!1},onComplete:t.OnSizeChanged}),t.m_animationCollapse.Start()}),ci.ChatStore.EmbedStore.SetWidths(this.props.unAccountIDSender,this.props.msgUniqueKey,this.m_frameDefaultWidth,this.m_frameDefaultWidth))},e.prototype.OnResize=function(e){var t=e.currentTarget.ownerDocument.defaultView;t.addEventListener("mousemove",this.HandleMouseMove),t.addEventListener("mouseup",this.HandleMouseUp)},e.prototype.HandleMouseMove=function(e){this.m_frameInitialXPos<0&&(this.m_frameInitialXPos=e.clientX),this.m_frameInitialWidth<0&&(this.m_frameInitialWidth=this.m_elContainer.clientWidth),this.m_frameDefaultWidth<0&&!this.state.bResized&&(this.m_frameDefaultWidth=this.m_elContainer.clientWidth),this.m_frameInitialYPos<0&&(this.m_frameInitialYPos=e.clientY);var t=e.clientX-this.m_frameInitialXPos,n=e.clientY-this.m_frameInitialYPos,o=this.m_frameInitialWidth+t+n,i="image"==this.props.strMediaType?64:320;o<i&&(o=i),1280<o&&(o=1280),this.setState({nResizedWidth:o,bResized:!0,bIsResizing:!0}),this.OnSizeChanged()},e.prototype.HandleTallImages=function(){var e=450*(this.props.width/this.props.height),t=this.props.width;t>Math.min(1280,e)&&(t=Math.min(1280,e)),t<parseInt(this.m_elContainer.ownerDocument.defaultView.getComputedStyle(this.m_elContainer).maxWidth)&&this.setState({nMaxWidth:t}),this.OnSizeChanged()},e.prototype.HandleMouseUp=function(e){e.view.removeEventListener("mousemove",this.HandleMouseMove),e.view.removeEventListener("mouseup",this.HandleMouseUp),this.m_frameInitialXPos=-1,this.m_frameInitialYPos=-1,this.m_frameInitialWidth=-1,this.state.bIsResizing&&this.setState({bIsResizing:!1}),!this.state.bMinimized&&this.m_elContainer&&(this.m_frameDesiredWidth=this.m_elContainer.clientWidth),ci.ChatStore.EmbedStore.SetWidths(this.props.unAccountIDSender,this.props.msgUniqueKey,this.m_frameDesiredWidth,this.m_frameDefaultWidth)},e.prototype.render=function(){var e={};0<this.state.nResizedWidth?e.width=this.state.nResizedWidth+"px":this.state.nMaxWidth&&(e.maxWidth=this.state.nMaxWidth+"px");var t="BBCodeResizableComponent";this.props.className&&(t+=" "+this.props.className),this.state.bResized&&(t+=" Resized"),this.state.bIsResizing&&(t+=" ActivelyResizing"),this.state.bMinimized&&(t+=" Minimized"),this.state.bIsMinimizing&&(t+=" Minimizing");var n=this.props.titleInfo?this.props.titleInfo:"";return Ee.createElement(Xc,{style:this.props["data-copystyle"],text:this.props["data-copytext"]},Ee.createElement("div",{className:t,style:e,ref:this.BindContainer},Ee.createElement("div",{className:"BBCodeCollapsed",onClick:this.handleCollapse,title:n},Object($.b)("#bbcode_"+this.props.strMediaType+"_minimized")),!this.state.bMinimized&&!this.state.bIsMinimizing&&this.props.children,Ee.createElement("div",{className:"BBCodeRestoreControl",onClick:this.handleRestore,title:Object($.b)("#bbcode_"+this.props.strMediaType+"_tooltip_restore")},Ee.createElement("div",{className:"restoreSize"})),Ee.createElement("div",{className:"BBCodeResizeControl",onMouseDown:this.OnResize,title:Object($.b)("#bbcode_"+this.props.strMediaType+"_tooltip_resize")},Ee.createElement(ui.N,null)),Ee.createElement("div",{className:"BBCodeCollapseControl",onClick:this.handleCollapse,title:this.state.bMinimized?Object($.b)("#bbcode_"+this.props.strMediaType+"_tooltip_uncollapse"):Object($.b)("#bbcode_"+this.props.strMediaType+"_tooltip_collapse")},Ee.createElement(ui.ib,null))))},R.c([T.a],e.prototype,"BindContainer",null),R.c([T.a],e.prototype,"handleCollapse",null),R.c([T.a],e.prototype,"OnSizeChanged",null),R.c([T.a],e.prototype,"handleRestore",null),R.c([T.a],e.prototype,"OnResize",null),R.c([T.a],e.prototype,"HandleMouseMove",null),R.c([T.a],e.prototype,"HandleTallImages",null),R.c([T.a],e.prototype,"HandleMouseUp",null),e}(Ee.Component),cm=function(n){function e(e){var t=n.call(this,e)||this;return t.state={strTitle:"",strAuthor:"",strVideoID:""},t}return R.d(e,n),e.prototype.OnVideoInfoChanged=function(e){var t=e.strTitle,n=e.strAuthor,o=e.strVideoID;this.setState({strTitle:t,strAuthor:n,strVideoID:o})},e.prototype.OnPlayerReady=function(){this.props.context.onLoad&&this.props.context.onLoad("BBCodeYouTubeComponent "+this.state.strVideoID)},e.prototype.OnPlaceholderImageLoad=function(){this.props.context.onLoad&&this.props.context.onLoad("BBCodeYouTubeComponent "+this.state.strVideoID)},e.prototype.componentDidMount=function(){var e=this;W.findDOMNode(this).ownerDocument.defaultView.setTimeout(function(){e.props.context.onLoad&&e.props.context.onLoad("BBCodeYouTubeComponent "+e.state.strVideoID)},250)},e.prototype.GetVideoID=function(){return this.GetArgument("v").replace(/^[^a-z0-9\-_]*([a-z0-9\-_]+).*$/gi,"$1")},e.prototype.render=function(){var e=this.state.strAuthor,t=this.state.strTitle,n="https://www.youtube.com/watch?v="+this.state.strVideoID,o=this.GetArgument("t");if(o&&(n+="&t="+encodeURIComponent(o)),ci.SettingsStore.FriendsSettings.bDisableEmbedInlining){var i="https://www.youtube.com/watch?v="+encodeURIComponent(this.GetVideoID());return o&&(i+="&t="+encodeURIComponent(o)),Ee.createElement(lm,{href:i},Ee.createElement(ui.kb,null),i)}var r=0;if(o){var a=o.match(/^(?:([\d]+)h)?(?:([\d]+)m)?(?:([\d]+)s)?/);0<a[0].length?(null!=a[1]&&(r+=3600*parseInt(a[1])),null!=a[2]&&(r+=60*parseInt(a[2])),null!=a[3]&&(r+=parseInt(a[3]))):r=parseInt(o)}return Ee.createElement(Xc,{style:"block",text:[t,n]},Ee.createElement(sm,{className:"BBCodeYouTubeComponent",unAccountIDSender:this.props.context.unAccountIDSender,msgUniqueKey:this.props.context.key,strMediaType:"video",titleInfo:t,onSizeChanged:this.props.context.onLoad},Ee.createElement("div",{className:"BBCodeYouTubeComponent_Sizer BBCodeResizableElement"},Ee.createElement(xu,{video:this.GetVideoID(),startSeconds:r,width:640,height:385,autoplay:!1,controls:!0,showFullscreenBtn:!0,onVideoInfoChanged:this.OnVideoInfoChanged,onPlayerReady:this.OnPlayerReady}),Ee.createElement(Xc,{style:"block",text:[t,n]},Ee.createElement("img",{src:G.a.PUBLIC_SHARED_URL+"images/responsive/youtube_16x9_placeholder.gif",width:"100%",onLoad:this.OnPlaceholderImageLoad}))),0<t.length&&Ee.createElement(Ar,{className:"test HideWhenMinimized",href:n},Ee.createElement("div",{className:"BBCodeTitle"},t)),0<e.length&&Ee.createElement("div",{className:"BBCodeDetails HideWhenMinimized"},Object($.b)("#bbcode_youtube_author",e))))},R.c([T.a],e.prototype,"OnVideoInfoChanged",null),R.c([T.a],e.prototype,"OnPlayerReady",null),R.c([T.a],e.prototype,"OnPlaceholderImageLoad",null),e=R.c([or.observer],e)}(we);function lm(e){var t=e.copyText;return null==t&&(t=e.href),Ee.createElement(Xc,{text:t,style:"merge-adjacent"},Ee.createElement("div",{className:"NonInlinedEmbed"},Ee.createElement(Ar,{href:e.href,title:e.href},e.children)))}(rm=im||(im={}))[rm.Loading=1]="Loading",rm[rm.Loaded=2]="Loaded",rm[rm.Error=3]="Error";var pm=function(n){function e(e){var t=n.call(this,e)||this;return t.state={eLoadingState:im.Loading},t}return R.d(e,n),e.prototype.IsEmbeddedInOtherTag=function(){for(var e=0,t=this.props.parentTags;e<t.length;e++){if("tweet"==t[e])return!0}return!1},e.prototype.OnImageLoad=function(){this.setState({eLoadingState:im.Loaded}),this.props.context.onLoad&&this.props.context.onLoad("BBCodeImage "+this.props.args.src)},e.prototype.OnImageError=function(){this.setState({eLoadingState:im.Error})},e.prototype.ShowModal=function(e,t){var n=parseInt(this.GetArgument("width")),o=parseInt(this.GetArgument("height")),i=e.currentTarget.ownerDocument.defaultView;fr(Ee.createElement(um,{imageUrl:t,ownerWin:i}),i,"ImageModal",{strTitle:"",popupHeight:Object(_n.a)(o,.5*i.screen.height,.7*i.screen.height),popupWidth:Object(_n.a)(n,.5*i.screen.width,.7*i.screen.width)},pd(i))},e.prototype.render=function(){var e,t=this,n=this.GetArgument("thumbnail_src"),o=this.GetArgument("srcset",!0),i=this.GetArgument("src"),r=this.GetArgument("title"),a=this.state.eLoadingState,s=parseInt(this.GetArgument("width")),c=parseInt(this.GetArgument("height")),l=void 0!==this.GetArgument("giphy_search");if(c&&(c=Math.max(0,Math.min(c,652))),s&&(s=Math.max(0,Math.min(s,652))),l&&(e="/giphy "+this.GetArgument("giphy_search")),ci.SettingsStore.FriendsSettings.bDisableEmbedInlining){if(l)return Ee.createElement(lm,{href:i,copyText:[e,i]},Ee.createElement("div",{className:"NonInlinedEmbedLogo NonInlinedEmbedLogo_Giphy"}),Ee.createElement("span",{style:{fontWeight:"bold"}}," ",Object($.d)("#bbcode_image_link_giphy",Ee.createElement("span",{className:"giphySearch"},this.GetArgument("giphy_search")))));var p=i;return r&&(p=Object($.b)("#bbcode_disable_embed_inlining_parenthetical",r,Uu(i))),Ee.createElement(lm,{href:i,copyText:[r,i]},Ee.createElement(ui.x,null),p)}if("true"==this.GetArgument("proxied")&&(n+="?s=652x652"),this.IsEmbeddedInOtherTag())return Ee.createElement(dm,{className:"embeddedImg",context:this.props.context,src:n,onContextMenu:Vr});var u="chatImageContainer";l&&(u+=" giphyImg"),a==im.Error&&(u+=" FailedToLoad");var m={display:"none"};return a==im.Loaded&&(m={display:"block"}),Ee.createElement(Ee.Fragment,null,l&&Ee.createElement(Xc,null,Ee.createElement("div",null,e)),Ee.createElement(Xc,{style:"block",text:[r,i]},Ee.createElement(sm,{className:u,width:s,height:c,strMediaType:"image",unAccountIDSender:this.props.context.unAccountIDSender,msgUniqueKey:this.props.context.key,titleInfo:l?Object($.b)("#bbcode_image_link_giphy",this.GetArgument("giphy_search")):i,onSizeChanged:this.props.context.onLoad},a==im.Loading&&Ee.createElement("div",{className:"LoadingImage"},"Loading image: ",Ee.createElement(Ar,{href:i},i)),a==im.Error&&Ee.createElement("div",{className:"FailedToLoadImage"},Ee.createElement("span",null,"Failed to load image:")," ",Ee.createElement(Ar,{href:i},i)),Ee.createElement("img",{style:m,className:"chatImageFull BBCodeResizableElement",src:n,srcSet:o,onLoad:this.OnImageLoad,onError:this.OnImageError,onContextMenu:function(e){xr(e,i)},onClick:function(e){return t.ShowModal(e,l?n:i)}}),a==im.Loaded&&Ee.createElement(Ee.Fragment,null,Ee.createElement(Ar,{className:"chatImageURL",href:i,title:l?Object($.b)("#bbcode_image_tooltip_link_giphy",this.GetArgument("giphy_search")):Object($.b)("#bbcode_image_tooltip_link")},Ee.createElement(ui.L,null),Ee.createElement("div",{className:"giphyTag"},l&&Object($.d)("#bbcode_image_link_giphy",Ee.createElement("span",{className:"giphySearch"},this.GetArgument("giphy_search")))))))))},R.c([T.a],e.prototype,"OnImageLoad",null),R.c([T.a],e.prototype,"OnImageError",null),R.c([T.a],e.prototype,"ShowModal",null),e=R.c([or.observer],e)}(we),um=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return R.d(t,e),t.prototype.render=function(){return Ee.createElement(sr,{onEscKeypress:this.props.closeModal,hideTopBar:!0},Ee.createElement("div",{className:Ju.a.ImageModalBackground},Ee.createElement("img",{className:Ju.a.ImageModalContent,src:this.props.imageUrl})))},t}(Ee.Component),mm=function(n){function e(e){var t=n.call(this,e)||this;return t.state={bSeeking:!1,bPlay:!1,bError:!1},t}return R.d(e,n),e.prototype.StartVideo=function(){this.m_elVideo&&this.m_elVideo.play()},e.prototype.BindVideo=function(e){this.m_elVideo=e},e.prototype.OnVideoPlay=function(){this.setState({bPlay:!0})},e.prototype.OnVideoPause=function(){this.state.bPlay||this.state.bSeeking||this.setState({bPlay:!1})},e.prototype.OnVideoError=function(e){this.setState({bError:!0})},e.prototype.OnVideoLoaded=function(){this.props.context.onLoad&&this.props.context.onLoad("CBBCodeVideo "+this.props.context.key)},e.prototype.render=function(){this.GetArgument("simple");var e=this.GetArgument("src"),t=this.GetArgument("title"),n=this.state.bError;if(ci.SettingsStore.FriendsSettings.bDisableEmbedInlining){var o=e;return t&&(o=Object($.b)("#bbcode_disable_embed_inlining_parenthetical",t,Uu(e))),Ee.createElement(lm,{href:e},Ee.createElement(ui.eb,null),o)}var i,r={controls:this.state.bPlay,autoPlay:!1,loop:!1,muted:!1};return n&&(i=Ee.createElement(Ar,{className:"failedVideoURL",href:e,title:Object($.b)("#bbcode_video_tooltip_link")},Ee.createElement("span",{className:"failedVideoSpan"},e))),n?Ee.createElement("div",{className:"ChatMessageErrorSendingAlert VideoFailed"},Object($.d)("#Chat_VideoLoadError",i)):Ee.createElement(Xc,{style:"block",text:[t,e]},Ee.createElement(sm,{className:"chatVideoContainer",strMediaType:"video",unAccountIDSender:this.props.context.unAccountIDSender,msgUniqueKey:this.props.context.key,titleInfo:e,onSizeChanged:this.props.context.onLoad},Ee.createElement("video",R.a({className:"BBCodeResizableElement"},r,{ref:this.BindVideo,onPause:this.OnVideoPause,onPlay:this.OnVideoPlay,controlsList:"nodownload",onError:this.OnVideoError,onLoadedData:this.OnVideoLoaded}),Ee.createElement("source",{src:e,type:this.GetArgument("type",!0),onError:this.OnVideoError,onLoad:this.OnVideoLoaded})),!this.state.bPlay&&Ee.createElement("div",{className:"chatVideoPlayControl HideWhenMinimized",onClick:this.StartVideo},Ee.createElement("div",{className:"playButtonContainer"},Ee.createElement(ui.J,null))),Ee.createElement(Ar,{className:"chatImageURL",href:e,title:Object($.b)("#bbcode_video_tooltip_link")},Ee.createElement(ui.L,null))))},R.c([T.a],e.prototype,"StartVideo",null),R.c([T.a],e.prototype,"BindVideo",null),R.c([T.a],e.prototype,"OnVideoPlay",null),R.c([T.a],e.prototype,"OnVideoPause",null),R.c([T.a],e.prototype,"OnVideoError",null),R.c([T.a],e.prototype,"OnVideoLoaded",null),e=R.c([or.observer],e)}(we),dm=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return R.d(t,e),t.prototype.OnLoad=function(){this.props.context.onLoad&&this.props.context.onLoad("ImgNotifyChatOnLoad "+this.props.src)},t.prototype.render=function(){var e=this.props,t=(e.context,R.f(e,["context"]));return Ee.createElement("img",R.a({},t,{onLoad:this.OnLoad}))},R.c([T.a],t.prototype,"OnLoad",null),t}(Ee.Component);function hm(e){var t=e.context,n=e.width,o=e.height,i=e.src,r=R.f(e,["context","width","height","src"]),a=i+"?s="+n+"x"+o,s=a+"dpx2x";return Ee.createElement(dm,R.a({context:t},r,{src:a,srcSet:a+" 1x, "+s+" 2x"}))}var _m=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return R.d(t,e),t.prototype.CopyToClipboard=function(){var e=this.GetArgument("url");e&&0!=e.length&&Ci.j(e)},t.prototype.HandleFocus=function(e){e.target.select()},t.prototype.OnLoad=function(){this.props.context.onLoad&&this.props.context.onLoad("CBBCodeOpenGraph.OnLoad "+this.GetArgument("url"))},t.prototype.render=function(){var e=this.GetArgument("img"),t=this.GetArgument("title"),n=this.GetArgument("desc"),o=this.GetArgument("url"),i=Uu(o);if(ci.SettingsStore.FriendsSettings.bDisableEmbedInlining){var r=o;return t&&(r=Object($.b)("#bbcode_disable_embed_inlining_parenthetical",t,i)),Ee.createElement(lm,{href:o,copyText:[r,o]},Ee.createElement(ui.w,null),r)}return Ee.createElement(Xc,{style:"block",text:[t,n,o]},Ee.createElement("div",{className:"ChatMessageOpenGraph"},Ee.createElement("div",{className:"OpenGraphContent"},e&&0<e.length&&Ee.createElement("div",{className:"OpenGraphImgBackground"},Ee.createElement("img",{className:"ChatMessageOpenGraph_Image",src:e,onLoad:this.OnLoad})),e&&0<e.length&&Ee.createElement(Ar,{className:"OpenGraphImgContainer",href:o},Ee.createElement(hm,{width:256,height:140,context:this.props.context,className:"ChatMessageOpenGraph_Image",src:e,onContextMenu:function(e){Vr(e,o)}})),Ee.createElement("div",{className:"ChatMessageOpenGraph_Body"},t&&0<t.length&&Ee.createElement(Ar,{className:"ChatMessageOpenGraph_Title",href:o},t),n&&0<n.length&&Ee.createElement("div",{className:"ChatMessageOpenGraph_Description"},n)),Ee.createElement("div",{style:{clear:"left"}})),Ee.createElement("div",{className:"OpenGraphFooter"},Ee.createElement("div",{className:"OpenGraphMessageURL"},Ee.createElement("span",{className:"OpenGraphMessageURLPosition",onFocus:this.HandleFocus,onClick:this.HandleFocus},Ee.createElement("span",{className:"OpenGraphMessageURL_short"},i),Ee.createElement("input",{className:"OpenGraphMessageURL_full",value:o,onFocus:this.HandleFocus,onClick:this.HandleFocus,readOnly:!0}))),Ee.createElement("div",{className:"OpenGraphURLButton CopyToClipboard",onClick:this.CopyToClipboard,title:Object($.b)("#Chat_Copy_Link_Clipboard")},Ee.createElement(ui.i,null)))))},R.c([T.a],t.prototype,"CopyToClipboard",null),R.c([T.a],t.prototype,"HandleFocus",null),R.c([T.a],t.prototype,"OnLoad",null),t=R.c([or.observer],t)}(we),fm=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return R.d(t,e),t.prototype.FormatCreatedDate=function(e){var t=new Date(e),n=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][t.getMonth()];return t.getDate()+" "+n+" "+t.getFullYear()},t.prototype.OpenTweet=function(e){for(var t=!1,n=e.target,o=e.currentTarget;n&&n!=o;){if("A"==n.nodeName||n.classList.contains("chatVideoContainer")){t=!0;break}n=n.parentElement}t||Ci.a(o)||Ur(e,this.GetArgument("url"))},t.prototype.OnImageLoaded=function(){this.props.context.onLoad&&this.props.context.onLoad("CBBCodeTweet "+this.GetArgument("url"))},t.prototype.render=function(){var e=this.GetArgument("created"),t=this.GetArgument("profile_name"),n=this.GetArgument("profile_screen_name"),o=this.GetArgument("profile_image"),i=this.GetArgument("profile_verified"),r=this.GetArgument("url"),a="http://twitter.com/"+n,s="true"==i;if(e=this.FormatCreatedDate(e),ci.SettingsStore.FriendsSettings.bDisableEmbedInlining){var c=new Date(e).toLocaleDateString($.a.GetPreferredLocales(),{year:"numeric",month:"long",day:"numeric"}),l=void 0;if("string"==typeof this.props.children)l=this.props.children;else if(this.props.children instanceof Array)for(var p=0,u=this.props.children;p<u.length;p++){var m=u[p];if("string"==typeof m){l=m;break}}return Ee.createElement(lm,{href:r,copyText:[l,r]},Ee.createElement("div",{className:"NonInlinedEmbedLogo NonInlinedEmbedLogo_Twitter"}),Object($.b)("#bbcode_disable_embed_inlining_tweet",t,c),Ee.createElement("br",null),Ee.createElement("div",{className:"NonInlinedEmbedSingleLine"},l))}return Ee.createElement("div",{className:Ju.a.ChatMessageTweet,onClick:this.OpenTweet},Ee.createElement(Xc,{style:"block",text:t+" (@"+n+")"},Ee.createElement("div",{className:Ju.a.ChatMessageTweet_Header},Ee.createElement(Ar,{className:Ju.a.ChatMessageTweet_ProfileImage,href:a},Ee.createElement("img",{src:o,onLoad:this.OnImageLoaded})),Ee.createElement("div",{className:Ju.a.ChatMessageTweet_NameSection},Ee.createElement("div",{className:Ju.a.ChatMessageTweet_NameGroup},Ee.createElement(Ar,{className:Ju.a.ChatMessageTweet_Name,href:a},t),s&&Ee.createElement("div",{className:Ju.a.ChatMessageTweet_Verified})),Ee.createElement(Ar,{className:Ju.a.ChatMessageTweet_ScreenName,href:a},"@",n)),Ee.createElement(Ar,{className:Ju.a.ChatMessageTweet_Logo,href:r}))),Ee.createElement(Xc,{style:"block-continue prepend-innertext-with-newline",text:r},Ee.createElement("div",{className:Ju.a.ChatMessageTweet_Body},this.props.children)),Ee.createElement("div",{className:Ju.a.ChatMessageTweet_Footer},Ee.createElement("div",{className:Ju.a.ChatMessageTweet_Created},e)))},R.c([T.a],t.prototype,"OpenTweet",null),R.c([T.a],t.prototype,"OnImageLoaded",null),t=R.c([or.observer],t)}(we),gm=function(n){function e(e){var t=n.call(this,e)||this;return t.state={bActivated:!1},t}return R.d(e,n),e.prototype.Activate=function(){this.setState({bActivated:!0})},e.prototype.OnImageLoaded=function(){this.props.context.onLoad&&this.props.context.onLoad("CBBCodeOEmbed "+this.props.context.key)},e.prototype.render=function(){var e=this.GetArgument("url"),t=this.GetArgument("title"),n=this.GetArgument("author"),o=this.GetArgument("provider_name"),i=this.GetArgument("preview_image");if(ci.SettingsStore.FriendsSettings.bDisableEmbedInlining){var r=e;return t&&(r=Object($.b)("#bbcode_disable_embed_inlining_parenthetical",t,e)),Ee.createElement(lm,{href:e,copyText:[t,e]},Ee.createElement(ui.w,null),r)}var a,s=!this.state.bActivated;if("SoundCloud"!=o&&"Spotify"!=o||(s=!1),s)a=Ee.createElement("div",{className:"OEmbedPreview",onClick:this.Activate},Ee.createElement("div",{className:"oembedImgContainer"},Ee.createElement(Xc,{style:"block",text:[t,e]},Ee.createElement("img",{src:i,onLoad:this.OnImageLoaded})),Ee.createElement("div",{className:"oembedHint"},Object($.b)("#bbcode_oembed_preview_hint"))),Ee.createElement("div",{className:"oembedProvider"},o),Ee.createElement("div",{className:"oembedTitle"},t));else{var c=this.GetArgument("iframe_attrs");a=Ee.createElement(Ar,{className:"OpenGraphImgContainer",href:e},Ee.createElement(bm,{strIFrameJSON:c,strProviderName:o}),o&&o.length&&Ee.createElement("div",{className:"oembedProvider"},o),t&&0<t.length&&Ee.createElement("div",{className:"oembedTitle"},t),n&&0<n.length&&Ee.createElement("div",{className:"oembedAuthor"},Object($.b)("#bbcode_oembed_author",n)))}return Ee.createElement(Xc,{style:"block",text:[t,e]},Ee.createElement("div",{className:"BBCodeOEmbedComponent "+o},a))},R.c([T.a],e.prototype,"Activate",null),R.c([T.a],e.prototype,"OnImageLoaded",null),e=R.c([or.observer],e)}(we);function bm(e){var t=e.strProviderName,n=JSON.parse(e.strIFrameJSON),o={width:n.width,height:n.height},i=n.src;return i&&i.startsWith("http")?("SoundCloud"==t&&(i=i.replace("visual=true","visual=false")),"Vimeo"==t&&(o.allowFullScreen=!0),Ee.createElement("iframe",R.a({},o,{src:i,scrolling:"no",frameBorder:0,sandbox:"allow-scripts allow-same-origin"}))):null}var vm=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return R.d(t,e),t.prototype.render=function(){return Ee.createElement(ju,null,this.props.children)},t}(we),Sm=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return R.d(t,e),t.prototype.render=function(){var e=this.props.context,t=e.bAnimate,n=e.onAnimationStart,o=e.onAnimationEnd;return Ee.createElement("div",{className:hr(Ju.a.plusOne,t&&Ju.a.MsgAnimating),onAnimationStart:n,onAnimationEnd:o},"+1")},t}(we),ym=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return R.d(t,e),t.prototype.render=function(){var e=this.props.context,t=e.bAnimate,n=e.onAnimationStart,o=e.onAnimationEnd,i=this.props.children,r=this.GetArgument("result"),a=hr(Ju.a.flipCoinAndResult,t&&Ju.a.MsgAnimating),s=hr(Ju.a.flipCoinContainer,r);return Ee.createElement(Xc,{text:i},Ee.createElement("div",{className:a,onAnimationStart:n,onAnimationEnd:o},Ee.createElement("div",null,"/flip:"),Ee.createElement("div",{className:s},Ee.createElement("div",{className:Ju.a.coin},Ee.createElement("div",{className:Ju.a.front}),Ee.createElement("div",{className:Ju.a.front_b}),Ee.createElement("div",{className:Ju.a.mid}),Ee.createElement("div",{className:Ju.a.back}),Ee.createElement("div",{className:Ju.a.back_b}))),Ee.createElement("div",{className:Ju.a.resultLabel},Object($.b)("#SlashCommandCoinFlip_Result_"+r))))},t}(we),Cm=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return R.d(t,e),t.prototype.Pad=function(e,t){for(var n=e+"";n.length<t;)n="0"+n;return n},t.prototype.GetLastNumber=function(e){if(e<10)return e;var t=Math.pow(10,Math.floor(Math.log(e)/Math.log(10))-1),n=Math.floor(e/t);return n-10*Math.floor(n/10)},t.prototype.render=function(){for(var e=this.props.children,t=this.GetArgument("min"),n=this.GetArgument("max"),o=this.Pad(this.GetArgument("result"),n.length),i=[],r=!0,a=0;a<n.length;a++){"0"!=o[a]&&(r=!1);var s=(n.length-a)*Math.max(.5*n.length,2)/n.length,c=10-a;i.push(Ee.createElement("div",{key:"random"+a,className:Ju.a.numberCounterContainer},Ee.createElement("div",{className:Ju.a.numberColumn+(r?" "+Ju.a.startingZero:""),style:{animationDuration:s+"s",animationName:Ju.a["randomNumbers"+c]}},Ee.createElement("div",{className:Ju.a.randomNumberLabel+" "+Ju.a.randomActual},o[a]),Ee.createElement("div",{className:Ju.a.randomNumberLabel},this.GetLastNumber(parseInt(o[a])+1)),Ee.createElement("div",{className:Ju.a.randomNumberLabel},this.GetLastNumber(parseInt(o[a])+2)),Ee.createElement("div",{className:Ju.a.randomNumberLabel},this.GetLastNumber(parseInt(o[a])+3)),Ee.createElement("div",{className:Ju.a.randomNumberLabel},this.GetLastNumber(parseInt(o[a])+4)),Ee.createElement("div",{className:Ju.a.randomNumberLabel},this.GetLastNumber(parseInt(o[a])+5)),Ee.createElement("div",{className:Ju.a.randomNumberLabel},this.GetLastNumber(parseInt(o[a])+6)),Ee.createElement("div",{className:Ju.a.randomNumberLabel},this.GetLastNumber(parseInt(o[a])+7)),Ee.createElement("div",{className:Ju.a.randomNumberLabel},this.GetLastNumber(parseInt(o[a])+8)),Ee.createElement("div",{className:Ju.a.randomNumberLabel},this.GetLastNumber(parseInt(o[a])+9)),Ee.createElement("div",{className:Ju.a.randomNumberLabel},o[a])),Ee.createElement("div",{className:Ju.a.randomNumberShadow})))}var l=this.props.context,p=l.bAnimate,u=l.onAnimationStart,m=l.onAnimationEnd;return Ee.createElement(Xc,{text:e},Ee.createElement("div",{className:hr(Ju.a.randomMsg,p&&Ju.a.MsgAnimating),onAnimationStart:u,onAnimationEnd:m},Ee.createElement("span",null,"/random "),Ee.createElement("span",{className:Ju.a.randomValues},t,"-",n)," : ",i))},t}(we),Im=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return R.d(t,e),t.prototype.render=function(){return Ee.createElement(Ku,null,this.props.children)},t}(we),Em=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return R.d(t,e),t.prototype.render=function(){return Ee.createElement(qu,null,this.props.children)},t}(we),Om=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return R.d(t,e),t.prototype.render=function(){return Ee.createElement(zu,null,this.props.children)},t}(we),wm=function(n){function e(e){var t=n.call(this,e)||this;return t.state={invite:void 0},t}return R.d(e,n),e.getDerivedStateFromProps=function(e,t){var n=e.args.invitecode;return{invite:e.context.chat.ChatStore.InviteStore.GetInviteFromCode(n)}},e.prototype.render=function(){var e=this.props.context.chat.GetMember(this.props.context.unAccountIDSender);return Ee.createElement(Tu,{invite:this.state.invite,inviter:e})},e}(we),Mm=function(n){function e(e){var t=n.call(this,e)||this;return t.state={invite:void 0,inviter:void 0,invitee:void 0},t}return R.d(e,n),e.getDerivedStateFromProps=function(e,t){var n,o,i,r=e.args.chatgroupid,a=e.args.chatid,s=e.context.chat;return n=s.self.accountid==e.context.unAccountIDSender?(o=s.self,i=s.chat_partner,s.accountid_partner):(o=s.chat_partner,i=s.self,s.self.accountid),{invite:e.context.chat.ChatStore.InviteStore.GetDirectInviteInfo(r,a,n),inviter:o,invitee:i}},e.prototype.render=function(){return Ee.createElement(Tu,{invite:this.state.invite,inviter:this.state.inviter,invitee:this.state.invitee})},e}(we),Dm=function(n){function e(e){var t=n.call(this,e)||this;return t.state={inviter:void 0,inviteTarget:void 0,gameInvite:void 0},t}return R.d(e,n),e.getDerivedStateFromProps=function(e,t){var n,o,i=e.args.appid,r=e.args.connect,a=e.context.chat;return o=a.self.accountid==e.context.unAccountIDSender?(n=a.self,a.chat_partner):(n=a.chat_partner,a.self),{inviter:n,inviteTarget:o,gameInvite:e.context.chat.ChatStore.GameInviteStore.RegisterGameInvite(e.context.unAccountIDSender,e.context.rtTimestamp,parseInt(i),r,void 0)}},e.prototype.render=function(){return Ee.createElement(Lu,{inviter:this.state.inviter,inviteTarget:this.state.inviteTarget,gameInvite:this.state.gameInvite})},e}(we),Tm=function(n){function e(e){var t=n.call(this,e)||this;return t.state={inviter:void 0,inviteTarget:void 0,gameInvite:void 0},t}return R.d(e,n),e.getDerivedStateFromProps=function(e,t){var n,o,i=e.args.appid,r=e.args.lobbyid,a=e.context.chat;return o=a.self.accountid==e.context.unAccountIDSender?(n=a.self,a.chat_partner):(n=a.chat_partner,a.self),{inviter:n,inviteTarget:o,gameInvite:e.context.chat.ChatStore.GameInviteStore.RegisterGameInvite(e.context.unAccountIDSender,e.context.rtTimestamp,parseInt(i),"",r)}},e.prototype.render=function(){return Ee.createElement(Lu,{inviter:this.state.inviter,inviteTarget:this.state.inviteTarget,gameInvite:this.state.gameInvite})},e}(we),Gm=function(n){function e(e){var t=n.call(this,e)||this;return t.state={broadcastid:"",broadcaster:void 0,viewer:void 0,appid:0},t}return R.d(e,n),e.getDerivedStateFromProps=function(e,t){var n,o,i=e.args.broadcastid,r=Number(e.args.appid),a=e.context.chat;return o=a.self.accountid==e.context.unAccountIDSender?(n=a.self,a.chat_partner):(n=a.chat_partner,a.self),{broadcastid:i,broadcaster:n,viewer:o,appid:r}},e.prototype.render=function(){return Ee.createElement(ku,{broadcastid:this.state.broadcastid,appid:this.state.appid,broadcaster:this.state.broadcaster,viewer:this.state.viewer})},e}(we),Rm=function(n){function e(e){var t=n.call(this,e)||this;return t.state={broadcaster:void 0,viewer:void 0,requestid:0,appid:0},t}return R.d(e,n),e.getDerivedStateFromProps=function(e,t){var n,o,i=Number(e.args.requestid),r=e.context.chat,a=ci.FriendStore.self.persona.m_unGamePlayedAppID;return o=r.self.accountid!=e.context.unAccountIDSender?(n=r.self,r.chat_partner):(n=r.chat_partner,r.self),{requestid:i,appid:a,broadcaster:n,viewer:o}},e.prototype.render=function(){return Ee.createElement(Pu,{requestid:this.state.requestid,appid:this.state.appid,broadcaster:this.state.broadcaster,viewer:this.state.viewer})},e}(we),Nm=function(n){function e(e){var t=n.call(this,e)||this;return t.m_bMounted=!1,t.state={bHaveVoteData:!1,bLocalVoteDown:!1,bLocalVoteUp:!1,nCommentCount:parseInt(t.GetArgument("num_comments_public"))},t}return R.d(e,n),e.prototype.componentWillUnmount=function(){this.m_bMounted=!1},e.prototype.componentDidMount=function(){var n=this;this.m_bMounted=!0;var e=ci.CMInterface;if(e){var t=this.GetArgument("fileid"),o=m.Init(ot.a,8509);o.Body().add_published_file_ids().set_published_file_id(t),e.SendMsgAndAwaitResponse(o,ot.b).then(function(e){if(1==e.Body().eresult()&&1==e.Body().user_item_vote_details().length){var t=e.Body().user_item_vote_details()[0].vote();n.m_bMounted&&n.setState({bHaveVoteData:!0,bLocalVoteUp:1==t,bLocalVoteDown:2==t})}})}},e.prototype.VoteItem=function(t,e){var n=this,o=ci.CMInterface;if(o){var i=m.Init(ot.c,8507);i.Body().set_published_file_id(e),i.Body().set_vote_up(t),o.SendMsgAndAwaitResponse(i,ot.d).then(function(e){1==e.Body().eresult()&&n.m_bMounted&&n.setState({bLocalVoteUp:t,bLocalVoteDown:!t})})}},e.prototype.render=function(){var e=this,t=this.GetArgument("fileid"),n=this.GetArgument("url"),o=this.GetArgument("title"),i=this.GetArgument("description"),r=this.GetArgument("preview_url"),a=parseInt(this.GetArgument("file_type")),s=["SteamPublishedFile"];switch(a){case 4:s.push("video");break;case 3:case 5:s.push("image")}if(ci.SettingsStore.FriendsSettings.bDisableEmbedInlining){var c=n;o&&(c=Object($.b)("#bbcode_disable_embed_inlining_steam_workshop",o));var l=Ee.createElement(ui.w,null);switch(a){case 4:l=Ee.createElement(ui.eb,null);break;case 3:case 5:l=Ee.createElement(ui.x,null)}return Ee.createElement(lm,{href:n,copyText:[c,n]},l,c)}var p,u=parseInt(this.GetArgument("num_comments_public")),m=parseInt(this.GetArgument("votes_up"));return this.state.bLocalVoteUp&&m++,(o||i)&&(p=Ee.createElement(Xc,{text:[o,i,n]},Ee.createElement("div",{className:"ChatLargeImageContainer_Description"},o&&Ee.createElement(Ar,{className:"ChatMessageOpenGraph_Title",href:n},o),i&&Ee.createElement("div",{className:"ChatMessageOpenGraph_Description"},i)))),Ee.createElement("div",{className:s.join(" ")},r&&0<r.length&&Ee.createElement(Ar,{className:"ChatLargeImageContainer",href:n},Ee.createElement(dm,{context:this.props.context,className:"ChatLargeImageContainer_Image",src:r,onContextMenu:function(e){xr(e,n)}})),p,Ee.createElement(Ar,{className:"SteamPublishedFile_Logo",href:n}),this.state.bHaveVoteData&&Ee.createElement("div",null,Ee.createElement("div",{className:"workshopItemControls"},Ee.createElement("div",{className:"workshopItemControlCtn"},0<=m&&Ee.createElement("span",{className:"upvoteCount"},m),0<=u&&Ee.createElement("span",{className:"commentCount"},u),Ee.createElement("span",{className:this.state.bLocalVoteUp?"general_btn voteUp toggled":"general_btn voteUp",onClick:function(){e.VoteItem(!0,t)}},Object($.b)("#bbcode_community_publishedfile_vote_up")),Ee.createElement("span",{className:this.state.bLocalVoteDown?"general_btn voteDown toggled":"general_btn voteDown",onClick:function(){e.VoteItem(!1,t)}})))))},e=R.c([or.observer],e)}(we),Lm=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return R.d(t,e),t.prototype.OnCreateOfferClick=function(e){var t="NewTradeOffer"+parseInt(this.GetArgument("partner"));Ci.m(e).open(this.GetArgument("url"),t,"height=1120,width=1028,resize=yes,scrollbars=yes").focus()},t.prototype.render=function(){var e=this.GetArgument("url"),t=parseInt(this.GetArgument("partner"));if(t&&t==this.props.context.unAccountIDSender){var n=this.props.context.chat.GetMember(t);if(n){var o=Object($.b)("#TradeOfferLink_Label");return Ee.createElement(Xc,{style:"block",text:[o,e]},Ee.createElement("div",{className:"ChatMessageInvite NoBGSplitInvite TradeOfferInvite"},Ee.createElement("div",{className:"leftInviteContainer"},Ee.createElement(Kc,{friend:n,context:{chat:this.props.context.chat},bLarge:!0})),Ee.createElement("div",{className:"rightInviteContainer rightInvite_Horizontal"},Ee.createElement("div",{className:"rightInviteContainerContent"},Ee.createElement("div",{className:"inviteLabel TradeOfferInvite_Title"},Object($.d)("#TradeOfferLink_SharedTradeLink",n.display_name)),Ee.createElement(Nu,{url:e,strLabel:o})),Ee.createElement("button",{className:"inviteButton inviteButtonJoinChat",type:"button",onClick:this.OnCreateOfferClick},Object($.d)("#TradeOfferLink_SendUserOffer"))),Ee.createElement("div",{style:{clear:"left"}})))}}return Ee.createElement(Ar,{href:e},e)},R.c([T.a],t.prototype,"OnCreateOfferClick",null),t}(we),km=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return R.d(t,e),t.prototype.ViewOfferClick=function(e){var t=this.GetArgument("id"),n=G.a.COMMUNITY_BASE_URL+"tradeoffer/"+t+"/",o="ViewTradeOffer"+t;Ci.m(e).open(n,o,"height=1120,width=1028,resize=yes,scrollbars=yes").focus()},t.prototype.ViewMyOffersClick=function(e){var t=this.props.context.chat.self.steamid64,n=this.GetArgument("id");Ur(e,G.a.COMMUNITY_BASE_URL+"profiles/"+t+"/tradeoffers/sent/#tradeofferid_"+n)},t.prototype.render=function(){var e=this.GetArgument("id"),t=parseInt(this.GetArgument("sender"));if(!e&&this.GetArgument("url"))return Ee.createElement(Lm,R.a({},this.props));var n=this.props.context.chat,o=n.self.accountid==t,i=Ee.createElement("span",{className:"inviteeNameLabel"},n.chat_partner.display_name);return Ee.createElement("div",{className:"ChatMessageInvite TradeOfferInvite"},Ee.createElement("div",{className:"leftInviteContainer"},Ee.createElement(Kc,{friend:o?n.self:n.chat_partner,context:{chat:n},bLarge:!0}),Ee.createElement(ui.bb,null)),Ee.createElement("div",{className:"rightInviteContainer"+(o?" rightInvite_Horizontal":"")},Ee.createElement("div",{className:"rightInviteContainerContent"},Ee.createElement(Xc,null,Ee.createElement("div",{className:"inviteLabel TradeOfferInvite_Title"},Object($.d)(o?"#TradeOffer_YouSentFriend":"#TradeOffer_FriendSentYou",i)),0<Ee.Children.count(this.props.children)&&Ee.createElement("div",{className:"TradeOffer_NoteFromFriendCtn"},Ee.createElement("div",{className:"TradeOffer_NoteFromFriend_QuoteArrow"}),Ee.createElement("div",{className:"inviteLabel TradeOffer_NoteFromFriend"},this.props.children)))),Ee.createElement("button",{className:"DialogButton Primary",type:"button",onClick:o?this.ViewMyOffersClick:this.ViewOfferClick},Object($.d)("#TradeOffer_ViewTradeOffer"))),Ee.createElement("div",{style:{clear:"left"}}))},R.c([T.a],t.prototype,"ViewOfferClick",null),R.c([T.a],t.prototype,"ViewMyOffersClick",null),t}(we),Pm=function(n){function e(e){var t=n.call(this,e)||this;return t.state={broadcaster:void 0},t}return R.d(e,n),e.getDerivedStateFromProps=function(e,t){var n=new D.a(e.args.broadcaster);return{broadcaster:ci.FriendStore.GetPlayer(n.GetAccountID())}},e.prototype.render=function(){return Ee.createElement(Au,{broadcaster:this.state.broadcaster})},e}(we),Am=function(n){function e(e){var t=n.call(this,e)||this;return t.m_bMounted=!1,t.state={bLoading:!0,bStillLoading:!1,bLoadFail:!1,bLoadSuccess:!1,description:null},t}return R.d(e,n),e.prototype.CopyToClipboard=function(){var e=this.GetArgument("url");e&&0!=e.length&&Ci.j(e)},e.prototype.componentWillUnmount=function(){this.m_bMounted=!1},e.prototype.componentDidMount=function(){var t=this;this.m_bMounted=!0;var e=ci.CMInterface;if(e){var n=parseInt(this.GetArgument("appid")),o=this.GetArgument("classid"),i=this.GetArgument("instanceid"),r=m.Init(Be.a);r.Body().set_language(G.a.LANGUAGE),r.Body().set_appid(n);var a=r.Body().add_classes();a.set_classid(o),a.set_instanceid(i),Be.c.GetAssetClassInfo(e.GetServiceTransport(),r).then(function(e){t.m_bMounted&&(1==e.GetEResult()?t.setState({bLoading:!1,bLoadFail:!1,bLoadSuccess:!0,description:e.Body().descriptions()[0]}):t.setState({bLoading:!1,bLoadFail:!0,bLoadSuccess:!1}))})}W.findDOMNode(this).ownerDocument.defaultView.setTimeout(function(){t.m_bMounted&&t.setState(function(e){return e.bLoading?{bStillLoading:!0}:null})},500)},e.prototype.OnImageLoaded=function(){this.props.context.onLoad&&this.props.context.onLoad("CBBCodeEconItem "+this.GetArgument("url"))},e.prototype.render=function(){var e=this.GetArgument("image"),t=this.GetArgument("url"),n=parseInt(this.GetArgument("appid")),o=this.GetArgument("contextid"),i=this.GetArgument("assetid"),r=this.GetArgument("market_hash_name"),a=parseInt(this.GetArgument("owner")),s=ci.AppInfoStore.GetAppInfo(n);if(a&&t){var c=this.props.context.chat.GetMember(a),l=c?c.display_name:this.GetArgument("persona"),p=Uu(t),u=G.a.COMMUNITY_BASE_URL+"economy/image/"+e+"/512x512",m={color:""},d=G.a.COMMUNITY_BASE_URL+"market/listings/"+n+"/"+r,h=G.a.COMMUNITY_BASE_URL+"tradeoffer/new/?partner="+a+"&for_items[]="+n+"_"+o+"_"+i;return this.state.bLoadSuccess&&(this.state.description.name_color()&&(m.color="#"+this.state.description.name_color()),this.state.description.icon_url_large()?u=G.a.COMMUNITY_BASE_URL+"economy/image/"+this.state.description.icon_url_large()+"/512x512":this.state.description.icon_url()&&(u=G.a.COMMUNITY_BASE_URL+"economy/image/"+this.state.description.icon_url()+"/512x512")),Ee.createElement(Xc,{text:t},Ee.createElement("div",{className:"ChatMessageOpenGraph"},Ee.createElement("div",{className:"OpenGraphContent ClientFetchesData"},Ee.createElement("div",{className:"OpenGraphImgBackground"},Ee.createElement("img",{className:"ChatMessageOpenGraph_Image",src:u,onLoad:this.OnImageLoaded})),Ee.createElement(Ar,{className:"OpenGraphImgContainer",href:t},Ee.createElement(dm,{context:this.props.context,className:"ChatMessageOpenGraph_Image",src:u,onContextMenu:function(e){Vr(e,t)}})),Ee.createElement("div",{className:"ChatMessageOpenGraph_Body"},this.state.bStillLoading&&Ee.createElement(Xa,{size:"medium",position:"center"}),this.state.bLoadSuccess&&Ee.createElement(Xc,{text:[Object($.b)("#bbcode_econ_ItemTitle",l,this.state.description.name()),t]},Ee.createElement("div",null,Ee.createElement(Ar,{className:"ChatMessageOpenGraph_Title",href:t,style:m},Object($.b)("#bbcode_econ_ItemTitle",l,this.state.description.name())),Ee.createElement("div",{className:"ChatMessageOpenGraph_Description"},Ee.createElement("div",{className:"EconItemOpenGraph_GameInfo"},Ee.createElement("img",{src:s.icon_url,onLoad:this.OnImageLoaded}),Ee.createElement("div",null,Ee.createElement("div",null,s.m_strName),Ee.createElement("div",null,this.state.description.type())))),Ee.createElement("div",{style:{marginTop:"1em"}},this.state.description.tradable()&&ci.CMInterface&&a!=ci.CMInterface.steamid.GetAccountID()&&Ee.createElement(Ar,{className:"general_btn inline",href:h},Object($.b)("#bbcode_econ_TradeWithOwner",l)),this.state.description.marketable()&&Ee.createElement(Ar,{className:"general_btn inline",href:d},Object($.b)("#bbcode_econ_ViewInMarket"))))),this.state.bLoadFail&&Ee.createElement("div",null,Ee.createElement(Ar,{className:"ChatMessageOpenGraph_Title",href:t},Object($.b)("#bbcode_econ_UnknownItem")),Ee.createElement("div",{className:"ChatMessageOpenGraph_Description"},Object($.b)("#bbcode_econ_LoadFail"))))),Ee.createElement("div",{className:"OpenGraphFooter"},Ee.createElement(Ar,{className:"OpenGraphMessageURL",href:t},Ee.createElement("span",{className:"OpenGraphMessageURLPosition"},Ee.createElement("span",{className:"OpenGraphMessageURL_short"},p),Ee.createElement("span",{className:"OpenGraphMessageURL_full"},t))),Ee.createElement("div",{className:"OpenGraphURLButton CopyToClipboard",onClick:this.CopyToClipboard},Ee.createElement(ui.i,null)))))}return Ee.createElement(Ar,{href:t},t)},R.c([T.a],e.prototype,"CopyToClipboard",null),R.c([T.a],e.prototype,"OnImageLoaded",null),e=R.c([or.observer],e)}(we),Bm=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return R.d(t,e),t.prototype.render=function(){var e=this.props.children?this.props.args[""]:"";return Ee.createElement(Xc,{text:Object($.b)("#bbcode_linkremoved")},Ee.createElement("span",{className:"filteredURL bb_removedlink",title:Object($.b)("#Community_RemoveLink_Tooltip")},Ee.createElement(ui.f,null),Ee.createElement("span",{className:"threatURLDesc"},Object($.b)("#bbcode_linkremoved_desc")),Ee.createElement("span",{className:"threatURL"},e)))},t}(we),Fm=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return R.d(t,e),t.prototype.render=function(){var e=this.GetArgument();if(e){if("here"==e&&(e="online"),"all"==e||"online"==e)return Ee.createElement("span",{className:"mention me"},Ee.createElement("span",{className:"MentionAtSymbol"},"@"),e);var t=parseInt(e),n=t&&this.props.context.chat.GetMember(t);if(n||(n=t&&ci.FriendStore.GetPlayer(t)),n){var o=n.accountid==this.props.context.chat.self.accountid;return Ee.createElement(Wc,{friend:n,context:{chat:this.props.context.chat}},Ee.createElement("span",{className:"mention"+(o?" me":"")},Ee.createElement("span",{className:"MentionAtSymbol"},"@"),n.display_name))}}return Ee.createElement("span",null,"@"+e)},t=R.c([or.observer],t)}(we),Vm=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return R.d(t,e),t.prototype.render=function(){var n="";return"string"==typeof this.props.children?n=this.props.children:Ee.Children.forEach(this.props.children,function(e){if("string"==typeof e&&(n+=e),"object"==typeof e&&e.props){var t=e.props["bbcode-text"];t&&(n+=t)}}),n?Ee.createElement($c,{emoticon:n,large:this.props.context.bUseLargeEmoticons}):null},t}(we),xm=function(n){function e(e){var t=n.call(this,e)||this;return t.m_storePreferences=ci.SettingsStore.StorePreferences,t.state={SteamStoreItem:null,bStoreRequestFailed:!1,bPlayVideo:!1,nThumbnailHovered:-1},t}return R.d(e,n),e.prototype.ExtractGameData=function(e,t){var n=e.name,o=e.is_free,i=e.short_description,r=e.header_image,a=e.developers,s=e.screenshots,c=e.movies,l=e.release_date,p=e.price_overview,u=e.content_descriptors;return{name:n,is_free:o,description:i,header_image:r,developer:a&&a[0],screenshot:s&&s[0]&&s[0].path_thumbnail,screenshots:s&&s,movie:c&&c[0]&&c[0].webm&&c[0].webm[480]&&c[0].webm[480].replace("http://","https://"),thumbnail:c&&c[0]&&c[0].thumbnail,release_date:l&&l.date,url:G.a.STORE_BASE_URL+"app/"+t,price:p&&p.final_formatted,initial_price:p&&p.initial_formatted,discount:p&&p.discount_percent&&p.discount_percent,content_descriptor_ids:u&&u.ids}},e.prototype.OnFrameLoaded=function(){this.props.context.onLoad&&this.props.context.onLoad("CBBCodeSteamStore "+this.GetArgument("app"))},e.prototype.componentDidMount=function(){var o=this,i=this.GetArgument("app"),e=G.a.COUNTRY||"US";C.a.get(G.a.STORE_BASE_URL+"api/appdetails?appids="+i+"&cc="+e+"&language="+G.a.LANGUAGE+"&filters=basic,price_overview,developers,screenshots,movies,release_date,content_descriptors").then(function(e){var t=null;if(e&&e.data){var n=o.GetArgument("app");t=e.data[n]}t&&t.success?o.setState({SteamStoreItem:o.ExtractGameData(t.data,i),bStoreRequestFailed:!1},o.OnFrameLoaded):o.setState({bStoreRequestFailed:!0})})},e.prototype.OpenStoreLink=function(e){Ur(e,this.state.SteamStoreItem.url)},e.prototype.PlayVideoClicked=function(){this.setState({bPlayVideo:!this.state.bPlayVideo})},e.prototype.OnThumbnailOver=function(e){this.setState({nThumbnailHovered:e})},e.prototype.OnThumbnailLeave=function(){this.setState({nThumbnailHovered:-1})},e.prototype.CopyToClipboard=function(){var e=this.props.children;e&&0!=e.length&&Ci.j(e)},e.prototype.render=function(){var o=this;if(ci.SettingsStore.FriendsSettings.bDisableEmbedInlining){var e=om(this.props.children);return Ee.createElement(lm,{href:e},Ee.createElement(ui.w,null),e)}if(this.state.bStoreRequestFailed){var t=ci.FriendStore.GetPlayer(this.props.context.unAccountIDSender).display_name,n=(e=om(this.props.children),Ee.createElement("span",{className:Ju.a.senderName},t)),i=Ee.createElement("span",{className:Ju.a.URLSent},e),r=Ee.createElement(Ar,{className:Ju.a.SteamURL,href:"https://store.steampowered.com/"},Object($.b)("#bbcode_steam_store_embed_Failed_Steam_Store"));return Ee.createElement("div",{className:Ju.a.ChatMessageSteamStore_Failed},Ee.createElement("span",null,Object($.d)("#bbcode_steam_store_embed_Failed",n,r,i)))}var a=this.state.SteamStoreItem;if(!a)return Ee.createElement("div",{className:Ju.a.ChatMessageSteamStore,style:{width:640,height:208}},Ee.createElement("div",{className:Ju.a.ChatMessageSteamStore_Header,style:{height:70}},Ee.createElement("div",{className:Ju.a.ChatMessageSteamStore_HeaderImage})),Ee.createElement(Xa,null));var s=a.name,c=a.price,l=a.description,p=a.header_image,u=a.developer,m=a.movie,d=a.thumbnail,h=a.release_date,_=a.screenshots,f=a.is_free,g=a.initial_price,b=a.discount,v=a.content_descriptor_ids,S=!1,y=this.m_storePreferences&&this.m_storePreferences.content_descriptor_preferences()&&this.m_storePreferences.content_descriptor_preferences().content_descriptors_to_exclude()&&this.m_storePreferences.content_descriptor_preferences().content_descriptors_to_exclude().map(function(e){return e.content_descriptorid()});v&&y&&v.some(function(e){return-1!==y.indexOf(e)})&&(S=!0);var C=[],I=!0;if(S)I=!1;else for(var E=function(e){var t=e;if(m||(t=e+1),m&&2<t||!m&&3<t)return"break";var n="";_&&_[t]&&"undefined"!==_[t].path_thumbnail?n=""+_[t].path_thumbnail:I=!1,C.push(Ee.createElement("div",{key:"screenshot"+t,className:Ju.a.ChatMessageSteamStore_Screenshot},Ee.createElement("img",{className:Ju.a.ChatMessageSteamStore_ScreenshotThumbnail,src:n,onMouseEnter:function(){return o.OnThumbnailOver(t)}})))},O=0;O<_.length;O++){if("break"===E(O))break}var w=!("0"==b||null==b),M=this.state.nThumbnailHovered,D=this.state.bPlayVideo,T=Ee.createElement("div",{className:Ju.a.ChatMessageSteamStore_FilteredDescription},Object($.b)("#bbcode_steam_store_embed_Filtered")," ");return Ee.createElement("div",{className:hr(Ju.a.ChatMessageSteamStore,S?Ju.a.ChatMessagesSteamStore_FilteredContent:null)},Ee.createElement("div",{className:Ju.a.ChatMessageSteamStore_Header},p&&Ee.createElement(Ee.Fragment,null,Ee.createElement("img",{className:Ju.a.ChatMessageSteamStore_HeaderImage,src:p,onClick:S?null:this.OpenStoreLink}),S&&Ee.createElement("div",{className:Ju.a.ChatMessageSteamStore_HeaderImageFiltered},Object($.b)("#bbcode_steam_store_embed_Image_Filtered")),Ee.createElement("img",{className:hr(Ju.a.ChatMessageSteamStore_HeaderImage,Ju.a.Blurred),src:p})),Ee.createElement("div",{className:Ju.a.ChatMessageSteamStore_GameDetails},Ee.createElement("div",{className:Ju.a.ChatMessageSteamStore_GameNameAndIcon,onClick:S?null:this.OpenStoreLink},Ee.createElement("div",{className:Ju.a.ChatMessageSteamStore_Name},s)),Ee.createElement("div",null,Object($.b)("#bbcode_steam_store_embed_From"),Ee.createElement("span",{style:{color:"#fffc"}},""+u)),Ee.createElement("div",{style:{fontSize:12}},Object($.b)("#bbcode_steam_store_embed_ReleaseDate"),Ee.createElement("span",{style:{color:"#fffc"}},""+h)))),Ee.createElement("div",{className:Ju.a.ChatMessageSteamStore_Body},Ee.createElement("div",{className:Ju.a.ChatMessageSteamStore_DetailsContainer},Ee.createElement("div",{className:Ju.a.ChatMessageTweet_NameSection},Ee.createElement("div",{className:Ju.a.ChatMessageSteamStore_Description},S?T:l," "),Ee.createElement("div",{className:Ju.a.ChatMessageSteamStore_Footer},Ee.createElement("div",{className:Ju.a.ChatMessageSteamStore_PricingContainer},Ee.createElement("div",{className:Ju.a.ChatMessageSteamStore_Pricing},w&&Ee.createElement("div",{className:Ju.a.ChatMessageSteamStore_Pricing_Discount},"-"+b+"%"),Ee.createElement("div",{className:Ju.a.ChatMessageSteamStore_Pricing_FinalContainer},w&&g&&Ee.createElement("div",{className:Ju.a.ChatMessageSteamStore_Pricing_Initial},""+g),c&&Ee.createElement("div",{className:hr(Ju.a.ChatMessageSteamStore_Pricing_Final,w?Ju.a.hasDiscount:null)},""+c)),f&&!c&&Ee.createElement("span",{className:Ju.a.ChatMessageSteamStore_Free},Object($.b)("#bbcode_steam_store_embed_FreeToPlay"))),Ee.createElement("div",{className:Ju.a.ChatMessageSteamStore_ViewStore,onClick:this.OpenStoreLink},Object($.b)(S?"#bbcode_steam_store_embed_ViewStorePage_Filtered":"#bbcode_steam_store_embed_ViewStorePage"))),Ee.createElement("div",{className:Ju.a.ChatMessageSteamStore_CopyURL,onClick:this.CopyToClipboard,title:Object($.b)("#Chat_Copy_Link_Clipboard")},Ee.createElement(ui.i,null))))),!S&&Ee.createElement("div",{className:Ju.a.ChatMessageSteamStore_MediaContainer},Ee.createElement("div",{className:Ju.a.ChatMessageSteamStore_MainMedia},m&&Ee.createElement("div",{className:hr(Ju.a.ChatMessageSteamStore_VideoThumbnail,D?Ju.a.videoPlaying:null),onClick:this.PlayVideoClicked},M<0||null==M?Ee.createElement(Ee.Fragment,null,Ee.createElement("img",{src:d}),Ee.createElement("div",{className:Ju.a.ChatMessageSteamStore_VideoPlayButton},Ee.createElement(ui.J,null))):Ee.createElement("img",{src:""+_[M].path_thumbnail,style:{width:"100%"}})),!m&&_&&Ee.createElement("img",{src:""+_[Math.max(M,0)].path_thumbnail,style:{width:"100%"}})),I&&_&&Ee.createElement("div",{className:Ju.a.ChatMessageSteamStore_ThumbnailsContainer,onMouseLeave:this.OnThumbnailLeave},C)),Ee.createElement("div",{className:hr(Ju.a.ChatMessageSteamStore_VideoLargeContainer,D?Ju.a.videoPlaying:null),onClick:this.PlayVideoClicked},D&&Ee.createElement("video",{className:Ju.a.ChatMessageSteamStore_VideoLarge,src:m,controls:!0,autoPlay:!0}),Ee.createElement("div",{onClick:this.PlayVideoClicked},Ee.createElement(ui.jb,null)))))},R.c([T.a],e.prototype,"ExtractGameData",null),R.c([T.a],e.prototype,"OnFrameLoaded",null),R.c([T.a],e.prototype,"OpenStoreLink",null),R.c([T.a],e.prototype,"PlayVideoClicked",null),R.c([T.a],e.prototype,"OnThumbnailOver",null),R.c([T.a],e.prototype,"OnThumbnailLeave",null),R.c([T.a],e.prototype,"CopyToClipboard",null),e=R.c([or.observer],e)}(we),Um=function(){function e(){}return e.prototype.GetObject=function(n){return R.b(this,void 0,void 0,function(){var t;return R.e(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,this.GetString(n)];case 1:return[2,(t=e.sent())?JSON.parse(t):null];case 2:return e.sent(),[2,null];case 3:return[2]}})})},e.prototype.StoreObject=function(t,n){return R.b(this,void 0,void 0,function(){return R.e(this,function(e){return[2,this.StoreString(t,JSON.stringify(n))]})})},e}(),jm=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return R.d(t,e),t.prototype.GetString=function(n){return SteamClient.Storage.GetString(n).then(function(e){if(e)return e;var t=localStorage.getItem(n);return t&&SteamClient.Storage.SetString(n,t),t})},t.prototype.StoreString=function(e,t){return SteamClient.Storage.SetString(e,t),Promise.resolve()},t.prototype.RemoveObject=function(e){return SteamClient.Storage.DeleteKey(e),Promise.resolve()},t}(Um),Hm=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return R.d(t,e),t.prototype.GetString=function(e){return Promise.resolve(localStorage.getItem(e))},t.prototype.StoreString=function(e,t){return localStorage.setItem(e,t),Promise.resolve()},t.prototype.RemoveObject=function(e){return localStorage.removeItem(e),Promise.resolve()},t}(Um),Wm=function(){function e(){this.m_mapEmoticonHovers=new Map}return e.prototype.GetEmoticonHover=function(e){var t=this.m_mapEmoticonHovers.get(e);return t||(t=new zm(e),this.m_mapEmoticonHovers.set(e,t)),t},e}(),zm=function(){function i(e){this.m_bVisible=!1,this.m_strEmoticonHoverHTML=void 0,this.m_bLoadingData=!1,this.m_strEmoticonName=e}return Object.defineProperty(i.prototype,"visible",{get:function(){return this.m_bVisible&&!!this.m_strEmoticonHoverHTML},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"emoticon_html",{get:function(){return this.m_strEmoticonHoverHTML},enumerable:!0,configurable:!0}),i.prototype.Show=function(e){var t=this;this.EnsureEmoticonLoaded();var n=e.currentTarget,o=Ee.createElement(el,{hover:this,target:n});i.sm_embeddedElements.ShowElementDelayed(n.ownerDocument,50,o,this).then(function(){t.m_bVisible=!0})},i.prototype.Hide=function(e){this.m_bVisible=!1,i.sm_embeddedElements.HideElement(e.currentTarget.ownerDocument,this,500)},i.prototype.EnsureEmoticonLoaded=function(){var t=this;if(void 0===this.m_strEmoticonHoverHTML&&!this.m_bLoadingData){this.m_bLoadingData=!0;var e="OnLoadEmoticon_"+this.m_strEmoticonName,n=G.a.COMMUNITY_CDN_URL+"economy/emoticonhover/"+encodeURIComponent(this.m_strEmoticonName)+"/jsonp.js?callback="+encodeURIComponent(e)+"&l="+encodeURIComponent(G.a.LANGUAGE),o=void 0,i=void 0,r=function(){t.m_bLoadingData=!1,delete window[e],o&&ClearBackgroundTimeout(o),i&&i.remove()};window[e]=function(e){t.m_strEmoticonHoverHTML=e,t.m_bVisible=!0,r()},o=SetBackgroundTimeout(r,5e3),(i=window.document.createElement("script")).type="text/javascript",i.async=!0,i.src=n,i.onerror=r,window.document.head.appendChild(i)}},i.sm_embeddedElements=new di.a("CEmoticonHoverContainer"),R.c([d.observable],i.prototype,"m_bVisible",void 0),R.c([d.observable],i.prototype,"m_strEmoticonHoverHTML",void 0),i}(),qm=function(){function e(){this.m_mapBrowserInfo=new Map,this.m_hOverlayChatBrowserInfoChanged=null}return e.prototype.Init=function(e){var t=this;this.m_CMInterface=e,this.m_hOverlayChatBrowserInfoChanged=SteamClient.WebChat.RegisterOverlayChatBrowserInfoChanged(this.OnOverlayChatBrowserInfoChanged),this.m_CMInterface.RunWhenLoggedOn(function(){t.OnOverlayChatBrowserInfoChanged()})},e.prototype.HasOverlayInstance=function(e){return this.m_mapBrowserInfo.has(e)},e.prototype.OnOverlayChatBrowserInfoChanged=function(){var s=this;SteamClient.WebChat.GetOverlayChatBrowserInfo().then(function(e){for(var t=new Map(s.m_mapBrowserInfo),n=0,o=e;n<o.length;n++){var i=o[n];t.delete(i.unPID);var r=s.m_mapBrowserInfo.get(i.unPID);if(r&&(r.m_nBrowserID!=i.nBrowserID?(s.OverlayBrowserClosed(r),s.m_mapBrowserInfo.delete(i.unPID),r=void 0):ci.UIStore.OnOverlayBrowserChanged({m_unPID:i.unPID,m_nBrowserID:i.nBrowserID},i.nScreenWidth,i.nScreenHeight)),!r){var a={m_unPID:i.unPID,m_nBrowserID:i.nBrowserID};s.m_mapBrowserInfo.set(i.unPID,a),s.OverlayBrowserCreated(a,i.nScreenWidth,i.nScreenHeight)}}t.forEach(function(e,t){s.m_mapBrowserInfo.delete(t),s.OverlayBrowserClosed(e)})}).catch(function(e){console.log("Failed to load overlay browser info:",e)})},e.prototype.OverlayBrowserCreated=function(e,t,n){ci.UIStore.OnOverlayBrowserCreated(e,t,n),_d.ShowPopupFriendsList(e,!1,!1),ci.SetDefaultPopupContext(e)},e.prototype.OverlayBrowserClosed=function(e){ci.UIStore.SetSuppressBrowserContextBroadcasting(!0),ci.GetDefaultBrowserContext().m_nBrowserID==e.m_nBrowserID&&ci.GetDefaultBrowserContext().m_unPID==e.m_unPID&&ci.SetDefaultPopupContext(ai),console.log("Removing overlay browser window:",e.m_unPID,e.m_nBrowserID),rr.d.ClosePopupsOwnedByBrowser(e),ci.UIStore.SetSuppressBrowserContextBroadcasting(!1),ci.UIStore.OnOverlayBrowserClosed(e)},R.c([T.a],e.prototype,"OnOverlayChatBrowserInfoChanged",null),e}(),Km=function(){function e(e){this.m_FriendStore=e}return e.prototype.DisplayNotificationFromFriend=function(t,e,n){return void 0===n&&(n={}),this.DisplayNotification(R.a({icon:t.persona.avatar_url_medium},e),function(e){return t.OpenChatDialog(e)},n)},e.prototype.BNotificationsPermitted=function(){return!ci.ParentalStore.BIsFriendsBlocked()},e.prototype.RequestNotificationPermission=function(){return Promise.resolve(!0)},e}(),Ym=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return R.d(t,e),t.prototype.GetNotificationPermissionLevel=function(){if("undefined"==typeof Notification)return"unsupported";var e=Notification.permission;return"default"==e||"granted"==e||"denied"==e?e:"unsupported"},t.prototype.DisplayNotification=function(e,t,n){var o=this;void 0===n&&(n={});var i={body:e.body,icon:e.icon,tag:e.tag,silent:!0},r=new Notification(e.title,R.a({badge:G.a.COMMUNITY_CDN_URL+"public/shared/images/responsive/share_steam_logo.png"},i));return window.setTimeout(function(){r.close()},n.timeoutMS||5e3),r.addEventListener("click",function(){return o.OnNotificationClicked(r,t)}),new Promise(function(e,t){r.addEventListener("close",function(){e()})})},t.prototype.OnNotificationClicked=function(e,t){t(ai),e.close()},t.prototype.BNotificationsPermitted=function(){return"granted"==this.GetNotificationPermissionLevel()},t.prototype.RequestNotificationPermission=function(){return"unsupported"==this.GetNotificationPermissionLevel()?Promise.resolve(!1):this.BNotificationsPermitted()?e.prototype.RequestNotificationPermission.call(this):new Promise(function(t,e){Notification.requestPermission(function(e){t("granted"==e)})})},t}(Km),Jm=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return R.d(t,e),t.prototype.DisplayNotification=function(e,t,n){if(void 0===n&&(n={}),e.tag){var o=JSON.stringify(e);e.tag.startsWith("groupmsg_")?SteamClient.ClientNotifications.DisplayClientNotification(cn.k_EClientUINotificationGroupChatMessage,o,t):e.tag.startsWith("message_")?SteamClient.ClientNotifications.DisplayClientNotification(cn.k_EClientUINotificationFriendChatMessage,o,t):ci.SettingsStore.BClientHasFeatureOrOnWeb("PersonaNotifications")&&e.tag.startsWith("state_")&&SteamClient.ClientNotifications.DisplayClientNotification(cn.k_EClientUINotificationFriendPersonaState,o,t)}return Promise.resolve()},t}(Km),Xm=function(){function e(){this.m_mapPlaybackObjs=new Map,this.m_bVoiceActive=!1,this.m_hCloseContextTimeout=void 0,this.m_nLastObservedSampleRate=0,this.m_bSupportsAudioWorkletProcessors=!1,this.m_MediaStreamDestination=void 0,this.m_MediaStreamAudioElem=void 0}return Object.defineProperty(e.prototype,"context",{get:function(){return this.m_Context},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"supports_audio_worklets",{get:function(){return this.m_bSupportsAudioWorkletProcessors},enumerable:!0,configurable:!0}),e.prototype.GetActiveDestination=function(){if(this.CreateContextIfNeeded(),ci.VoiceStore.IsAnyVoiceActive()&&"default"!=ci.VoiceStore.GetSelectedOutputDevice()){if(null==this.m_MediaStreamDestination){var e=this.m_Context;this.m_MediaStreamDestination=e.createMediaStreamDestination(),this.m_MediaStreamAudioElem=document.createElement("audio"),this.m_MediaStreamAudioElem.srcObject=this.m_MediaStreamDestination.stream,this.m_MediaStreamAudioElem.play();try{this.m_MediaStreamAudioElem.setSinkId(ci.VoiceStore.GetSelectedOutputDevice())}catch(e){console.log("(CAudioPlaybackManager) Failed setting audio output device to "+ci.VoiceStore.GetSelectedOutputDevice()+": "+e)}}return this.m_MediaStreamDestination}return this.m_Context.destination},e.prototype.PlayAudioURL=function(e,t){return void 0===t&&(t=1),this.PlayAudioURLWithRepeats(e)},e.prototype.PlayAudioURLWithRepeats=function(e,t){void 0===t&&(t=0),console.log("(CAudioPlaybackManager) web audio playback requested: "+e),this.CreateContextIfNeeded();var n=new Qm(this,e,t);return this.m_mapPlaybackObjs.set(n,!0),n},e.prototype.PlaybackFinished=function(e){this.m_mapPlaybackObjs.delete(e),this.CleanupContextIfUneeded(!1)},e.prototype.SetVoiceActive=function(e){this.m_bVoiceActive=!0,this.CreateContextIfNeeded(e)},e.prototype.SetVoiceNotActive=function(){this.m_bVoiceActive=!1,this.CleanupContextIfUneeded(!0)},e.prototype.GetLastObservedSampleRate=function(){return this.m_nLastObservedSampleRate},e.prototype.CreateContextIfNeeded=function(t){if(void 0===t&&(t=void 0),null==this.m_Context){console.log("(CAudioPlaybackManager) new context");var e=window,n=e.AudioContext||e.webkitAudioContext||!1;this.m_Context=new n,this.m_Context.onstatechange=this.OnAudioContextStateChange,console.log("(CAudioPlaybackManager) sample rate "+this.m_Context.sampleRate),this.m_nLastObservedSampleRate=this.m_Context.sampleRate;var o=this.m_Context;null!=o.audioWorklet?(this.m_bSupportsAudioWorkletProcessors=!0,o.audioWorklet.addModule(G.a.CHAT_BASE_URL+"public/javascript/webui/noisegate-audio-worklet.js?v=3").then(function(){console.log("(CAudioPlaybackManager) noisegate-audio-worklet.js worklet processor loaded"),t&&t()}).catch(function(e){console.log("(CAudioPlaybackManager) Failed to load noisegate-audio-worklet.js worklet processor"),t&&t()})):t&&t()}else t&&t()},e.prototype.DelayedCleanupContextIfInactive=function(){this.m_hCloseContextTimeout=void 0,0==this.m_mapPlaybackObjs.size&&0==this.m_bVoiceActive&&(console.log("(CAudioPlaybackManager) close context"),null!=this.m_MediaStreamAudioElem&&(this.m_MediaStreamAudioElem.pause(),this.m_MediaStreamAudioElem.src=void 0,this.m_MediaStreamAudioElem.srcObject=void 0),this.m_MediaStreamAudioElem=void 0,this.m_MediaStreamDestination=void 0,this.m_Context.close(),this.m_Context=void 0)},e.prototype.CleanupContextIfUneeded=function(e){if(0==this.m_mapPlaybackObjs.size&&0==this.m_bVoiceActive){if(null!=this.m_hCloseContextTimeout&&(clearTimeout(this.m_hCloseContextTimeout),this.m_hCloseContextTimeout=void 0),e)return void this.DelayedCleanupContextIfInactive();this.m_hCloseContextTimeout=SetBackgroundTimeout(this.DelayedCleanupContextIfInactive,1e4)}},e.prototype.OnAudioContextStateChange=function(){null!=this.m_Context&&console.log("(CAudioPlaybackManager) web audio context state changed: "+this.m_Context.state)},R.c([d.observable],e.prototype,"m_nLastObservedSampleRate",void 0),R.c([d.observable],e.prototype,"m_bSupportsAudioWorkletProcessors",void 0),R.c([T.a],e.prototype,"DelayedCleanupContextIfInactive",null),R.c([d.action.bound],e.prototype,"OnAudioContextStateChange",null),e}(),Qm=function(){function e(n,e,t){var o=this;this.m_Source=void 0,this.m_RepeatCount=0,this.m_TimesPlayed=0,this.m_Cancelled=!1,this.m_Manager=n,this.m_URL=e,this.m_RepeatCount=t,C.a.get(e,{responseType:"arraybuffer"}).then(function(e){n.context.decodeAudioData(e.data).then(function(e){if(o.m_Cancelled)o.m_Manager.PlaybackFinished(o);else{var t=n.context.createBufferSource();t.buffer=e,t.connect(n.GetActiveDestination()),t.start(0),t.onended=o.OnPlaybackEnded,o.m_Source=t}}).catch(function(e){o.OnFailure()})}).catch(function(e){o.OnFailure()})}return e.prototype.StopPlayback=function(){this.m_Cancelled=!0,this.m_Source&&(this.m_Source.stop(0),this.m_Source.disconnect(),this.m_Source=void 0,this.m_Manager.PlaybackFinished(this))},Object.defineProperty(e.prototype,"url",{get:function(){return this.m_URL},enumerable:!0,configurable:!0}),e.prototype.OnFailure=function(){var e=this;SetBackgroundTimeout(function(){return e.m_Manager.PlaybackFinished(e)},1)},e.prototype.OnPlaybackEnded=function(e){if(this.m_TimesPlayed+=1,!this.m_Cancelled&&this.m_TimesPlayed<=this.m_RepeatCount){var t=this.m_Manager.context.createBufferSource();return t.buffer=this.m_Source.buffer,t.connect(this.m_Manager.GetActiveDestination()),t.start(0),t.onended=this.OnPlaybackEnded,this.m_Source.disconnect(),this.m_Source=void 0,void(this.m_Source=t)}this.m_Source.disconnect(),this.m_Source=void 0,this.m_Manager.PlaybackFinished(this)},R.c([d.action.bound],e.prototype,"OnFailure",null),R.c([d.action.bound],e.prototype,"OnPlaybackEnded",null),e}(),Zm=function(){function e(){this.m_rgActivityCallbacks=[]}return e.prototype.AddTrackedWindow=function(e){},e.prototype.BIsUserIdle=function(e){return this.GetUserIdleTime()>e},e.prototype.AddOnIdleCallback=function(e,t){this.RunOnIdleCallback(e,t)},e.prototype.AddOnNextActivityCallback=function(e){this.m_rgActivityCallbacks.push(e)},e.prototype.FireOnUserActivityCallbacks=function(){if(this.m_rgActivityCallbacks.length){for(var e=0,t=this.m_rgActivityCallbacks;e<t.length;e++){(0,t[e])()}this.m_rgActivityCallbacks=[]}},e.prototype.RunOnIdleCallback=function(e,t){this.GetUserIdleTime()>=t-1?e():SetBackgroundTimeout(this.RunOnIdleCallback.bind(this,e,t),1e3*(t-this.GetUserIdleTime()))},e}(),$m=function(t){function i(){var e=t.call(this)||this;return e.m_rgWindows=[],e.m_bEventTrackingActive=!1,e.OnUserAction(),e}return R.d(i,t),i.prototype.GetUserIdleTime=function(){return Math.floor((performance.now()-this.m_msUserLastAction)/1e3)},i.prototype.AddTrackedWindow=function(e){this.m_rgWindows.push(e),e.addEventListener("unload",this.RemoveTrackedWindow.bind(this,e)),this.m_bEventTrackingActive&&this.BindEventsForWindow(e)},i.prototype.RemoveTrackedWindow=function(e){this.m_bEventTrackingActive&&this.UnbindEventsForWindow(e),M.d(this.m_rgWindows,e)},i.prototype.OnUserAction=function(){this.m_msUserLastAction=performance.now(),this.FireOnUserActivityCallbacks(),this.UnbindEvents(),window.setTimeout(this.BindEvents.bind(this),1e4)},i.prototype.BindEvents=function(){if(!this.m_bEventTrackingActive){this.m_bEventTrackingActive=!0;for(var e=0,t=this.m_rgWindows;e<t.length;e++){var n=t[e];this.BindEventsForWindow(n)}}},i.prototype.UnbindEvents=function(){if(this.m_bEventTrackingActive){this.m_bEventTrackingActive=!1;for(var e=0,t=this.m_rgWindows;e<t.length;e++){var n=t[e];this.UnbindEventsForWindow(n)}}},i.prototype.UnbindEventsForWindow=function(e){for(var t=0,n=i.sm_rgUserEvents;t<n.length;t++){var o=n[t];e.removeEventListener(o,this.OnUserAction)}},i.prototype.BindEventsForWindow=function(e){for(var t=0,n=i.sm_rgUserEvents;t<n.length;t++){var o=n[t];e.addEventListener(o,this.OnUserAction)}},i.sm_rgUserEvents=["mousemove","mousedown","keypress","focus"],R.c([T.a],i.prototype,"OnUserAction",null),i}(Zm),ed=function(t){function e(){var e=t.call(this)||this;return e.m_eActiveState=pn.k_EComputerActiveStateActive,e.m_hRegisterForComputerActiveStateChange=null,e.m_hFireUserStillActive=void 0,e.m_hRegisterForComputerActiveStateChange=SteamClient.WebChat.RegisterForComputerActiveStateChange(e.OnComputerActiveStateChange),e}return R.d(e,t),e.prototype.OnComputerActiveStateChange=function(e,t){var n=(new Date).getTime()/1e3-t;this.m_eActiveState=e,this.m_msUserLastAction=Math.max(performance.now()-1e3*n,this.m_msUserLastAction),this.m_eActiveState==pn.k_EComputerActiveStateActive&&(this.m_hFireUserStillActive&&(clearTimeout(this.m_hFireUserStillActive),this.m_hFireUserStillActive=void 0),this.UpdateStillActive())},e.prototype.UpdateStillActive=function(){this.m_hFireUserStillActive=void 0,this.m_eActiveState==pn.k_EComputerActiveStateActive&&(this.OnUserAction(),this.m_hFireUserStillActive=SetBackgroundTimeout(this.UpdateStillActive,1e4))},R.c([T.a],e.prototype,"OnComputerActiveStateChange",null),R.c([T.a],e.prototype,"UpdateStillActive",null),e}($m),td=function(){function e(){this.m_bDropConsumed=!1,this.m_onDropCompleteCallbacks=new N,this.m_vecClasses=[]}return e.prototype.BInDrag=function(){return!!this.m_data},e.prototype.StartDrag=function(e){var t,n;Object(I.a)(!this.m_data,"second drag started, existing data discarded",this.m_data),this.m_data=e,this.m_bDropConsumed=!1,this.m_vecClasses.push("in_global_drag"),this.m_vecClasses.push("drag_type_"+e.type),void 0!==e.source&&this.m_vecClasses.push("drag_source_"+e.source);for(var o=0,i=Array.from(rr.d.GetPopups());o<i.length;o++){var r=i[o];r.window&&r.window.document.body&&(t=r.window.document.body.classList).add.apply(t,this.m_vecClasses)}(n=window.document.body.classList).add.apply(n,this.m_vecClasses)},e.prototype.EndDrag=function(){var e,t;this.m_onDropCompleteCallbacks.Dispatch(this.m_bDropConsumed),this.m_onDropCompleteCallbacks.ClearAllCallbacks(),this.m_data=void 0,this.m_bDropConsumed=void 0;for(var n=0,o=Array.from(rr.d.GetPopups());n<o.length;n++){var i=o[n];i.window&&i.window.document.body&&(e=i.window.document.body.classList).remove.apply(e,this.m_vecClasses)}(t=window.document.body.classList).remove.apply(t,this.m_vecClasses),this.m_vecClasses=[]},e.prototype.GetDragData=function(){return this.m_data},e.prototype.BWasDropConsumed=function(){return this.m_bDropConsumed},e.prototype.SetDropConsumed=function(){Object(I.a)(this.BInDrag(),"Asked to set drop consumed but no active drag"),this.m_bDropConsumed=!0},e.prototype.RegisterForDropComplete=function(e){return this.m_onDropCompleteCallbacks.Register(e)},e}(),nd=function(){return function(e){var t=this;this.m_UsabilityHandler=a(pe.X.NotifyRequestClientUsabilityMetricsHandler,function(n){return R.b(t,void 0,void 0,function(){var t;return R.e(this,function(e){switch(e.label){case 0:return(t=m.Init(pe.Q)).Body().set_metrics_run_id(n.Body().metrics_run_id()),t.Body().set_metrics_version(3),t.Body().set_client_build(G.a.BUILD_TIMESTAMP),t.Body().set_in_web(!G.a.IN_CLIENT),ci.ready_to_render?[3,2]:[4,Object(d.when)(function(){return ci.ready_to_render})];case 1:e.sent(),e.label=2;case 2:return[4,ci.SettingsStore.FillInChatUsabilityMetrics(t.Body())];case 3:return e.sent(),[4,ci.FriendStore.FillInChatUsabilityMetrics(t.Body())];case 4:return e.sent(),[4,ci.ChatStore.FillInChatUsabilityMetrics(t.Body())];case 5:return e.sent(),[4,ci.UIStore.FillInChatUsabilityMetrics(t.Body())];case 6:return e.sent(),[4,ci.VoiceStore.FillInChatUsabilityMetrics(t.Body())];case 7:return e.sent(),this.m_fnFillAppUsabilityMetrics?[4,this.m_fnFillAppUsabilityMetrics(t.Body())]:[3,9];case 8:e.sent(),e.label=9;case 9:return pe.Y.NotifyClientUsabilityMetrics(ci.CMInterface.GetServiceTransport(),t),[2,1]}})})}),this.m_fnFillAppUsabilityMetrics=e}}(),od=function(n){function e(e){var t=n.call(this)||this;return t.m_window=e,t}return R.d(e,n),e.prototype.BringToFront=function(){null!=this.m_window.SteamClient&&null!=this.m_window.SteamClient.Window&&null!=this.m_window.SteamClient.Window.BringToFront?this.m_window.SteamClient.Window.BringToFront():this.m_window.focus()},e.prototype.FlashWindow=function(){null!=this.m_window.SteamClient&&null!=this.m_window.SteamClient.Window&&null!=this.m_window.SteamClient.Window.FlashWindow&&this.m_window.SteamClient.Window.FlashWindow()},e.prototype.Close=function(){this.m_window&&this.m_window.close()},Object.defineProperty(e.prototype,"title",{get:function(){return this.m_window.document.title},set:function(e){this.m_window.document.title=e},enumerable:!0,configurable:!0}),e.prototype.BIsClosed=function(){return this.m_window.closed},e.prototype.BIsVisible=function(){return"visible"==this.m_window.document.visibilityState},e.prototype.BIsFocused=function(){return this.m_window.document.hasFocus()},e.prototype.OnFocus=function(e){var t=this,n=function(){e()};return this.m_window.addEventListener("focus",n),{unregister:function(){t.m_window.removeEventListener("focus",n)}}},e.prototype.GetWindow=function(){return this.m_window},e}(oi),id=function(n){function e(e){var t=n.call(this)||this;return t.m_popup=e,t}return R.d(e,n),Object.defineProperty(e.prototype,"container",{get:function(){return!this.m_container&&this.m_popup.window&&(this.m_container=new od(this.m_popup.window)),this.m_container},enumerable:!0,configurable:!0}),e.prototype.Show=function(e){ci.ParentalStore.BIsFriendsBlocked()?console.log("Blocked popup due to parental controls"):this.m_popup.Show(e)},e.prototype.Close=function(){this.m_popup.Close()},e.prototype.GetWindowRestoreDetails=function(){return this.m_popup.GetWindowRestoreDetails()},e.prototype.IsMinimized=function(){return this.m_popup.IsMinimized()},e.prototype.GetBrowserContext=function(){return this.m_popup.browser_info},e.prototype.GetWindow=function(){return this.m_popup.window},e}(ii),rd={nChatRoomListHeightPx:224,bChatRoomListCollapsed:!1,bDontShowVoiceAlert:!1,nFriendsListSingleWindowWidthPx:300,bFavoritesHintDismissed:!1,nChangeLogDismissed:0},ad="UIDisplayPrefs",sd=function(){function e(e,t){var n=this;this.m_FriendHoverStore=new hc,this.m_EmoticonHoverStore=new Wm,this.m_DragDropManager=new td,this.m_OverlayStore=new qm,this.m_UsabilityMetricsStore=new nd(this.FillInChatUsabilityMetrics.bind(this)),this.m_mapFriendsListPopups=new Map,this.m_UIDisplayPrefs=rd,this.m_bUpdatedBuildAvailable=!1,this.m_nSecondsOutOfDate=0,this.m_strLoaderWindowRestoreDetails=void 0,this.m_bShowFriendsListOnLoadFromLoader=void 0,this.m_FriendsUIApp=e,this.m_bEmbeddedApp=t,this.IsEmbeddedApp()||("undefined"!=typeof SteamClient&&SteamClient.WebChat&&SteamClient.WebChat.RegisterForFriendPostMessage?(SteamClient.WebChat.RegisterForFriendPostMessage(this.HandlePostMessage),window.addEventListener("message",this.HandleWebLoaderPostMessage)):(Object(I.a)(!G.a.IN_CLIENT,"Config.IN_CLIENT set but SteamClient globals not available"),window.addEventListener("message",this.HandlePostMessage)),this.InstrumentWindow(window,ai),rr.d.AddPopupCreatedCallback(function(e){n.InstrumentWindow(e.window,e.browser_info||ai)}))}return e.prototype.IsEmbeddedApp=function(){return this.m_bEmbeddedApp},e.prototype.OverlayStore=function(){return this.m_OverlayStore},e.prototype.BNeedsUpdate=function(){return this.m_bUpdatedBuildAvailable},e.prototype.GetSecondsOutOfDate=function(){return this.m_nSecondsOutOfDate},e.prototype.InstrumentWindow=function(e,t){e.__FriendsUIBrowserContext=t,this.m_FriendsUIApp.IdleTracker.AddTrackedWindow(e)},e.prototype.HandlePostMessage=function(e){var t=e.data;if(t&&t.command){var n=this.m_FriendsUIApp.GetDefaultBrowserContext();void 0!==e.data.pid&&(n={m_unPID:e.data.pid,m_nBrowserID:e.data.browserid}),this.ExecuteCommand(n,e.data)}},e.prototype.PerformFriendsUIUpdate=function(){var e=this.m_FriendsUIApp.UIStore.SerializePopupStateToObject(!0);window.parent.postMessage({message:"ChatReloadRequest",state:e},"https://steamloopback.host")},e.prototype.HandleWebLoaderPostMessage=function(e){null!=e.data.message&&("UpdatedBuildAvailable"==e.data.message?(console.log("There is an updated friendsui build available, we are "+(e.data.bVeryOutOfDate?"":"NOT ")+"very out of date. We are "+(e.data.bForce?"":"NOT ")+"forcing an update."),this.m_bUpdatedBuildAvailable=!0,void 0!==e.data.nSecondsOutOfDate&&(this.m_nSecondsOutOfDate=e.data.nSecondsOutOfDate),(7200<this.m_FriendsUIApp.IdleTracker.GetUserIdleTime()||void 0!==e.data.bForce&&1==e.data.bForce)&&this.PerformFriendsUIUpdate()):"ReloadSerializedChatState"==e.data.message&&void 0!==e.data.state?(console.log("Asked by loader to reload serialized chat state"),this.m_FriendsUIApp.UIStore.SetStateToRestoreFrom(e.data.state)):"LoaderWindowRestoreDetails"==e.data.message?(this.m_bShowFriendsListOnLoadFromLoader=e.data.bVisible,this.m_strLoaderWindowRestoreDetails=e.data.data):"SetPersonaState"==e.data.message&&this.SetUserPersonaStateWhenReady(e.data.persona_state))},e.prototype.SetUserPersonaStateWhenReady=function(e){this.m_FriendsUIApp.FriendStore.SetUserPersonaState(e)},e.prototype.ExecuteCommand=function(e,t){switch(t.command){case"CheckForUpdates":window.parent.postMessage({message:"CheckForAndForceUpdate"},"https://steamloopback.host");break;case"ShowPopupFriendsList":this.ShowPopupFriendsList(e,!1,!0,"1"===t.force_to_foreground);break;case"ShowFriendChatDialog":(i=new D.a(t.steamid)).BIsValid()?i.BIsIndividualAccount()?this.m_FriendsUIApp.UIStore.ShowFriendChatDialogWhenReady(e,i.GetAccountID()):i.BIsClanAccount()&&this.m_FriendsUIApp.FriendStore.ClanStore.JoinClanChatRoom(e,i):this.ShowChatUnreadMessages(e);break;case"CloseChatDialog":if((i=new D.a(t.steamid)).BIsIndividualAccount()){var n=this.m_FriendsUIApp.ChatStore.GetFriendChat(i.GetAccountID(),!1);n&&this.m_FriendsUIApp.UIStore.CloseTabByID(n.unique_id)}else if(i.BIsClanAccount()){var o=this.m_FriendsUIApp.FriendStore.ClanStore.GetClan(i);if(o&&o.GetChatGroupIDIfLoaded())(a=this.m_FriendsUIApp.ChatStore.GetChatRoomGroup(o.GetChatGroupIDIfLoaded()))&&this.m_FriendsUIApp.UIStore.CloseTabByID(a.unique_id)}break;case"ShowInviteToTradeDialog":var i;if((i=new D.a(t.steamid)).BIsIndividualAccount()){var r=this.m_FriendsUIApp.FriendStore.GetFriend(i.GetAccountID());r&&(this.m_FriendsUIApp.UIStore.ShowFriendChatDialogWhenReady(e,r.accountid),this.m_FriendsUIApp.FriendStore.InviteToTrade(r))}break;case"ShowChatRoomGroupDialog":var a,s=t.chat_group_id,c=t.chat_room_id;if((a=this.m_FriendsUIApp.ChatStore.GetChatRoomGroup(s))&&a.BIsCurrentUserAMember()&&!c)this.m_FriendsUIApp.UIStore.ShowAndOrActivateChatRoomGroupWhenReady(e,a,!0);else{var l=this.m_FriendsUIApp.ChatStore.InviteStore.GetDirectInviteInfo(s,c,this.m_FriendsUIApp.FriendStore.self.accountid);Du({invite:l,inviter:null},e,window)}break;case"ShowChatRoomGroupInvite":if(this.m_FriendsUIApp.ready_to_render){var p=t.invite_code;l=this.m_FriendsUIApp.ChatStore.InviteStore.GetInviteFromCode(p);Du({invite:l,inviter:null},e,window)}break;case"SetPersonaState":this.m_FriendsUIApp.FriendStore.SetUserPersonaState(t.persona_state);break;case"ShowWatchBroadcast":var u=new D.a(t.steamid);this.m_FriendsUIApp.UIStore.ShowOrActivateBroadcast(e,u.GetAccountID(),!0).ShowWatchPromptDialog()}},e.prototype.Init=function(e,t,n){var r=this,o=[],i=this.m_FriendsUIApp.SettingsStore.GetObjectFromLocalStorageWhenReady(ad,rd).then(function(e){Object(d.runInAction)(function(){r.m_UIDisplayPrefs=e})});if(o.push(i),e.RunWhenLoggedOn(function(){rr.d.SetCurrentLoggedInAccountID(e.steamid.GetAccountID())}),this.m_WebLogonManager=n,mi.b.GetBrowserInfoForPopup=pd,t&&this.m_OverlayStore.Init(e),window.addEventListener("dragover",function(e){(e||event).preventDefault()},!1),window.addEventListener("dragenter",function(e){(e||event).preventDefault()},!1),window.addEventListener("drop",function(e){(e||event).preventDefault()},!1),G.a.IN_CLIENT&&void 0!==SteamClient.FriendSettings.GetEnabledFeatures){var a=SteamClient.FriendSettings.GetEnabledFeatures().then(function(e){for(var t=!1,n=0,o=e;n<o.length;n++){var i=o[n];if("LoaderWindowSynchronization"==i.feature){t=i.bEnabled;break}}return t?Object(d.when)(function(){return void 0!==r.m_strLoaderWindowRestoreDetails}):Promise.resolve()});o.push(a)}return o},Object.defineProperty(e.prototype,"FriendHoverStore",{get:function(){return this.m_FriendHoverStore},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"EmoticonHoverStore",{get:function(){return this.m_EmoticonHoverStore},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"WebLogonManager",{get:function(){return this.m_WebLogonManager},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"DragDropManager",{get:function(){return this.m_DragDropManager},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"UIDisplayPrefs",{get:function(){return this.m_UIDisplayPrefs},enumerable:!0,configurable:!0}),e.prototype.SetUIDisplayPref=function(e,t){var n=this;this.m_UIDisplayPrefs[e]!=t&&(this.m_UIDisplayPrefs[e]=t,this.m_iTimeoutSaveUIDisplayPrefs&&window.clearTimeout(this.m_iTimeoutSaveUIDisplayPrefs),this.m_iTimeoutSaveUIDisplayPrefs=window.setTimeout(function(){n.m_FriendsUIApp.SettingsStore.StoreObjectInLocalStorage(ad,n.m_UIDisplayPrefs),n.m_iTimeoutSaveUIDisplayPrefs=void 0},1e3))},e.prototype.ShowPopupFriendsList=function(e,t,n,o){if(this.m_FriendsUIApp.ParentalStore.BIsFriendsBlocked())console.log("Blocked friends list popup due to parental controls");else{var i=this.m_mapFriendsListPopups.get(e.m_unPID);if(i)!t&&n&&i.Focus(o);else{i=new fu(this.m_FriendsUIApp.FriendStore,this.m_FriendsUIApp.ChatStore,e,t),this.m_mapFriendsListPopups.set(e.m_unPID,i),i.Show(!t&&n,o);var r=new id(i);this.m_FriendsUIApp.UIStore.GetPerContextChatData(e).SetFriendsListWindow(r.container),this.m_FriendsUIApp.UIStore.SerializePopupState()}}},e.prototype.OnFriendsListClosed=function(e){this.m_mapFriendsListPopups.delete(e.m_unPID),this.m_FriendsUIApp.UIStore.GetPerContextChatData(e).SetFriendsListWindow(void 0),this.m_FriendsUIApp.UIStore.SerializePopupState()},e.prototype.ToggleSingleWindowToggle=function(e){var t=ld(e);if(this.m_FriendsUIApp.UIStore.BIsFriendsListSingleWindow(t)){n=Math.min(_d.UIDisplayPrefs.nFriendsListSingleWindowWidthPx,e.screen.availWidth);e.SteamClient.Window.ResizeTo(n,e.innerHeight)}else{var n=Math.min(1280,e.screen.availWidth);e.SteamClient.Window.ResizeTo(n,e.innerHeight),_d.SetUIDisplayPref("nFriendsListSingleWindowWidthPx",e.innerWidth)}},e.prototype.FillInChatUsabilityMetrics=function(e){e.ui_state().set_friends_list_group_chats_height(this.UIDisplayPrefs.nChatRoomListHeightPx);var t=this.m_FriendsUIApp.UIStore.GetPerContextChatData(ai),n=t.friends_list_window;n&&n instanceof od&&(e.ui_state().set_friends_list_width(n.GetWindow().outerWidth),e.ui_state().set_friends_list_height(n.GetWindow().outerHeight));for(var o=void 0,i=0,r=Array.from(t.popup_list);i<r.length;i++){var a=r[i];if((o=a).tab_set===t.default_tabset&&!t.IsFriendsListSingleWindow())break}o&&o.popup.GetWindow()&&(e.ui_state().set_friends_list_width(o.popup.GetWindow().outerWidth),e.ui_state().set_friends_list_height(o.popup.GetWindow().outerHeight))},e.prototype.ShowChatUnreadMessages=function(e){if(!this.m_FriendsUIApp.ParentalStore.BIsFriendsBlocked()){var t=this.m_FriendsUIApp.ChatStore.GetChatToActivateForOldestUnread(e);return t?(console.log("ShowChatUnreadMessages - showing chat "+t.unique_id),void this.m_FriendsUIApp.UIStore.ShowAndOrActivateChat(e,t,!0)):this.ShowPopupFriendsList(e,!1,!0)}console.log("Blocked friends list popup due to parental controls")},R.c([d.observable],e.prototype,"m_UIDisplayPrefs",void 0),R.c([d.observable],e.prototype,"m_bUpdatedBuildAvailable",void 0),R.c([d.observable],e.prototype,"m_nSecondsOutOfDate",void 0),R.c([d.observable],e.prototype,"m_strLoaderWindowRestoreDetails",void 0),R.c([d.observable],e.prototype,"m_bShowFriendsListOnLoadFromLoader",void 0),R.c([T.a],e.prototype,"HandlePostMessage",null),R.c([T.a],e.prototype,"HandleWebLoaderPostMessage",null),R.c([ti],e.prototype,"SetUserPersonaStateWhenReady",null),R.c([d.computed],e.prototype,"UIDisplayPrefs",null),R.c([d.action],e.prototype,"SetUIDisplayPref",null),R.c([ti],e.prototype,"ShowPopupFriendsList",null),R.c([ti],e.prototype,"ShowChatUnreadMessages",null),e}();function cd(e,t){var n=Object(Ci.m)(t);if(!n&&e){var o=W.findDOMNode(e);o&&o.ownerDocument&&(n=o.ownerDocument.defaultView)}return Object(I.a)(n,"Couldn't find owning window to determine browser context"),ld(n)}function ld(e){var t=ai;return e&&(Object(I.a)(e.__FriendsUIBrowserContext,"FriendsUI Browser context missing from owner window"),e.__FriendsUIBrowserContext&&(t=e.__FriendsUIBrowserContext)),t}function pd(e){var t=ld(e);return t&&t.m_unPID!=ai.m_unPID&&t.m_nBrowserID!=ai.m_nBrowserID?t:null}var ud=function(l){function e(){var e=l.call(this,G.a.IN_CLIENT&&void 0!==SteamClient.Storage?new jm:new Hm)||this;return e.m_AudioPlaybackManager=new Xm,e.m_IdleTracker=G.a.IN_CLIENT?new ed:new $m,e.m_DesktopApp=_d=new sd(e,!1),e.m_ChatRoomBBCodeParser=new ke(Object.assign(nm(),{mention:Fm}),Le),e.m_FriendChatBBCodeParser=new ke(Object.assign(nm(),{invite:Mm,gameinvite:Dm,lobbyinvite:Tm,tradeoffer:km,broadcastinvite:Gm,broadcastviewrequest:Rm}),Le),e.m_NotificationBBCodeParser=new Re({gameinvite:Xu,lobbyinvite:Qu,invite:Zu,tradeoffer:$u,spoiler:em}),_d=e.m_DesktopApp,Object(I.a)(!G.a.IN_MOBILE,"DesktopApp initialized in mobile context"),e}return R.d(e,l),e.prototype.Init=function(e,t,n){var o,i,r,a,s=t?new Jm(this.m_FriendStore):new Ym(this.m_FriendStore),c=this.m_DesktopApp.Init(e,t,n);l.prototype.InitInternal.call(this,e,s,c),o=ai,i=this.m_FriendStore,r=this.m_ChatStore,a=document.getElementById("friendslist-container"),(t?ni:setTimeout)(function(){W.render(Ee.createElement(du,{friends:i,chats:r,browserContext:o,elTarget:a}),a)})},e.prototype.OnReadyToRender=function(){return R.b(this,void 0,void 0,function(){var t,n,o,i,r,a,s,c;return R.e(this,function(e){switch(e.label){case 0:return[4,this.UIStore.RestorePopupState()];case 1:e.sent(),(t=rr.d.GetRestoreDetails("PopupFriendsListDimensions"))&&window.parent.postMessage({message:"FriendsListRestoreDetailsChanged",data:t},"https://steamloopback.host"),n="oFriendsUIStartupParam";try{(o=window.sessionStorage.getItem(n))&&(i=JSON.parse(o))&&i.command&&this.m_DesktopApp.ExecuteCommand(ai,i.command),window.sessionStorage.removeItem(n)}catch(e){}if(window.opener)for(r=[G.a.COMMUNITY_BASE_URL,G.a.STORE_BASE_URL,G.a.CHAT_BASE_URL],a=0,s=r;a<s.length;a++)c=s[a],window.opener.postMessage("FriendsUIReady",c.replace(/\/$/,""));return[2]}})})},Object.defineProperty(e.prototype,"AudioPlaybackManager",{get:function(){return this.m_AudioPlaybackManager},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"IdleTracker",{get:function(){return this.m_IdleTracker},enumerable:!0,configurable:!0}),e.prototype.AddPopupManagerShutdownCallback=function(e){rr.d.AddShutdownCallback(e)},e.prototype.CreateChatPopup=function(e,t,n,o,i,r){var a=new Su(e,t,n,o,i,r),s=new id(a);return new bo(s,a)},e.prototype.ShowPopupFriendsListAtStartup=function(e){var t=e;if(void 0!==_d.m_bShowFriendsListOnLoadFromLoader&&(t=_d.m_bShowFriendsListOnLoadFromLoader),t){var n=!0===_d.m_bShowFriendsListOnLoadFromLoader;ci.GetDefaultBrowserContext()!=ai&&(console.log("Blocked taking focus in root context during ShowPopupFriendsList, because other context is primary"),n=!1),ci.ShowPopupFriendsList(ai,!1,n)}},e.prototype.ShowPopupFriendsList=function(e,t,n){this.m_DesktopApp.ShowPopupFriendsList(e,t,n)},e.prototype.OnFriendsListClosed=function(e){this.m_DesktopApp.OnFriendsListClosed(e)},e.prototype.ShowAlert=function(e,t,n){return yr(window,e,t,n)},e.prototype.OpenURLInBrowser=function(e,t){G.a.IN_CLIENT?SteamClient.WebChat.OpenURLInClient(e,t.m_unPID):Ur(window,e)},e.prototype.BIsValidBrowserContext=function(e){return l.prototype.BIsValidBrowserContext.call(this,e)||this.m_DesktopApp.OverlayStore().HasOverlayInstance(e.m_unPID)},e.prototype.ShowCloseActiveVoiceConfirmation=function(e,t){if(!this.m_DesktopApp.UIDisplayPrefs.bDontShowVoiceAlert){var n=t.popup;o=n.GetWindow(),_d.UIDisplayPrefs.bDontShowVoiceAlert||o&&fr(Ee.createElement(Dl,null),o,"ActiveVoiceAlert",{strTitle:Object($.b)("#Chat_StillInVoiceDialog_Title"),popupWidth:650,popupHeight:340},pd(o))}var o},e.prototype.SignOutOfFriends=function(e){var t=ci.UIStore.GetRootChatPerContextData().friends_list_window&&ci.UIStore.GetRootChatPerContextData().friends_list_window.BIsVisible();window.parent.postMessage({message:"SignOutRequest",bShowLoaderWindow:t,browserContext:e},"https://steamloopback.host")},e}(si);var md,dd,hd,_d=void 0;n("Y3TG"),n("yLAU"),n("w/TS"),n("whIR"),n("eeM7"),n("m1EC");window.AssertMsg=I.a,document.addEventListener("DOMContentLoaded",function(){Object(G.c)();var e,t=!0;if(!G.a.IN_CLIENT&&G.a.STEAM_TV){var n=Object(G.b)("broadcast");n&&("76561198873238444"==(e=n.steamid)?Q.init({bValid:!0,stream:{"76561198873238444":"#Broadcast_EnglishMain"},name:"WePlay! Artifact Tournament",appID:583950,link:"https://store.steampowered.com/app/583950/Artifact/",linkName:"Artifact on Steam",tabIcon:"public/images/webui/broadcast/artifact_icon.png",offlineClassName:"BroadcastArtifactOffline"}):"76561198894692971"==e?Q.init({bValid:!0,stream:{"76561198894692971":"#Broadcast_EnglishMain"},name:"The Steam Awards 2018",appID:1025790,link:"https://steam.tv/steamawards",linkName:"steam.tv/steamawards",tabIcon:"public/images/webui/broadcast/awards_icon.png",offlineClassName:"BroadcastSteamAwardsOffline"}):"76561198871875463"==e?Q.init({bValid:!0,stream:{"76561198871875463":"#Broadcast_EnglishMain"},name:"The Chongqing Major",appID:570,link:"https://store.steampowered.com/app/570/Dota_2/",linkName:"steam.tv/dota",tabIcon:"public/images/webui/broadcast/chongqing_icon.png",offlineClassName:"BroadcastDOTAChongqingOffline"}):"76561198198486997"==e||"148618792083695635"==e&&"beta"!=_.b.WEB_UNIVERSE?Q.init({bValid:!0,stream:{"76561198124468676":"#Broadcast_EnglishMain"},name:"True Sight",appID:570,link:"https://steam.tv/dota",linkName:"steam.tv/dota",tabIcon:"public/images/webui/broadcast/true_sight_tab.png",offlineClassName:"BroadcastDOTATrueSight"}):"76561197960270087"==e?Q.init({bValid:!0,stream:{"76561197960270087":"#Broadcast_EnglishMain"},name:"Injustice 2 Pro Series Grand Finals 2018",appID:627270,link:"https://steam.tv/injustice2",linkName:"steam.tv/injustice2",tabIcon:"public/images/webui/broadcast/injustice2_tab_logo.jpg",offlineClassName:"BroadcastInjustice2Offline"}):"76561198835282120"==e?Q.init({bValid:!0,stream:{"76561198835282120":"#Broadcast_EnglishMain"},name:"SMITE World Championship",appID:386360,link:"https://steam.tv/smite",linkName:"steam.tv/smite",tabIcon:"public/images/webui/broadcast/hrx_tab_icon_2018.jpg",offlineClassName:"BroadcastSmiteOffline"}):"76561198835114410"==e?Q.init({bValid:!0,stream:{"76561198835114410":"#Broadcast_EnglishMain"},name:"Paladins World Championship",appID:444090,link:"https://steam.tv/paladins",linkName:"steam.tv/paladins",tabIcon:"public/images/webui/broadcast/hrx_tab_icon_2018.jpg",offlineClassName:"BroadcastPaladinsOffline"}):"76561198838606142"==e&&Q.init({bValid:!0,stream:{"76561198838606142":"#Broadcast_EnglishMain"},name:"Realm Royale",appID:813820,link:"https://steam.tv/realmroyale",linkName:"steam.tv/realmroyale",tabIcon:"public/images/webui/broadcast/hrx_tab_icon_2018.jpg",offlineClassName:"BroadcastRealmRoyaleOffline"}),Object.assign(_.a,n)),G.d.logged_in?np():(t=!1,(new op).Init(function(){window.location=window.location}))}t&&function(){var e,t=new ud,n=null,o=!1;if(G.a.IN_CLIENT){var i={message:"ChatJavascriptInitialized",data:G.a.BUILD_TIMESTAMP};window.parent.postMessage(i,"https://steamloopback.host"),window.parent.postMessage("ChatJavascriptIntialized","https://steamloopback.host"),o=!0,(e=x.ConstructClientCMInterface()).Connect()}else e=x.ConstructWebCMInterface(t.Storage),(n=new H(e)).PerformInitialLogon(G.d);t.Init(e,o,n)}()}),window.LocalizationReady=function(e,t,n){if("english"!==t)"friendsui"==e?md=n:"shared"==e&&(dd=n);else if("shared"==e)hd=n;else{var o=void 0,i=null,r=void 0,a=null;void 0!==md?(o=md,i=n):o=n,void 0!==dd?(r=dd,a=hd):r=hd,$.a.InitFromObjects(o,i,r,a),hd=dd=md=void 0}}},m1EC:function(e,t,n){},oh5H:function(e,t,n){"use strict";n.d(t,"b",function(){return i}),n.d(t,"d",function(){return o}),n.d(t,"c",function(){return r}),n.d(t,"e",function(){return a}),n.d(t,"a",function(){return _});var l=n("q1tI");n("XaMz");function i(e){for(var o=[],t=1;t<arguments.length;t++)o[t-1]=arguments[t];var n=_.LocalizeString(e);return n?(0<o.length&&(n=n.replace(/%(\d+)\$s/g,function(e,t){if(t<=o.length&&1<=t){var n=o[t-1];return String(null==n?"":n)}return e})),n):e}function o(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var o=_.LocalizeString(e);if(!o)return e;for(var i,r=[],a=/(.*?)%(\d+)\$s/g,s=0;i=a.exec(o);){s+=i[0].length,r.push(i[1]);var c=parseInt(i[2]);1<=c&&c<=t.length&&r.push(t[c-1])}return r.push(o.substr(s)),l.createElement.apply(l,[l.Fragment,null].concat(r))}function r(e,t){for(var n=[],o=2;o<arguments.length;o++)n[o-2]=arguments[o];return i.apply(void 0,1===t||"1"===t?[e,t].concat(n):[e+"_Plural",t].concat(n))}function a(e,t){return void 0===t&&(t=!1),h(e,!t)}var s=31536e3,c=2628e3,p=604800,u=86400,m=3600,d=60;function h(e,t,n){void 0===t&&(t=!1),void 0===n&&(n=!0);var o=t?"#TimeSince_":"#TimeInterval_";return 2*s<=e?i(o+"XYears",Math.floor(e/s)):s<=e?2*c<=(e-=s)?i(o+"1YearXMonths",Math.floor(e/c)):i(o+"1Year"):2*c<=e?i(o+"XMonths",Math.floor(e/c)):2*p<=e?i(o+"XWeeks",Math.floor(e/p)):2*u<=e?i(o+"XDays",Math.floor(e/u)):u<=e?2*m<=(e-=u)?i(o+"1DayXHours",Math.floor(e/m)):i(o+"1Day"):2*m<=e?i(o+"XHours",Math.floor(e/m)):m<=e?2*d<=(e-=m)&&n?i(o+"1HourXMinutes",Math.floor(e/d)):i(o+"1Hour"):n?2*d<=e?i(o+"XMinutes",Math.floor(e/d)):i(d<=e?o+"1Minute":o+"LessThanAMinute"):i(o+"LessThanAnHour")}var _=new(function(){function e(){this.m_mapTokens=new Map,this.m_mapFallbackTokens=new Map}return e.prototype.InitFromObjects=function(n,o,i,r){var a=this;this.m_mapTokens.clear(),Object.keys(i).forEach(function(e,t){a.m_mapTokens.set(e,i[e])}),Object.keys(n).forEach(function(e,t){a.m_mapTokens.set(e,n[e])}),o&&Object.keys(o).forEach(function(e,t){a.m_mapTokens.has(e)||a.m_mapTokens.set(e,o[e]),a.m_mapFallbackTokens.set(e,o[e])}),r&&Object.keys(r).forEach(function(e,t){a.m_mapTokens.has(e)||a.m_mapTokens.set(e,r[e]),a.m_mapFallbackTokens.has(e)||a.m_mapFallbackTokens.set(e,r[e])})},e.prototype.InitDirect=function(n){var o=this;this.m_mapTokens.clear(),this.m_mapFallbackTokens.clear(),Object.keys(n).forEach(function(e,t){o.m_mapTokens.set(e,n[e])})},e.prototype.GetPreferredLocales=function(){var e=["en-US"];return"undefined"!=typeof navigator&&void 0!==navigator.languages&&(e=navigator.languages),e},e.prototype.LocalizeString=function(e){if(!e||0==e.length||"#"!=e.charAt(0))return"";var t=this.m_mapTokens.get(e.substring(1));return void 0===t?"":t},e.prototype.LocalizeStringFromFallback=function(e){if(!e||0==e.length||"#"!=e.charAt(0))return"";var t=this.m_mapFallbackTokens.get(e.substring(1));return void 0===t?"":t},e}());window.LocalizationManager=_},r6f6:function(e,t,n){e.exports={miniProfile:"miniprofile_miniProfile_s5zcg",miniProfileContent:"miniprofile_miniProfileContent_25Sge",miniProfileHeader:"miniprofile_miniProfileHeader_3oBIW",miniProfilePlayer:"miniprofile_miniProfilePlayer_3cN6K",playerContent:"miniprofile_playerContent_PV11V",miniProfileBackground:"miniprofile_miniProfileBackground_3gfFJ",miniProfileBackgroundBlur:"miniprofile_miniProfileBackgroundBlur_G000o",miniProfileBlocked:"miniprofile_miniProfileBlocked_1fKEq",miniProfileNotFriends:"miniprofile_miniProfileNotFriends_7gGbH",notFriends:"miniprofile_notFriends_nfBN5",SnoozeContainer:"miniprofile_SnoozeContainer_2HCB2",miniProfileHover:"miniprofile_miniProfileHover_2P8wD",miniprofile_arrow:"miniprofile_miniprofile_arrow_38UVn",left:"miniprofile_left_qVPF2",playerAvatar:"miniprofile_playerAvatar_1dzWG",avatarStatus:"miniprofile_avatarStatus_23H45",miniProfileAvatarStatus:"miniprofile_miniProfileAvatarStatus_1VgK8",personaName:"miniprofile_personaName_W3QjS",hasNickname:"miniprofile_hasNickname_dgG-l",personaNameLabel:"miniprofile_personaNameLabel_390p4",nickName:"miniprofile_nickName_2E8Iz",persona:"miniprofile_persona_1Z3Ey",awayStatusLabel:"miniprofile_awayStatusLabel_2UzRy",nickname:"miniprofile_nickname_1W3dU",playerNicknameBracket:"miniprofile_playerNicknameBracket_1bkKo",notInOrWatchingGame:"miniprofile_notInOrWatchingGame_3AIC2",miniProfileBottom:"miniprofile_miniProfileBottom_3Agb6",miniProfileGameContainer:"miniprofile_miniProfileGameContainer_2FyZH",gameLogo:"miniprofile_gameLogo_2B0di",ingame:"miniprofile_ingame_3H2mq",richPresence:"miniprofile_richPresence_1rud4",gameState:"miniprofile_gameState_2Va3_",golden:"miniprofile_golden_3cUbZ",watchingbroadcast:"miniprofile_watchingbroadcast_24vwG",watchingbroadcastThumbnail:"miniprofile_watchingbroadcastThumbnail_3EoM-",gameContent:"miniprofile_gameContent_3x24t",miniProfileFeaturedContainer:"miniprofile_miniProfileFeaturedContainer_3ljT4",favoriteBadgeIcon:"miniprofile_favoriteBadgeIcon_icnrU",badgeIcon:"miniprofile_badgeIcon_2TBf0",featuredLabels:"miniprofile_featuredLabels_1dGw1",friendPlayerLevelNum:"miniprofile_friendPlayerLevelNum_2Ni_1",featuredTitle:"miniprofile_featuredTitle_2_2RA",mutualFriends:"miniprofile_mutualFriends_36Vl4",featuredSubTitle:"miniprofile_featuredSubTitle_2p8kJ"}},"s+DT":function(e,t,n){"use strict";n.d(t,"a",function(){return i});var o=n("2lpH"),a=n.n(o),r=n("0N1H"),s=n("1n9R"),c=n("XaMz"),i=function(){function i(e,t,n,o){void 0===e&&(e=0),e instanceof i?this.m_ulSteamID=e.m_ulSteamID:"string"==typeof e?(this.m_ulSteamID=a.a.fromString(e,!0),Object(c.a)(0!=this.m_ulSteamID.getHighBits(),"String "+e+" was provided as a steam ID as a string, but had no high bits set. This is likely actually an account ID or was meant to be passed as a number")):t&&n&&void 0!==o?this.SetFromComponents(e,o,n,t):this.m_ulSteamID=e?a.a.fromNumber(e,!0):a.a.UZERO}return i.InitFromAccountID=function(e){return new i(e,s.b.EUNIVERSE,1,r.m)},i.InitFromClanID=function(e){return new i(e,s.b.EUNIVERSE,7,0)},i.prototype.GetAccountID=function(){return this.m_ulSteamID.getLowBitsUnsigned()},i.prototype.GetInstance=function(){return 1048575&this.m_ulSteamID.getHighBitsUnsigned()},i.prototype.GetAccountType=function(){return this.m_ulSteamID.getHighBitsUnsigned()>>20&15},i.prototype.GetUniverse=function(){return this.m_ulSteamID.getHighBitsUnsigned()>>24&255},i.prototype.ConvertTo64BitString=function(){return this.m_ulSteamID.toString()},i.prototype.Render=function(){switch(this.GetAccountType()){case 0:return"[I:"+this.GetUniverse()+":"+this.GetAccountID()+"]";case 7:return"[g:"+this.GetUniverse()+":"+this.GetAccountID()+"]";case 4:return"[A:"+this.GetUniverse()+":"+this.GetAccountID()+":"+this.GetInstance()+"]";case 3:return"[G:"+this.GetUniverse()+":"+this.GetAccountID()+"]";case 2:return"[M:"+this.GetUniverse()+":"+this.GetAccountID()+":"+this.GetInstance()+"]";case 5:return"[P:"+this.GetUniverse()+":"+this.GetAccountID()+"]";case 6:return"[C:"+this.GetUniverse()+":"+this.GetAccountID()+"]";default:return"[U:"+this.GetUniverse()+":"+this.GetAccountID()+"]"}},i.prototype.BIsValid=function(){var e=this.GetAccountType();if(e<=0||11<=e)return!1;var t=this.GetUniverse();if(t<=0||5<=t)return!1;if(1==e){if(0==this.GetAccountID()||this.GetInstance()>r.n)return!1}else if(7==e){if(0==this.GetAccountID()||0!=this.GetInstance())return!1}else if(3==e&&0==this.GetAccountID())return!1;return!0},i.prototype.BIsIndividualAccount=function(){return 1==this.GetAccountType()},i.prototype.BIsClanAccount=function(){return 7==this.GetAccountType()},i.prototype.SetAccountID=function(e){this.m_ulSteamID=new a.a(e,this.m_ulSteamID.getHighBitsUnsigned(),!0)},i.prototype.SetInstance=function(e){this.SetFromComponents(this.GetAccountID(),e,this.GetAccountType(),this.GetUniverse())},i.prototype.SetAccountType=function(e){this.SetFromComponents(this.GetAccountID(),this.GetInstance(),e,this.GetUniverse())},i.prototype.SetUniverse=function(e){this.SetFromComponents(this.GetAccountID(),this.GetInstance(),this.GetAccountType(),e)},i.prototype.SetFromComponents=function(e,t,n,o){var i=((255&o)<<24)+((15&n)<<20)+(1048575&t),r=4294967295&e;this.m_ulSteamID=new a.a(r,i,!0)},i}()},s13G:function(e,t,n){e.exports={statusAndName:"personanameandstatus_statusAndName_9U-hi",blocked:"personanameandstatus_blocked_138jh",richPresenceLabel:"personanameandstatus_richPresenceLabel_3Q6g1",playerName:"personanameandstatus_playerName_1uxaf",playerNickname:"personanameandstatus_playerNickname_3-32P",playerNicknameBracket:"personanameandstatus_playerNicknameBracket_1lu-g",richPresenceContainer:"personanameandstatus_richPresenceContainer_21cNf",twoLine:"personanameandstatus_twoLine_2wZNn",DNDContainer:"personanameandstatus_DNDContainer_3h0SR",partyBeaconJoin:"personanameandstatus_partyBeaconJoin__ugTP",gameName:"personanameandstatus_gameName_qvibF",hidePersona:"personanameandstatus_hidePersona_1-otV",compactView:"personanameandstatus_compactView_2PCWF",noContextMenu:"personanameandstatus_noContextMenu_35VFv",SnoozeContainer:"personanameandstatus_SnoozeContainer_2xgNz",ModalPosition_TopBar:"personanameandstatus_ModalPosition_TopBar_1Y6m1"}},tkkQ:function(e,t,n){"use strict";var o=n("1n9R");n.d(t,"a",function(){return o.b}),n.d(t,"d",function(){return o.e}),n.d(t,"c",function(){return o.d}),n.d(t,"b",function(){return o.c})},twdX:function(e,t,n){e.exports={LoadingWrapper:"throbber_LoadingWrapper_9UFR8",noString:"throbber_noString_2uxjb",Throbber:"throbber_Throbber_1Y6Da",throbber_small:"throbber_throbber_small_21jHr",throbber_medium:"throbber_throbber_medium_1nACb",throbber_large:"throbber_throbber_large_3hJM_",throbber_center_wrapper:"throbber_throbber_center_wrapper_1Dn-N",ThrobberText:"throbber_ThrobberText_3r290",blur:"throbber_blur_3cMTP",ThrobberRoundLoop:"throbber_ThrobberRoundLoop_3iwJU",roundOuterOutline:"throbber_roundOuterOutline_1yAiX",roundOuter:"throbber_roundOuter_3LNze",roundFill:"throbber_roundFill_3dnp9",ThrobberFillLoop:"throbber_ThrobberFillLoop_1e442",topCircle:"throbber_topCircle_3Zy4H",circlePulse:"throbber_circlePulse_17mrs",ThrobberTopCircleLoop:"throbber_ThrobberTopCircleLoop_RFW6m",ThrobberBottomCircleLoop:"throbber_ThrobberBottomCircleLoop_1AigW",bottomCircle:"throbber_bottomCircle_1XTvd",roundThrobber15:"throbber_roundThrobber15_Ty6Px",roundThrobber14:"throbber_roundThrobber14_T03GA",roundThrobber13:"throbber_roundThrobber13_2YjHq",roundThrobber12:"throbber_roundThrobber12_39ueX",roundThrobber11:"throbber_roundThrobber11_ze_zC",roundThrobber10:"throbber_roundThrobber10_jIdSr",roundThrobber09:"throbber_roundThrobber09_3R4dR",roundThrobber08:"throbber_roundThrobber08_2WJ-s",roundThrobber07:"throbber_roundThrobber07_2UhCH",roundThrobber06:"throbber_roundThrobber06_gkW0p",roundThrobber05:"throbber_roundThrobber05_20j9w",roundThrobber04:"throbber_roundThrobber04_3TMdv",roundThrobber03:"throbber_roundThrobber03_3aNO_",roundThrobber02:"throbber_roundThrobber02_1m8h_",roundThrobber01:"throbber_roundThrobber01_2h6Ph",ThrobberRoundLoopThickness:"throbber_ThrobberRoundLoopThickness_1YJDV",throbber_xlarge:"throbber_throbber_xlarge_iO6_X"}},ugMY:function(e,t,n){e.exports={avatarHolder:"steamavatar_avatarHolder_1G7LI",avatarStatus:"steamavatar_avatarStatus_1Pwr6",avatar:"steamavatar_avatar_f2laR",friendavatar:"steamavatar_friendavatar_2yzw2"}},v5rQ:function(e,t,n){e.exports={SpeakerName_InGame:"messages_SpeakerName_InGame_1vaKy",SpeakerName_Golden:"messages_SpeakerName_Golden_hZgKn",SpeakerName_WatchingBroadcast:"messages_SpeakerName_WatchingBroadcast_3DQ_c",SpeakerName_Online:"messages_SpeakerName_Online_2nKVN",SpeakerName_Default:"messages_SpeakerName_Default_1Qo8j"}},"w/TS":function(e,t,n){},whIR:function(e,t,n){},yLAU:function(e,t,n){}});